function DocsOut_SubmenuTabClicked(pFadePageCover) {
    debugger;
    pFadePageCover = (pFadePageCover != undefined && pFadePageCover != null ? pFadePageCover : true);
    if ($("#tblDocsOut tbody tr").length == 0) {
        DocsOut_LoadAll($("#hOperationID").val(), null, pFadePageCover);
        //var pWhereClause = " WHERE ID = " + $("#hOperationID").val() + " OR MasterOperationID = " + $("#hOperationID").val();
        //GetListWithOpCodeAndHouseNoAndClientEmailAttr($("#hOperationID").val(), "/api/Operations/LoadWithParameters", null, "slDocsOutOperations", { pPageNumber: 1, pPageSize: 99999, pWhereClause: pWhereClause, pOrderBy: "HouseNumber" }
        //    , null);
        if ($("#tblPayables tbody tr").length == 0 && $("#tblReceivables tbody tr").length == 0) {
            Payables_LoadWithPagingWithWhereClause($("#hOperationID").val(), null, pFadePageCover);
            Receivables_LoadWithPagingWithWhereClause($("#hOperationID").val(), null, false);
        }
    }
}
function DocsOut_BindTableRows(pDocumentTypes) {
    debugger;
    ClearAllTableRows("tblDocsOut");
    //editControlsText = " class='btn btn-xs btn-rounded btn-info float-right' > <i class='fa fa-pencil' style='padding-left: 5px;'></i> <span style='padding-right: 5px;'>" + TranslateString("Edit") + "</span>";
    var printControlsText = " class='btn btn-xs btn-rounded btn-info float-right' > <i class='fa fa-print' style='padding-left: 5px;'></i> <span style='padding-right: 5px;'>" + TranslateString("Print") + "</span>";
    var emailControlsText = " class='btn btn-xs btn-rounded btn-primary float-right' > <i class='fa fa-envelope-o' style='padding-left: 5px;'></i> <span style='padding-right: 5px;'>" + TranslateString("Mail") + "</span>";
    var FIATAControlsText = " class='btn btn-xs btn-rounded btn-lightblue float-right' > <i class='fa fa-globe' style='padding-left: 5px;'></i> <span style='padding-right: 5px;'>" + "Send To FIATA" + "</span>";
    $.each(pDocumentTypes, function (i, item) {
        AppendRowtoTable("tblDocsOut",
            //("<tr ID='" + item.ID + "' ondblclick='DocumentTypes_EditByDblClick(" + item.ID + ");'>"
            ("<tr ID='" + item.ID + "' "
                + "class='"
                + (!ODDoc && item.Name == "LetterRelease" ? "hide" : "")
                + "'"
                + ">"
                + "<td class='ID hide'> <input name='Delete' type='checkbox' value='" + item.ID + "' /></td>"
                + "<td class='Name hide'>" + (item.Name == 0 ? "" : item.Name) + "</td>"
                + "<td class='LocalName hide'>" + (item.LocalName == 0 ? "" : item.LocalName) + "</td>"
                + "<td class='TableOrViewName'>" + (item.TableOrViewName == 0 ? "" : item.TableOrViewName) + ((item.Name == "eFBL" && glbCallingControl == "OperationsEdit" && pOperationHeader_Global.eFBLID != "0") ? ("-" + pOperationHeader_Global.eFBLID) : "") + "</td>"//the local name is used as the shown name(with spaces)
                //+ "<td class='TableOrViewName'>" + (item.TableOrViewName == 0 ? "" : item.TableOrViewName) + "</td>"//the local name is used as the shown name(with spaces)
                + "<td class='ISOCode'>" + (item.ISOCode == 0 ? "" : item.ISOCode) + "</td>"
                + "<td class='IsImport hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsImport == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsExport hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsExport == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsDomestic hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsDomestic == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsOcean hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsOcean == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsAir hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsAir == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsInland hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsInland == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsDocIn hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsDocIn == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsDocOut hide'> <input type='checkbox' disabled='disabled' val='" + (item.IsDocOut == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='ShowHeader hide'> <input type='checkbox' disabled='disabled' val='" + (item.ShowHeader == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='ShowFooter hide'> <input type='checkbox' disabled='disabled' val='" + (item.ShowFooter == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='IsPrintISOCode hide'> <input type='checkbox' disabled='disabled' val='" + (item.PrintISOCode == true ? "true' checked='checked'" : "'") + " /></td>"
                + "<td class='Notes hide'>" + (item.Notes == 0 ? "" : item.Notes) + "</td>"
                //+ "<td class='PrintCount hide'>" + item.PrintCount + "</td>"
                //+ "<td class=''><a href='#DocumentTypeModal' data-toggle='modal' onclick='DocumentTypes_FillControls(" + item.ID + ");' " + editControlsText + "</a></td></tr>"));
                + "<td class=''>"
                //+ "<a onclick='DocsOut_SendEmail(" + item.ID + ", function(){window.onbeforeunload = confirmExit;});' " + emailControlsText + "</a>"
                //eFBL_Send

                + (item.Name == "eFBL" && glbCallingControl == "OperationsEdit"
                    ?
                    ("<a href='#' id='a2' data-toggle='modal' " + (pOperationHeader_Global.eFBLID == 0 ? "" : (" onclick='OpenUploadedFile_Global(" + `"/api` + String.raw`\\eFBL\\` + pOperationHeader_Global.ID + String.raw`\\` + pOperationHeader_Global.eFBLID + `.pdf"` + ");' ")) + " class='btn btn-xs btn-rounded btn-info float-right classEnableForeFBL " + (pOperationHeader_Global.eFBLID == 0 ? "disabled " : "") + "' > <i class='fa fa-print' style='padding-left: 5px;'></i> <span style='padding-right: 5px;'>" + TranslateString("Print") + "</span>" + "</a>"
                        + "<a id='a2_SendeFBLEmail' onclick='eFBL_SendMail(" + pOperationHeader_Global.ID + `,"` + pOperationHeader_Global.eFBLID + `.pdf"` + ");' " + " class='btn btn-xs btn-rounded btn-primary float-right classEnableForeFBL " + (pOperationHeader_Global.eFBLID == 0 ? "disabled " : "") + "' > <i class='fa fa-envelope-o' style='padding-left: 5px;'></i> <span style='padding-right: 5px;'>" + TranslateString("Mail") + "</span>" + "</a>"
                        + "<a href='#DocumentTypeModal' data-toggle='modal' onclick='eFBL_Generate();' " + FIATAControlsText + "</a>"
                    )
                    : ("<a href='#DocumentTypeModal' data-toggle='modal' onclick='DocsOut_Print(" + item.ID + ",0,null,null," + '"Print"' + ");' " + printControlsText + "</a>"
                        + "<a onclick='DocsOut_OpenPartnersModal(" + item.ID + ",0,null,null," + '"Email"' + ");' " + emailControlsText + "</a>"
                    )
                )
                + "</td>"
                //+ ($("#hIsOperationDisabled").val() == false
                //? ("<td class=''><a href='#DocumentTypeModal' data-toggle='modal' onclick='DocsOut_Print(" + item.ID + ",0);' " + printControlsText + "</a><a onclick='DocsOut_SendEmail(" + item.ID + ", function(){window.onbeforeunload = confirmExit;});' " + emailControlsText + "</a>&nbsp;&nbsp;&nbsp;</td>")
                //: "<td></td>")
                + "</tr>"));
    });
    //ApplyPermissions();
    BindAllCheckboxonTable("tblDocsOut", "ID");
    CheckAllCheckbox("ID");
    //HighlightText("#tblDocumentTypes>tbody>tr", $("#txt-Search").val().trim());
    //if (showDeleteFailMessage) {//sherif: if deletion failed due to foreign key, then this message is shown
    //    swal(strSorry, strDeleteFailMessage, "warning");
    //    showDeleteFailMessage = false;
    //}
}
function DocsOut_LoadAll(pOperationID, pSlNameToBeFilled, pFadePageCover) {
    pFadePageCover = (pFadePageCover != undefined && pFadePageCover != null ? pFadePageCover : true);
    var pWhereClause = " WHERE 1=1 ";
    //if (pSlNameToBeFilled != undefined && pSlNameToBeFilled != null)
    //    pWhereClause += " AND Name <> 'HBL' ";
    if (!ODDoc)
        pWhereClause += " AND Name NOT IN (N'ExpectedProfit',N'OperationStatement') ";
    pWhereClause += ($("#cbIsImport").prop("checked") ? " AND IsImport = 1 " : "");
    pWhereClause += ($("#cbIsExport").prop("checked") ? " AND IsExport = 1 " : "");
    pWhereClause += ($("#cbIsDomestic").prop("checked") ? " AND IsDomestic = 1 " : "");
    pWhereClause += ($("#cbIsOcean").prop("checked") ? " AND IsOcean = 1 " : "");
    pWhereClause += ($("#cbIsAir").prop("checked") ? " AND IsAir = 1 " : "");
    pWhereClause += ($("#cbIsInland").prop("checked") ? " AND IsInland = 1 " : "");
    pWhereClause += " AND IsDocOut = 1 ";

    if (IsMESCOCompany && glbCallingControl == "BLDocuments")
        pWhereClause += " AND NAME IN ('DeliveryOrder', 'Shipping Order', 'HBL') ";

    //pWhereClause += " AND (OperationID = " + pOperationID + " OR OperationID IS NULL) ";
    pWhereClause += " ORDER BY ViewOrder,TableOrViewName ";//the ID is used as the ViewOrder(its not AutoIdentity)
    LoadAll("/api/DocumentTypes/LoadAll", pWhereClause
        , function (pTabelRows) {
            DocsOut_BindTableRows(JSON.parse(pTabelRows)); /*DocsOut_ClearAllControls();*/
            if (pSlNameToBeFilled != null && pSlNameToBeFilled != undefined)
                FillListFromObject(null, 2, "<--Select-->", pSlNameToBeFilled, pTabelRows, null);
        }
        , pFadePageCover);
}

function DocsOut_OpenPartnersModal(pDocumentTypeID, pTruckingOrderID, pShipmentID, IsA4Paper, pOption) {
    debugger;
    FadePageCover(true);
    $("#lblSelectListGeneralShown").text("Partner");
    $("#btnSelectListGeneral").html('<span class="fa fa-envelope"></span> Send');
    $("#btnSelectListGeneral").attr("onclick", "DocsOut_Print(" + pDocumentTypeID + "," + pTruckingOrderID + "," + pShipmentID + "," + IsA4Paper + ",'" + pOption + "');");
    var pWhereClause = " WHERE OperationID = " + $("#slDocsOutOperations").val();
    //var pWhereClause = " WHERE (OperationID = " + $("#slDocsOutOperations").val() + " OR MasterOperationID = " + $("#slDocsOutOperations").val() + " ) \n";
    pWhereClause += " AND PartnerID IS NOT NULL ";
    //pWhereClause += " AND (PartnerTypeID = " + constCustomerPartnerTypeID;
    //pWhereClause += " OR PartnerTypeID = " + constAgentPartnerTypeID + ") ";
    pWhereClause += " ORDER BY PartnerTypeName ";
    //parameters: ID, strFnName, First Row in select list, select list name, whereClause, callback
    GetListOperationPartnersWithPartnerTypeIDAndPartnerIDAttrAndWhereClause(null, "/api/OperationPartners/LoadAll", "Select Partner", "slSelectListGeneral", pWhereClause
        , function () {
            //if ((pID == null || pID == undefined) && $("#" + pSlName + " :nth-of-type(2)").val() != undefined)
            //    $("#" + pSlName).val($("#" + pSlName + " :nth-of-type(2)").val());//to select the 1st item
            jQuery("#SelectListGeneralModal").modal("show");
            FadePageCover(false);
        });
}

function DocsOut_GetHouseOperationNumbersOnMaster() {
    var strHouses = ""
    if ($("#slDocsOutOperations option").length > 1)
        $("#slDocsOutOperations option").each(function (i) {
            debugger;
            strHouses += (i == 0 ? "" : (strHouses == "" ? $(this).attr("OperationCode") : ', ' + $(this).attr("OperationCode")));
        });
    return strHouses
}
function DocsOut_CallPrintFromOutOfOperation() {
    debugger;
    if ($("#slDocsOutTypes").val() == "")
        swal("Sorry", "Please, select document to print.");
    else {
        $("#slDocsOutOperations").html($("#slDocsOutOperationsFromSearch").html());
        DocsOut_Print($("#slDocsOutTypes").val(), 0, $("#slDocsOutOperationsFromSearch").val(), 0);
    }
}
function DocsOut_Print(pDocumentTypeID, pTruckingOrderID, pShipmentID, IsA4Paper, pOption) { //pShipmentID is used when called from shipments to print HBL
    debugger;
    FadePageCover(true);
    var pSelectedPayableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblPayables', 'PrintPayable');
    var pSelectedReceivableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblReceivables', 'nameExcludePurchase');
    //var pSelectedPayableIDs = GetAllSelectedIDsAsString('tblPayables');
    var pWhereClause = "";
    pWhereClause += " WHERE ID = " + pDocumentTypeID;
    var pParametersWithValues = {
        pWhereClause: pWhereClause
        , pDocumentTypeID: pDocumentTypeID
        , pOperationID: pShipmentID == undefined ? $("#slDocsOutOperations").val() : pShipmentID //$("#hOperationID").val()
        , pReportTypeID: 3//$("#ulDocsOutReportTypes .active").val() //3:pdf , 4:rft
        , pTruckingOrderID: pTruckingOrderID
        , pSelectedPayableIDs: pSelectedPayableIDs == "" ? "0" : pSelectedPayableIDs
        , pSelectedReceivableIDs: pSelectedReceivableIDs == "" ? "0" : pSelectedReceivableIDs
        , pWithVAT: $("#cbWithVAT").prop("checked")
        , pCommodityID: $("#slDocsOutCommodity").val() == "" || $("#slDocsOutCommodity").val() == undefined ? 0 : $("#slDocsOutCommodity").val()
    };
    CallGETFunctionWithParameters("/api/Reports/Report_DocsOut"
        , pParametersWithValues
        , function (data) {
            if (data[0] == false) {
                swal(strSorry, data[1]);
                FadePageCover(false);
            }
            else { //(data[0] == true)
                if (pDefaults.UnEditableCompanyName == "DYN"
                    && (
                        $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "BookingConfirmation"
                        || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ArrivalNotice"
                        || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingAdvice"
                    )
                )
                    DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ArrivalNotice") {
                    if (pDefaults.UnEditableCompanyName == "SGA")
                        DocsOut_Print_ArrivalNotice_SeaGate(data, pDocumentTypeID, pOption);
                    else if (pDefaults.UnEditableCompanyName == "FFI" || pDefaults.UnEditableCompanyName == "NSL" || pDefaults.UnEditableCompanyName == "KML")
                        DocsOut_Print_ArrivalNotice_OldForm(data, pDocumentTypeID, pOption);
                    else if (1 == 1) { //all other
                        if ($("#cbIsAir").prop("checked"))
                            DocsOut_Print_ArrivalNotice_Default_AIR(data, pDocumentTypeID, pOption);
                        else
                            DocsOut_Print_ArrivalNotice_Default_OCEAN(data, pDocumentTypeID, pOption); //ocean and inland
                    }
                }
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DeliveryOrder") {
                    if ((pDefaults.UnEditableCompanyName == "EEL") && $("#cbIsAir").prop("checked"))
                        DocsOut_Print_DeliveryOrder_EEL_Air(data, pDocumentTypeID, pOption);
                    else {
                        if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                            DocsOut_Print_DeliveryOrderILS($("#slDocsOutOperations").val());
                        }
                        else {
                            DocsOut_Print_DeliveryOrder(data, pDocumentTypeID, pOption);
                        }
                    }
                }
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "AirLabel")
                    DocsOut_Print_AirLabel(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "LetterRelease") {
                    if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                        DocsOut_Print_LetterReleaseILS($("#slDocsOutOperations").val());
                    }
                    else {
                        DocsOut_Print_LetterRelease(data, pDocumentTypeID, pOption);
                    }
                }

                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ReservationLetter")
                    DocsOut_Print_ReservationLetter(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DangerousGoodsLetter")
                    DocsOut_Print_DangerousGoodsLetter(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover"
                    || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit"
                    || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationStatement")
                    if (pDefaults.UnEditableCompanyName == "NSL" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover" && $("#cbIsExport").prop("checked")) //ExpectedProfit & OperationStatement & Export for NSL are printed as the other companies
                        DocsOut_Print_OperationCover_NSL(data, pDocumentTypeID, pOption);
                    else if ((pDefaults.UnEditableCompanyName == "EEL") && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover")
                        DocsOut_Print_OperationCover_EEL(data, pDocumentTypeID, pOption);
                    else //anycompany other than NSL,EEL,PFS
                        if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "ExpectedProfit"
                            && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "OperationStatement") {
                            DocsOut_Print_OperationCoverAndDetailsILS(pShipmentID == undefined ? $("#slDocsOutOperations").val() : pShipmentID);

                        }
                        else {
                            DocsOut_Print_OperationCoverAndDetails(data, pDocumentTypeID, pOption);

                        }
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationSummary")
                    DocsOut_Print_OperationSummary(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ProofOfDelivery")
                    DocsOut_Print_ProofOfDelivery(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PaymentRequests"
                    || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationPayables"
                    || pDocumentTypeID == 60 || pDocumentTypeID == 70 || pDocumentTypeID == 90 || pDocumentTypeID == 95)
                    DocsOut_Print_PaymentRequests(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DangerousShippingDeclarationAir")
                    DocsOut_Print_ShippingDeclaration_DangerousAir(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration" || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration") {
                    if (pDefaults.UnEditableCompanyName == "SGA")
                        DocsOut_Print_ShippingAndPreShippingDeclaration_SeaGate(data, pDocumentTypeID, pOption);
                    else if (pDefaults.UnEditableCompanyName == "OAO" || pDefaults.UnEditableCompanyName == "STR" || pDefaults.UnEditableCompanyName == "TRL" || pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC")
                        DocsOut_Print_ShippingAndPreShippingDeclaration_OAO(data, pDocumentTypeID, pOption);
                    else //any other companies
                        DocsOut_Print_ShippingAndPreShippingDeclaration(data, pDocumentTypeID, pOption);
                }
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingAdvice")
                    DocsOut_Print_ShippingAdvice(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShipmentDetails")
                    DocsOut_Print_ShipmentDetails(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "BookingConfirmation")
                    DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "HBL") { //All companies use LATT format
                    //if (pDefaults.UnEditableCompanyName == "SGA")
                    //    DocsOut_Print_HBL_SGA(data, pDocumentTypeID, pOption);
                    //else
                    //if ($("#cbIsAWB").prop("checked"))
                    debugger;
                    var SelectedOperationID = "";
                    if (glbCallingControl == "OperationsManagement")
                        SelectedOperationID = $("#slDocsOutOperationsFromSearch").val();
                    else
                        SelectedOperationID = (pShipmentID == 0 || pShipmentID == null) ? $("#slDocsOutOperations").val() : pShipmentID;

                    if ($("#cbIsAir").prop("checked")) {
                        //// AIR
                        //if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG" || IsMESCOCompany)) {
                            if (data[2] == "0") {// means house
                                DocsOut_Print_HBL_LATILS_AIR("AIRHBL", SelectedOperationID);
                            }
                            else {
                                DocsOut_Print_HBL_LATILS_AIR("AIR", SelectedOperationID);
                            }

                        //}
                        //else {
                        //    DocsOut_Print_AWB(data, pDocumentTypeID, pOption, IsA4Paper);

                        //}
                    } else if (pDefaults.UnEditableCompanyName == "NIL" || pDefaults.UnEditableCompanyName == "GBL"
                        || pDefaults.UnEditableCompanyName == "ELI" || pDefaults.UnEditableCompanyName == "PFS"
                        || pDefaults.UnEditableCompanyName == "SWI" || pDefaults.UnEditableCompanyName == "FIV"

                        || pDefaults.UnEditableCompanyName == "ALT" || pDefaults.UnEditableCompanyName == "MES"
                        || pDefaults.UnEditableCompanyName == "GLO" || pDefaults.UnEditableCompanyName == "SAC"
                        || pDefaults.UnEditableCompanyName == "EUR"
                    ) {
                        DocsOut_Print_HBL(data, pDocumentTypeID, pOption);
                    } else {
                        if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                            if (data[40] == "FCL") {
                                if (data[2] == "0") {
                                    DocsOut_Print_HBL_LATILS("FCLHBL", SelectedOperationID);

                                }
                                else {
                                    DocsOut_Print_HBL_LATILS("FCL", SelectedOperationID);

                                }

                            }
                            else if (data[40] == "LCL") {
                                DocsOut_Print_HBL_LATILS("LCL", SelectedOperationID);

                            }
                            else if (data[40] == "CONSOL") {
                                DocsOut_Print_HBL_LATILS("CONSOL", SelectedOperationID);

                            }
                            else {
                                DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption);

                            }

                        }
                        else {

                            // ARKBL
                            if (pDefaults.UnEditableCompanyName == "ARK"){
                                DocsOut_Print_HBL_LAT_ARK(SelectedOperationID);
                            } else {
                                DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption);
                            }


                        }
                    }

                }
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "TruckingOrder")
                    DocsOut_Print_TruckingOrder(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Manifest")
                    DocsOut_Print_Manifest(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ManifestModify")
                    DocsOut_Print_ManifestModify(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "MEDCover")
                    DocsOut_Print_MEDCover(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Route")
                    DocsOut_Print_Route(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DismissalPermission")
                    DocsOut_Print_DismissalPermission(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Consolidation Letter")
                    DocsOut_Print_ConsolidationLetter(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Shipping Order")
                    DocsOut_Print_ShippingOrder(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Operation Tracking")
                    DocsOut_Print_OperationTracking(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اذن شحن")
                    DocsOut_Print_ShippingPermission(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اذن تسليم")
                    DocsOut_Print_DeliveryPermission(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرارHBL")
                    DocsOut_Print_HBLEndorsement(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار المنافيست")
                    DocsOut_Print_ManifestEndorsement(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مخزن")
                    DocsOut_Print_StoreEndorsement(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مستودعات")
                    DocsOut_Print_WarehouseEndorsement(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مفرقعات")
                    DocsOut_Print_ExplosivesEndorsement(data, pDocumentTypeID, pOption);
                else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرارالشبكه الالكترونيه")
                    DocsOut_Print_NetworkEndorsement(data, pDocumentTypeID, pOption);
                if (pOption != "Email")
                    FadePageCover(false);
            } //(data[0] == true)
        });
}
function DocsOut_Print_Multiple_ManyPages() {
    debugger;
    var pDocumentTypeID = 0;
    var pTruckingOrderID = 0;
    var pOption = "Print";

    if ($("#slDocsOutTypesOutsideModal").val() == "") {
        swal(strSorry, "Please Select Document Type First");
    } else if (GetAllSelectedIDsAsString('tblOperations') == "") {
        swal(strSorry, "Please Select at least one Operation");
    } else {
        debugger;
        pDocumentTypeID = $("#slDocsOutTypesOutsideModal").val();


        FadePageCover(true);
        var pSelectedPayableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblPayables', 'PrintPayable');
        var pSelectedReceivableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblReceivables', 'nameExcludePurchase');
        //var pSelectedPayableIDs = GetAllSelectedIDsAsString('tblPayables');
        var pWhereClause = "";
        pWhereClause += " WHERE ID = " + pDocumentTypeID;
        var pParametersWithValues = {
            pWhereClause: pWhereClause
            , pDocumentTypeID: pDocumentTypeID
            //, pOperationID: pShipmentID == undefined ? $("#slDocsOutOperations").val() : pShipmentID //$("#hOperationID").val()
            , pOperationIDsList: GetAllSelectedIDsAsString('tblOperations')
            , pReportTypeID: 3//$("#ulDocsOutReportTypes .active").val() //3:pdf , 4:rft
            , pTruckingOrderID: pTruckingOrderID
            , pSelectedPayableIDs: pSelectedPayableIDs == "" ? "0" : pSelectedPayableIDs
            , pSelectedReceivableIDs: pSelectedReceivableIDs == "" ? "0" : pSelectedReceivableIDs
            , pWithVAT: $("#cbWithVAT").prop("checked")
            , pCommodityID: $("#slDocsOutCommodity").val() == "" || $("#slDocsOutCommodity").val() == undefined ? 0 : $("#slDocsOutCommodity").val()
        };
        CallGETFunctionWithParameters("/api/Reports/Report_DocsOut_Multiple"
            , pParametersWithValues
            , function (DataArray) {
                debugger;
                var pOperationIDsArray = GetAllSelectedIDsAsString('tblOperations').split(',');
                for (let i = 0; i < pOperationIDsArray.length; i++) {
                    var data = DataArray[i];

                    if (data[0] == false) {
                        swal(strSorry, data[1]);
                        FadePageCover(false);
                    }
                    else { //(data[0] == true)
                        if (pDefaults.UnEditableCompanyName == "DYN"
                            && (
                                $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "BookingConfirmation"
                                || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ArrivalNotice"
                                || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingAdvice"
                            )
                        )
                            DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ArrivalNotice") {
                            if (pDefaults.UnEditableCompanyName == "SGA")
                                DocsOut_Print_ArrivalNotice_SeaGate(data, pDocumentTypeID, pOption);
                            else if (pDefaults.UnEditableCompanyName == "FFI" || pDefaults.UnEditableCompanyName == "NSL" || pDefaults.UnEditableCompanyName == "KML")
                                DocsOut_Print_ArrivalNotice_OldForm(data, pDocumentTypeID, pOption);
                            else if (1 == 1) { //all other
                                if ($("#cbIsAir").prop("checked"))
                                    DocsOut_Print_ArrivalNotice_Default_AIR(data, pDocumentTypeID, pOption);
                                else
                                    DocsOut_Print_ArrivalNotice_Default_OCEAN(data, pDocumentTypeID, pOption); //ocean and inland
                            }
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DeliveryOrder") {
                            if ((pDefaults.UnEditableCompanyName == "EEL") && $("#cbIsAir").prop("checked"))
                                DocsOut_Print_DeliveryOrder_EEL_Air(data, pDocumentTypeID, pOption);
                            else {
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                    DocsOut_Print_DeliveryOrderILS($("#slDocsOutOperations").val());
                                }
                                else {
                                    DocsOut_Print_DeliveryOrder(data, pDocumentTypeID, pOption);
                                }
                            }
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "AirLabel")
                            DocsOut_Print_AirLabel(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "LetterRelease") {
                            if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                DocsOut_Print_LetterReleaseILS($("#slDocsOutOperations").val());
                            }
                            else {
                                DocsOut_Print_LetterRelease(data, pDocumentTypeID, pOption);
                            }
                        }

                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ReservationLetter")
                            DocsOut_Print_ReservationLetter(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DangerousGoodsLetter")
                            DocsOut_Print_DangerousGoodsLetter(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover"
                            || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit"
                            || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationStatement")
                            if (pDefaults.UnEditableCompanyName == "NSL" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover" && $("#cbIsExport").prop("checked")) //ExpectedProfit & OperationStatement & Export for NSL are printed as the other companies
                                DocsOut_Print_OperationCover_NSL(data, pDocumentTypeID, pOption);
                            else if ((pDefaults.UnEditableCompanyName == "EEL") && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover")
                                DocsOut_Print_OperationCover_EEL(data, pDocumentTypeID, pOption);
                            else //anycompany other than NSL,EEL,PFS
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "ExpectedProfit"
                                    && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "OperationStatement") {
                                    DocsOut_Print_OperationCoverAndDetailsILS(pShipmentID == undefined ? $("#slDocsOutOperations").val() : pShipmentID);

                                }
                                else {
                                    DocsOut_Print_OperationCoverAndDetails(data, pDocumentTypeID, pOption);

                                }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationSummary")
                            DocsOut_Print_OperationSummary(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ProofOfDelivery")
                            DocsOut_Print_ProofOfDelivery(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PaymentRequests"
                            || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationPayables"
                            || pDocumentTypeID == 60 || pDocumentTypeID == 70 || pDocumentTypeID == 90 || pDocumentTypeID == 95)
                            DocsOut_Print_PaymentRequests(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DangerousShippingDeclarationAir")
                            DocsOut_Print_ShippingDeclaration_DangerousAir(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration" || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration") {
                            if (pDefaults.UnEditableCompanyName == "SGA")
                                DocsOut_Print_ShippingAndPreShippingDeclaration_SeaGate(data, pDocumentTypeID, pOption);
                            else if (pDefaults.UnEditableCompanyName == "OAO" || pDefaults.UnEditableCompanyName == "STR" || pDefaults.UnEditableCompanyName == "TRL" || pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC")
                                DocsOut_Print_ShippingAndPreShippingDeclaration_OAO(data, pDocumentTypeID, pOption);
                            else //any other companies
                                DocsOut_Print_ShippingAndPreShippingDeclaration(data, pDocumentTypeID, pOption);
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingAdvice")
                            DocsOut_Print_ShippingAdvice(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShipmentDetails")
                            DocsOut_Print_ShipmentDetails(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "BookingConfirmation")
                            DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "HBL") { //All companies use LATT format
                            //if (pDefaults.UnEditableCompanyName == "SGA")
                            //    DocsOut_Print_HBL_SGA(data, pDocumentTypeID, pOption);
                            //else 
                            //if ($("#cbIsAWB").prop("checked"))
                            if ($("#cbIsAir").prop("checked"))
                                //if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG" || pDefaults.UnEditableCompanyName == "GLS")) {
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                    if (data[2] == "0") {
                                        DocsOut_Print_HBL_LATILS("AIRHBL", $("#slDocsOutOperations").val());

                                    }
                                    else {
                                        DocsOut_Print_HBL_LATILS("AIR", $("#slDocsOutOperations").val());

                                    }

                                }
                                else {
                                    DocsOut_Print_AWB(data, pDocumentTypeID, pOption, IsA4Paper);

                                }
                            else if (pDefaults.UnEditableCompanyName == "NIL" || pDefaults.UnEditableCompanyName == "GBL"
                                || pDefaults.UnEditableCompanyName == "ELI" || pDefaults.UnEditableCompanyName == "PFS"
                                || pDefaults.UnEditableCompanyName == "SWI" || pDefaults.UnEditableCompanyName == "FIV"

                                || pDefaults.UnEditableCompanyName == "ALT" || pDefaults.UnEditableCompanyName == "MES"
                                || pDefaults.UnEditableCompanyName == "GLO" || pDefaults.UnEditableCompanyName == "SAC"
                                || pDefaults.UnEditableCompanyName == "EUR"
                            )
                                DocsOut_Print_HBL(data, pDocumentTypeID, pOption);
                            else
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                    if (data[40] == "FCL") {
                                        if (data[2] == "0") {
                                            DocsOut_Print_HBL_LATILS("FCLHBL", $("#slDocsOutOperations").val());

                                        }
                                        else {
                                            DocsOut_Print_HBL_LATILS("FCL", $("#slDocsOutOperations").val());

                                        }

                                    }
                                    else if (data[40] == "LCL") {
                                        DocsOut_Print_HBL_LATILS("LCL", $("#slDocsOutOperations").val());

                                    }
                                    else if (data[40] == "CONSOL") {
                                        DocsOut_Print_HBL_LATILS("CONSOL", $("#slDocsOutOperations").val());

                                    }
                                    else {
                                        DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption);

                                    }

                                }
                                else {
                                    DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption);

                                }
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "TruckingOrder")
                            DocsOut_Print_TruckingOrder(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Manifest")
                            DocsOut_Print_Manifest(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ManifestModify")
                            DocsOut_Print_ManifestModify(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "MEDCover")
                            DocsOut_Print_MEDCover(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Route")
                            DocsOut_Print_Route(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DismissalPermission")
                            DocsOut_Print_DismissalPermission(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Consolidation Letter")
                            DocsOut_Print_ConsolidationLetter(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Shipping Order")
                            DocsOut_Print_ShippingOrder(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Operation Tracking")
                            DocsOut_Print_OperationTracking(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اذن شحن")
                            DocsOut_Print_ShippingPermission(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اذن تسليم")
                            DocsOut_Print_DeliveryPermission(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرارHBL")
                            DocsOut_Print_HBLEndorsement(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار المنافيست")
                            DocsOut_Print_ManifestEndorsement(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مخزن")
                            DocsOut_Print_StoreEndorsement(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مستودعات")
                            DocsOut_Print_WarehouseEndorsement(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مفرقعات")
                            DocsOut_Print_ExplosivesEndorsement(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرارالشبكه الالكترونيه")
                            DocsOut_Print_NetworkEndorsement(data, pDocumentTypeID, pOption);
                        if (pOption != "Email")
                            FadePageCover(false);
                    } //(data[0] == true)
                } //for (let i = 0; i < pOperationIDsArray.length; i++)


            });
    }


}
function DocsOut_Print_Multiple_OnePage() {
    debugger;
    var pDocumentTypeID = 0;
    var pTruckingOrderID = 0;
    var pOption = "Print";
    var IsLastPage = false;
    var IsFirstPage = false;

    if ($("#slDocsOutTypesOutsideModal").val() == "") {
        swal(strSorry, "Please Select Document Type First");
    } else if (GetAllSelectedIDsAsString('tblOperations') == "") {
        swal(strSorry, "Please Select at least one Operation");
    } else {
        debugger;
        pDocumentTypeID = $("#slDocsOutTypesOutsideModal").val();


        FadePageCover(true);
        var pSelectedPayableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblPayables', 'PrintPayable');
        var pSelectedReceivableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblReceivables', 'nameExcludePurchase');
        //var pSelectedPayableIDs = GetAllSelectedIDsAsString('tblPayables');
        var pWhereClause = "";
        pWhereClause += " WHERE ID = " + pDocumentTypeID;
        var pParametersWithValues = {
            pWhereClause: pWhereClause
            , pDocumentTypeID: pDocumentTypeID
            //, pOperationID: pShipmentID == undefined ? $("#slDocsOutOperations").val() : pShipmentID //$("#hOperationID").val()
            , pOperationIDsList: GetAllSelectedIDsAsString('tblOperations')
            , pReportTypeID: 3//$("#ulDocsOutReportTypes .active").val() //3:pdf , 4:rft
            , pTruckingOrderID: pTruckingOrderID
            , pSelectedPayableIDs: pSelectedPayableIDs == "" ? "0" : pSelectedPayableIDs
            , pSelectedReceivableIDs: pSelectedReceivableIDs == "" ? "0" : pSelectedReceivableIDs
            , pWithVAT: $("#cbWithVAT").prop("checked")
            , pCommodityID: $("#slDocsOutCommodity").val() == "" || $("#slDocsOutCommodity").val() == undefined ? 0 : $("#slDocsOutCommodity").val()
        };
        CallGETFunctionWithParameters("/api/Reports/Report_DocsOut_Multiple"
            , pParametersWithValues
            , function (DataArray) {
                debugger;
                var pOperationIDsArray = GetAllSelectedIDsAsString('tblOperations').split(',');
                for (let i = 0; i < pOperationIDsArray.length; i++) {
                    var data = DataArray[i];

                    if (i == 0) {
                        IsFirstPage = true;
                    } else {
                        IsFirstPage = false;
                    }

                    if (i == pOperationIDsArray.length - 1) {
                        IsLastPage = true;
                    }

                    if (data[0] == false) {
                        swal(strSorry, data[1]);
                        FadePageCover(false);
                    }
                    else { //(data[0] == true)
                        if (pDefaults.UnEditableCompanyName == "DYN"
                            && (
                                $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "BookingConfirmation"
                                || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ArrivalNotice"
                                || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingAdvice"
                            )
                        )
                            DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ArrivalNotice") {
                            if (pDefaults.UnEditableCompanyName == "SGA")
                                DocsOut_Print_ArrivalNotice_SeaGate(data, pDocumentTypeID, pOption);
                            else if (pDefaults.UnEditableCompanyName == "FFI" || pDefaults.UnEditableCompanyName == "NSL" || pDefaults.UnEditableCompanyName == "KML")
                                DocsOut_Print_ArrivalNotice_OldForm(data, pDocumentTypeID, pOption);
                            else if (1 == 1) { //all other
                                if ($("#cbIsAir").prop("checked"))
                                    DocsOut_Print_ArrivalNotice_Default_AIR(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                                else
                                    DocsOut_Print_ArrivalNotice_Default_OCEAN(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage); //ocean and inland
                            }
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DeliveryOrder") {
                            if ((pDefaults.UnEditableCompanyName == "EEL") && $("#cbIsAir").prop("checked"))
                                DocsOut_Print_DeliveryOrder_EEL_Air(data, pDocumentTypeID, pOption);
                            else {
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                    DocsOut_Print_DeliveryOrderILS($("#slDocsOutOperations").val());
                                }
                                else {
                                    DocsOut_Print_DeliveryOrder(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                                }
                            }
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "AirLabel")
                            DocsOut_Print_AirLabel(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "LetterRelease") {
                            if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                DocsOut_Print_LetterReleaseILS($("#slDocsOutOperations").val());
                            }
                            else {
                                DocsOut_Print_LetterRelease(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                            }
                        }

                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ReservationLetter")
                            DocsOut_Print_ReservationLetter(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DangerousGoodsLetter")
                            DocsOut_Print_DangerousGoodsLetter(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover"
                            || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit"
                            || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationStatement")
                            if (pDefaults.UnEditableCompanyName == "NSL" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover" && $("#cbIsExport").prop("checked")) //ExpectedProfit & OperationStatement & Export for NSL are printed as the other companies
                                DocsOut_Print_OperationCover_NSL(data, pDocumentTypeID, pOption);
                            else if ((pDefaults.UnEditableCompanyName == "EEL") && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover")
                                DocsOut_Print_OperationCover_EEL(data, pDocumentTypeID, pOption);
                            else //anycompany other than NSL,EEL,PFS
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "ExpectedProfit"
                                    && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "OperationStatement") {
                                    DocsOut_Print_OperationCoverAndDetailsILS(pShipmentID == undefined ? $("#slDocsOutOperations").val() : pShipmentID);

                                }
                                else {
                                    DocsOut_Print_OperationCoverAndDetails(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);

                                }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationSummary")
                            DocsOut_Print_OperationSummary(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ProofOfDelivery")
                            DocsOut_Print_ProofOfDelivery(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PaymentRequests"
                            || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationPayables"
                            || pDocumentTypeID == 60 || pDocumentTypeID == 70 || pDocumentTypeID == 90 || pDocumentTypeID == 95)
                            DocsOut_Print_PaymentRequests(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DangerousShippingDeclarationAir")
                            DocsOut_Print_ShippingDeclaration_DangerousAir(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration" || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration") {
                            if (pDefaults.UnEditableCompanyName == "SGA")
                                DocsOut_Print_ShippingAndPreShippingDeclaration_SeaGate(data, pDocumentTypeID, pOption);
                            else if (pDefaults.UnEditableCompanyName == "OAO" || pDefaults.UnEditableCompanyName == "STR" || pDefaults.UnEditableCompanyName == "TRL" || pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC")
                                DocsOut_Print_ShippingAndPreShippingDeclaration_OAO(data, pDocumentTypeID, pOption);
                            else //any other companies
                                DocsOut_Print_ShippingAndPreShippingDeclaration(data, pDocumentTypeID, pOption);
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingAdvice")
                            DocsOut_Print_ShippingAdvice(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShipmentDetails")
                            DocsOut_Print_ShipmentDetails(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "BookingConfirmation")
                            DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "HBL") { //All companies use LATT format
                            //if (pDefaults.UnEditableCompanyName == "SGA")
                            //    DocsOut_Print_HBL_SGA(data, pDocumentTypeID, pOption);
                            //else 
                            //if ($("#cbIsAWB").prop("checked"))
                            if ($("#cbIsAir").prop("checked"))
                                //if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG" || pDefaults.UnEditableCompanyName == "GLS")) {
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                    if (data[2] == "0") {
                                        DocsOut_Print_HBL_LATILS("AIRHBL", $("#slDocsOutOperations").val());

                                    }
                                    else {
                                        DocsOut_Print_HBL_LATILS("AIR", $("#slDocsOutOperations").val());

                                    }

                                }
                                else {
                                    DocsOut_Print_AWB(data, pDocumentTypeID, pOption, IsA4Paper);

                                }
                            else if (pDefaults.UnEditableCompanyName == "NIL" || pDefaults.UnEditableCompanyName == "GBL"
                                || pDefaults.UnEditableCompanyName == "ELI" || pDefaults.UnEditableCompanyName == "PFS"
                                || pDefaults.UnEditableCompanyName == "SWI" || pDefaults.UnEditableCompanyName == "FIV"

                                || pDefaults.UnEditableCompanyName == "ALT" || pDefaults.UnEditableCompanyName == "MES"
                                || pDefaults.UnEditableCompanyName == "GLO" || pDefaults.UnEditableCompanyName == "SAC"
                                || pDefaults.UnEditableCompanyName == "EUR"
                            )
                                DocsOut_Print_HBL(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                            else
                                if ((pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")) {
                                    if (data[40] == "FCL") {
                                        if (data[2] == "0") {
                                            DocsOut_Print_HBL_LATILS("FCLHBL", $("#slDocsOutOperations").val());

                                        }
                                        else {
                                            DocsOut_Print_HBL_LATILS("FCL", $("#slDocsOutOperations").val());

                                        }

                                    }
                                    else if (data[40] == "LCL") {
                                        DocsOut_Print_HBL_LATILS("LCL", $("#slDocsOutOperations").val());

                                    }
                                    else if (data[40] == "CONSOL") {
                                        DocsOut_Print_HBL_LATILS("CONSOL", $("#slDocsOutOperations").val());

                                    }
                                    else {
                                        DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption);

                                    }

                                }
                                else {
                                    DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption);

                                }
                        }
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "TruckingOrder")
                            DocsOut_Print_TruckingOrder(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Manifest")
                            DocsOut_Print_Manifest(data, pDocumentTypeID, pOption);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ManifestModify")
                            DocsOut_Print_ManifestModify(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "MEDCover")
                            DocsOut_Print_MEDCover(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Route")
                            DocsOut_Print_Route(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "DismissalPermission")
                            DocsOut_Print_DismissalPermission(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Consolidation Letter")
                            DocsOut_Print_ConsolidationLetter(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Shipping Order")
                            DocsOut_Print_ShippingOrder(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "Operation Tracking")
                            DocsOut_Print_OperationTracking(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اذن شحن")
                            DocsOut_Print_ShippingPermission(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اذن تسليم")
                            DocsOut_Print_DeliveryPermission(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرارHBL")
                            DocsOut_Print_HBLEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار المنافيست")
                            DocsOut_Print_ManifestEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مخزن")
                            DocsOut_Print_StoreEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مستودعات")
                            DocsOut_Print_WarehouseEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرار مفرقعات")
                            DocsOut_Print_ExplosivesEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "اقرارالشبكه الالكترونيه")
                            DocsOut_Print_NetworkEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage);
                        if (pOption != "Email")
                            FadePageCover(false);
                    } //(data[0] == true)
                } //for (let i = 0; i < pOperationIDsArray.length; i++)


            });
    }


}


function DocsOut_Print_AirLabel(data, pDocumentTypeID, pOption) {
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pEnCompanyName = data[3];
    var pArCompanyName = data[4];
    var pContainerNumbers = data[5];
    var pGrossWeightSum = data[6];
    var pVolumeSum = data[7];
    var pVesselName = data[8];
    var pPOLCodeAndName = data[9];
    var pPODCodeAndName = data[10];
    var pLineName = data[11];
    var pExpectedArrival = data[12]; //pExpectedArrival.ToShortDateString()
    var pClientName = data[13];
    var pClientEmail = data[14];
    var pDescriptionOfGoods = data[15];
    var pActualArrival = data[16];

    var pMasterBL = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];

    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCommodityName = data[45];
    var pCustomerReference = data[46];
    var pCCAName = data[47];
    var pNumberOfPackages = data[48];
    var pVGMSum = data[49];
    var pDeliveryCountryName = data[50];
    var pDeliveryCityName = data[51];
    var pBookingNumber = data[52];
    var pExpectedDeparture = data[53];  //POL
    var pVoyageOrTruckNumber = data[54];
    var pActualDeparture = data[55];
    var pMasterOperationCode = data[56];
    var pOperationHeader = JSON.parse(data[57]);
    var pOperationContainersAndPackages = JSON.parse(data[58]);

    var ReportHTML = '';
    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if (pOperationHeader.BLType == constMasterBLType) { //master
        ReportHTML += '             <table border="0">';
        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td style="font-size:14pt;width:9.5cm;height:5.1cm;text-align:center;">';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.AirlineName == 0 ? "" : pOperationHeader.AirlineName) + '</p>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.Barcode == "" ? "Barcode Not Entered" : pOperationHeader.Barcode) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';
        ReportHTML += '             </table>';

        ReportHTML += '             <table border="1">';
        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="2" style="font-size:14pt;width:9.5cm;height:1.5cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Air-Waybill Number</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="1" style="font-size:14pt;width:4.75cm;height:1.4cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Destination</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.PODCode == 0 ? "" : pOperationHeader.PODCode) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                     <td colspan="1" style="font-size:14pt;width:4.75cm;height:1.4cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Total No of Pieces</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="2" style="font-size:14pt;width:9.5cm;height:1.4cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Agent</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.AgentName == 0 ? "" : pOperationHeader.AgentName) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';
        ReportHTML += '             </table>';
    }
    else { //house and direct
        ReportHTML += '             <table border="1">';
        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td style="font-size:14pt;width:9.5cm;height:1.5cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Airline</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.AirlineName == 0 ? "" : pOperationHeader.AirlineName) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';
        ReportHTML += '             </table>';

        ReportHTML += '             <table border="0">';
        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td style="font-size:12pt;width:9.5cm;height:2.6cm;text-align:center;">';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.Barcode == "" ? "Barcode Not Entered" : pOperationHeader.Barcode) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';
        ReportHTML += '             </table>';

        ReportHTML += '             <table border="1">';
        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="2" style="font-size:10pt;width:9.5cm;height:1.1cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Air-Waybill Number</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="1" style="font-size:10pt;width:4.75cm;height:1.1cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Destination</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.PODCode == 0 ? "" : pOperationHeader.PODCode) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                     <td colspan="1" style="font-size:10pt;width:4.75cm;height:1.1cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Total No of Pieces</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="2" style="font-size:10pt;width:9.5cm;height:1.1cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Agent</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.AgentName == 0 ? "" : pOperationHeader.AgentName) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="2" style="font-size:10pt;width:9.5cm;height:1.1cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">House Waybill Number</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '                 <tr>';
        ReportHTML += '                     <td colspan="1" style="font-size:10pt;width:4.75cm;height:1cm;text-align:center;">';
        ReportHTML += '                         <span style="float:left;font-size:6pt;">Total No. of HWB Pieces</span>';
        ReportHTML += '                         <p style="position:relative;clear:both;">' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + '</p>';
        ReportHTML += '                     </td>';
        ReportHTML += '                     <td colspan="1" style="font-size:10pt;width:4.75cm;height:1.1cm;text-align:center;">';
        ReportHTML += '                     </td>';
        ReportHTML += '                 </tr>';

        ReportHTML += '             </table>';
    } //else { //house and direct
    ReportHTML += '         </body>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ArrivalNotice_OldForm(data, pDocumentTypeID, pOption) {
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pEnCompanyName = data[3];
    var pArCompanyName = data[4];
    var pContainerNumbers = data[5];
    var pGrossWeightSum = data[6];
    var pVolumeSum = data[7];
    var pVesselName = data[8];
    var pPOLCodeAndName = data[9];
    var pPODCodeAndName = data[10];
    var pLineName = data[11];
    var pExpectedArrival = data[12]; //pExpectedArrival.ToShortDateString()
    var pClientName = data[13];
    var pClientEmail = data[14];
    var pDescriptionOfGoods = data[15];
    var pActualArrival = data[16];

    var pMasterBL = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];

    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCommodityName = data[45];
    var pCustomerReference = data[46];
    var pCCAName = data[47];
    var pNumberOfPackages = data[48];
    var pVGMSum = data[49];
    var pDeliveryCountryName = data[50];
    var pDeliveryCityName = data[51];
    var pBookingNumber = data[52];
    var pExpectedDeparture = data[53];  //POL
    var pVoyageOrTruckNumber = data[54];
    var pActualDeparture = data[55];
    var pMasterOperationCode = data[56];
    var pOperationHeader = JSON.parse(data[57]);
    var pOperationContainersAndPackages = JSON.parse(data[58]);

    var ReportHTML = '';
    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';

    ReportHTML += '             <div class="col-xs-12"><b>' + pBranchName + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
    ReportHTML += '             <div class="col-xs-12 m-t"><b>Messrs. : </b>' + pClientName + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-t">We <b>' + pEnCompanyName + '</b> inform you about the following shipment :</div>';

    ReportHTML += '             <div class="col-xs-12 m-l m-t"><b>HB/L: </b>' + (pOperationHeader.HouseNumber == 0 ? 'N/A' : pOperationHeader.HouseNumber) + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>MB/L: </b>' + (pOperationHeader.MasterBL == 0 ? 'N/A' : pOperationHeader.MasterBL) + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>POL: </b>' + pPOLCodeAndName + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>POD: </b>' + pPODCodeAndName + '</div>';
    if ($("#cbIsOcean").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 m-l"><b>Container No(s): </b>' + pContainerNumbers + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>Weight: </b>' + pGrossWeightSum + ' KG</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>Volume: </b>' + pVolumeSum + ' CBM</div>';
    if (pLineName != "") //pLineName
        ReportHTML += '         <div class="col-xs-12 m-l"><b>Line: </b>' + pLineName + '</div>';
    if ($("#cbIsOcean").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 m-l"><b>Vessel : </b>' + pVesselName + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>ETA: </b>' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? 'N/A' : pExpectedArrival) + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><b>Description of goods : </b><textarea class="printedTextArea" readonly>' + (pDescriptionOfGoods == "" ? "N/A" : pDescriptionOfGoods) + '</textarea></div>';
    //ReportHTML += '             <div class="col-xs-12 m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
    ReportHTML += '         <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ArrivalNotice_SeaGate(data, pDocumentTypeID, pOption) {
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pEnCompanyName = data[3];
    var pArCompanyName = data[4];
    var pContainerNumbers = data[5];
    var pGrossWeightSum = data[6];
    var pVolumeSum = data[7];
    var pVesselName = data[8];
    var pPOLCodeAndName = data[9];
    var pPODCodeAndName = data[10];
    var pLineName = data[11];
    var pExpectedArrival = data[12]; //pExpectedArrival.ToShortDateString()
    var pClientName = data[13];
    var pClientEmail = data[14];
    var pDescriptionOfGoods = data[15];
    var pActualArrival = data[16];

    var pMasterBL = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];

    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCommodityName = data[45];
    var pCustomerReference = data[46];
    var pCCAName = data[47];
    var pNumberOfPackages = data[48];
    var pVGMSum = data[49];
    var pDeliveryCountryName = data[50];
    var pDeliveryCityName = data[51];
    var pBookingNumber = data[52];
    var pExpectedDeparture = data[53];  //POL
    var pVoyageOrTruckNumber = data[54];
    var pActualDeparture = data[55];
    var pMasterOperationCode = data[56];
    var pOperationHeader = JSON.parse(data[57]);
    var pOperationContainersAndPackages = JSON.parse(data[58]);

    var ReportHTML = '';
    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n"><h3>' + ' إخطار وصول شحنة - Arrival Notice ' + '</h3></div> </br>';

    ReportHTML += '             <div class="col-xs-12 m-l-lg row">';
    ReportHTML += '                 <div class="col-xs-6"><b> Date : </b>' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
    ReportHTML += '                 <div class="col-xs-5 text-right"><b> Job No : </b>' + $("#slDocsOutOperations option:selected").attr("OperationCode") + '</div>';
    ReportHTML += '                 <div class="col-xs-1">' + ' ' + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="text-center row"><b> To : ' + pClientName + '</b></h4></div>';
    ReportHTML += '             <div class="m-t col-xs-12 m-l" style="height:0px;border:1px solid #000;"></div>';//This is a line!</div>
    ReportHTML += '             <div class="col-xs-12 m-t m-l-sm row">';
    ReportHTML += '                 <div class="col-xs-6">';
    ReportHTML += '                     <b>Messrs, </b><br><br>';
    ReportHTML += '                     Please note that below shipment Expected at <br><br>';
    ReportHTML += '                     <b>Port : </b>' + pPODCodeAndName + '<b> On: </b>' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? 'N/A' : pExpectedArrival) + ' <br><br>';
    ReportHTML += '                     <b>H/BL : </b>' + (pOperationHeader.HouseNumber == 0 ? 'N/A' : pOperationHeader.HouseNumber) + ' <br>';
    ReportHTML += '                     <b>M/BL : </b>' + (pOperationHeader.MasterBL == 0 ? 'N/A' : pOperationHeader.MasterBL) + ' <br>';
    if ($("#cbIsOcean").prop('checked'))
        ReportHTML += '                     <b>Vessel : </b>' + pVesselName + ' <br>';
    ReportHTML += '                     <b>POL : </b>' + pPOLCodeAndName + ' <br><br>';
    ReportHTML += '                     You are kindly requested to approach our office with all the required documents at the below address for documents release. <br><br>';
    ReportHTML += '                     <b>Documents required :</b><br><br>';
    ReportHTML += '                     - Original Bills of Lading(s) (If available) <br>';
    ReportHTML += '                     - Authorization letter (bank authenticated)  <br>';
    ReportHTML += '                     - Copy of the representative ID <br><br>';
    ReportHTML += '                     <b>Disclaimer :</b><br><br>';
    ReportHTML += '                     - Your urgent attention is drown to release your cargo A.S.A.P to avoid demurrage / storage charges.  <br>';
    ReportHTML += '                     - TAG Marine Egypt is not liable for the nature of cargo and whatsoever could affect the cargo due to delay in release, with indication that customs might sell the cargo in auction whenever time bar exceeded as per the customs rules and regulations. <br>';
    ReportHTML += '                 </div>';
    ReportHTML += '                 <div class="col-xs-6 text-right">';
    ReportHTML += '                     <b> ، السادة </b><br><br>';
    ReportHTML += '                     نحيط علم سيادتكم بأن الشحنة التالية ' + '<b> وصلت </b>' + '<br><br>';
    ReportHTML += '                 ' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? 'N/A' : pExpectedArrival) + '<b> : يوم </b>' + pPODCodeAndName + '<b> :ميناء </b>' + ' <br><br>';
    ReportHTML += '                 ' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b> : بوليصة فرعية رقم </b> ' + ' <br>';
    ReportHTML += '                 ' + (pOperationHeader.MasterBL == 0 ? '' : pOperationHeader.MasterBL) + '<b> : بوليصة رقم </b>' + ' <br>';
    if ($("#cbIsOcean").prop('checked'))
        ReportHTML += '                 ' + pVesselName + ' :<b> الباخرة  </b>' + ' <br>';
    ReportHTML += '                 ' + pPOLCodeAndName + '<b> : ميناء الشحن  </b>' + ' <br><br>';
    ReportHTML += '                     الرجاء التكرم بسرعة التوجه إلى مقر شركتنا المدون </b><br>';
    ReportHTML += '                     أدناه بجميع الأوراق اللازمة لإتمام إجراءات تسليم </b><br>';
    ReportHTML += '                    . المستندات </b><br><br>';
    ReportHTML += '                     <b> : المستندات المطلوبة </b><br><br>';
    ReportHTML += '                     (سندات الشحن الأصلية (المتاحة - <br>';
    ReportHTML += '                     تفويض سارى مصحوب بصحة توقيع من البنك - <br>';
    ReportHTML += '                     صورة تحقيق الشخصية للمندوب - <br><br>';
    ReportHTML += '                     <b> : تنبيه </b><br><br>';
    ReportHTML += '                     برجاء التقدم بالاستلام في أسرع وقت ممكن - <br>';
    ReportHTML += '                    . لتفادي غرامات التأخير و مصاريف  الأرضيات <br>';
    ReportHTML += '                    الشركة غير مسئولة مدنيا أو جنائيا عن طبيعة - <br>';
    ReportHTML += '                    البضائع وما قد يلحق بها من ضرر ينتج عن التأخر فى <br>';
    ReportHTML += '                    سحبها من الجمارك وما قد يترتب على ذلك من  <br>';
    ReportHTML += '                    إحتمالية تصرف الجمارك في البضائع بالبيع بعد مرور <br>';
    ReportHTML += '                    . المهلة المحددة طبقا للقوانين واللوائح الجمركية <br>';
    ReportHTML += '                 </div>';
    ReportHTML += '             </div>'
    ReportHTML += '             <div class="m-t text-center row"><h4><b> Sea Gate Agency S.A.E </b></h4></div>';
    ReportHTML += '             <div class="m-t-n text-center row"><h4><b> كوكلاء فقط </b></h4></div>';
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ArrivalNotice_Default_AIR(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pEnCompanyName = data[3];
    var pArCompanyName = data[4];
    var pContainerNumbers = data[5];
    var pGrossWeightSum = data[6];
    var pVolumeSum = data[7];
    var pVesselName = data[8];
    var pPOLCodeAndName = data[9];
    var pPODCodeAndName = data[10];
    var pLineName = data[11];
    var pExpectedArrival = data[12]; //pExpectedArrival.ToShortDateString()
    var pClientName = data[13];
    var pClientEmail = data[14];
    var pDescriptionOfGoods = data[15];
    var pActualArrival = data[16];

    var pMasterBL = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];

    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCommodityName = data[45];
    var pCustomerReference = data[46];
    var pCCAName = data[47];
    var pNumberOfPackages = data[48];
    var pVGMSum = data[49];
    var pDeliveryCountryName = data[50];
    var pDeliveryCityName = data[51];
    var pBookingNumber = data[52];
    var pExpectedDeparture = data[53];  //POL
    var pVoyageOrTruckNumber = data[54];
    var pActualDeparture = data[55];
    var pMasterOperationCode = data[56];
    var pOperationHeader = JSON.parse(data[57]);
    var pOperationContainersAndPackages = JSON.parse(data[58]);

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));

    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>Arrival Note</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC")
        ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div>';
    else
        ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' FREIGHT ARRIVAL NOTICE' + '</b></h3></div>';

    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
        //ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + $("#txtOperationReference").val() + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
    else if (pDefaults.UnEditableCompanyName == "SWI")
        ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

    ReportHTML += '             <div class="col-xs-8 m-t-xs">';
    ReportHTML += '                 <b>' + pClientName + '</b>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-4 m-t-xs">';
    ReportHTML += '                 <table id="tblShipment" class="table table-striped b-light text-sm table-bordered"">';//style="border:solid #000 !Important;"
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
    ReportHTML += '                             <td style="text-align:center!Important;"><b>SHIPMENT</b><td style="text-align:center!Important;">' + pOperationHeader.Code + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:center!Important;"><b>CONSOL</b><td style="text-align:center!Important;">' + (pOperationHeader.MasterBL == 0 ? '' : pOperationHeader.MasterBL) + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:center!Important;"><b>DATE</b><td style="text-align:center!Important;">' + getTodaysDateInddMMyyyyFormat() + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td><div class="col-xs-6 m-l-n" style="text-align:left!Important;"><b>SHIPMENT DETAILS</b></div><div class="col-xs-6 m-l" style="text-align:right!Important;"><b>PRINTED BY : ' + $("#hLoggedUserNameNotLogin").val() + '</b></div></td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>SHIPPER</b>';
    ReportHTML += '                                 <br>' + pShipperName;
    ReportHTML += '                                 ' + (pShipperAddressLine1 == "" ? "" : ('<br>' + pShipperAddressLine1))
    ReportHTML += '                                 ' + (pShipperAddressLine2 == "" ? "" : ('<br>' + pShipperAddressLine2))
    ReportHTML += '                                 ' + (pShipperCityName == "" ? "" : ('<br>' + pShipperCityName))
    ReportHTML += '                                 ' + (pShipperCountryName == "" ? "" : ('<br>' + pShipperCountryName))
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>CONSIGNEE</b>';
    ReportHTML += '                                 <br>' + pConsigneeName;
    ReportHTML += '                                 ' + (pConsigneeAddressLine1 == "" ? "" : ('<br>' + pConsigneeAddressLine1))
    ReportHTML += '                                 ' + (pConsigneeAddressLine2 == "" ? "" : ('<br>' + pConsigneeAddressLine2))
    ReportHTML += '                                 ' + (pConsigneeCityName == "" ? "" : ('<br>' + pConsigneeCityName))
    ReportHTML += '                                 ' + (pConsigneeCountryName == "" ? "" : ('<br>' + pConsigneeCountryName))
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>NOTIFY PARTY</b>';
    ReportHTML += '                                 ' + (pNotify1Name == "" ? '<br><br><br><br><br>' : ('<br>' + pNotify1Name));
    ReportHTML += '                                 ' + (pNotify1AddressLine1 == "" ? "" : ('<br>' + pNotify1AddressLine1))
    ReportHTML += '                                 ' + (pNotify1AddressLine2 == "" ? "" : ('<br>' + pNotify1AddressLine2))
    ReportHTML += '                                 ' + (pNotify1CityName == "" ? "" : ('<br>' + pNotify1CityName))
    ReportHTML += '                                 ' + (pNotify1CountryName == "" ? "" : ('<br>' + pNotify1CountryName))
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>GOODS AVAILABLE AT</b>';
    ReportHTML += '                                 <br><br><br><br><br>';
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>COMMODITY SUMMARY</b>';
    ReportHTML += '                                 <br>' + pCommodityName;
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>CARRIER</b>';
    ReportHTML += '                                 <br>' + pLineName;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>GOODS TO BE CLEARED BY</b>';
    ReportHTML += '                                 <br>' + (pCCAName == "" ? '<br>' : pCCAName);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>' + (pDefaults.UnEditableCompanyName == "SWI" ? 'SWIFT REFERENCE' : 'ORDER NUMBERS/REFERENCE') + '</b>';
    ReportHTML += '                                 <br>' + pCustomerReference;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:25%;"><b>' + ($("#cbIsAir").prop("checked") ? 'MAWB' : 'MBL') + '</b>';
    ReportHTML += '                                 <br>' + (pOperationHeader.MasterBL == 0 ? '' : pOperationHeader.MasterBL);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:25%;"><b>' + ($("#cbIsAir").prop("checked") ? 'HAWB' : 'HBL') + '</b>';
    ReportHTML += '                                 <br>' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? '' : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>GOODS DESCRIPTION</b>';
    ReportHTML += '                                 <br>' + pDescriptionOfGoods;
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>PACKAGES</b>';
    ReportHTML += '                                 <br>' + (pNumberOfPackages == "0" ? "N/A" : pNumberOfPackages);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>WEIGHT</b>';
    ReportHTML += '                                 <br>' + pGrossWeightSum.toFixed(2) + ' KGM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>CBM</b>';
    ReportHTML += '                                 <br>' + pVolumeSum + ' CBM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VGM</b>';
    ReportHTML += '                                 <br>' + pVGMSum.toFixed(2) + ' KG';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>EST DELIVRY</b>';
    ReportHTML += '                                 <br>' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>GOODS COLLECTED FROM</b>';
    ReportHTML += '                                 <br>' + pPOLCodeAndName;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>ETD</b>';
    ReportHTML += '                                 <br>' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + ' KGM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>GOODS DELIVERED TO</b>';
    ReportHTML += '                                 <br>' + pPODCodeAndName;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>ETA</b>';
    ReportHTML += '                                 <br>' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><b>' + 'ROUTING INFORMATION' + '</b></div>';
    ReportHTML += '             <div class="col-xs-12">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Mode</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>' + ($("#cbIsAir").prop("checked") ? 'Flight' : 'Voy.No.') + '</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Carrier</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Load</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Discharge</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>ETD</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>ETA</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>ATD</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>ATA</b></td>';
    ReportHTML += '                         </tr>';

    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;">' + GetTransportType(pOperationHeader.TransportType) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pVoyageOrTruckNumber + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pLineName + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pPOLCodeAndName + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pPODCodeAndName + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + (pActualDeparture == '01/01/1900' ? 'N/A' : pActualDeparture) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + (pActualArrival == '01/01/1900' ? 'N/A' : pActualArrival) + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-12 text-left">' + 'Yours Sincerely,<br>' + $("#hLoggedUserNameNotLogin").val() + '</div>';
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ArrivalNotice_Default_OCEAN(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) { //called Pre-Alert
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pEnCompanyName = data[3];
    var pArCompanyName = data[4];
    var pContainerNumbers = data[5];
    var pGrossWeightSum = data[6];
    var pVolumeSum = data[7];
    var pVesselName = data[8];
    var pPOLCodeAndName = data[9];
    var pPODCodeAndName = data[10];
    var pLineName = data[11];
    var pExpectedArrival = data[12]; //pExpectedArrival.ToShortDateString()
    var pClientName = data[13];
    var pClientEmail = data[14];
    var pDescriptionOfGoods = data[15];
    var pActualArrival = data[16];

    var pMasterBL = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];

    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCommodityName = data[45];
    var pCustomerReference = data[46];
    var pCCAName = data[47];
    var pNumberOfPackages = data[48];
    var pVGMSum = data[49];
    var pDeliveryCountryName = data[50];
    var pDeliveryCityName = data[51];
    var pBookingNumber = data[52];
    var pExpectedDeparture = data[53];  //POL
    var pVoyageOrTruckNumber = data[54];
    var pActualDeparture = data[55];
    var pMasterOperationCode = data[56];
    var pOperationHeader = JSON.parse(data[57]);
    var pOperationContainersAndPackages = JSON.parse(data[58]);

    if (pDefaults.UnEditableCompanyName == "PFS") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center m-t"><h3><b>' + ' إخطار عن وصول بضاعة ' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center m-t"></br></br><h3><b>' + ' إخطار عن وصول بضاعة ' + '</b></h3></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-lg text-right" style="font-size:16px;">' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '<b>' + ' : ميناء الشحن ' + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + pVesselName + '<b>' + ' : اسم السفينة ' + '</b></div>';
        else
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + pVoyageOrTruckNumber + '<b>' + ' : رقم الرحلة ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + pOperationHeader.GrossWeightSum + ' KG' + '<b>' + ' : الوزن ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '<b>' + ' : بوليصة كلية رقم ' + '</b></div>';
        if (pOperationHeader.BLType != constMasterBLType)
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b>' + ' : بوليصة فرعية رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b>' + ' : السادة ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-lg text-right" style="font-size:16px;">' + '<b>' + ' ،،، تحية طيبة و بعد ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n-lg m-t-xs text-right" style="font-size:16px;">' + (pExpectedArrival == "01/01/1900" ? "" : pExpectedArrival) + '<b>' + ' يسرنا إفادتكم بأن السفينة المذكورة بعاليه متوقع وصولها يوم  ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-lg text-right" style="font-size:16px;">' + '<b>' + ' و على سيادتكم المتابعة تليفونياً ابتداءً من ذلك اليوم صباحاً للتأكيد' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-lg text-right" style="font-size:16px;">' + '<b>' + '  كما نأمل التكرم بتقديم سند الشحن الأصلى للحصول على إذن التسليم تمهيداً لبدأ إجراءات صرف الرسالة و ذلك لتفادى أى غرامات تأخير  ' + '</b></div>';

        if (pDefaults.UnEditableCompanyName == "PFS") {
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-lg text-right" style="font-size:16px;">' + ' <b> ' + '  نشكركم على ثقتكم و يسعدنا لقاؤكم بمقر الشركة   ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + ' <b> ' + '  (  رقم 107 عمارات صقر قريش - مساكن شيراتون - القاهرة  )  ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + ' <b> ' + '  (  رقم 88 طريق الحرية - عمارة الهرام - الإسكندرية  )  ' + '</b></div>';
        }
        else
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pDefaults.AddressLine1 == "" ? "" : (' ' + pDefaults.AddressLine1)) + (pDefaults.AddressLine2 == "" ? "" : (' ' + pDefaults.AddressLine2) + (pDefaults.AddressLine3 == "" ? "" : (' ' + pDefaults.AddressLine3))) + ' <b> ' + '  نشكركم على ثقتكم و يسعدنا لقاؤكم بمقر الشركة   ' + '</b></div>';


        ReportHTML += '             <div class="col-xs-12 m-t-lg text-left" style="font-size:16px;"><b>' + (pDefaults.CompanyLocalName == 0 ? pDefaults.CompanyName : pDefaults.CompanyLocalName) + '</b></div>';


        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "PFS") {
    else if (pDefaults.UnEditableCompanyName == "GLS") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>Pre Alert</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
        ReportHTML += '             <div class="col-xs-12 text-center m-t-n"><h3><b> Arrival Notice' + '</b></h3></div>';
        ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b> Date' + getTodaysDateInddMMyyyyFormat() + '</b></h3></div>';

        ReportHTML += '             <div class="row col-xs-12">';
        ReportHTML += '                  <div class="col-xs-6 m-t-xs"><table id="tblMessers" class="table table-striped b-light text-sm table-bordered"">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Messers</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         </tbody></table></div>';
        ReportHTML += '             <div class="col-xs-6"></div></div>';

        ReportHTML += '              <div class="row col-xs-12"><div class="col-xs-6 m-t-xs">';
        ReportHTML += '                  <table id="tblMessers" class="table table-striped b-light text-sm table-bordered"">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>B/L Number</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + pOperationHeader.HouseNumber + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>POL</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + pPOLCodeAndName + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>POD</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + pPODCodeAndName + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         </tbody></table></div>';
        ReportHTML += '             <div class="col-xs-6"></div></div>';

        ReportHTML += '              <div class="row col-xs-12"><div class="col-xs-6 m-t-xs">';
        ReportHTML += '                  <table id="tblMessers" class="table table-striped b-light text-sm table-bordered"">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Number of Packages</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + 'x' + pOperationHeader.PackageTypeName + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Weight</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + pOperationHeader.GrossWeightSum + ' KGS' + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Volume</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + pVolumeSum + ' CBM' + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         </tbody></table></div>';
        ReportHTML += '             <div class="col-xs-6"></div></div>';

        ReportHTML += '              <div class="row col-xs-12"><div class="col-xs-6 m-t-xs">';
        ReportHTML += '                  <table id="tblMessers" class="table table-striped b-light text-sm table-bordered"">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Vessel</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + pVesselName + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>ETA/ATA</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + (pActualArrival == "01/01/1900" ? "" : pActualArrival) + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:18px;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><b>CONTAINER No</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + (pOperationHeader.ContainerNumber == 0 ? "" : pOperationHeader.ContainerNumber) + '</b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         </tbody></table></div>';
        ReportHTML += '             <div class="col-xs-6"></div></div>';

        ReportHTML += '             <div class="row col-xs-12 m-t-xs" style="font-size:19px;">';
        ReportHTML += '             Should you have any questions ir inquiries please do not hesitate to contact us. our Best attention at all times is yours. Look forward to hearing from you';
        ReportHTML += '             </div>';


        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "GLS") {
    else {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>Pre Alert</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if (pDefaults.UnEditableCompanyName == "LAT")
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-LATT-Logo.jpg" alt="logo"/></div>';
        else if (pDefaults.UnEditableCompanyName == "EEL") {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
            ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' ' + $("#hDefaultCountryName").val() + ' FREIGHT ARRIVAL PRE-ALERT' + '</b></h3></div>';
        }
        //else if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC") {
        //    ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div>';
        //    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' FREIGHT ARRIVAL PRE-ALERT' + '</b></h3></div>';
        //}
        else {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
            if (pDefaults.UnEditableCompanyName == "BME" || pDefaults.UnEditableCompanyName == "MAR")
                ReportHTML += '             <div class="col-xs-12 text-center m-t-n"><h3><b>' + 'ARRIVAL NOTICE' + '</b></h3></div>';
            else if (pDefaults.UnEditableCompanyName == "EGL" || pDefaults.UnEditableCompanyName == "TEU")
                ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' FREIGHT ARRIVAL NOTIFICATION' + '</b></h3></div>';
            else
                ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' FREIGHT ARRIVAL PRE-ALERT' + '</b></h3></div>';
        }
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            //ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + $("#txtOperationReference").val() + '</div>';
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        else if (pDefaults.UnEditableCompanyName == "SWI")
            ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

        ReportHTML += '             <div class="col-xs-8 m-t-xs">';

        ReportHTML += '             </div>';
        ReportHTML += '             <div class="col-xs-4 m-t-xs">';
        ReportHTML += '                 <table id="tblShipment" class="table table-striped b-light text-sm table-bordered"">';//style="border:solid #000 !Important;"
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:center!Important;"><b>SHIPMENT</b><td style="text-align:center!Important;">' + pOperationHeader.Code + '</td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:center!Important;"><b>MB/L</b><td style="text-align:center!Important;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</td>';
        ReportHTML += '                         </tr>';
        if (pOperationHeader.BLType == constHouseBLType) {
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:center!Important;"><b>HB/L</b><td style="text-align:center!Important;">' + (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) + '</td>';
            ReportHTML += '                         </tr>';
        }
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:center!Important;"><b>DATE</b><td style="text-align:center!Important;">' + getTodaysDateInddMMyyyyFormat() + '</td>';
        ReportHTML += '                         </tr>';
        if (pDefaults.UnEditableCompanyName == "MED") {
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:center!Important;"><b>ACID No</b><td style="text-align:center!Important;">' + (pOperationHeader.ACIDNumber == 0 ? "" : pOperationHeader.ACIDNumber) + '</td>';
            ReportHTML += '                         </tr>';
        }

        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td><div class="col-xs-6 m-l-n" style="text-align:left!Important;"><b>SHIPMENT DETAILS</b></div><div class="col-xs-6 m-l" style="text-align:right!Important;"><b>PRINTED BY : ' + $("#hLoggedUserNameNotLogin").val() + '</b></div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>SHIPPER</b>';
        ReportHTML += '                                 <br>' + pShipperName;
        ReportHTML += '                                 <br>' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1)
        ReportHTML += '                                 <br>' + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2)
        ReportHTML += '                                 <br>' + (pShipperCityName == "" ? "" : pShipperCityName)
        ReportHTML += '                                 <br>' + (pShipperCountryName == "" ? "" : pShipperCountryName)
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>CONSIGNEE</b>';
        ReportHTML += '                                 <br>' + pConsigneeName;
        ReportHTML += '                                 <br>' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1)
        ReportHTML += '                                 <br>' + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2)
        ReportHTML += '                                 <br>' + (pConsigneeCityName == "" ? "" : pConsigneeCityName)
        ReportHTML += '                                 <br>' + (pConsigneeCountryName == "" ? "" : pConsigneeCountryName)
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>Notify</b>';
        ReportHTML += '                                 <br>' + (pOperationHeader.Notify1Name == 0 ? "<br>" : pOperationHeader.Notify1Name);
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>COMMODITY TYPE</b>';
        ReportHTML += '                                 <br>' + pCommodityName;
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>' + (pDefaults.UnEditableCompanyName == "SWI" ? 'SWIFT REFERENCE' : 'ORDER NUMBERS/REFERENCE') + '</b>';
        ReportHTML += '                                 <br>' + pCustomerReference;
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:25%;"><b>OCEAN BILL OF LADING</b>';
        ReportHTML += '                                 <br>' + (pOperationHeader.MasterBL == 0 ? '' : pOperationHeader.MasterBL);
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:25%;"><b>HOUSE BILL OF LADING</b>';
        ReportHTML += '                                 <br>' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? '' : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs);
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>GOODS DESCRIPTION</b>';
        ReportHTML += '                                 <br>' + pDescriptionOfGoods;
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>PACKAGES</b>';
        ReportHTML += '                                 <br>' + (pOperationHeader.NumberOfPackages == 0 ? pNumberOfPackages : pOperationHeader.NumberOfPackages);
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>WEIGHT</b>';
        ReportHTML += '                                 <br>' + pGrossWeightSum.toFixed(2) + ' KGM';
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VOLUME</b>';
        ReportHTML += '                                 <br>' + pVolumeSum + ' CBM';
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VGM</b>';
        ReportHTML += '                                 <br>' + pVGMSum.toFixed(2) + ' KG';
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>GOODS COLLECTED FROM</b>';
        ReportHTML += '                                 <br>' + pPOLCodeAndName;
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>ETD</b>';
        ReportHTML += '                                 <br>' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + ' KGM';
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>GOODS DELIVERED TO</b>';
        ReportHTML += '                                 <br>' + pPODCodeAndName;
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>ETA</b>';
        ReportHTML += '                                 <br>' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival);
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><b>' + 'ROUTING INFORMATION' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Mode</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>' + 'Vessel/Voyage/IMO' + '</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Carrier</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Load</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>Discharge</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>ETD</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>ETA</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>ATD</b></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><b>ATA</b></td>';
        if (pDefaults.UnEditableCompanyName == "BME")
            ReportHTML += '                             <td style="text-align:left!Important;"><b>Container</b></td>';
        ReportHTML += '                         </tr>';

        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;">' + GetTransportType(pOperationHeader.TransportType) + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + pVesselName + '/' + pVoyageOrTruckNumber + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + pLineName + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + pPOLCodeAndName + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + pPODCodeAndName + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival) + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + (pActualDeparture == '01/01/1900' ? 'N/A' : pActualDeparture) + '</td>';
        ReportHTML += '                             <td style="text-align:left!Important;">' + (pActualArrival == '01/01/1900' ? 'N/A' : pActualArrival) + '</td>';
        if (pDefaults.UnEditableCompanyName == "BME")
            ReportHTML += '                             <td style="text-align:left!Important;">' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>';
        if (pDefaults.UnEditableCompanyName == "BME")
            ReportHTML += '         <div class="row text-center m-t-n"><img src="/Content/Images/ArrivalNotificationSquare-BME.jpg" alt="BME"/></div>';
        else
            ReportHTML += '             <div class="col-xs-12 text-left">' + 'Yours Sincerely,<br>' + $("#hLoggedUserNameNotLogin").val() + '</div>';

        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
}
function DocsOut_Print_OperationCoverAndDetailsILS(ID) {
    debugger;
    if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {
        var arr_Keys = new Array();
        var arr_Values = new Array();
        arr_Keys.push("ID");
        arr_Values.push(ID);

        var pParametersWithValues =
        {
            arr_Keys: arr_Keys
            , arr_Values: arr_Values
            , pTitle: "Cover File"
            , pReportName: "Rep_OperationCover"
        };
        var win = window.open("", "_blank");
        var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        win.location = url;
    }
    else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG") {
        var arr_Keys = new Array();
        var arr_Values = new Array();
        arr_Keys.push("ID");
        arr_Values.push(ID);

        var pParametersWithValues =
        {
            arr_Keys: arr_Keys
            , arr_Values: arr_Values
            , pTitle: "Cover File"
            , pReportName: "Rep_OperationCoverEG"
        };
        var win = window.open("", "_blank");
        var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        win.location = url;
    }
}
function DocsOut_Print_HBL_LATILS_AIR(Type, ID) {
    debugger;
    if (Type == "AIR") {
        //if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "HBL AIR"
                , pReportName: "Rep_HBL_AIR"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;

        //}
        //else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG" || IsMESCOCompany) {
        //    var arr_Keys = new Array();
        //    var arr_Values = new Array();
        //    arr_Keys.push("ID");
        //    arr_Values.push(ID);

        //    var pParametersWithValues =
        //    {
        //        arr_Keys: arr_Keys
        //        , arr_Values: arr_Values
        //        , pTitle: "HBL AIR"
        //        , pReportName: "Rep_HBL_AIREG"
        //    };
        //    var win = window.open("", "_blank");
        //    var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        //    win.location = url;
        //}

    }
    else if (Type == "AIRHBL") {
        //if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "HBL AIR"
                , pReportName: "Rep_HBL_AIRHBL"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;

        //}
        //else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG" || IsMESCOCompany) {
        //    var arr_Keys = new Array();
        //    var arr_Values = new Array();
        //    arr_Keys.push("ID");
        //    arr_Values.push(ID);

        //    var pParametersWithValues =
        //    {
        //        arr_Keys: arr_Keys
        //        , arr_Values: arr_Values
        //        , pTitle: "HBL AIR"
        //        , pReportName: "Rep_HBL_AIRHBLEG"
        //    };
        //    var win = window.open("", "_blank");
        //    var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        //    win.location = url;
        //}

    }

}
function DocsOut_Print_HBL_LATILS(Type, ID) {
    debugger;


    if (Type == "FCL") {
        if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "MBL FCL"
                , pReportName: "Rep_MBL_FCL"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;

        }
        else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG" || IsMESCOCompany) {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "MBL FCL"
                , pReportName: "Rep_MBL_FCLEG"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }
    }
    else if (Type == "FCLHBL") {
        if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {

            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "HBL FCL"
                , pReportName: "Rep_FCL_HBL"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }
        else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG" || IsMESCOCompany) {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "HBL FCL"
                , pReportName: "Rep_FCL_HBLEG"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }
    }
    else if (Type == "LCL") {
        if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {

            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "MBL LCL"
                , pReportName: "Rep_MBL_LCL"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }
        else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG" || IsMESCOCompany) {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "MBL LCL"
                , pReportName: "Rep_MBL_LCLEG"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }

    }
    else if (Type == "CONSOL") {
        if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {

            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "MBL CONSOL"
                , pReportName: "Rep_FCL_CONSOL"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }
        else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG" || IsMESCOCompany) {
            var arr_Keys = new Array();
            var arr_Values = new Array();
            arr_Keys.push("ID");
            arr_Values.push(ID);

            var pParametersWithValues =
            {
                arr_Keys: arr_Keys
                , arr_Values: arr_Values
                , pTitle: "MBL CONSOL"
                , pReportName: "Rep_FCL_CONSOLEG"
            };
            var win = window.open("", "_blank");
            var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

            win.location = url;
        }

    }

}
function DocsOut_Print_HBL_LAT_ARK(ID) {
    debugger;
    var arr_Keys = new Array();
    var arr_Values = new Array();
    arr_Keys.push("OperationID");
    arr_Values.push(ID);

    var query = `SELECT ID,ShipperName,ShipperAddress,PickupAddress,DeliveryAddress,PickupCityName,DeliveryCityName,POrCName,NumberOfOriginalBills,ActualDeparture,HouseNumber,HouseBLs,BLType,ConsigneeName,ConsigneeAddress,Reference,AgentName,(select [Address] from Agents where id=AgentID) AgentAddress,Notify1Name,Notify1Address,POLCountryName,VesselName,VoyageOrTruckNumber,POLName,PODName FROM vwOperations WHERE ID=${ID}`
    var pParametersWithValues =
    {
        query: query
        , arr_Keys: arr_Keys
        , arr_Values: arr_Values
        , pTitle: "ARK BL"
        , pReportName: "Rep_BL_ARK"
        , pReportType: "Print"
    };

    var win = window.open("", "_blank");

    url = '/ReportMainClass/PrintReportQueryAndParams?pTitle="' + pParametersWithValues.pTitle + '"'
        + '&query=' + pParametersWithValues.query + ''
        + '&arr_Keys=' + pParametersWithValues.arr_Keys + ''
        + '&arr_Values=' + pParametersWithValues.arr_Values + ''
        + '&pReportName=' + pParametersWithValues.pReportName + ''
        + '&pReportType=' + pParametersWithValues.pReportType + '';

    win.location = url;

}

function DocsOut_Print_LetterReleaseILS(ID) {
    debugger;
    if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {
        var arr_Keys = new Array();
        var arr_Values = new Array();
        arr_Keys.push("ID");
        arr_Values.push(ID);

        var pParametersWithValues =
        {
            arr_Keys: arr_Keys
            , arr_Values: arr_Values
            , pTitle: "Release Leter"
            , pReportName: "Rep_ReleaseLeter"
        };
        var win = window.open("", "_blank");
        var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        win.location = url;

    }
    else if ($("#hDefaultUnEditableCompanyName").val() == "ILSEG") {
        var arr_Keys = new Array();
        var arr_Values = new Array();
        arr_Keys.push("ID");
        arr_Values.push(ID);

        var pParametersWithValues =
        {
            arr_Keys: arr_Keys
            , arr_Values: arr_Values
            , pTitle: "Release Leter"
            , pReportName: "Rep_ReleaseLeterEG"
        };
        var win = window.open("", "_blank");
        var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        win.location = url;
    }

}

function DocsOut_Print_DeliveryOrderILS(ID) {
    debugger;

    if ($("#hDefaultUnEditableCompanyName").val() == "ILS") {
        var arr_Keys = new Array();
        var arr_Values = new Array();
        arr_Keys.push("ID");
        arr_Values.push(ID);

        var pParametersWithValues =
        {
            arr_Keys: arr_Keys
            , arr_Values: arr_Values
            , pTitle: "Delivery Orders"
            , pReportName: "Rep_DeliveryOrders"
        };
        var win = window.open("", "_blank");
        var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        win.location = url;
    }
    else if (pDefaults.UnEditableCompanyName == "ILSEG") {
        var arr_Keys = new Array();
        var arr_Values = new Array();
        arr_Keys.push("ID");
        arr_Values.push(ID);

        var pParametersWithValues =
        {
            arr_Keys: arr_Keys
            , arr_Values: arr_Values
            , pTitle: "Delivery Orders"
            , pReportName: "Rep_DeliveryOrdersEG"
        };
        var win = window.open("", "_blank");
        var url = '/ReportMainClass/PrintReport?pTitle="' + pParametersWithValues.pTitle + '"' + '&arr_Keys=' + pParametersWithValues.arr_Keys + '' + '&arr_Values=' + pParametersWithValues.arr_Values + '&pReportName=' + pParametersWithValues.pReportName + '';

        win.location = url;
    }
}

var ReportHTML = '';
function DocsOut_Print_DeliveryOrder(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pCommodityName = data[3];
    var pVesselName = data[4];
    var pLineName = data[5];
    var pMasterBL = data[6];
    var pHouseNumber = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pActualArrival = data[11];
    var pOperationContainersAndPackages = JSON.parse(data[12]);
    var pClientEmail = data[13];
    var pEnCompanyName = data[14];
    var pRoadOrContainerNumber = data[15];//save in the ContainerNumber field
    var pShipmentType = data[16];
    var pMasterOperationCode = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];
    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCustomerReference = data[45];
    var pNumberOfPackages = data[46];
    var pGrossWeightSum = data[47];
    var pVolumeSum = data[48];
    var pVGMSum = data[49];
    var pDescriptionOfGoods = data[50];
    var pOperationHeader = JSON.parse(data[51]);
    var pRoadNumber = data[52];
    var pDeliveryOrderNumber = data[53];
    var pMainRoute = JSON.parse(data[54]);
    var pMainRouteMaster = data[55] == null ? 0 : JSON.parse(data[55]);
    if (pRoadNumber == 0)//$("#tblRoutings tbody tr td.Notes")[0].innerHTML;
        pRoadNumber = pMainRoute.RoadNumber == 0 ? (pMainRouteMaster.RoadNumber == 0 || pMainRouteMaster.RoadNumber == undefined ? "" : pMainRouteMaster.RoadNumber) : pMainRoute.RoadNumber //$("#tblRoutings tr td.RoutingType[val=30]").parent().find("td.RoadNumber").text(); 
    var pWarehouse = pMainRoute.WareHouse == 0 ? (pMainRouteMaster.WareHouse == 0 || pMainRouteMaster.WareHouse == undefined ? "" : pMainRouteMaster.WareHouse) : pMainRoute.WareHouse //$("#tblRoutings tr td.RoutingType[val=30]").parent().find("td.WareHouse").text();
    //if (pDeliveryOrderNumber == 0)
    //    pDeliveryOrderNumber = $("#tblRoutings tr td.RoutingType[val=30]").parent().find("td.DeliveryOrderNumber").text();
    var pDescriptionOfGoodsOnContainers = "";
    $.each(pOperationContainersAndPackages, function (i, item) {
        pDescriptionOfGoodsOnContainers += (item.DescriptionOfGoods == 0 ? "" : (item.DescriptionOfGoods + " "));
    });

    //var pGrossWeightSum = data[14].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    if (pDefaults.UnEditableCompanyName == "BAK") {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }

        //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; font-size:150%;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        else
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-12 text-center"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div>';
        ReportHTML += '             <div class="col-xs-12 text-center"><h4>' + 'No. ' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '</h4></div> </br>';

        ReportHTML += '             <div class="col-xs-12 m-t"><b>CONSIGNEE : </b>' + pOperationHeader.ConsigneeName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><b>' + (pOperationHeader.TransportType == AirTransportType ? 'MAWB' : 'MBL') + ' : </b>' + pOperationHeader.MasterBL + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><b>' + (pOperationHeader.TransportType == AirTransportType ? 'HAWB' : 'HBL') + ' : </b>' + (pOperationHeader.HouseNumber == 0 ? pOperationHeader.HouseBLs : pOperationHeader.HouseNumber) + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t"><b>Pieces : </b>' + (pOperationHeader.NumberOfPackages + " x " + pOperationHeader.PackageTypeName) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><b>Gross Weight : </b>' + pGrossWeightSum + ' KG</div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><b>Chargeable Weight : </b>' + pOperationHeader.ChargeableWeightSum + ' KG</div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><b>Commodity : </b>' + pOperationHeader.CommodityName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><b>Line : </b>' + pOperationHeader.LineName + '</div>';



        ReportHTML += '             <div class="col-xs-12 m-t-lg"><b>TK:</b></div>';
        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        ReportHTML += '         <div class="col-xs-12">This document is issued without any reponsibility for cargo contents or any deficiency of weight/pieces, as we are only a booking agent (Freight Forwarder)</div>';
        ReportHTML += '         <div class="col-xs-12 text-right m-t-lg">' + pDefaults.CompanyName + '</div>';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        else {
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div> </br>';
        }
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF if (pDefaults.UnEditableCompanyName == "BAK")
    else if (pDefaults.UnEditableCompanyName == "KDS") {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; ">'; //font-size:95%;

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            //ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + " No. " + (pOperationHeader.CodeSerial == 0 ? pDeliveryOrderNumber : (pOperationHeader.CodeSerial + '/' + pOperationHeader.Code.substring(1, 3))) + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + " No. " + pOperationHeader.ID + '</h3></div> </br>';
        }
        else //header not printed so leave place for header on the original company paper
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + " No. " + (pOperationHeader.CodeSerial == 0 ? pDeliveryOrderNumber : (pOperationHeader.CodeSerial + '/' + pOperationHeader.Code.substring(1, 3))) + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br></br></br></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + " No. " + pOperationHeader.ID + '</h3></div> </br>';
        //ReportHTML += '             <div class="col-xs-3">' + '<b>' + 'Branch :' + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-6 text-center">' + pBranchName + ' ' + getTodaysDateInddMMyyyyFormat() + '</div>';
        //ReportHTML += '             <div class="col-xs-3 text-right">' + '<b>' + ' : الفرع  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-12">' + '<b>' + pBranchName + ' IN : ' + '</b>' + getTodaysDateInddMMyyyyFormat() + '</div>';

        ReportHTML += '             <div class="col-xs-3">' + '<b>' + 'Please deliver to : ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 text-center">' + pConsigneeName + '</div>';
        ReportHTML += '             <div class="col-xs-3 text-right">' + '<b>' + '   السيد مخزنجى الجمارك الرجاء تسليم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-3">' + '<b>' + 'Goods arrived per M/V :' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 text-center">' + pVesselName + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : (" - " + pOperationHeader.VoyageOrTruckNumber)) + '</div>';
        ReportHTML += '             <div class="col-xs-3 text-right">' + '<b>' + ' البضاعة المذكورة أدناه على الباخرة  ' + '</b>' + '</div>';

        //ReportHTML += '             <div class="col-xs-4">' + '<b>' + 'Arrival Date : </b>' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '<b>' + '  تاريخ الوصول  ' + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-1 text-left">' + '<b>' + 'POL:' + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-5 text-center">' + '<b>' + pOperationHeader.POLName + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-2 text-right">' + '<b>' + '  : ميناء الشحن  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2">' + '<b>' + 'Arrival Date :' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-1 text-center">' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-right">' + '<b>' + ' : تاريخ الوصول  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-1 text-right">' + '<b>' + 'POL:' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-4 text-center">' + pOperationHeader.POLName + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-right">' + '<b>' + '  : ميناء الشحن  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-3">' + '<b>' + 'Dis.Terminal: ' + '</b>' + pOperationHeader.PODCode + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-right">' + '<b>' + ' : محطة التفريغ  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-1 text-right">' + '<b>' + 'POD:' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-4 text-center">' + pOperationHeader.PODName + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-right">' + '<b>' + '  : ميناء التفريغ  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-1">' + '<b>' + 'Road#' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-center">' + (pRoadNumber == 0 ? "" : pRoadNumber) + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-right">' + '<b>' + ' : رقم الطريق  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-left">' + '<b>' + 'Frght: ' + '</b>' + (pOperationHeader.POrCName == 0 ? "" : pOperationHeader.POrCName) + '</div>';
        ReportHTML += '             <div class="col-xs-1 text-right">' + '<b>' + ' :النولون  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-1 text-left" style="font-size:12px;">' + '<b>' + 'B/L:' + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-2 text-center">' + pMasterBL + '</div>';
        ReportHTML += '             <div class="col-xs-2 text-center" style="font-size:12px;">' + $("#slDocsOutOperations option:selected").text().split(":")[1].split(")")[0] + '</div>';
        ReportHTML += '             <div class="col-xs-1 text-right" style="font-size:12px;">' + '<b>' + '  :بوليصة  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-12 text-left" style="clear:both;">' + '<b>' + 'CBM: ' + '</b>' + pVolumeSum + '</div>';
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table m-t-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            ReportHTML += '                                 <th>Marks & Numbers</th>';
        else
            ReportHTML += '                                 <th>Package Type</th>';
        ReportHTML += '                                     <th>No. Of Packages</th>';
        ReportHTML += '                                     <th>Description Of Goods</th>';
        ReportHTML += '                                     <th>Weight (KG)</th>';
        //ReportHTML += '                                     <th>CBM</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        $.each(JSON.parse(data[12]), function (i, item) {
            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                ReportHTML += '                                     <td>' + item.ContainerTypeCode + (item.MarksAndNumbers == 0 ? "" : ('-' + item.MarksAndNumbers)) + '</td>';
                ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + '</td>';
            }
            else {
                ReportHTML += '                                     <td>' + item.PackageTypeName + '</td>';
                ReportHTML += '                                     <td>' + item.Quantity + '</td>';
            }
            ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == "0" ? 'N/A' : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            ReportHTML += '                                         <td>' + item.GrossWeight.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
            //ReportHTML += '                                         <td>' + item.Volume.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
            ReportHTML += '                                     </tr>';
        });
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';

        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        ReportHTML += '                         <div class="col-xs-6 text-left">' + 'Not responsible for weight and measurement shown,' + '</div>';
        ReportHTML += '                         <div class="col-xs-6 text-right">' + ' غير مسئول عن المقاسات المبينة عاليه ' + '</div>';
        ReportHTML += '                         <div class="col-xs-6 text-left">' + 'The above goods are charged at risks and expenses' + '</div>';
        ReportHTML += '                         <div class="col-xs-6 text-right">' + ' و البضاعة فرغت تحت مسئوليةو مصاريف ' + '</div>';
        ReportHTML += '                         <div class="col-xs-6 text-left">' + ' of consignee.' + '</div>';
        ReportHTML += '                         <div class="col-xs-6 text-right">' + ' المرسل إليه و المستلم ' + '</div>';

        ReportHTML += '                         <div class="col-xs-3 text-left">' + '<b>' + ' As Agents Only ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-6 text-center">' + '<b>' + '  تنبيه هام ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-3 text-right">' + '<b>' + '  كوكلاء فقط ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right">' + ' نظرا إلى أن بضاعتكم قد خزنت على مسئوليتكم و لحسابكم فى الأماكن التى عينتها السلطات المختصة ، لذلك فإننا نرجوكم سحبها فى أقرب فرصة ممكنة علما بأننا و لا وكلائنا مسئولين عن ضياع أوأى ضرر قد يلحق بالبضائع بمجرد تفريغها أو انتظار سحبها من الأمكنة التى قد تكون فرغت بها فالرجاء تخليص بضائعكم فورا أو فعل ما ترونه لازما لحمايتها كالتأمين أو ما شابه ' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 text-right">' + '    يعمل بهذا الإذن لمدة ستة أشهر من تاريخ صدوره غير مسئولين عن الأوزان و الأحجام المذكورة هنا ' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 text-right">' + '    تفريغ هذه البضاعة على مسئولية و حساب المستلمين  ' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
        ReportHTML += '                         <div class="col-xs-4"><b>Import Department</b></div>';
        ReportHTML += '                         <div class="col-xs-8"><img src="/Content/Images/Signature-' + pLoggedUser.Username + '.jpg" alt=""/><img src="/Content/Images/Stamp-' + pLoggedUser.Username + '.jpg" alt=""/></div>';
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
    else if (pDefaults.UnEditableCompanyName == "NIL") {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        //ReportHTML += '             <div class="col-xs-12"><b>Ref No. </b>' + $("#txtOperationReference").val().split('-')[1] + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>Ref No. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference.split('-')[1]) + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>Date : </b>' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>Operation No. </b>' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>To : </b>' + ' مصلحة الجمارك ' + '</div>';

        //ReportHTML += '             <div class="col-xs-12 m-t-lg m-l-n text-right">' + '  مدير المخازن  ' + '<b>' + ' : إلى السيد ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg m-l-n text-right">' + '  مدير المخازن  ' + '<b><span style="float:right;">' + ' : إلى السيد ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + pConsigneeName + '<b>' + ' : الرجاء تسليم السادة ' + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n text-right">' + pVesselName + '<b>' + ' : البضاعة المذكورة أدناه الواردة على الباخرة ' + '</b></div>';
        else
            ReportHTML += '         <div class="col-xs-12 m-l-n text-right">' + pVoyageOrTruckNumber + '<b>' + ' : رقم الرحلة ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '<b>' + ' : بموجب بوليصة كلية رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b>' + ' : بموجب بوليصة فرعية رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + pPOLCodeAndName + '<b>' + ' : الواردة من ميناء ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '<b>' + ' : بتاريخ  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pRoadNumber == "0" ? "" : pRoadNumber) + '<b>' + ' : رقم الطريق ' + '</b></div>';
        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table m-t-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            ReportHTML += '                                 <th>Marks & Numbers</th>';
        else
            ReportHTML += '                                 <th>Package Type</th>';
        ReportHTML += '                                     <th>No. Of Packages</th>';
        ReportHTML += '                                     <th>Description Of Goods</th>';
        ReportHTML += '                                     <th>Weight (KG)</th>';
        ReportHTML += '                                     <th>CBM</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        $.each(JSON.parse(data[12]), function (i, item) {
            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                ReportHTML += '                                     <td>' + item.MarksAndNumbers + '</td>';
                ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + '</td>';
            }
            else {
                ReportHTML += '                                     <td>' + item.PackageTypeName + '</td>';
                ReportHTML += '                                     <td>' + item.Quantity + '</td>';
            }
            ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == "0" ? 'N/A' : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            ReportHTML += '                                         <td>' + item.GrossWeight.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
            ReportHTML += '                                         <td>' + item.Volume.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
            ReportHTML += '                                     </tr>';
        });
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        ReportHTML += '                         <div class="col-xs-12 m-l-n text-center">' + '<b>' + ' . حيث أننا وكلاء شحن فقط ' + '</b></div>';
        //ReportHTML += '                         <div class="col-xs-12 m-l-n text-right">' + '<b>' + ' : تنبيه هام ' + '</b></div>';
        //ReportHTML += '                         <div class="col-xs-12 text-right">' + ' نظرا إلى أن بضاعتكم قد خزنت على مسئوليتكم و لحسابكم فى الأماكن التى عينتها السلطات المختصة ، لذلك فإننا نرجوكم سحبها فى أقرب فرصة ممكنة علما بأننا و لا وكلائنا مسئولين عن ضياع أوأى ضرر قد يلحق بالبضائع بمجرد تفريغها أو انتظار سحبها من الأمكنة التى قد تكون فرغت بها فالرجاء تخليص بضائعكم فورا أو فعل ما ترونه لازما لحمايتها كالتأمين أو ما شابه ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12 text-right">' + '    (شروط وصول البضاعة و استلامها بالمخازن)' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12 text-right">' + '    يعمل بهذا الإذن لمدة ستة أشهر من تاريخ صدوره غير مسئولين عن الأوزان و الأحجام المذكورة هنا ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12 text-right">' + '    تفريغ هذه البضاعة على مسئولية و حساب المستلمين  ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12 text-right">' + '    يرجى من السادة العملاء الكرام و التى تحتوى الرسالة الخاصة بهم على مواد غذائية أو مواد تدخل فى صناعة الأغذية إخطار الموظف المسئول عند سحب إذن التسليم على أن مشمول فى الرسالة يحتوى على مواد غذائة واجبة العرض على معمل الفحص الإشعاعى مع دفع المصاريف الخاصة بحسب عينة الإشعاع و ترك صورة من إيصال السداد طرف الموظف المختص و ذلك لعدم حدوث أى تأخير فى سحب العينة من الرسائل الواردة ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12 text-right">' + '  التوكيل غير مسئول عن أى تأخير يحدث نتيجة الإخلال بهذا التنبيه ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
        //ReportHTML += '                         <div class="col-xs-12 text-left"><b>Import Department</b></div>';
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
    else if (pDefaults.UnEditableCompanyName == "DSE" || (pDefaults.UnEditableCompanyName == "DSC")) {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; font-size:14px;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        }
        else //header not printed so leave place for header on the original company paper
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ;
        ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? "" : pOperationHeader.Reference) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm">' + '<b>DELIVERY ORDER NO.</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-4 m-t-sm text-center">' + pOperationHeader.ID + '</div>';
        ReportHTML += '             <div class="col-xs-4 m-t-sm text-right">' + '<b>' + ' : إذن تسليم رقم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-6 m-t-sm" style="clear:both;">' + '<b>TO CUSTOMS WAREHOUSING:</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.PONumber == 0 ? "NOT SPECIFIED" : pOperationHeader.PONumber) + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-sm text-right">' + '<b>' + ' : السادة المخازن الجمركية  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-3 m-t-sm" style="clear:both;">' + '<b>PLEASE Deliver TO:</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-sm text-center">' + (pOperationHeader.ConsigneeName == 0 ? "NOT SPECIFIED" : pOperationHeader.ClientName) + '</div>';
        ReportHTML += '             <div class="col-xs-3 m-t-sm text-right">' + '<b>' + ' : برجاء تسليم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm" style="clear:both;">' + '<b>DATE:</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : بتاريخ  ' + '</b>' + '</div>';
        if ($("#cbIsOcean").prop("checked")) {
            ReportHTML += '             <div class="col-xs-3 m-t-sm" style="clear:both;">' + '<b>CARGO ON VESSEL:</b>' + '</div>';
            ReportHTML += '             <div class="col-xs-6 m-t-sm text-center">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</div>';
            ReportHTML += '             <div class="col-xs-3 m-t-sm text-right">' + '<b>' + ' : البضاعة المذكورة أدناه الواردة على الباخرة ' + '</b>' + '</div>';
        }
        ReportHTML += '             <div class="col-xs-3 m-t-sm" style="clear:both;">' + '<b>PORT OF LOADING:</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-sm text-center">' + pOperationHeader.POLName + ' / ' + pOperationHeader.POLCountryName + '</div>';
        ReportHTML += '             <div class="col-xs-3 m-t-sm text-right">' + '<b>' + ' : الواردة من ميناء  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm" style="clear:both;">' + '<b>' + (pOperationHeader.TransportType == AirTransportType ? 'MAWB' : 'MBL') + ':</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : بوليصة كلية   ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm" style="clear:both;">' + '<b>' + (pOperationHeader.TransportType == AirTransportType ? 'MAWB' : 'HBL') + ':</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : بوليصة فرعية  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-6 m-t-sm" style="clear:both;">' + '<b>DESCRIBED AS FOLLOWS:</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.PONumber == 0 ? "NOT SPECIFIED" : pOperationHeader.PONumber) + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-sm text-right">' + '<b>' + ' : بيانتها كالتالى  ' + '</b>' + '</div>';

        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table m-t-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            ReportHTML += '                                 <th>Marks & Numbers</th>';
        else
            ReportHTML += '                                 <th>Package Type</th>';
        ReportHTML += '                                     <th>No. Of Packages</th>';
        ReportHTML += '                                     <th>Description Of Goods</th>';
        ReportHTML += '                                     <th>Weight (KGM)</th>';
        ReportHTML += '                                     <th>Measurement (CBM)</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        $.each(JSON.parse(data[12]), function (i, item) {
            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                ReportHTML += '                                     <td>' + item.MarksAndNumbers + '</td>';
                ReportHTML += '                                     <td>' + (item.PackageTypeNameOnContainer == 0 ? item.ExtraPackages : (item.NumberOfPackagesOnContainer + ' x ' + item.PackageTypeNameOnContainer)) + '</td>';
            }
            else {
                ReportHTML += '                                     <td>' + item.PackageTypeName + '</td>';
                ReportHTML += '                                     <td>' + item.Quantity + '</td>';
            }
            //ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == "0" ? 'N/A' : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            if (i == 0)
                ReportHTML += '                                         <td rowspan=' + pOperationContainersAndPackages.length + '>' + (pOperationContainersAndPackages[0]["DescriptionOfGoods"] == 0 ? "" : pOperationContainersAndPackages[0]["DescriptionOfGoods"].replace(/\n/g, "<br/>")) + '</td>';
            ReportHTML += '                                         <td>' + item.GrossWeight.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
            ReportHTML += '                                         <td>' + item.Volume.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
            ReportHTML += '                                     </tr>';
        });
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        ReportHTML += '                         <div class="col-xs-12">' + pDefaults.CompanyName + ' Not responsible for weight and measurement stated above and the cargo are unloaded at the Shippers/Receivers responsibility and account. ' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 m-t text-right">' + '<b>' + '  غير مسئولة عن الوزن و المقاس المبين بعالية والبضاعة تم تفريغها تحت و لحساب الشاحن و المستلم حيث اننا وكلاء شحن فقط  ' + (pDefaults.CompanyLocalName == 0 ? pDefaults.CompanyName : pDefaults.CompanyName) + '</b></div>';

        //ReportHTML += '                         <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
        //ReportHTML += '                         <div class="col-xs-12 text-left"><b>Import Department</b></div>';
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "DSE" && pDefaults.UnEditableCompanyName == "DSC")
    else if (pDefaults.UnEditableCompanyName == "GLS") {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.DeliveryOrderSerial) + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.DeliveryOrderSerial) + '</h3></div> </br>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.DeliveryOrderSerial) + '</h3></div> </br>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + ConvertDateFormat(FormattedTodaysDate) + '</div><div  class="col-xs-4 text-right"><b> : التاريخ</b></div></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-md m-l-n text-right" style="font-size:16px;"><b> الي السيد / مدير الجمارك </b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pOperationHeader.ClientName == 0 ? (pOperationHeader.DirectionType == constImportDirectionType ? pConsigneeName : pShipperName) : pOperationHeader.ClientName) + '</div><div  class="col-xs-4 text-right"><b>  : الرجاء تسليم السادة </b></div></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + pVesselName + '</div><div  class="col-xs-4 text-right"><b> : البضاعة المذكورة أدناه الواردة على الباخرة </b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + pOperationHeader.POLName + '</div><div  class="col-xs-4 text-right"><b>  : ميناء الشحن  </b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '</div><div  class="col-xs-4 text-right"><b>  : تاريخ الوصول </b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</div><div  class="col-xs-4 text-right"><b>  : بوليصة كلية رقم</b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</div><div  class="col-xs-4 text-right"><b> : بوليصة فرعية رقم</b></div></div>';
        //ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pOperationContainersAndPackages[0].ConsolContainerNumber == 0 ? (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) : pOperationContainersAndPackages[0].ConsolContainerNumber)+ '</div><div  class="col-xs-4 text-right"><b>   : حاوية رقم </b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pOperationHeader.ContainerNumber == 0 ? "" : pOperationHeader.ContainerNumber) + '</div><div class="col-xs-4 text-right"><b>   : حاوية رقم </b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + (pRoadNumber == "0" || pRoadNumber == undefined ? "" : pRoadNumber) + '</div><div  class="col-xs-4 text-right"><b>  : رقم الطريق</b></div></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-md" style="font-size:16px;"><div class="col-xs-8 text-center">' + pWarehouse + '</div><div  class="col-xs-4 text-right"><b>  : اسم المستودع</b></div></div>';

        ReportHTML += '                         <table id="tblDeliveryOrder" class="table m-t-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>Marks & No</th>';
        ReportHTML += '                                     <th>Package Type</th>';
        ReportHTML += '                                     <th>No Of PKGS</th>';
        ReportHTML += '                                     <th>Description</th>';
        ReportHTML += '                                     <th>Weight (KG)</th>';
        ReportHTML += '                                     <th>Volume</th>';
        ReportHTML += '                                     <th>Freight</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="text-align:center; vertical-align:text-top; font-size:95%;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.MarksAndNumbers == 0 ? (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + '</td>';
        //ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypeName == 0 ? "" : pOperationHeader.PackageTypeName) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.NumberOfPackages) + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>") + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum + ' KGM' + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.VolumeSum + ' CBM' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.POrCName == 0 ? "" : pOperationHeader.POrCName) + '</td>';
        ReportHTML += '                                     </tr>';

        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';

        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        //ReportHTML += '                         <div class="col-xs-12 m-l-n m-t-lg text-right" style="clear:both;">' + '<b>' + ' : تنبيه هام ' + '</b></div>';
        ReportHTML += '                         </br><div class="col-xs-12 text-right"><b style="font-size:16px;">.الشركة غير مسئولة عن الوزن والقياس وحالة البضائع المبينة أعلاه والتى تم تفريغها على مسئولية وحساب الشاحن والمستلم</b></div>';
        ReportHTML += '                         </br><div class="col-xs-12 text-right"><b style="font-size:16px;">' + ' .البضائع المذكورة أعلاه تم تفريغها وتخزينها في الأماكن التي حددتها السلطات المختصة حيث أنها غير مؤمن عليها لدى شركتنا أو وكلائنا لذا نخلى مسئوليتنا عما قد يلق بها من تلف أو ضياع أو سرقة ' + '</b></div>';
        ReportHTML += '                         </br><div class="col-xs-12 text-right"><b style="font-size:16px;">.أى شكوي عن وجود أى زيادة أو عجز أو تلف أو ضياع أو سرقة لن يلتفت اليها اذا تقدم بها صاحب الشأن بعد يومين من وصول الباخرة ولن يلتفت الي شكوي خاصة بالطرود التي يتم فتحها بواسطة الجمارك</b></div>';

        //ReportHTML += '                         <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
        ReportHTML += '                         </br><div class="col-xs-12">';
        ReportHTML += '                         <div class="col-xs-3"><b class="text-center" style="font-size:16px;">كوكلاء فقط</b></div>';
        ReportHTML += '                         <div class="col-xs-3"><b class="text-center" style="font-size:16px;">التوقيع المعتمد</b></div>';
        ReportHTML += '                         <div class="col-xs-3"><b class="text-center" style="font-size:16px;">كوكلاء فقط</b></div>';
        ReportHTML += '                         <div class="col-xs-3"><b class="text-center" style="font-size:16px;">عن الشركة</b></div>';
        ReportHTML += '              </div>';
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "GLS") {
    else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.ID) + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.ID) + '</h3></div> </br>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.ID) + '</h3></div> </br>';
        ReportHTML += '             <div class="col-xs-12 m-l-n"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? "" : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + 'Printed On : ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
        {
            ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + ' Salesman : ' + (pOperationHeader.Salesman == 0 ? "" : pOperationHeader.Salesman) + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + ' Operation opened by : ' + (pOperationHeader.CreatorName == 0 ? "" : pOperationHeader.CreatorName) + '</b></div>';
        }
        ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + 'Please, deliver to : ' + (pOperationHeader.Consignee2Name == 0 ? (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) : pOperationHeader.Consignee2Name) + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n">' + '<b>' + 'Cargo stated down that came on Vessel : ' + pVesselName + '</b></div>';
        else
            ReportHTML += '         <div class="col-xs-12 m-l-n">' + '<b>' + 'Voyage No. : ' + pVoyageOrTruckNumber + '</b></div>';

        //if ($("#cbIsAir").prop("checked"))
        //    ReportHTML += '         <div class="col-xs-12 m-l-n">' + (pRoadOrContainerNumber == "N/A" ? (pRoadNumber == "0" ? "" : pRoadNumber) : pRoadOrContainerNumber) + '<b>' + ' : رقم الطريق ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + 'BL No. : ' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + 'HBL : ' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n">' + '<b>' + 'POL : ' + pPOLCodeAndName + '</b></div>';
        ReportHTML += '             <div class="col-xs-4 m-l-n">' + '<b>' + 'Warehouse: ' + (pWarehouse == "0" ? "" : pWarehouse) + '</b></div>';
        ReportHTML += '             <div class="col-xs-4">' + '<b>' + 'Road No : ' + (pRoadNumber == "0" ? "" : pRoadNumber) + '</b></div>';
        ReportHTML += '             <div class="col-xs-4">' + '<b>' + 'Arrival Date: ' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '</b></div>';
        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table m-t-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            ReportHTML += '                                 <th>Marks & Numbers</th>';
        else
            ReportHTML += '                                 <th>Package Type</th>';
        ReportHTML += '                                     <th>No. Of Packages</th>';
        ReportHTML += '                                     <th>Description Of Goods</th>';
        ReportHTML += '                                     <th>Weight (KG)</th>';
        if (pDefaults.UnEditableCompanyName != "FFI")
            ReportHTML += '                                     <th>CBM</th>';
        ReportHTML += '                                     <th>Freight</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="text-align:center; vertical-align:text-top; font-size:95%;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>") + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum + ' KGM' + '</td>';
        if (pDefaults.UnEditableCompanyName != "FFI")
            ReportHTML += '                                         <td>' + pOperationHeader.VolumeSum + ' CBM' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.POrCName == 0 ? "" : pOperationHeader.POrCName) + '</td>';
        ReportHTML += '                                     </tr>';

        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';


        ReportHTML += '                 <div class="m-t-n" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + 'Revised By' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-6 text-center"><b>' + '' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + 'Issued By' + '</b></div>';
        ReportHTML += '                 </div>'
        ReportHTML += '                 <div class="" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
        ReportHTML += '                     <div class="col-xs-3 text-center">' + '' + '</div>';
        ReportHTML += '                     <div class="col-xs-6 text-center">' + '' + '</div>';
        ReportHTML += '                     <div class="col-xs-3 text-center">' + $("#hLoggedUserNameNotLogin").val() + '</div>';
        ReportHTML += '                 </div>'

        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        //ReportHTML += '                         <div class="col-xs-12 m-l-n m-t-lg" style="clear:both;">' + '<b>' + ' : تنبيه هام ' + '</b></div>';
        //ReportHTML += '                         <div class="col-xs-12">' + ' نظرا إلى أن بضاعتكم قد خزنت على مسئوليتكم و لحسابكم فى الأماكن التى عينتها السلطات المختصة ، لذلك فإننا نرجوكم سحبها فى أقرب فرصة ممكنة علما بأننا و لا وكلائنا مسئولين عن ضياع أوأى ضرر قد يلحق بالبضائع بمجرد تفريغها أو انتظار سحبها من الأمكنة التى قد تكون فرغت بها فالرجاء تخليص بضائعكم فورا أو فعل ما ترونه لازما لحمايتها كالتأمين أو ما شابه ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12">' + '    (شروط وصول البضاعة و استلامها بالمخازن)' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12">' + '    يعمل بهذا الإذن لمدة ستة أشهر من تاريخ صدوره غير مسئولين عن الأوزان و الأحجام المذكورة هنا ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12">' + '    تفريغ هذه البضاعة على مسئولية و حساب المستلمين  ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12">' + '    يرجى من السادة العملاء الكرام و التى تحتوى الرسالة الخاصة بهم على مواد غذائية أو مواد تدخل فى صناعة الأغذية إخطار الموظف المسئول عند سحب إذن التسليم على أن مشمول فى الرسالة يحتوى على مواد غذائة واجبة العرض على معمل الفحص الإشعاعى مع دفع المصاريف الخاصة بحسب عينة الإشعاع و ترك صورة من إيصال السداد طرف الموظف المختص و ذلك لعدم حدوث أى تأخير فى سحب العينة من الرسائل الواردة ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12">' + '  التوكيل غير مسئول عن أى تأخير يحدث نتيجة الإخلال بهذا التنبيه ' + '</div>';
        //ReportHTML += '                         <div class="col-xs-12">' + '  أي شكوي عن وجود زيادة أو عجز أو تلف أو ضياع أو سرقة لن يلتفت إليها إذا تقدم بها صاحب الشأن في خلال يومين من وصول الباخرة و لن يلتفت لشكوي خاصة بطرود قامت بفتحها الجمارك ' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-left"><b>Import Department</b></div>';
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA")
    else {
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + pOperationHeader.ID) + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        debugger;
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + (pDefaults.UnEditableCompanyName == "BOM" ? pOperationHeader.DeliveryOrderSerial : pOperationHeader.ID)) + '</h3></div> </br>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + (" No. " + (pDefaults.UnEditableCompanyName == "BOM" ? pOperationHeader.DeliveryOrderSerial : pOperationHeader.ID)) + '</h3></div> </br>';
        if (pDefaults.UnEditableCompanyName != "BOM")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? "" : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + ConvertDateFormat(FormattedTodaysDate) + '<b>' + ' : اليوم ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "EGL")
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + '<b><u>' + ' : إلى السيد مخزنجي مصلحة الجمارك  ' + '</u></b></div>';
        else if (pDefaults.UnEditableCompanyName == "BOM") {
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + '<b>' + ' : إلى السيد مدير الجمارك  ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.Code == 0 ? "" : pOperationHeader.Code) + '<b>' + ' : رقم العملية ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.PODName == 0 ? "" : pOperationHeader.PODName) + '<b>' + ' : ميناء الوصول ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.ActualArrival == 0 ? "" : new Date(parseFloat((pOperationHeader.ActualArrival).slice(6, 19))).toString().slice(0, 15)) + '<b>' + ' : تاريخ الوصول ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.ACIDNumber == 0 ? "" : pOperationHeader.ACIDNumber) + '<b>' + ' : ACID رقم ' + '</b></div>';
        }
        else if (pDefaults.UnEditableCompanyName != "MAR" && pDefaults.UnEditableCompanyName != "KML") {
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.Salesman == 0 ? "" : pOperationHeader.Salesman) + '<b>' + ' : البائع ' + '</b></div>';
            if (!IsMESCOCompany)
                ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.CreatorName == 0 ? "" : pOperationHeader.CreatorName) + '<b>' + ' : قام بفتح العملية ' + '</b></div>';
        }
        if (pDefaults.UnEditableCompanyName == "MAR")
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b>' + ' : الرجاء تسليم السادة ' + '</b></div>';
        else if ($("#cbWithNotify").prop("checked"))
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.Notify1Name == 0 ? "" : pOperationHeader.Notify1Name) + '<b>' + ' : الرجاء تسليم السادة ' + '</b></div>';
        else
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.Consignee2Name == 0 ? (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) : pOperationHeader.Consignee2Name) + '<b>' + ' : الرجاء تسليم السادة ' + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n text-right">' + pVesselName + '<b>' + ' : البضاعة المذكورة أدناه الواردة على الباخرة ' + '</b></div>';
        else
            if (!IsMESCOCompany)
                ReportHTML += '         <div class="col-xs-12 m-l-n text-right">' + pVoyageOrTruckNumber + '<b>' + ' : رقم الرحلة ' + '</b></div>';

        //if ($("#cbIsAir").prop("checked"))
        //    ReportHTML += '         <div class="col-xs-12 m-l-n text-right">' + (pRoadOrContainerNumber == "N/A" ? (pRoadNumber == "0" ? "" : pRoadNumber) : pRoadOrContainerNumber) + '<b>' + ' : رقم الطريق ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '<b>' + ' : بموجب بوليصة كلية رقم ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName != "MAR")
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b>' + ' : بموجب بوليصة فرعية رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + pPOLCodeAndName + '<b>' + (pDefaults.UnEditableCompanyName == "MAR" ? ' :   ميناء الشحن ' : ' : الواردة من ميناء ') + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "MAR")
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + pPODCodeAndName + '<b>' + ' :   ميناء الوصول ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-4 text-right">' + (pWarehouse == "0" ? "" : pWarehouse) + '<b>' + ' : المستودع  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-4 text-right">' + (pRoadNumber == "0" ? "" : pRoadNumber) + '<b>' + ' : رقم الطريق  ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName != "BOM")
            ReportHTML += '             <div class="col-xs-4 m-l-n text-right">' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? "" : pActualArrival) + '<b>' + ' : بتاريخ  ' + '</b></div>';
        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table m-t-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            ReportHTML += '                                 <th>Marks & Numbers</th>';
        else
            ReportHTML += '                                 <th>Package Type</th>';
        ReportHTML += '                                     <th>No. Of Packages</th>';
        ReportHTML += '                                     <th>Description Of Goods</th>';
        ReportHTML += '                                     <th>Weight (KG)</th>';
        if (pDefaults.UnEditableCompanyName != "FFI")
            ReportHTML += '                                     <th>CBM</th>';
        ReportHTML += '                                     <th>Freight</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        //$.each(pOperationContainersAndPackages, function (i, item) {
        //    ReportHTML += '                                     <tr class="" style="font-size:95%;">';
        //    if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
        //        ReportHTML += '                                     <td>' + item.MarksAndNumbers + '</td>';
        //        ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + '</td>';
        //    }
        //    else {
        //        ReportHTML += '                                     <td>' + item.PackageTypeName + '</td>';
        //        ReportHTML += '                                     <td>' + item.Quantity + '</td>';
        //    }
        //    ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == "0" ? 'N/A' : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
        //    ReportHTML += '                                         <td>' + item.GrossWeight.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
        //    if (pDefaults.UnEditableCompanyName != "FFI" && pDefaults.UnEditableCompanyName != "DSE" && pDefaults.UnEditableCompanyName != "DSC")
        //        ReportHTML += '                                         <td>' + item.Volume.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
        //    ReportHTML += '                                     </tr>';
        //});
        ReportHTML += '                                     <tr class="" style="text-align:center; vertical-align:text-top; font-size:95%;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? (pOperationHeader.PackageTypeName == 0 ? "" : (pOperationHeader.NumberOfPackages + 'x' + pOperationHeader.PackageTypeName)) : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>") + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum + ' KGM' + '</td>';
        if (pDefaults.UnEditableCompanyName != "FFI")
            ReportHTML += '                                         <td>' + pOperationHeader.VolumeSum + ' CBM' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.POrCName == 0 ? "" : pOperationHeader.POrCName) + '</td>';
        ReportHTML += '                                     </tr>';

        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';


        ReportHTML += '                 <div class="m-t-n" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + 'Revised By' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-6 text-center"><b>' + '' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + 'Issued By' + '</b></div>';
        ReportHTML += '                 </div>'
        ReportHTML += '                 <div class="" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
        ReportHTML += '                     <div class="col-xs-3 text-center">' + '' + '</div>';
        ReportHTML += '                     <div class="col-xs-6 text-center">' + '' + '</div>';
        ReportHTML += '                     <div class="col-xs-3 text-center">' + $("#hLoggedUserNameNotLogin").val() + '</div>';
        ReportHTML += '                 </div>'

        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        if (pDefaults.UnEditableCompanyName != "SEF") {
            ReportHTML += '                         <div class="col-xs-12 m-l-n m-t-lg text-right" style="clear:both;">' + '<b>' + ' : تنبيه هام ' + '</b></div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + ' نظرا إلى أن بضاعتكم قد خزنت على مسئوليتكم و لحسابكم فى الأماكن التى عينتها السلطات المختصة ، لذلك فإننا نرجوكم سحبها فى أقرب فرصة ممكنة علما بأننا و لا وكلائنا مسئولين عن ضياع أوأى ضرر قد يلحق بالبضائع بمجرد تفريغها أو انتظار سحبها من الأمكنة التى قد تكون فرغت بها فالرجاء تخليص بضائعكم فورا أو فعل ما ترونه لازما لحمايتها كالتأمين أو ما شابه ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + '    (شروط وصول البضاعة و استلامها بالمخازن)' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + '    يعمل بهذا الإذن لمدة ستة أشهر من تاريخ صدوره غير مسئولين عن الأوزان و الأحجام المذكورة هنا ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + '    تفريغ هذه البضاعة على مسئولية و حساب المستلمين  ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + '    يرجى من السادة العملاء الكرام و التى تحتوى الرسالة الخاصة بهم على مواد غذائية أو مواد تدخل فى صناعة الأغذية إخطار الموظف المسئول عند سحب إذن التسليم على أن مشمول فى الرسالة يحتوى على مواد غذائة واجبة العرض على معمل الفحص الإشعاعى مع دفع المصاريف الخاصة بحسب عينة الإشعاع و ترك صورة من إيصال السداد طرف الموظف المختص و ذلك لعدم حدوث أى تأخير فى سحب العينة من الرسائل الواردة ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + '  التوكيل غير مسئول عن أى تأخير يحدث نتيجة الإخلال بهذا التنبيه ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-right">' + '  أي شكوي عن وجود زيادة أو عجز أو تلف أو ضياع أو سرقة لن يلتفت إليها إذا تقدم بها صاحب الشأن في خلال يومين من وصول الباخرة و لن يلتفت لشكوي خاصة بطرود قامت بفتحها الجمارك ' + '</div>';
            if (pDefaults.UnEditableCompanyName != "BOM") {
                ReportHTML += '                         <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
                ReportHTML += '                         <div class="col-xs-4"><b>Import Department</b></div>';
            }
            if (pDefaults.UnEditableCompanyName == "EGL")
                ReportHTML += '         <div class="col-xs-8"><img src="/Content/Images/Signature-' + pLoggedUser.Username + '.jpg" alt=""/><img src="/Content/Images/Stamp-' + pLoggedUser.Username + '.jpg" alt=""/></div>';
        } //if (pDefaults.UnEditableCompanyName != "SEF") {
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        if (pDefaults.UnEditableCompanyName == "BOM") {
            ReportHTML += '<br/><br/><br/>';

            ReportHTML += '             <div class="col-xs-3 text-center"><b>' + ' كوكلاء فقط ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-3 text-center"><b>' + ' التوقيع المعتمد ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-3 text-center"><b>' + ' كوكلاء فقط ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-3 text-center"><b>' + ' عن شركة بلو اوشن تريد ' + '</b></div>';
        }
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        //if (pDefaults.UnEditableCompanyName == "BOM"){
        //    ReportHTML += '<br/><br/><br/>';

        //    ReportHTML += '             <div class="col-xs-6 text-right"><b>' + ' التليفونات ' + '</b></div>';
        //    ReportHTML += '             <div class="col-xs-6 text-right"><b>' + ' الفروع ' + '</b></div>';
        //}
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            debugger;
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }

        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
}
function DocsOut_Print_DeliveryOrder_EEL_Air(data, pDocumentTypeID, pOption) {
    debugger;
    //var RecordsExist = data[0];
    //var MissingMandatoryFields = data[1];
    //var pOperationCode = data[2];
    //var pShipperName = data[3];
    //var pShipperContactName = data[4];
    //var pShipperPhones = data[5];
    //var pShipperFax = data[6];
    //var pShipperEmail = data[7];
    //var pConsigneeName = data[8];
    //var pConsigneeContactName = data[9];
    //var pConsigneePhones = data[10];
    //var pConsigneeFax = data[11];
    //var pConsigneeEmail = data[12];
    //var pNotify1Name = data[13];
    //var pNotify1ContactName = data[14];
    //var pNotify1Phones = data[15];
    //var pNotify1Fax = data[16];
    //var pNotify1Email = data[17];
    //var pLineName = data[18];
    //var pVoyageOrTruckNumber = data[19];
    //var pVesselName = data[20];
    //var pActualDeparture = data[21];
    //var pPOLCodeAndName = data[22];
    //var pPODCodeAndName = data[23];
    //var pEnCompanyName = data[24];
    //var pArCompanyName = data[25];
    //var pPOrC = data[26];
    //var pAddressLine1 = data[27];
    //var pAddressLine2 = data[28];
    //var pAddressLine3 = data[29];
    //var pAddressLine4 = data[30];
    //var pAddressLine5 = data[31];
    //var pOperationContainersAndPackages = JSON.parse(data[32]); //objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    //var pPhones = data[33];
    //var pFaxes = data[34];
    //var pEmail = data[35];
    //var pWebsite = data[36];
    //var pClientEmail = data[37];
    //var pContainerTypes = data[38];
    //var pPackageTypes = data[39];
    //var pShipmentType = data[40];
    //var pGrossWeightSum = data[41];
    //var pDescriptionOfGoods = data[42];
    //var pRoadOrContainerNumber = data[43];
    //var pPackageTypesOnContainersTotals = data[44];

    //var pShipperAddressLine1 = data[45];
    //var pShipperAddressLine2 = data[46];
    //var pShipperCityName = data[47];
    //var pShipperCountryName = data[48];

    //var pConsigneeAddressLine1 = data[49];
    //var pConsigneeAddressLine2 = data[50];
    //var pConsigneeCityName = data[51];
    //var pConsigneeCountryName = data[52];

    //var pNotify1AddressLine1 = data[53];
    //var pNotify1AddressLine2 = data[54];
    //var pNotify1CityName = data[55];
    //var pNotify1CountryName = data[56];

    //var pNetWeightSum = data[57];
    //var pVGMSum = data[58];

    //var pDeliveryCountryName = data[59];
    //var pDeliveryCityName = data[60];
    //var pBookingNumber = data[61];
    //var pExpectedArrival = data[62]; //POD
    //var pVolumeSum = data[63];
    //var pExpectedDeparture = data[64];  //POL
    //var pETAPOLDate = data[65];
    //var pClientName = data[66];
    //var pMasterOperationCode = data[67];
    //var pCommodityName = data[68];
    //var pCCAName = data[69];
    //var pCustomerReference = data[70];
    //var pActualArrival = data[71];
    //var pMasterBL = data[72];

    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pCommodityName = data[3];
    var pVesselName = data[4];
    var pLineName = data[5];
    var pMasterBL = data[6];
    var pHouseNumber = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pActualArrival = data[11];
    //data[12] : objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pClientEmail = data[13];
    var pEnCompanyName = data[14];
    var pRoadOrContainerNumber = data[15];//save in the ContainerNumber field
    var pShipmentType = data[16];

    var pMasterOperationCode = data[17];
    var pShipperName = data[18];
    var pShipperContactName = data[19];
    var pShipperPhones = data[20];
    var pShipperFax = data[21];
    var pShipperEmail = data[22];
    var pConsigneeName = data[23];
    var pConsigneeContactName = data[24];
    var pConsigneePhones = data[25];
    var pConsigneeFax = data[26];
    var pConsigneeEmail = data[27];
    var pNotify1Name = data[28];
    var pNotify1ContactName = data[29];
    var pNotify1Phones = data[30];
    var pNotify1Fax = data[31];
    var pNotify1Email = data[32];
    var pShipperAddressLine1 = data[33];
    var pShipperAddressLine2 = data[34];
    var pShipperCityName = data[35];
    var pShipperCountryName = data[36];
    var pConsigneeAddressLine1 = data[37];
    var pConsigneeAddressLine2 = data[38];
    var pConsigneeCityName = data[39];
    var pConsigneeCountryName = data[40];
    var pNotify1AddressLine1 = data[41];
    var pNotify1AddressLine2 = data[42];
    var pNotify1CityName = data[43];
    var pNotify1CountryName = data[44];
    var pCustomerReference = data[45];
    var pNumberOfPackages = data[46];
    var pGrossWeightSum = data[47];
    var pVolumeSum = data[48];
    var pVGMSum = data[49];
    var pDescriptionOfGoods = data[50];
    var pOperationHeader = JSON.parse(data[51]);
    var pRoadNumber = data[52];
    var pDeliveryOrderNumber = data[53];
    var pMainRoute = JSON.parse(data[54]);
    var pMainRouteMaster = data[55] == null ? 0 : JSON.parse(data[55]);
    if (pRoadNumber == 0)//$("#tblRoutings tbody tr td.Notes")[0].innerHTML;
        pRoadNumber = pMainRoute.RoadNumber == 0 ? (pMainRouteMaster.RoadNumber == 0 || pMainRouteMaster.RoadNumber == undefined ? "" : pMainRouteMaster.RoadNumber) : pMainRoute.RoadNumber //$("#tblRoutings tr td.RoutingType[val=30]").parent().find("td.RoadNumber").text(); 
    var pWarehouse = pMainRoute.WareHouse == 0 ? (pMainRouteMaster.WareHouse == 0 || pMainRouteMaster.WareHouse == undefined ? "" : pMainRouteMaster.WareHouse) : pMainRoute.WareHouse //$("#tblRoutings tr td.RoutingType[val=30]").parent().find("td.WareHouse").text();
    var pDeliveryOrderNumber = data[53];

    //var pGrossWeightSum = data[14].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>Delivery Order</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' ' + $("#hDefaultCountryName").val() + ' DELIVERY PERMIT' + '</b></h3></div>';

    ReportHTML += '             <div class="col-xs-8 m-t-xs">';
    ReportHTML += '                 THE CUSTOMS WAREHOUSE<br>' + pPODCodeAndName.split(':')[0];
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-4 m-t-xs">';
    ReportHTML += '                 <table id="tblShipment" class="table table-striped b-light text-sm table-bordered"">';//style="border:solid #000 !Important;"
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
    ReportHTML += '                             <td style="text-align:center!Important;"><b>SHIPMENT</b><td style="text-align:center!Important;">' + pOperationHeader.Code + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:center!Important;"><b>CONSOL</b><td style="text-align:center!Important;">' + (pMasterBL == 'N/A' ? pMasterOperationCode : pMasterBL) + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:center!Important;"><b>DATE</b><td style="text-align:center!Important;">' + getTodaysDateInddMMyyyyFormat() + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>PLEASE DELIVER THE FOLLOWING SHIPMENT TO CONSIGNEE AS MENTIONED BELOW:</b></td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>SHIPMENT DETAILS</b></td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>CONSIGNOR</b>';
    ReportHTML += '                                 <br>' + pShipperName;
    ReportHTML += '                                 ' + (pShipperAddressLine1 == "" ? "" : ('<br>' + pShipperAddressLine1))
    ReportHTML += '                                 ' + (pShipperAddressLine2 == "" ? "" : ('<br>' + pShipperAddressLine2))
    ReportHTML += '                                 ' + (pShipperCityName == "" ? "" : ('<br>' + pShipperCityName))
    ReportHTML += '                                 ' + (pShipperCountryName == "" ? "" : ('<br>' + pShipperCountryName))
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>CONSIGNEE</b>';
    ReportHTML += '                                 <br>' + pConsigneeName;
    ReportHTML += '                                 ' + (pConsigneeAddressLine1 == "" ? "" : ('<br>' + pConsigneeAddressLine1))
    ReportHTML += '                                 ' + (pConsigneeAddressLine2 == "" ? "" : ('<br>' + pConsigneeAddressLine2))
    ReportHTML += '                                 ' + (pConsigneeCityName == "" ? "" : ('<br>' + pConsigneeCityName))
    ReportHTML += '                                 ' + (pConsigneeCountryName == "" ? "" : ('<br>' + pConsigneeCountryName))
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>NOTIFY PARTY</b>';
    ReportHTML += '                                 ' + (pNotify1Name == "" ? '<br><br><br><br><br>' : ('<br>' + pNotify1Name));
    ReportHTML += '                                 ' + (pNotify1AddressLine1 == "" ? "" : ('<br>' + pNotify1AddressLine1))
    ReportHTML += '                                 ' + (pNotify1AddressLine2 == "" ? "" : ('<br>' + pNotify1AddressLine2))
    ReportHTML += '                                 ' + (pNotify1CityName == "" ? "" : ('<br>' + pNotify1CityName))
    ReportHTML += '                                 ' + (pNotify1CountryName == "" ? "" : ('<br>' + pNotify1CountryName))
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>GOODS AVAILABLE AT</b>';
    ReportHTML += '                                 <br><br><br><br><br>';
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>COMMODITY SUMMARY</b>';
    ReportHTML += '                                 <br>' + pCommodityName;
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>RELEASE TYPE</b>';
    ReportHTML += '                                 <br>' + 'Air Waybill';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>' + (pDefaults.UnEditableCompanyName == "SWI" ? 'SWIFT REFERENCE' : 'ORDER NUMBERS/REFERENCE') + '</b>';
    ReportHTML += '                                 <br>' + (pCustomerReference == "" ? '<br>' : pCustomerReference);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:35%;"><b>Line</b>';
    ReportHTML += '                                 <br>' + pLineName;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:15%;"><b>WAY No.</b>';
    ReportHTML += '                                 <br>' + pRoadOrContainerNumber;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:25%;"><b>' + ($("#cbIsAir").prop("checked") ? 'MAWB' : 'MBL') + '</b>';
    ReportHTML += '                                 <br>' + (pOperationHeader.MasterBL == 0 ? 'N/A' : pOperationHeader.MasterBL);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:25%;"><b>' + ($("#cbIsAir").prop("checked") ? 'HAWB' : 'HBL') + '</b>';
    ReportHTML += '                                 <br>' + (pOperationHeader.HouseNumber == 0 ? 'N/A' : pOperationHeader.HouseNumber);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>' + ($("#cbIsAir").prop("checked") ? "FLIGHT" : "VOYAGE No.") + '</b>';
    ReportHTML += '                                 <br>' + pVoyageOrTruckNumber + ' / ' + pPOLCodeAndName.split(':')[1] + ' / ' + (pActualArrival == '01/01/1900' ? 'N/A' : pActualArrival);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>COMMODITY TYPE</b>';
    ReportHTML += '                                 ' + (pCommodityName == "" ? '<br>' : ('<br>' + pCommodityName));
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>PACKAGES</b>';
    ReportHTML += '                                 <br>' + (pNumberOfPackages == "0" ? "" : pNumberOfPackages);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>WEIGHT</b>';
    ReportHTML += '                                 <br>' + pGrossWeightSum.toFixed(2) + ' KGM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VOLUME</b>';
    ReportHTML += '                                 <br>' + pVolumeSum + ' CBM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VGM</b>';
    ReportHTML += '                                 <br>' + pVGMSum.toFixed(2) + ' KG';
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>MARKS AND NUMBERS</b>';
    ReportHTML += '                                 <br><br>';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>GOODS DESCRIPTION</b>';
    ReportHTML += '                                 <br>' + pDescriptionOfGoods.replace(/\n/g, "<br />");
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'


    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;">';
    ReportHTML += '                                 <b>IN CASE OF UNFINISHING CUSTOMS CLEARANCE WITHIN 90 DAYS OF ARRIVAL, DATE PARCELS WILL BE TRANSFERRED TO A CUSTOMS BONDED WAREHOUSE.</b>';
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_LetterRelease(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pConsigneeName = data[3];
    var pVesselName = data[4];
    var pLineName = data[5];
    var pMasterBL = data[6];
    var pHouseNumber = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pActualArrival = data[11];
    var pContainerNumbers = data[12];
    var pEnCompanyName = data[13];
    var pClientEmail = data[14];
    var pRoadOrContainerNumber = data[15];
    var pClientName = data[16];
    var pOperationHeader = JSON.parse(data[17]);
    var pOperationContainersAndPackages = JSON.parse(data[18]);
    var pDeliveryOrderNumber = data[19];
    var pDeliveryDate = data[20];
    var pConsigneeAddressFromCustomers = data[21];
    //var pGrossWeightSum = data[15].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

    var pSealNumbers = ",";
    for (var i = 0; i < pOperationContainersAndPackages.length; i++)
        pSealNumbers += pOperationContainersAndPackages[i].CarrierSeal == 0 ? "" : (pOperationContainersAndPackages[i].CarrierSeal + ",");
    pSealNumbers = pSealNumbers.replace(',', ''); //Remove the first comma

    if (pDefaults.UnEditableCompanyName == "NIL" || pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-right text-ul"><h3>' + pBranchName + ' ' + ConvertDateFormat(FormattedTodaysDate) + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' RELEASE LETTER ' + '</h3></div> </br>';
        }
        else { //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-right text-ul m-t-lg"></br></br><h3>' + pBranchName + ' ' + ConvertDateFormat(FormattedTodaysDate) + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + ' RELEASE LETTER ' + '</h3></div> </br>';
        }
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Messrs&emsp;&emsp;: </b>' + pLineName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>From &emsp;&emsp;&emsp; : </b>' + pDefaults.CompanyName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>MB/L &emsp;&emsp;&emsp;&nbsp; : </b>' + pMasterBL + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>HB/L &emsp;&emsp;&emsp;&nbsp; : </b>' + pHouseNumber + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t">' + 'Dear Sirs,' + '</div>';
        ReportHTML += '             <div class="col-xs-12">' + 'You are kindly requested to deliver the related shipping release to the following Cnee:' + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t">' + 'Messrs / <b><u>' + pConsigneeName + '</u></b></div>';
        ReportHTML += '             <div class="col-xs-12">' + 'Address :  <b><u>' + (pConsigneeAddressFromCustomers == 0 ? "" : pConsigneeAddressFromCustomers) + '</u></b></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Vessel &emsp;&emsp;&nbsp; : </b>' + pVesselName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Voyage &emsp;&emsp; : </b>' + (pOperationHeader.VoyageOrTruckNumber == 0 ? "N/A" : pOperationHeader.VoyageOrTruckNumber) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>P.O.L &emsp;&emsp;&emsp; : </b>' + pPOLCodeAndName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>P.O.D &emsp;&emsp;&emsp;: </b>' + pPODCodeAndName + '</div>';

        //ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Oper. Serial : </b>' + pOperationHeader.CodeSerial + '</div>';
        //if (pOperationHeader.ShipmentTypeCode == "CONSOL" || pOperationHeader.ShipmentTypeCode == "FCL" || pOperationHeader.ShipmentTypeCode == "FTL") {
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Container Types : </b>' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.ContainerTypes) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Containers No. &nbsp;: </b>' + (pContainerNumbers == "N/A" ? pRoadOrContainerNumber : pContainerNumbers) + '</div>';
        //}
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>G.W. &nbsp;: </b>' + pOperationHeader.GrossWeightSum + ' KGM' + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Vol. &nbsp;: </b>' + pOperationHeader.VolumeSum + ' CBM</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + 'You are kindly requested to take the necessary procedures to deliver the required documents to the consignee for releasing the shipment :' + '</div>';

        ReportHTML += '             <div class="col-xs-12 text-center">' + 'As we are Freight Forwarders only.' + '</div>';

        ReportHTML += '             <div class="col-xs-12">' + 'Please contact us direclty if any clarifications or information required ...' + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm"><b>' + "Best Regards ," + '</b></div>';
        ReportHTML += '             <div class="col-xs-12"><i><b>' + pDefaults.CompanyName + '</b></i></div>';
        if (pDefaults.UnEditableCompanyName == "NIL")
            ReportHTML += '             <div class="col-xs-12"><i><b>' + 'General Manager' + '</b></i></div>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "NIL") 
    else if (pDefaults.UnEditableCompanyName == "EGL") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-right text-ul"><h3>' + pBranchName + ' ' + ConvertDateFormat(FormattedTodaysDate) + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' RELEASE LETTER ' + '</h3></div> </br>';
        }
        else { //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-right text-ul m-t-lg"></br></br><h3>' + pBranchName + ' ' + ConvertDateFormat(FormattedTodaysDate) + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + ' RELEASE LETTER ' + '</h3></div> </br>';
        }
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Messrs&emsp;&emsp;: </b>' + pLineName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Subject &emsp;&emsp;: </b>' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.ContainerTypes) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>P.O.L &emsp;&emsp;&emsp; : </b>' + pPOLCodeAndName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>P.O.D &emsp;&emsp;&emsp;: </b>' + pPODCodeAndName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>M/V &emsp;&emsp;&emsp;&nbsp;&nbsp; : </b>' + pVesselName + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>MB/L &emsp;&emsp;&emsp;: </b>' + pMasterBL + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>HB/L &emsp;&emsp;&emsp; : </b>' + pHouseNumber + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Oper. Serial : </b>' + (pOperationHeader.CodeSerial == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.CodeSerial) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + '<b>Containers &nbsp;: </b>' + (pContainerNumbers == "N/A" ? pRoadOrContainerNumber : pContainerNumbers) + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg">' + 'Dear Sirs,' + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + 'You are kindly requested to release the above mentioned shipment to :' + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg">' + 'Messrs / <b>' + pClientName + '</b></div>';
        ReportHTML += '             <div class="col-xs-12">' + 'Address :  <b>' + (pOperationHeader.ClientAddress == 0 ? "NOT SPECIFIED" : pOperationHeader.ClientAddress) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm">' + 'WITHOUT ANY RESPONSIBILITY ON OUR COMPANY.' + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg">' + 'With our best regards,' + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-sm"><b>' + "&emsp;<br>" + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><i><b>' + 'Egyptian Global Logistics' + '</b></i></div>';

        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "EGL")
    else if (pDefaults.UnEditableCompanyName == "GLS") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; font-size:16px;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' خطاب تنازل ' + '</h3></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br></br></br><h3>' + ' خطاب تنازل ' + '</h3></div> </br>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><b style="font-size:20px;"> ' + ConvertDateFormat(FormattedTodaysDate) + ' : الاسكندرية فى  </b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><b style="font-size:20px;"> ' + (pLineName == "N/A" ? "" : pLineName) + ': السادة  </b></div>';
        ReportHTML += ' </br>';
        ReportHTML += '             <div class="col-xs-12 text-center m-l-md"><b style="font-size:20px;" >نحيط سيادتكم علما بأننا قد تنازلنا عن مشمول البوليصة الأتى تفاصيلها </b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><b style="font-size:20px;"> / الى السادة شركة </b></div>';
        ReportHTML += '             <div class="col-xs-12 text-center m-l-md"><b>' + pClientName + '</b></div>';
        ReportHTML += ' </br>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-center">';
        ReportHTML += '                         <table id="tblReleaseLetter" class=" table table-striped b-light table-bordered" text-sm">'; //table-hover 
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>TYPE</b></td>';
        ReportHTML += '                                     <td >' + pOperationHeader.ShipmentTypeCode + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>BL No.</b></td>';
        ReportHTML += '                                     <td >' + (pOperationHeader.MasterBL == 0 ? pHouseNumber : pOperationHeader.MasterBL) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>POL</b></td>';
        ReportHTML += '                                     <td >' + pOperationHeader.POLName + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>POD</b></td>';
        ReportHTML += '                                     <td >' + pOperationHeader.PODName + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>WGT</b></td>';
        ReportHTML += '                                     <td >' + pOperationHeader.GrossWeightSum + ' KGS </td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>CNTR. NO.</b></td>';
        ReportHTML += '                                     <td >' + (pOperationHeader.ContainerNumbers == "0" ? "" : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td ><b>PKGS</b></td>';
        ReportHTML += '                                     <td >' + pOperationHeader.NumberOfPackages + 'x' + pOperationHeader.PackageTypeName + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                             </table>';
        ReportHTML += '                                 </div>';


        //ReportHTML += '             <div class="col-xs-12 m-t m-l-n text-right"><b>' + ' هم الملاك الأصليين لهذه الشحنة - و لذا يرجى التكرم بإصدار إذن التسليم باسمائهم مباشرة و اعتبار هذا تنازل منا بذلك ، مع تحصيل أى مصاريف تخص هذه الشحنة من المستفيد مباشرة دون أدنى مسئولية على الشركة حيث أننا وكلاء شحن فقط  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg  text-center"><b>' + ' ....... و تفضلوا سيادتكم بقبول فائق التحية و الاحترام ' + '</b></div>';
        //ReportHTML += '             <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';

        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }//if (pDefaults.UnEditableCompanyName == "GLS") {
    else if (pDefaults.UnEditableCompanyName == "FAI") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; font-size:16px;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' خطاب تنازل ' + '</h3></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br></br></br><h3>' + ' خطاب تنازل ' + '</h3></div> </br>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + ConvertDateFormat(FormattedTodaysDate) + ' <b style="font-size:20px;">: بورسعيد فى  </b></p></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (pOperationHeader.LineName == "0" ? "" : pOperationHeader.LineName) + ' <b style="font-size:20px;">: الخط الملاحي  </b></p></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (pOperationHeader.VesselName == "0" ? "" : pOperationHeader.VesselName) + '<b style="font-size:20px;">: الموضوع : الباخرة  </b></p></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (pOperationHeader.MasterBL == "0" ? "" : pOperationHeader.MasterBL) + ' <b style="font-size:20px;">: بوليصة الخط الملاحي  </b></p></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (pOperationHeader.HouseBLs == "0" ? (pOperationHeader.HouseNumber == "0" ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + ' <b style="font-size:20px;">: بوليصة فرعية  </b></p></div>';
        var SumContainer20 = 0;
        var SumContainer40 = 0;
        var countContainerTypes20 = pOperationHeader.ContainerTypes20.split('-').length;
        var countContainerTypes40 = pOperationHeader.ContainerTypes40.split('-').length;
        var cnt = 0;
        for (cnt = 0; cnt < countContainerTypes20; cnt++) {
            SumContainer20 += parseInt(pOperationHeader.ContainerTypes20.split('-')[cnt][0]);
        }
        cnt = 0;
        for (cnt = 0; cnt < countContainerTypes40; cnt++) {
            SumContainer40 += parseInt(pOperationHeader.ContainerTypes40.split('-')[cnt][0]);
        }

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (SumContainer20 == 0 ? "" : (SumContainer20 + " x 20 __ ")) + (SumContainer40 == 0 ? "" : (SumContainer40 + " x 40")) + '<b style="font-size:20px;"> : عدد الحاويات  </b></p></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (pOperationHeader.ContainerNumbers == "0" ? "" : pOperationHeader.ContainerNumbers) + '</p></div>';
        //ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-center"><b style="font-size:20px;"> ' + (pOperationHeader.VesselName == "0" ? "" : pOperationHeader.VesselName) + ' </b></div>';
        if (pOperationHeader.ShipmentTypeCode != "FCL" && pOperationHeader.ShipmentTypeCode != "FTL")
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><p style="font-size:20px;"> ' + (pOperationHeader.NumberOfPackages + ' x ' + pOperationHeader.PackageTypeName) + '<b style="font-size:20px;"> : البضائع  </b></p></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-md text-center" style="font-size:20px;">برجاء التكرم بتسليم اذن التسليم الخاص البوليصة اعلاه الي الساده  </div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-center" style="font-size:20px;"> ' + (pOperationHeader.ConsigneeName == "0" ? "" : pOperationHeader.ConsigneeName) + ' </div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-md text-center" style="font-size:20px;">  مع التكرم بتحصيل كافة مستحقاتكم من العميل مباشرة حيث أن هذه الشحنه تخصه ولا تخصنا حيث أننا وكلاء شحن فقط</div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-lg text-center" style="font-size:19px;">واذ نشكركم سلفا على حسن  تعاونكم </div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-center" style="font-size:19px;">وتفضلوا بقبول وافر التحية والاحترام </div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-center" style="font-size:19px;"> شركة فيرترانس للملاحة</div>';

        ReportHTML += ' </br>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }//if (pDefaults.UnEditableCompanyName == "FAI") {
    else if (pDefaults.UnEditableCompanyName == "BME") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; font-size:16px;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' RELEASE LETTER ' + '</h3></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br></br></br><h3>' + ' RELEASE LETTER ' + '</h3></div> </br>';

        ReportHTML += '             <div class="col-xs-12 m-t-xs ">Carrier: ' + (pLineName == "N/A" ? "" : pLineName) + '<b></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs ">MBL#:    ' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '<b></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs ">HBL#:   ' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs ">Vessel / Voyage:  ' + (pVesselName == "N/A" ? "" : pVesselName) + ' / ' + (pVoyageOrTruckNumber == "N/A" ? "" : pVoyageOrTruckNumber) + '<b></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs ">POL / POD:  ' + pOperationHeader.POLName + ' / ' + pOperationHeader.PODName + '<b></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs ">Consignee: ' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ClientName) + '<b></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs ">ACID Number: ' + (pOperationHeader.ACIDNumber == 0 ? "" : pOperationHeader.ACIDNumber) + '<b></b></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-md">';
        ReportHTML += '                 <table id="tblReleaseLetter" class="table table-striped b-light text-sm table-bordered"">';//style="border:solid #000 !Important;"
        ReportHTML += '                     <thead>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        //ReportHTML += '                             <td style="text-align:center!Important;"><b>PAKAGING </b></td>';
        ReportHTML += '                             <td style="text-align:center!Important;"><b>WEIGHT (KG)  </b></td>';
        //ReportHTML += '                             <td style="text-align:center!Important;"><b>VOLUME (CBM)  </b></td>';
        ReportHTML += '                             <td style="text-align:center!Important;"><b>DESCRIPTION  </b></td>';
        ReportHTML += '                             <td style="text-align:center!Important;"><b>ContainerType  </b></td>';
        ReportHTML += '                             <td style="text-align:center!Important;"><b>CONTAINER NO.  </b></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </thead>';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        //ReportHTML += '                             <td style="text-align:center!Important;">' + (pOperationHeader.NumberOfPackages == "0" ? "" : pOperationHeader.NumberOfPackages) + (pOperationHeader.PackageTypeName == "0" ? "" : (' x ' + pOperationHeader.PackageTypeName)) + '</td>';
        ReportHTML += '                             <td style="text-align:center!Important;">' + pOperationHeader.GrossWeightSum + '</td>';
        //ReportHTML += '                             <td style="text-align:center!Important;">' + pOperationHeader.VolumeSum + '</td>';
        ReportHTML += '                             <td style="text-align:center!Important;">' + (pOperationHeader.DescriptionOfGoods == "0" ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
        ReportHTML += '                             <td style="text-align:center!Important;">' + (pOperationHeader.ContainerTypes == "0" ? "" : pOperationHeader.ContainerTypes) + '</td>';
        ReportHTML += '                             <td style="text-align:center!Important;">' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + ' / ' + (pContainerNumbers == "N/A" ? pRoadOrContainerNumber : pContainerNumbers) + '</td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'

        ReportHTML += '             <div class="col-xs-12 m-l-n-lg m-t text-right"><b>برجاء التكرم بأصدار اذن التسليم الخاص بهذه البوليصة للسادة المذكورين اعلاه حيث انهم المستلمين الفعليين و اننا وكلاء شحن وذلك دون أدني مسئولية على التوكيل الملاحي</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-center m-t-md m-b-md">' + '<b style="font-size:15px;">' + ' ولكم جزيل الشكر والاحترام ' + '</b></div>';
        ReportHTML += '                         <div class="row col-xs-12"><div class="col-xs-5 text-right m-t-md m-b-md">' + '<b style="font-size:17px;">' + '  شركة بلو مارين ايجيبت لخدمات الشحن و النقل  ' + '</b></div><div class="col-xs-7"><label> </label></div></div>';
        ReportHTML += '                         <div class="row col-xs-12"><div class="col-xs-5 text-right m-t-md m-b-md">' + '<b style="font-size:17px;">' + ' / التوقيع   ' + '</b></div><div class="col-xs-7"></div></div>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "BME") {
    else {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white; font-size:16px;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + (pDefaults.UnEditableCompanyName == "ASL" ? "Release Letter" : ' خطاب تنازل ') + '</h3></div> </br>';
        }
        else if (pDefaults.UnEditableCompanyName == "BAK") {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader-Empty.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' خطاب تنازل ' + '</h3></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br><h3>' + ' خطاب تنازل ' + '</h3></div> </br>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        else if (pDefaults.UnEditableCompanyName == "SWI")
            ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        else if (pDefaults.UnEditableCompanyName == "TEU")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.DismissalPermissionSerial == 0 ? '' : pOperationHeader.DismissalPermissionSerial) + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + ConvertDateFormat(FormattedTodaysDate) + '<b>' + ' : اليوم ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "BAK" || pDefaults.UnEditableCompanyName == "TEU")
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '<b>' + '  / عملية ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "ELI")
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pOperationHeader.BookingNumbers == 0 ? "" : pOperationHeader.BookingNumbers) + '<b>' + '  / رقم الحجز ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "MSL" && pOperationHeader.BLType == constHouseBLType)
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><b>' + ' السادة / مصلحة الجمارك المصرية ' + '</b></div>';
        else
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pLineName + '<b>' + '  / السادة ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><b>' + ' عناية / قسم الوارد ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n-lg m-t text-right"><b>' + '  ..... تحية طيبة و بعد ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t text-right"><b>' + '  : ليست المالكة للشحنة الواردة على  ' + '</b>' + pEnCompanyName + '<b>' + '  نحيط سيادتكم علما بأن شركة ' + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right">' + pVesselName + '<b>' + ' : الباخرة ' + '</b></div>';
        else
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right">' + pVoyageOrTruckNumber + '<b>' + ' : رقم الرحلة ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pOperationHeader.POLName + '<b>' + '  : ميناء التحميل  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pOperationHeader.PODName + '<b>' + '  : ميناء الوصول  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '<b>' + (pDefaults.UnEditableCompanyName == "MAR" ? ' : بخصوص البوليصة رقم ' : ' : بخصوص البوليصة الكلية ') + '</b></div>';

        if (pDefaults.UnEditableCompanyName != "LIO" && pDefaults.UnEditableCompanyName != "MAR" && pDefaults.UnEditableCompanyName != "GBL")
            ReportHTML += '             <div class="col-xs-12 m-l-n text-right">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b>' + ' : بموجب البوليصة/البوالص الفرعية رقم ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "ASL" || pDefaults.UnEditableCompanyName == "DGL") {
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + $("#txtOperationACIDNumber").val().trim() + '<b>' + ' : الرقم التعريفي للبوليصة الكلية ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pOperationHeader.ACIDNumber + '<b>' + /*'  : ACID No  '*/' : الرقم التعريفي للبوليصة الفرعية  ' + '</b></div>';
        }
        else {
            if (pDefaults.UnEditableCompanyName != "GBL")
                ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + $("#txtOperationACIDNumber").val()?.trim() + '<b>' + ' : Master ACID No ' + '</b></div>';
            if (pOperationHeader.BLType == constHouseBLType)
                ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pOperationHeader.ACIDNumber + '<b>' + '  : House ACID No  ' + '</b></div>';
        }
        if ($("#cbIsOcean").prop("checked")) {
            if (pDefaults.UnEditableCompanyName != "BAK" && pDefaults.UnEditableCompanyName != "MAR" && pDefaults.UnEditableCompanyName != "TEU" && pDefaults.UnEditableCompanyName != "GBL")
                ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pContainerNumbers == "N/A" ? pRoadOrContainerNumber : pContainerNumbers) + '<b>' + ' : حاوية رقم ' + '</b></div>';
            if (pDefaults.UnEditableCompanyName == "MED") {
                ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pSealNumbers) + '<b>' + ' : Seal No ' + '</b></div>';
                ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pOperationHeader.ACIDNumber == 0 ? "" : pOperationHeader.ACIDNumber) + '<b>' + ' : ACID No ' + '</b></div>';
            }
            if (pDefaults.UnEditableCompanyName == "DGL" || pDefaults.UnEditableCompanyName == "BAK" || pDefaults.UnEditableCompanyName == "MAR"
                || (pDefaults.UnEditableCompanyName == "TEU" && pOperationHeader.ShipmentType == constFCLShipmentType))
                ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '<b>' + ' : عدد الحاويات ' + '</b></div>';
        }
        if (pDefaults.UnEditableCompanyName != "MAR" && pDefaults.UnEditableCompanyName != "GBL"
            && !(pDefaults.UnEditableCompanyName == "TEU" && pOperationHeader.ShipmentType == constFCLShipmentType))
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pOperationHeader.GrossWeightSum + ' KGM' + '<b>' + '  : الوزن  ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName != "ARK" && pDefaults.UnEditableCompanyName != "MAR" && pDefaults.UnEditableCompanyName != "GBL"
            && !(pDefaults.UnEditableCompanyName == "TEU" && pOperationHeader.ShipmentType == constFCLShipmentType))
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pOperationHeader.VolumeSum + ' CBM' + '<b>' + '  : الحجم  ' + '</b></div>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "TEU")
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + (pOperationHeader.ConsigneeName == 0 ? pOperationHeader.ClientName : pOperationHeader.ConsigneeName) + '<b>' + ' : و أن السادة ' + '</b></div>';
        else
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right">' + pClientName + '<b><span class="float-right">' + ' : و أن السادة ' + '</span></b></div>';
        if (pDefaults.UnEditableCompanyName == "MAR")
            ReportHTML += '             <div class="col-xs-12 m-t m-l-n text-right"><b>' + ' هم الملاك الأصليين لهذه الشحنة - و لذا يرجى التكرم بإصدار إذن التسليم باسمائهم مباشرة و اعتبار هذا تنازل منا بذلك ، مع تحصيل أى مصاريف تخص هذه الشحنة من المستفيد مباشرة دون أدنى مسئولية على الشركة حيث أننا توكيل ملاحي  ' + '</b></div>';
        else
            ReportHTML += '             <div class="col-xs-12 m-t m-l-n text-right"><b>' + ' هم الملاك الأصليين لهذه الشحنة - و لذا يرجى التكرم بإصدار إذن التسليم باسمائهم مباشرة و اعتبار هذا تنازل منا بذلك ، مع تحصيل أى مصاريف تخص هذه الشحنة من المستفيد مباشرة دون أدنى مسئولية على الشركة حيث أننا وكلاء شحن فقط  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg  text-center"><b>' + ' ....... و تفضلوا سيادتكم بقبول فائق التحية و الاحترام ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg  text-left"><b>' + pEnCompanyName + '</b></div>';
        if (pDefaults.UnEditableCompanyName != "DSE" && pDefaults.UnEditableCompanyName != "DSC")
            ReportHTML += '             <div class="col-xs-12 text-left"><b>Import Department</b></div>';

        if (pDefaults.UnEditableCompanyName == "MAR")
            ReportHTML += '             <div class="col-xs-12 text-left"><b>VAT No: 618-102-779</b></div>';

        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
}
function DocsOut_Print_DangerousGoodsLetter(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pConsigneeName = data[3];
    var pVesselName = data[4];
    var pLineName = data[5];
    var pMasterBL = data[6];
    var pHouseNumber = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pActualArrival = data[11];
    var pContainerNumbers = data[12];
    var pEnCompanyName = data[13];
    var pClientEmail = data[14];
    var pRoadOrContainerNumber = data[15];
    var pClientName = data[16];
    var pOperationHeader = JSON.parse(data[17]);
    var pOperationContainersAndPackages = JSON.parse(data[18]);
    var pDeliveryOrderNumber = data[19];
    var pDeliveryDate = data[20];
    var pConsigneeAddressFromCustomers = data[21];
    //var pGrossWeightSum = data[15].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

    if (pDefaults.UnEditableCompanyName == "GLS") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br><h3>' + '</h3></div> </br>';

        ReportHTML += '             <div class="col-xs-12 m-t-xs text-center"><h3><b>' + '  خطاب خطر ' + '</b></h3></div>';

        ReportHTML += '             </br></br><div class="col-xs-12 m-l-n m-t-xs text-right">' + '<h4><b>' + ConvertDateFormat(FormattedTodaysDate) + ' : الاسكندرية في ' + '</b></h4></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><h4><b>  السيد /  العميد مدير إدراة الحماية المدنية </b></h4></div>';
        ReportHTML += '             <div class="col-xs-12 text-center m-t"><h4><b>' + ' ....... تحية طيبة و بعد  ' + '</b></h4></div> </br>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;"><b>' + '  : نحيط سيادتكم علما بأن الشحنة الاتي بياناتها خطر ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b>' + '  : اسم العميل ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.GrossWeightSum == 0 ? "" : pOperationHeader.GrossWeightSum) + '<b>' + '  : اجمالى الوزن ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t text-right" style="font-size:16px;">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b>' + ' : بوليصة رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.DescriptionOfGoods == "0" ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '<b>' + ' : وصف البضاعة ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.PackageTypes == "0" ? "" : pOperationHeader.PackageTypes) + '<b>' + ' : عدد الطرود ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '<b>' + ' : الخط الملاحى ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg text-center" style="font-size:17px;"><b>' + 'وذلك دون أدني مسئولية على الخط الملاحي ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg text-center" style="font-size:17px;"><b>' + 'برجاء تحصيل مصاريف الخطر على البوليصة عاليه من صاحب الشأن مباشرة دون الرجوع الي التوكيل الملاحى وذلك طبقا للبوليصة المرفقة ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg  text-center" style="font-size:17px;"><b><u>' + ' ... و تفضلوا بقبول فائق الاحترام ' + '</ul></b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "GLS") 
    else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br><h3>' + '</h3></div> </br>';

        ReportHTML += '             </br></br><div class="col-xs-12 m-l-n m-t-xs">' + '<h4>' + 'Printed on : ' + ConvertDateFormat(FormattedTodaysDate) + '</h4></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs"><h4>' + 'Dear Messers : Customs Authority' + '</h4></div>';
        ReportHTML += '             <div class="col-xs-12 m-t"><h4><b>' + 'Good day,' + '</b></h4></div> </br>';


        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'We hereby inform you that the cargo stated here is for :' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t" style="font-size:16px;">' + '<b>' + 'HBL : ' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'MBL : ' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'POL :' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'Line : ' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'Goods Description : ' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'Vessel : ' + pVesselName + '</b></div>';
        else
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'Voyage : ' + pVoyageOrTruckNumber + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'For : ' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.ContainerTypes) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'Container No. : ' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs" style="font-size:16px;">' + '<b>' + 'Arrival Date : ' + (pActualArrival == "01/01/1900" ? "" : pActualArrival) + '</b></div>';


        ReportHTML += '             <div class="col-xs-12 m-t-lg" style="font-size:16px;"><b>' + 'Please, collect the dangerous cargo fees from the client directly without returning to the shipping line.' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg  text-left" style="font-size:16px;"><b><u>' + 'Thanks and best regards...........' + '</ul></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs  text-left" style="font-size:16px;"><b><u>' + (pDefaults.CompanyLocalName == 0 ? pDefaults.CompanyName : pDefaults.CompanyLocalName) + '</u></b></div>';


        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA"){
    else { //Other Companies
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        }
        else //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg"></br></br></br></br></br></br><h3>' + '</h3></div> </br>';

        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             </br></br><div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        else if (pDefaults.UnEditableCompanyName == "SWI")
            ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

        ReportHTML += '             </br></br><div class="col-xs-12 m-l-n m-t-xs text-right">' + '<h4>' + ConvertDateFormat(FormattedTodaysDate) + ' : اليوم ' + '</h4></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right"><h4>' + ' عناية السادة / إدراة الدفاع المدنى و الحريق ' + '</h4></div>';
        ReportHTML += '             <div class="col-xs-12 text-center m-t"><h4><b>' + ' ....... تحية طيبة و بعد  ' + '</b></h4></div> </br>';


        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b>' + '  / نحيط سيادتكم علما أن الشحنة المذكورة عاليه تخص السادة ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-l-n m-t text-right" style="font-size:16px;">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b>' + ' : بوليصة فرعية رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '<b>' + ' : بوليصة كلية رقم ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '<b>' + ' : ميناء الشحن ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '<b>' + ' : الخط الملاحى ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '<b>' + ' : وصف البضاعة ' + '</b></div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + pVesselName + '<b>' + ' : واردة على الباخرة ' + '</b></div>';
        else
            ReportHTML += '         <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + pVoyageOrTruckNumber + '<b>' + ' : رقم الرحلة ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.ContainerTypes) + '<b>' + ' : لعدد ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '<b>' + ' : أرقام الحاويات ' + '</b></div>';

        if (pDefaults.UnEditableCompanyName != "PFS")
            ReportHTML += '             <div class="col-xs-12 m-l-n m-t-xs text-right" style="font-size:16px;">' + (pActualArrival == "01/01/1900" ? "" : pActualArrival) + '<b>' + ' : بتاريخ ' + '</b></div>';


        ReportHTML += '             <div class="col-xs-12 m-t-lg text-right" style="font-size:16px;"><b>' + '   برجاء التكرم بالموافقة على تحصيل مصاريف الخطر على البوليصة عاليه من صاحب الشأن مباشرة دون الرجوع الى التوكيل الملاحى  ' + '</b></div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg  text-left" style="font-size:16px;"><b><u>' + ' ....... و تفضلوا سيادتكم بقبول فائق التحية و الاحترام ' + '</ul></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs  text-left" style="font-size:16px;"><b><u>' + (pDefaults.CompanyLocalName == 0 ? pDefaults.CompanyName : pDefaults.CompanyLocalName) + '</u></b></div>';


        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else { //Other Companies
}
function DocsOut_Print_ReservationLetter(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pConsigneeName = data[3];
    var pVesselName = data[4];
    var pLineName = data[5];
    var pMasterBL = data[6];
    var pHouseNumber = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pActualArrival = data[11];
    var pContainerNumbers = data[12];
    var pEnCompanyName = data[13];
    var pClientEmail = data[14];
    var pRoadOrContainerNumber = data[15];
    var pClientName = data[16];
    var pOperationHeader = JSON.parse(data[17]);
    var pOperationContainersAndPackages = JSON.parse(data[18]);
    var pDeliveryOrderNumber = data[19];
    var pDeliveryDate = data[20];
    var pConsigneeAddressFromCustomers = data[21];

    //var pGrossWeightSum = data[15].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

    var pDescriptionOfGoods = "";
    $.each(pOperationContainersAndPackages, function (i, item) {
        pDescriptionOfGoods += (item.DescriptionOfGoods == 0 ? "" : (item.DescriptionOfGoods + " <br>"));
    });

    if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' RESERVATION LETTER ' + '</h3></div>';
        }
        else { //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + ' RESERVATION LETTER ' + '</h3></div> </br>';
        }

        //ReportHTML += '             <div class="col-xs-3 m-t-lg">' + '<b>' + pBranchName + ' IN :' + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-8 m-t-sm">' + getTodaysDateInddMMyyyyFormat() + '</div>';
        ////ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : فى  ' + pOperationHeader.BranchLocalName + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-lg" style="clear:both;">' + '<b>' + pBranchName + ' IN :' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-lg">' + getTodaysDateInddMMyyyyFormat() + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>OUR REF :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pOperationHeader.PONumber == 0 ? "NOT SPECIFIED" : pOperationHeader.PONumber) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>Messrs :</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pDefaults.UnEditableCompanyName == "EGL" ? (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) : pClientName) + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + pOperationHeader.LineName + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>VSL NAME :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pVesselName == "N/A" ? "" : pVesselName) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>ETA :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>B/L NO. :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>D/O NO. :</b>' + '</div>';
        //if (pOperationHeader.ShipmentType == constFCLShipmentType && pOperationHeader.BLType == constDirectBLType) //FCL Direct
        if (pOperationHeader.BLType == constDirectBLType)
            ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pDeliveryOrderNumber == 0 ? "" : pDeliveryOrderNumber) + '</div>';
        else
            ReportHTML += '             <div class="col-xs-8 m-t-sm">' + pOperationHeader.ID + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>D/O Date :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + pDeliveryDate + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>CONSIGNED TO :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pConsigneeName == 0 ? "" : pConsigneeName) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>Description :</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-6 m-t-sm">' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + pDescriptionOfGoods + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>Quantity :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.ContainerTypes) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-sm" style="clear:both;">' + '<b>WEIGHT :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm">' + (pOperationHeader.GrossWeightSum == 0 ? "" : pOperationHeader.GrossWeightSum + ' KGM') + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg" style="clear:both;">' + '<br><b>' + 'WE HEREBY DECLARE THAT A/M SHIPMENT HAD BEEN DISCHARGE AND RECEIVED IN BAD CONDITION AND STORAGE. THEREFORE WE ARE SORRY TO HOLD YOU COMPLETELY RESPONSIBLE FOR ALL DAMAGES OR SHORTAGE OCCURED AND KEEP ALL CONSIGNEE RIGHTS IN THIS CONCERN.' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t-lg " style="clear:both;">' + '<b>' + pEnCompanyName + '</b>' + '</div>';

        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
    else { //Other Companies

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) { //this means not fast freight //i removed all spaces
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center"><h3><b>' + '  خطاب تحفظ  ' + '</b></h3></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + ' RESERVATION LETTER ' + '</h3></div>';
        }
        else { //case printing on original company paper leave place for header
            ReportHTML += '             <div class="col-xs-12 text-center m-t-lg"></br></br><h3><b>' + '  خطاب تحفظ  ' + '</b></h3></div>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + ' RESERVATION LETTER ' + '</h3></div> </br>';
        }

        //ReportHTML += '             <div class="col-xs-3 m-t-lg">' + '<b>' + pBranchName + ' IN :' + '</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + getTodaysDateInddMMyyyyFormat() + '</div>';
        ////ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : فى  ' + pOperationHeader.BranchLocalName + '</b>' + '</div>';

        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        else if (pDefaults.UnEditableCompanyName == "SWI")
            ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

        ReportHTML += '             <div class="col-xs-4 m-t-lg">' + '<b>' + pBranchName + ' IN :' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-4 m-t-lg text-center">' + getTodaysDateInddMMyyyyFormat() + '</div>';
        ReportHTML += '             <div class="col-xs-4 m-t-lg text-right">' + '<b>' + ' : فى  ' + pOperationHeader.BranchLocalName + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>OUR REF :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.PONumber == 0 ? "NOT SPECIFIED" : pOperationHeader.PONumber) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : صادر رقم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>Messrs :</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pDefaults.UnEditableCompanyName == "EGL" ? (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) : pClientName) + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + pOperationHeader.LineName + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' / السادة  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>VSL NAME :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pVesselName == "N/A" ? "" : pVesselName) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : اسم الباخرة  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>ETA :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : تاريخ الوصول  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>B/L NO. :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : بوليصة رقم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>D/O NO. :</b>' + '</div>';
        //if (pOperationHeader.ShipmentType == constFCLShipmentType && pOperationHeader.BLType == constDirectBLType) //FCL Direct
        if (pOperationHeader.BLType == constDirectBLType)
            ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pDeliveryOrderNumber == 0 ? "" : pDeliveryOrderNumber) + '</div>';
        else
            ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + pOperationHeader.ID + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : رقم إذن التسليم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>D/O Date :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + pDeliveryDate + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : تاريخ إذن التسليم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-3 m-t-sm">' + '<b>CONSIGNED TO :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-sm text-center">' + (pConsigneeName == 0 ? "" : pConsigneeName) + '</div>';
        ReportHTML += '             <div class="col-xs-3 m-t-sm text-right">' + '<b>' + ' : باسم  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-3 m-t-sm">' + '<b>Description :</b>' + '</div>';
        //ReportHTML += '             <div class="col-xs-6 m-t-sm text-center">' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-sm text-center">' + pDescriptionOfGoods + '</div>';
        ReportHTML += '             <div class="col-xs-3 m-t-sm text-right">' + '<b>' + ' : الصنف  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm" style="clear:both;">' + '<b>Quantity :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.ContainerTypes) + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : العدد  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-2 m-t-sm">' + '<b>WEIGHT :</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-sm text-center">' + (pOperationHeader.GrossWeightSum == 0 ? "" : pOperationHeader.GrossWeightSum + ' KGM') + '</div>';
        ReportHTML += '             <div class="col-xs-2 m-t-sm text-right">' + '<b>' + ' : الوزن  ' + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-6 m-t-lg">' + '<b>' + 'WE HEREBY DECLARE THAT A/M SHIPMENT HAD' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-lg text-right">' + ' <b>' + '   نتشرف بإفادتكم أن الرسالة أعلاه قد فرغت وسلمت بحالة سيئة وعجز  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-6">' + '<b>' + 'BEEN DISCHARGE AND RECEIVED IN BAD' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 text-right">' + '<b>' + ' .  فى المشمول  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-6">' + '<b>' + 'CONDITION AND STORAGE.' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 text-right">' + ' <b>' + '  و نحن نأسف لتحميلكم المسئولية كاملة ونتحفظ لديكم بكافة حقوق  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-6">' + '<b>' + 'THEREFORE WE ARE SORRY TO HOLD YOU' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 text-right">' + ' <b>' + ' . صاحب الشأن عما يترتب عن أى تلف أو عجز  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12" style="clear:both;">' + '<b>' + 'COMPLETELY RESPONSIBLE FOR ALL' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-12">' + '<b>' + 'DAMAGES OR SHORTAGE OCCURED AND KEEP' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-12">' + '<b>' + "ALL CONSIGNEE'S RIGHTS IN THIS CONCERN" + '</b>' + '</div>';

        ReportHTML += '             <div class="col-xs-6 m-t-lg ">' + '<b>' + pEnCompanyName + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-lg text-right">' + '<b>' + pDefaults.CompanyLocalName + '</b>' + '</div>';

        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF Other Companies
}
//ExportOperationFile for NSL (OperationCover)
function DocsOut_Print_OperationCover_NSL(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pOperationCode = data[3];
    var pOpenDate = data[4];
    var pClientName = data[5];
    var pVolumeSum = data[6];
    var pSalesman = data[7];
    var pCommodityName = data[8];
    var pGrossWeightSum = data[9];
    var pPOLCodeAndName = data[10];
    var pPODCodeAndName = data[11];
    var pLineName = data[12];
    var pAgentName = data[13];
    var pIncotermName = data[14];
    var pActualArrival = data[15];
    var pActualDeparture = data[16];
    var pMasterBL = data[17];
    var pVesselName = data[18];
    //data[19] : objCvwProfitCurrencies.lstCVarvwProfitCurrencies
    var pHouseBLs = data[20]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pHouseClients = data[21];
    var pInvoices = data[22];
    var pContainerNumbers = data[23];
    var pClientEmail = data[24];
    var pContainerTypes = data[25];
    var pPackageTypes = data[26];
    var pShipmentType = data[27];
    var pProfitCurrenciesSubtotal = data[28];
    var pHouseNumber = data[29]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pRepBLTypeShown = data[30];
    var pMasterOperationCode = data[31];
    var pCCAName = data[32];
    var pTruckerName = data[33];
    var pPOLName = data[34];
    var pPODName = data[35];
    var pPayablesCurrenciesSubtotal = data[36];
    var pReceivablesOrInvoicesCurrenciesSubtotal = data[37];
    var pVGMSum = data[38];
    var pExpectedDeparture = data[39];
    var pExpectedArrival = data[40];
    var pVoyageOrTruckNumber = data[41];
    var pPOrC = data[42]; //Prepaid or Collect
    var pProfitInDefaultCurrency = data[43];
    var pPayablesInDefaultCurrency = data[44];
    var pReceivablesInDefaultCurrency = data[45];
    var pPickupAddress = data[46];
    var pDeliveryAddress = data[47];
    var pShipperName = data[48];
    var pBLDate = data[49];
    var pSupplierName = data[50];
    var pIsDelivered = data[51];
    var pIsTrucking = data[52];
    var pIsInsurance = data[53];
    var pIsClearance = data[54];
    var pIsGenset = data[55];
    var pTruckingOrderGateOutDate = data[56];
    var pTruckingOrderStuffingDate = data[57];
    var pTruckingOrderGateInDate = data[58];
    var pTruckingOrderDelays = data[59];
    var pTruckingOrderPowerFromGateInTillActualSailing = data[60];
    var pTruckingOrderTruckerName = data[61];
    var pTruckingOrderGensetSupplierName = data[62];
    var pIsCourrier = data[63];
    var pDummy = data[64]; //This was the pIsOBL field
    var pIsTelexRelease = data[65];
    var pETAPOLDate = data[66];
    var pATAPOLDate = data[67];

    var pConsigneeName = data[68];
    var pConsigneeContactName = data[69];
    var pConsigneePhones = data[70];
    var pConsigneeFax = data[71];
    var pConsigneeEmail = data[72];
    var pConsigneeAddressLine1 = data[73];
    var pConsigneeAddressLine2 = data[74];
    var pConsigneeCityName = data[75];
    var pConsigneeCountryName = data[76];
    var pClientAddressLine1 = data[77];
    var pClientAddressLine2 = data[78]
    var pClientCityName = data[79];
    var pClientCountryName = data[80];
    var pClientPhones = data[81];
    var pClientFax = data[82];
    var pShipperAddressLine1 = data[83];
    var pShipperAddressLine2 = data[84];
    var pShipperCityName = data[85];
    var pShipperCountryName = data[86];
    var pShipperPhones = data[87];
    var pShipperFax = data[88];
    var pShipperEmail = data[89];
    var pNotify1Name = data[90];
    var pNotify1ContactName = data[91];
    var pNotify1Phones = data[92];
    var pNotify1Fax = data[93];
    var pNotify1Email = data[94];
    var pNotify1AddressLine1 = data[95];
    var pNotify1AddressLine2 = data[96];
    var pNotify1CityName = data[97];
    var pNotify1CountryName = data[98];
    var pDescriptionOfGoods = data[99];
    var pRoadOrContainerNumber = data[100];
    var pNumberOfPackages = data[101];
    var pCustomerReference = data[102];
    var pEnCompanyName = data[103];
    var pAddressLine1 = data[104];
    var pAddressLine2 = data[105];
    var pAddressLine3 = data[106];
    var pAddressLine4 = data[107];
    var pAddressLine5 = data[108];
    var pPhones = data[109];
    var pFaxes = data[110];
    var pEmail = data[111];
    var pWebsite = data[112];
    var pAgentAddressLine1 = data[113];
    var pAgentAddressLine2 = data[114];
    var pAgentCityName = data[115];
    var pAgentCountryName = data[116];
    var pAgentPhones = data[117];
    var pAgentFax = data[118];
    var pMoveTypeName = data[119];
    var pOperationHeader = JSON.parse(data[120]);

    //var pMainRoute = JSON.parse(data[121]);
    //var pPayables = JSON.parse(data[122]);
    //var pReceivables = JSON.parse(data[123]);
    //var ProfitCurrencies_OpStatement = JSON.parse(data[125]);
    //var ProfitCurrencies_OpStatement_Invoice = JSON.parse(data[126]);
    //var vwHouses_OpStatement_CL = JSON.parse(data[127]);
    //var vwProfitCurrencies_OpStatement_OnlyMaster = JSON.parse(data[128]);

    var pCreditCurrenciesSubtotal = data[129];
    var pCreditInDefaultCurrency = data[130];
    var pDebitCurrenciesSubtotal = data[131];
    var pDebitInDefaultCurrency = data[132];

    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>


    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + 'EXPORT OPERATION FILE' + '</h3></div>';
    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
        ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
    else if (pDefaults.UnEditableCompanyName == "SWI")
        ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

    //ReportHTML += '             <div class="col-xs-12 text-right m-t-n"><b><u>JOB# :</u> </b>' + pOperationCode + '</div>';
    ReportHTML += '                         <table id="tblOperationPartners" class=" table table-striped b-light table-bordered" text-sm">'; //table-hover 
    ReportHTML += '                             <tbody>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>JOB NO</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pOperationCode + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>SHIPPER</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pShipperName + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>CARRIER</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pLineName + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=3><b>POL</b></td>';
    ReportHTML += '                                     <td colspan=3><b>POD</b></td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=3>' + pPOLCodeAndName + '</td>';
    ReportHTML += '                                     <td colspan=3>' + pPODCodeAndName + '</td>';
    ReportHTML += '                                 </tr>';
    if ($("#cbIsOcean").prop("checked")) {
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td colspan=3><b>Vessel</b></td>';
        ReportHTML += '                                     <td colspan=3><b>Voyage</b></td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td colspan=3>' + pVesselName + '</td>';
        ReportHTML += '                                     <td colspan=3>' + pVoyageOrTruckNumber + '</td>';
        ReportHTML += '                                 </tr>';
    }
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>ETA POL</b></td>';
    ReportHTML += '                                     <td colspan=2>' + (pETAPOLDate == '01/01/1900' ? 'N/A' : pETAPOLDate) + '</td>';
    ReportHTML += '                                     <td colspan=1><b>ETD POL</b></td>';
    ReportHTML += '                                     <td colspan=2>' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>Sailing Date</b></td>';
    ReportHTML += '                                     <td colspan=2>' + (pActualDeparture == '01/01/1900' ? 'N/A' : pActualDeparture) + '</td>';
    ReportHTML += '                                     <td colspan=1><b>ETA POD</b></td>';
    ReportHTML += '                                     <td colspan=2>' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival) + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>MBL #</b></td>';
    ReportHTML += '                                     <td colspan=2>' + pMasterBL + '</td>';
    ReportHTML += '                                     <td colspan=1>'/*+'<b>DATE</b>'*/ + '</td>';
    ReportHTML += '                                     <td colspan=2>' /*+ (pBLDate == '01/01/1900' ? 'N/A' : pBLDate)*/ + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>HBL #</b></td>';
    ReportHTML += '                                     <td colspan=2>' /*+ (pHouseBLs == 'N/A' ? pHouseNumber : pHouseBLs)*/ + '</td>';
    ReportHTML += '                                     <td colspan=1><b>DATE</b></td>';
    ReportHTML += '                                     <td colspan=2>' /*+ (pBLDate == '01/01/1900' ? 'N/A' : pBLDate)*/ + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>EQUIPMENT</b></td>';
    ReportHTML += '                                     <td colspan=2>' + (pContainerTypes == 'N/A' ? pPackageTypes : pContainerTypes) + '</td>';
    ReportHTML += '                                     <td colspan=1><b>COMMODITY</b></td>';
    ReportHTML += '                                     <td colspan=2>' + pCommodityName + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>SERVICE PROVIDED</b></td>';
    ReportHTML += '                                     <td colspan=4>' + (pMoveTypeName == 0 ? "" : pMoveTypeName) + '</td>';
    ReportHTML += '                                 </tr>';
    //ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    //ReportHTML += '                                     <td colspan=1 rowspan=4><b>SERVICE PROVIDED</b></td>';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsDelivered ? ' checked ' : '') + ' disabled="disabled">&nbsp;DELIVERED</label>' + '</td>';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsTrucking ? ' checked ' : '') + ' disabled="disabled">&nbsp;TRUCKING</label>' + '</td>';
    //ReportHTML += '                                 </tr>';
    //ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsInsurance ? ' checked ' : '') + ' disabled="disabled">&nbsp;INSURANCE</label>' + '</td>';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsClearance ? ' checked ' : '') + ' disabled="disabled">&nbsp;CLEARANCE</label>' + '</td>';
    //ReportHTML += '                                 </tr>';
    //ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsCourrier ? ' checked ' : '') + ' disabled="disabled">&nbsp;Courrier</label>' + '</td>';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsOBL ? ' checked ' : '') + ' disabled="disabled">&nbsp;OBL</label>' + '</td>';
    //ReportHTML += '                                 </tr>';
    //ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsGenset ? ' checked ' : '') + ' disabled="disabled">&nbsp;GENSET</label>' + ' : ' + pTruckingOrderGensetSupplierName + '</td>';
    //ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pIsTelexRelease ? ' checked ' : '') + ' disabled="disabled">&nbsp;Telex Release</label>' + '</td>';
    //ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>PAYMENT TERMS</b></td>';
    ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Prepaid</label>' + '</td>';
    ReportHTML += '                                     <td colspan=2>' + '<label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label>' + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>GATE OUT DATE</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pTruckingOrderGateOutDate + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>STUFFIFNG DATE</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pTruckingOrderStuffingDate + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>GATE IN DATE</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pTruckingOrderGateInDate + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>Trucker</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pTruckingOrderTruckerName + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=1><b>DELAYS</b></td>';
    ReportHTML += '                                     <td colspan=5>' + pTruckingOrderDelays + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=3><b>POWER FROM GATE IN TILL ACTUAL SAILING DATE</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pTruckingOrderPowerFromGateInTillActualSailing + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=6><b>Notes: </b><br>' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes.replace(/\n/g, "<br/>")) + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=6><b>TELEX sent to shipper by mail on &emsp;&emsp;&emsp;&emsp;/&emsp;&emsp;/&emsp;&emsp;&emsp; </b></td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';

    ReportHTML += '         </body>';

    ReportHTML += '     <footer class="footer col-xs-12 hide" style="width:100%; position:absolute; bottom:0;">';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_OperationCover_EEL(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pOperationCode = data[3];
    var pOpenDate = data[4];
    var pClientName = data[5];
    var pVolumeSum = data[6];
    var pSalesman = data[7];
    var pCommodityName = data[8];
    var pGrossWeightSum = data[9];
    var pPOLCodeAndName = data[10];
    var pPODCodeAndName = data[11];
    var pLineName = data[12];
    var pAgentName = data[13];
    var pIncotermName = data[14];
    var pActualArrival = data[15];
    var pActualDeparture = data[16];
    var pMasterBL = data[17];
    var pVesselName = data[18];
    //data[19] : objCvwProfitCurrencies.lstCVarvwProfitCurrencies
    var pHouseBLs = data[20]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pHouseClients = data[21];
    var pInvoices = data[22];
    var pContainerNumbers = data[23];
    var pClientEmail = data[24];
    var pContainerTypes = data[25];
    var pPackageTypes = data[26];
    var pShipmentType = data[27];
    var pProfitCurrenciesSubtotal = data[28];
    var pHouseNumber = data[29]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pRepBLTypeShown = data[30];
    var pMasterOperationCode = data[31];
    var pCCAName = data[32];
    var pTruckerName = data[33];
    var pPOLName = data[34];
    var pPODName = data[35];
    var pPayablesCurrenciesSubtotal = data[36];
    var pReceivablesOrInvoicesCurrenciesSubtotal = data[37];
    var pVGMSum = data[38];
    var pExpectedDeparture = data[39];
    var pExpectedArrival = data[40];
    var pVoyageOrTruckNumber = data[41];
    var pPOrC = data[42]; //Prepaid or Collect
    var pProfitInDefaultCurrency = data[43];
    var pPayablesInDefaultCurrency = data[44];
    var pReceivablesInDefaultCurrency = data[45];
    var pPickupAddress = data[46];
    var pDeliveryAddress = data[47];
    var pShipperName = data[48];
    var pBLDate = data[49];
    var pSupplierName = data[50];
    var pIsDelivered = data[51];
    var pIsTrucking = data[52];
    var pIsInsurance = data[53];
    var pIsClearance = data[54];
    var pIsGenset = data[55];
    var pTruckingOrderGateOutDate = data[56];
    var pTruckingOrderStuffingDate = data[57];
    var pTruckingOrderGateInDate = data[58];
    var pTruckingOrderDelays = data[59];
    var pTruckingOrderPowerFromGateInTillActualSailing = data[60];
    var pTruckingOrderTruckerName = data[61];
    var pTruckingOrderGensetSupplierName = data[62];
    var pIsCourrier = data[63];
    var pDummy = data[64]; //This was the pIsOBL field
    var pIsTelexRelease = data[65];
    var pETAPOLDate = data[66];
    var pATAPOLDate = data[67];

    var pConsigneeName = data[68];
    var pConsigneeContactName = data[69];
    var pConsigneePhones = data[70];
    var pConsigneeFax = data[71];
    var pConsigneeEmail = data[72];
    var pConsigneeAddressLine1 = data[73];
    var pConsigneeAddressLine2 = data[74];
    var pConsigneeCityName = data[75];
    var pConsigneeCountryName = data[76];
    var pClientAddressLine1 = data[77];
    var pClientAddressLine2 = data[78]
    var pClientCityName = data[79];
    var pClientCountryName = data[80];
    var pClientPhones = data[81];
    var pClientFax = data[82];
    var pShipperAddressLine1 = data[83];
    var pShipperAddressLine2 = data[84];
    var pShipperCityName = data[85];
    var pShipperCountryName = data[86];
    var pShipperPhones = data[87];
    var pShipperFax = data[88];
    var pShipperEmail = data[89];
    var pNotify1Name = data[90];
    var pNotify1ContactName = data[91];
    var pNotify1Phones = data[92];
    var pNotify1Fax = data[93];
    var pNotify1Email = data[94];
    var pNotify1AddressLine1 = data[95];
    var pNotify1AddressLine2 = data[96];
    var pNotify1CityName = data[97];
    var pNotify1CountryName = data[98];
    var pDescriptionOfGoods = data[99];
    var pRoadOrContainerNumber = data[100];
    var pNumberOfPackages = data[101];
    var pCustomerReference = data[102];
    var pEnCompanyName = data[103];
    var pAddressLine1 = data[104];
    var pAddressLine2 = data[105];
    var pAddressLine3 = data[106];
    var pAddressLine4 = data[107];
    var pAddressLine5 = data[108];
    var pPhones = data[109];
    var pFaxes = data[110];
    var pEmail = data[111];
    var pWebsite = data[112];
    var pAgentAddressLine1 = data[113];
    var pAgentAddressLine2 = data[114];
    var pAgentCityName = data[115];
    var pAgentCountryName = data[116];
    var pAgentPhones = data[117];
    var pAgentFax = data[118];
    var pMoveTypeName = data[119];
    var pOperationHeader = JSON.parse(data[120]);

    //var pMainRoute = JSON.parse(data[121]);
    //var pPayables = JSON.parse(data[122]);
    //var pReceivables = JSON.parse(data[123]);
    //var ProfitCurrencies_OpStatement = JSON.parse(data[125]);
    //var ProfitCurrencies_OpStatement_Invoice = JSON.parse(data[126]);
    //var vwHouses_OpStatement_CL = JSON.parse(data[127]);
    //var vwProfitCurrencies_OpStatement_OnlyMaster = JSON.parse(data[128]);

    var pCreditCurrenciesSubtotal = data[129];
    var pCreditInDefaultCurrency = data[130];
    var pDebitCurrenciesSubtotal = data[131];
    var pDebitInDefaultCurrency = data[132];

    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    //ReportHTML += '     <head><title>Pre Alert</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '     <head><title>Cover Sheet</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
    //ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' FREIGHT PRE-ALERT' + '</b></h3></div>';
    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><h3><b>' + GetTransportType(pOperationHeader.TransportType) + ' FREIGHT COVER SHEET' + '</b></h3></div>';

    ReportHTML += '             <div class="col-xs-8 m-t-xs">';

    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-4 m-t-n">';
    ReportHTML += '                 <table id="tblShipment" class="table table-striped b-light text-sm table-bordered"">';//style="border:solid #000 !Important;"
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
    ReportHTML += '                             <td style="text-align:center!Important;"><b>SHIPMENT</b><td style="text-align:center!Important;">' + pOperationHeader.Code + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:center!Important;"><b>CONSOL</b><td style="text-align:center!Important;">' + (pMasterBL == "N/A" ? pMasterOperationCode : pMasterBL) + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:center!Important;"><b>DATE</b><td style="text-align:center!Important;">' + getTodaysDateInddMMyyyyFormat() + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td><div class="col-xs-6 m-l-n" style="text-align:left!Important;"><b>SHIPMENT DETAILS</b></div><div class="col-xs-6 m-l" style="text-align:right!Important;"><b>PRINTED BY : ' + $("#hLoggedUserNameNotLogin").val() + '</b></div></td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>CONSIGNEE</b>';
    ReportHTML += '                                 <br>' + pConsigneeName;
    ReportHTML += '                                 <br>' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1);
    ReportHTML += '                                 <br>' + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2);
    ReportHTML += '                                 <br>' + (pConsigneeCityName == "" ? "" : pConsigneeCityName);
    ReportHTML += '                                 <br>' + (pConsigneeCountryName == "" ? "" : pConsigneeCountryName);
    ReportHTML += '                                 <br>TEL: ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' FAX: ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; vertical-align:top; width:50%;"><b>BILL TO</b>';
    ReportHTML += '                                 <br>' + pClientName;
    if (pClientCountryName != "") { //Address is entered for operation partner whose IsOperationClient is set to 1 
        ReportHTML += '                                 <br>' + (pClientAddressLine1 == "" ? "" : pClientAddressLine1);
        ReportHTML += '                                 <br>' + (pClientAddressLine2 == "" ? "" : pClientAddressLine2);
        ReportHTML += '                                 <br>' + (pClientCityName == "" ? "" : pClientCityName);
        ReportHTML += '                                 <br>' + (pClientCountryName == "" ? "" : pClientCountryName);
        ReportHTML += '                                 <br>TEL: ' + (pClientPhones == "" ? "N/A" : pClientPhones) + ' FAX: ' + (pClientFax == "" ? "N/A" : pClientFax);
    }
    else { //add the address in the general partner tab
        ReportHTML += '                                 <br>' + (pOperationHeader.ClientAddress == "0" ? "" : pOperationHeader.ClientAddress);
        ReportHTML += '                                 <br>' + (pOperationHeader.ClientPhonesAndFaxes == "0" ? "" : pOperationHeader.ClientPhonesAndFaxes);
    }
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td rowspan=2 style="text-align:left!Important; width:50%;"><b>SHIPPER</b>';
    ReportHTML += '                                 <br>' + pShipperName;
    ReportHTML += '                                 <br>' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1)
    ReportHTML += '                                 <br>' + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2)
    ReportHTML += '                                 <br>' + (pShipperCityName == "" ? "" : pShipperCityName)
    ReportHTML += '                                 <br>' + (pShipperCountryName == "" ? "" : pShipperCountryName)
    ReportHTML += '                                 <br>TEL: ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' FAX: ' + (pShipperFax == "" ? "N/A" : pShipperFax);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td  style="text-align:left!Important; width:50%;"><b>NOTIFY PARTY</b>';
    ReportHTML += '                                 <br>' + pNotify1Name;
    ReportHTML += '                                 <br>' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1);
    ReportHTML += '                                 <br>' + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2);
    ReportHTML += '                                 <br>' + (pNotify1CityName == "" ? "" : pNotify1CityName);
    ReportHTML += '                                 <br>' + (pNotify1CountryName == "" ? "" : pNotify1CountryName);
    ReportHTML += '                                 <br>TEL: ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' FAX: ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>HOUSE BILL OF LADING</b>';
    ReportHTML += '                                 <br>' + (pOperationHeader.HouseBLs == 0 ? pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber : pOperationHeader.HouseBLs);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Notes:</b>';
    ReportHTML += '                                 ' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>' + (pDefaults.UnEditableCompanyName == "SWI" ? 'SWIFT REFERENCE' : 'ORDER NUMBERS/REFERENCE') + '</b>';
    ReportHTML += '                                 <br>' + (pCustomerReference == "" ? '<br>' : pCustomerReference);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>PACKAGES</b>';
    ReportHTML += '                                 <br>' + (pNumberOfPackages == "0" ? "N/A" : pNumberOfPackages);
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>WEIGHT</b>';
    ReportHTML += '                                 <br>' + pGrossWeightSum.toFixed(2) + ' KGM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VOLUME</b>';
    ReportHTML += '                                 <br>' + pVolumeSum + ' CBM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:17%;"><b>VGM</b>';
    ReportHTML += '                                 <br>' + pVGMSum.toFixed(2) + ' KG';
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>GOODS COLLECTED FROM</b>';
    ReportHTML += '                                 <br>' + pPOLCodeAndName;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>ETD</b>';
    ReportHTML += '                                 <br>' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + ' KGM';
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:34%;"><b>GOODS DELIVERED TO</b>';
    ReportHTML += '                                 <br>' + pPODCodeAndName;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:16%;"><b>ETA</b>';
    ReportHTML += '                                 <br>' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival);
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><b>' + 'ROUTING INFORMATION' + '</b></div>';
    ReportHTML += '             <div class="col-xs-12">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Mode</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>' + ($("#cbIsOcean").prop("checked") ? 'Vessel/Voyage/IMO' : 'VOYAGE NUMBER') + '</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Carrier</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Load</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>Discharge</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>ETD</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important;"><b>ETA</b></td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important;">' + GetTransportType(pOperationHeader.TransportType) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + ($("#cbIsOcean").prop("checked") ? (pVesselName + '/' + pVoyageOrTruckNumber) : pVoyageOrTruckNumber) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pLineName + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pPOLCodeAndName + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + pPODCodeAndName + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important;">' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival) + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>';

    ReportHTML += '             <div class="col-xs-12 text-left m-t-n"><b>' + 'CONSOL DETAILS' + '</b></div>';
    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width:30%;"><b>' + ($("#cbIsOcean").prop("checked") ? 'OCEAN BILL OF LADING' : 'BILL OF LADING') + '</b>';
    ReportHTML += '                                 <br>' + pMasterBL;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:30%;"><b>' + (pDefaults.UnEditableCompanyName == "SWI" ? 'SWIFT REFERENCE' : 'CLIENT/BOOKING REFERENCE') + '</b>';
    ReportHTML += '                                 <br>' + pCustomerReference;
    ReportHTML += '                             </td>';
    ReportHTML += '                             <td style="text-align:left!Important; width:40%;"><b>CARRIER</b>';
    ReportHTML += '                                 <br>' + pLineName;
    ReportHTML += '                             </td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'

    ReportHTML += '             <div class="col-xs-12 m-t-n">';
    ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width=50%;"><b>' + ($("#cbIsOcean").prop("checked") ? 'Vessel/Voyage/IMO' : 'VOYAGE NUMBER') + '</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=12%;"><b>Load</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=13%;"><b>ETD</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=12%;"><b>Discharge</b></td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=13%;"><b>ETA</b></td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td style="text-align:left!Important; width=50%;">' + ($("#cbIsOcean").prop("checked") ? (pVesselName + '/' + pVoyageOrTruckNumber) : pVoyageOrTruckNumber) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=12%;">' + pPOLCodeAndName.split(':')[1] + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=13%;">' + (pExpectedDeparture == '01/01/1900' ? 'N/A' : pExpectedDeparture) + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=12%;">' + pPODCodeAndName.split(':')[1] + '</td>';
    ReportHTML += '                             <td style="text-align:left!Important; width=13%;">' + (pExpectedArrival == '01/01/1900' ? 'N/A' : pExpectedArrival) + '</td>';
    ReportHTML += '                         </tr>';
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>';

    if ($("#cbIsExport").prop("checked")) {
        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>EXPORT AGENT</b>';
        ReportHTML += '                                 <br>' + pEnCompanyName;
        ReportHTML += '                                 <br>' + (pAddressLine1 == "" ? "" : pAddressLine1);
        ReportHTML += '                                 <br>' + (pAddressLine2 == "" ? "" : pAddressLine2);
        ReportHTML += '                                 <br>' + (pAddressLine3 == "" ? "" : pAddressLine3);
        ReportHTML += '                                 <br>TEL: ' + (pPhones == "" ? "N/A" : pPhones) + ' FAX: ' + (pFaxes == "" ? "N/A" : pFaxes);
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>IMPORT AGENT</b>';
        ReportHTML += '                                 <br>' + pAgentName;
        ReportHTML += '                                 <br>' + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1);
        ReportHTML += '                                 <br>' + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2);
        ReportHTML += '                                 <br>' + (pAgentCityName == "" ? "" : pAgentCityName);
        ReportHTML += '                                 <br>' + (pAgentCountryName == "" ? "" : pAgentCountryName);
        ReportHTML += '                                 <br>TEL: ' + (pAgentPhones == "" ? "N/A" : pAgentPhones) + ' FAX: ' + (pAgentFax == "" ? "N/A" : pAgentFax);
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'
    }
    else {
        ReportHTML += '             <div class="col-xs-12 m-t-n">';
        ReportHTML += '                 <table class="table table-striped b-light text-sm table-bordered">';
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>EXPORT AGENT</b>';
        ReportHTML += '                                 <br>' + pAgentName;
        ReportHTML += '                                 <br>' + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1);
        ReportHTML += '                                 <br>' + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2);
        ReportHTML += '                                 <br>' + (pAgentCityName == "" ? "" : pAgentCityName);
        ReportHTML += '                                 <br>' + (pAgentCountryName == "" ? "" : pAgentCountryName);
        ReportHTML += '                                 <br>TEL: ' + (pAgentPhones == "" ? "N/A" : pAgentPhones) + ' FAX: ' + (pAgentFax == "" ? "N/A" : pAgentFax);
        ReportHTML += '                             </td>';
        ReportHTML += '                             <td style="text-align:left!Important; width:50%;"><b>IMPORT AGENT</b>';
        ReportHTML += '                                 <br>' + pEnCompanyName;
        ReportHTML += '                                 <br>' + (pAddressLine1 == "" ? "" : pAddressLine1);
        ReportHTML += '                                 <br>' + (pAddressLine2 == "" ? "" : pAddressLine2);
        ReportHTML += '                                 <br>' + (pAddressLine3 == "" ? "" : pAddressLine3);
        ReportHTML += '                                 <br>TEL: ' + (pPhones == "" ? "N/A" : pPhones) + ' FAX: ' + (pFaxes == "" ? "N/A" : pFaxes);
        ReportHTML += '                             </td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        ReportHTML += '             </div>'
    }

    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
    ReportHTML += '     </footer>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
//OperationCover, ExpectedProfit, OperationStatement Reports
//Very Important Note: If FastFreight asked to change in the OperationCover then this means in Code ExpectedProfit (stop using this note: NOT ANY MORE)
function DocsOut_Print_OperationCoverAndDetails(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pOperationCode = data[3];
    var pOpenDate = data[4];
    var pClientName = data[5];
    var pVolumeSum = data[6];
    var pSalesman = data[7];
    var pCommodityName = data[8];
    var pGrossWeightSum = data[9];
    var pPOLCodeAndName = data[10];
    var pPODCodeAndName = data[11];
    var pLineName = data[12];
    var pAgentName = data[13];
    var pIncotermName = data[14];
    var pActualArrival = data[15];
    var pActualDeparture = data[16];
    var pMasterBL = data[17];
    var pVesselName = data[18];
    var pProfitCurrencies = JSON.parse(data[19]); //data[19] : objCvwProfitCurrencies.lstCVarvwProfitCurrencies
    var pHouseBLs = data[20]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pHouseClients = data[21];
    var pInvoices = data[22];
    var pContainerNumbers = data[23];
    var pClientEmail = data[24];
    var pContainerTypes = data[25];
    var pPackageTypes = data[26];
    var pShipmentType = data[27];
    var pProfitCurrenciesSubtotal = data[28];
    var pHouseNumber = data[29]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pRepBLTypeShown = data[30];
    var pMasterOperationCode = data[31];
    var pCCAName = data[32];
    var pTruckerName = data[33];
    var pPOLName = data[34];
    var pPODName = data[35];
    var pPayablesCurrenciesSubtotal = data[36];
    var pReceivablesOrInvoicesCurrenciesSubtotal = data[37];
    var pVGMSum = data[38];
    var pExpectedDeparture = data[39];
    var pExpectedArrival = data[40];
    var pVoyageOrTruckNumber = data[41];
    var pPOrC = data[42]; //Prepaid or Collect
    var pProfitInDefaultCurrency = data[43];
    var pPayablesInDefaultCurrency = data[44];
    var pReceivablesInDefaultCurrency = data[45];
    var pPickupAddress = data[46];
    var pDeliveryAddress = data[47];
    var pShipperName = data[48];
    var pBLDate = data[49];
    var pSupplierName = data[50];
    var pIsDelivered = data[51];
    var pIsTrucking = data[52];
    var pIsInsurance = data[53];
    var pIsClearance = data[54];
    var pIsGenset = data[55];
    var pTruckingOrderGateOutDate = data[56];
    var pTruckingOrderStuffingDate = data[57];
    var pTruckingOrderGateInDate = data[58];
    var pTruckingOrderDelays = data[59];
    var pTruckingOrderPowerFromGateInTillActualSailing = data[60];
    var pTruckingOrderTruckerName = data[61];
    var pTruckingOrderGensetSupplierName = data[62];
    var pIsCourrier = data[63];
    var pDummy = data[64]; //This was the pIsOBL field
    var pIsTelexRelease = data[65];
    var pETAPOLDate = data[66];
    var pATAPOLDate = data[67];

    var pConsigneeName = data[68];
    var pConsigneeContactName = data[69];
    var pConsigneePhones = data[70];
    var pConsigneeFax = data[71];
    var pConsigneeEmail = data[72];
    var pConsigneeAddressLine1 = data[73];
    var pConsigneeAddressLine2 = data[74];
    var pConsigneeCityName = data[75];
    var pConsigneeCountryName = data[76];
    var pClientAddressLine1 = data[77];
    var pClientAddressLine2 = data[78]
    var pClientCityName = data[79];
    var pClientCountryName = data[80];
    var pClientPhones = data[81];
    var pClientFax = data[82];
    var pShipperAddressLine1 = data[83];
    var pShipperAddressLine2 = data[84];
    var pShipperCityName = data[85];
    var pShipperCountryName = data[86];
    var pShipperPhones = data[87];
    var pShipperFax = data[88];
    var pShipperEmail = data[89];
    var pNotify1Name = data[90];
    var pNotify1ContactName = data[91];
    var pNotify1Phones = data[92];
    var pNotify1Fax = data[93];
    var pNotify1Email = data[94];
    var pNotify1AddressLine1 = data[95];
    var pNotify1AddressLine2 = data[96];
    var pNotify1CityName = data[97];
    var pNotify1CountryName = data[98];
    var pDescriptionOfGoods = data[99];
    var pRoadOrContainerNumber = data[100];
    var pNumberOfPackages = data[101];
    var pCustomerReference = data[102];
    var pEnCompanyName = data[103];
    var pAddressLine1 = data[104];
    var pAddressLine2 = data[105];
    var pAddressLine3 = data[106];
    var pAddressLine4 = data[107];
    var pAddressLine5 = data[108];
    var pPhones = data[109];
    var pFaxes = data[110];
    var pEmail = data[111];
    var pWebsite = data[112];
    var pAgentAddressLine1 = data[113];
    var pAgentAddressLine2 = data[114];
    var pAgentCityName = data[115];
    var pAgentCountryName = data[116];
    var pAgentPhones = data[117];
    var pAgentFax = data[118];
    var pMoveTypeName = data[119];
    var pOperationHeader = JSON.parse(data[120]);

    var pMainRoute = JSON.parse(data[121]);
    var pPayables = JSON.parse(data[122]);
    var pReceivables = JSON.parse(data[123]);
    var ProfitCurrencies_OpStatement = JSON.parse(data[125]);
    var ProfitCurrencies_OpStatement_Invoice = JSON.parse(data[126]);
    var vwHouses_OpStatement_CL = JSON.parse(data[127]);
    var vwProfitCurrencies_OpStatement_OnlyMaster = JSON.parse(data[128]);

    var pCreditCurrenciesSubtotal = data[129];
    var pCreditInDefaultCurrency = data[130];
    var pDebitCurrenciesSubtotal = data[131];
    var pDebitInDefaultCurrency = data[132];
    debugger;

    // HS Code   >> Old >> pOperationHeader.BusinessUnit
    // new >> 3 Commodity Codes
    pOperationHeader.BusinessUnit = pOperationHeader.CommodityCode + " - " + pOperationHeader.CommodityCode2 + " - " + pOperationHeader.CommodityCode3;

    var _NotesOrCourierNo = (pMainRoute.Notes == 0 ? "" : pMainRoute.Notes);

    if (pDefaults.UnEditableCompanyName == "NIL") {

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        //ReportHTML += '             <div class="float-right m-t-n-lg">' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
        //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-n"><b>' + pBranchName + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
        ReportHTML += '                 <table id="tblReportOperationCover" class="table table-striped b-t b-dark text-sm  table-bordered">'; //table-hover //style="border:solid #000 !Important;"
        ReportHTML += '                     <tbody>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Created By :</b> ' + (pOperationHeader.CreatorName == 0 ? '' : pOperationHeader.CreatorName) + '</div><div class="col-xs-6"><b>Salesman :</b> ' + pOperationHeader.Salesman + '</div></td>';
        ReportHTML += '                         </tr>';
        //ReportHTML += '                       <tr class="" style="font-size:95%;">';
        //ReportHTML += '                             <td><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div><div class="col-xs-1"><b>' + GetTransportType(pOperationHeader.TransportType) + '</b></div><div class="col-xs-1"><b>' + GetDirectionType($("#hDirectionType").val()) + '</b></div><div class="col-xs-2"><b>' + pRepBLTypeShown + '</b></div></td>';
        //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + ' <b> / Open Date : </b>' + (pOpenDate == "01/01/1900" ? 'N/A' : pOpenDate) + '</div><div class="col-xs-6"><b>' + (pRepBLTypeShown == "DIRECT" ? pRepBLTypeShown + '</b>'
        //                                                                                                                                                    : (pRepBLTypeShown == "HOUSE" ? "Master Op. No.: </b>" + pMasterOperationCode
        //                                                                                                                                                    : "House Op.(s): </b>" + DocsOut_GetHouseOperationNumbersOnMaster())) + '</div></td>';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + ' <b> / Open Date : </b>' + (pOpenDate == "01/01/1900" ? 'N/A' : pOpenDate) + '</div><div class="col-xs-6"><b>' + (pRepBLTypeShown == "DIRECT" ? pRepBLTypeShown + '</b>'
            : (pRepBLTypeShown == "HOUSE" ? "Master Op. No.: </b>" + pMasterOperationCode
                : "&emsp;</b>")) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover")
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-12"><b>Client :</b> ' + pClientName + '</div></td>';
        else
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Client :</b> ' + pClientName + '</div><div class="col-xs-6"><b>Invoices :</b> ' + pInvoices + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Shipment Volume :</b> ' + (pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.ContainerTypes) + '</div><div class="col-xs-6"><b>Commodity :</b> ' + `${pCommodityName} - ${pOperationHeader.CommodityName2} - ${pOperationHeader.CommodityName3}` + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Packages :</b> ' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</div><div class="col-xs-3"><b>G.W. :</b> ' + pOperationHeader.GrossWeightSum + ' KGM' + '</div><div class="col-xs-3"><b>Volume :</b> ' + (pOperationHeader.Volume == 0 ? pOperationHeader.VolumeSum : pOperationHeader.Volume) + ' CBM' + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Port Of Load :</b> ' + pPOLName + "/" + pOperationHeader.POLCountryName + '</div><div class="col-xs-6"><b>Port Of Discharge :</b> ' + pPODName + "/" + pOperationHeader.PODCountryName + '</div></td>';
        ReportHTML += '                         </tr>';
        if (pPickupAddress != "" || pDeliveryAddress != "") {
            ReportHTML += '                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                         <td style="text-align:left!Important;"><div class="col-xs-6"><b>Pickup Address :</b> ' + pPickupAddress + '</div><div class="col-xs-6"><b>Delivery Address :</b> ' + pDeliveryAddress + '</div></td>';
            ReportHTML += '                     </tr>';
        }
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Carrier :</b> ' + pLineName + '</div>' + (pOperationHeader.TransportType != AirTransportType/*pOperationHeader.TransportType == OceanTransportType*/ ? ('<div class="col-xs-6"><b>Vessel :</b> ' + (pVesselName == 0 ? "" : pVesselName) + '</div>') : '') + '</td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'MBL No. :</b> ' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</div><div class="col-xs-6">' + ('<b>HBL :</b>' + (pRepBLTypeShown == "MASTER" ? pHouseBLs : (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber))) + '</div></td>';
        ReportHTML += '                         </tr>';
        //ReportHTML += '                         <tr class="" style="font-size:95%;">';
        //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Shipment Vol. :</b> ' + pVolumeSum + ' CBM</div><div class="col-xs-6"><b>Salesman :</b> ' + pSalesman + '</div></td>';
        //ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'MBL Consignee :</b> ' + (pOperationHeader.ConsigneeName == 0 ? '' : pOperationHeader.ConsigneeName) + '</div><div class="col-xs-6"><b>MBL Shipper :</b> ' + (pOperationHeader.ShipperName == 0 ? '' : pOperationHeader.ShipperName) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-12"><b>' + 'Trucker :</b> ' + (pTruckerName == "" ? "N/A" : pTruckerName) + '<b> - Clearance Agent :</b> ' + (pCCAName == "" ? "N/A" : pCCAName) + '<b> - Agent :</b> ' + pAgentName + '</div></td>';
        ReportHTML += '                         </tr>';
        if (pRepBLTypeShown == "MASTER") {
            //ReportHTML += '                         <tr class="" style="font-size:95%;">';
            //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-12"><b>House Clients :</b> ' + pHouseClients + '</div></td>';
            //ReportHTML += '                         </tr>';
        }
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Departure Date :</b> ' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? '' : pExpectedDeparture) + '</div><div class="col-xs-6"><b>Arrival Date :</b> ' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? '' : pExpectedArrival) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Container No :</b> ' + (pOperationHeader.ContainerNumbers == 0 ? '' : pOperationHeader.ContainerNumbers) + '</div><div class="col-xs-3"><b>PO Number :</b> ' + (pOperationHeader.PONumber == 0 ? '' : pOperationHeader.PONumber) + '</div><div class="col-xs-3"><b>PO Value :</b> ' + (pOperationHeader.POValue == 0 ? '' : pOperationHeader.POValue) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Service Scope :</b> ' + (pOperationHeader.MoveTypeName == 0 ? '' : pOperationHeader.MoveTypeName) + '</div><div class="col-xs-6"><b>Chrg.Wt. :</b> ' + (pOperationHeader.ChargeableWeight == 0 ? pOperationHeader.ChargeableWeightSum : pOperationHeader.ChargeableWeight) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Shipment Term :</b> ' + (pOperationHeader.IncotermName == 0 ? "" : pOperationHeader.IncotermName) + '</div><div class="col-xs-6"><b>' + 'Quotation :</b> ' + (pOperationHeader.QuotationCode == 0 ? "None" : pOperationHeader.QuotationCode) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Courier No :</b> ' + _NotesOrCourierNo + '</div><div class="col-xs-6"><b>' + 'Supplier Ref. :</b> ' + (pOperationHeader.SupplierReference == 0 ? "" : pOperationHeader.SupplierReference) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + ' PO Number :</b> ' + pOperationHeader.PONumber + '</div><div class="col-xs-6"><b>' + 'Supplier Ref. :</b> ' + (pOperationHeader.SupplierReference == 0 ? "" : pOperationHeader.SupplierReference) + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover")
            ReportHTML += '             <div class="m-t-n-xxs b-dark b-t b-r b-l b-b" style="width:100%;height:40%;"><span class="text-ul m-l-md"><b>Notes</b></span><br><p class="m-l-md">' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes.replace(/\n/g, "<br/>")) + '</p></div>';
        else { // ExpectedProfit AND OperationStatement
            ReportHTML += '                         <table id="tblProfitCurrencies" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Charge Type</th>';
            ReportHTML += '                                     <th>Est.Cost</th>';
            ReportHTML += '                                     <th>Payables</th>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit")
                ReportHTML += '                                 <th>Receivables</th>';
            else //OperationStatement
                ReportHTML += '                                 <th>Invoices</th>';
            ReportHTML += '                                     <th>Currency</th>';
            ReportHTML += '                                     <th>Profit/Currency</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            debugger;
            //$.each($("#tblPayables tr"), function (i, item) { debugger; });
            $.each(pProfitCurrencies, function (i, item) {
                ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                ReportHTML += '                                         <td>' + item.ChargeTypeName + '</td>';
                ReportHTML += '                                         <td>' + item.QuotationCost + '</td>';
                ReportHTML += '                                         <td>' + ($("#cbWithVAT").prop("checked") ? item.PayablesWithVAT : item.PayablesWithoutVAT) + '</td>';
                ReportHTML += '                                         <td>' + ($("#cbWithVAT").prop("checked") ? item.ReceivablesWithVAT : item.ReceivablesWithoutVAT) + '</td>';
                ReportHTML += '                                         <td>' + item.CurrencyCode + '</td>';
                ReportHTML += '                                         <td>' + ($("#cbWithVAT").prop("checked") ? (item.ReceivablesWithVAT - item.PayablesWithVAT).toFixed(2) : (item.ReceivablesWithoutVAT - item.PayablesWithoutVAT).toFixed(2)) + '</td>';
                ReportHTML += '                                     </tr>';
            });
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
            if (pProfitCurrenciesSubtotal != "") {
                ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"><b> Total Payables: ' + pPayablesCurrenciesSubtotal + " =(" + pPayablesInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"></br><b> Total Inv./Rec.: ' + pReceivablesOrInvoicesCurrenciesSubtotal + " =(" + pReceivablesInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"></br><b> Total Profit: ' + pProfitCurrenciesSubtotal + " =(" + pProfitInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
            }
        }
        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "NIL") {
    else //kk 23-12-2019
    {
        if ((pOperationHeader.ShipmentType == constConsolidationShipmentType || pOperationHeader.BLType == constHouseBLType)
            && pDefaults.UnEditableCompanyName != "KDS"
            && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationStatement") {

            /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
            //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
            ReportHTML += '<html>';
            ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
            ReportHTML += '         <body style="background-color:white;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
                ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="float-right m-t-n-lg">' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + ' House Bills</h3></div> </br>';
            //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
            ReportHTML += '             <div class="col-xs-12 m-t-n"><b>' + pBranchName + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
            if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
                ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
            else if (pDefaults.UnEditableCompanyName == "SWI" || pDefaults.UnEditableCompanyName == "ASL")
                ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

            //ReportHTML += '             <div> &nbsp; </div>'

            ReportHTML += '                         <table id="tblProfitCurrencies" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Operation Data</th>';
            ReportHTML += '                                     <th>AGENT</th>';
            ReportHTML += '                                     <th>POL</th>';
            ReportHTML += '                                     <th>POD</th>';
            ReportHTML += '                                     <th>VESSEL NAME</th>';
            ReportHTML += '                                     <th>Voyage</th>';
            ReportHTML += '                                     <th>Arrival Date</th>';
            ReportHTML += '                                     <th>Sailing Date</th>';
            ReportHTML += '                                     <th>Containers Size</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>' + pOperationHeader.CodeSerial + ' ( ' + (pOperationHeader.DirectionType == 1 ? "IMPORT" : "EXPORT") + ' ' + pOperationHeader.ShipmentTypeCode + ')</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.AgentName == 0 ? "" : pOperationHeader.AgentName) + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.PODName == 0 ? "" : pOperationHeader.PODName) + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : pOperationHeader.VoyageOrTruckNumber) + '</th>';
            ReportHTML += '                                     <th>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival)) : "") + '</th>';
            ReportHTML += '                                     <th>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualDeparture)) : "") + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.ContainerTypeCode == 0 ? "" : pOperationHeader.ContainerTypeCode) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody></table>';

            ReportHTML += '                         <table id="tblProfitCurrencies" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Client</th>';
            ReportHTML += '                                     <th>MB/L No.</th>';
            ReportHTML += '                                     <th>WEIGHT</th>';
            ReportHTML += '                                     <th>Volume</th>';
            ReportHTML += '                                     <th>Line</th>';
            ReportHTML += '                                     <th colspan="2">NO.OF.PKGS</th>';
            ReportHTML += '                                     <th colspan="2">Commodity</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</th>';
            ReportHTML += '                                     <th>' + pOperationHeader.GrossWeightSum + '</th>';
            ReportHTML += '                                     <th>' + pOperationHeader.VolumeSum + '</th>';
            ReportHTML += '                                     <th>' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</th>';
            ReportHTML += '                                     <th colspan="2">' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + '</th>';
            ReportHTML += '                                     <th colspan="2">' + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody></table>';
            debugger;

            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';

            //kk 
            ReportHTML += '                         <table id="tblHousesDetails" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>House Bill</th>';
            ReportHTML += '                                     <th>Client Name</th>';
            ReportHTML += '                                     <th>Weight</th>';
            ReportHTML += '                                     <th>Volume</th>';
            ReportHTML += '                                     <th>Packages</th>';
            ReportHTML += '                                     <th>FRT</th>';
            ReportHTML += '                                     <th>HB Income</th>';
            ReportHTML += '                                     <th>HB Outcome</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';



            debugger;

            // pPayables   pReceivables 
            var MBL_IncomeTotal = 0;
            var MBL_OutcomeTotal = 0;
            var TotalReceivables = 0;
            var TotalPayables = 0;//per house
            var TotalPayables_All = 0;
            var TotalReceivables_All = 0;
            var Counter_Houses = 0;
            $.each(ProfitCurrencies_OpStatement, function (i, item) {
                var Receivables = ($("#cbWithVAT").prop("checked") ? item.ReceivablesWithVAT : item.ReceivablesWithoutVAT)
                var Payables = ($("#cbWithVAT").prop("checked") ? item.PayablesWithVAT : item.PayablesWithoutVAT)
                if (item.BillID != 0) { //Calculate Payables & Receivables For house
                    if (i == 0) {
                        TotalReceivables += (Receivables * item.ExchangeRate);
                        TotalPayables += (Payables * item.ExchangeRate);
                        TotalPayables_All += (Payables * item.ExchangeRate);
                        TotalReceivables_All += (Receivables * item.ExchangeRate);
                    }
                    else {
                        var HB_Income = "";
                        var HB_Outcome = "";
                        debugger;
                        if (item.BillID != ProfitCurrencies_OpStatement[i - 1].BillID) {
                            debugger;
                            $.each(ProfitCurrencies_OpStatement_Invoice, function (cnt, obj) {
                                debugger;
                                if (obj.BillID != 0 && obj.BillID == (ProfitCurrencies_OpStatement[i - 1].BillID == 0 ? item.BillID : ProfitCurrencies_OpStatement[i - 1].BillID)) {
                                    HB_Income += ($("#cbWithVAT").prop("checked") ? (parseFloat(obj.InvoiceReceivableWithVAT) == 0 ? "" : obj.InvoiceReceivableWithVAT) : (parseFloat(obj.InvoiceReceivableWithoutVAT) == 0 ? "" : obj.InvoiceReceivableWithoutVAT)) + "</br>";
                                    HB_Outcome += ($("#cbWithVAT").prop("checked") ? (parseFloat(obj.InvoicePayableWithVAT) == 0 ? "" : obj.InvoicePayableWithVAT) : (parseFloat(obj.InvoicePayableWithoutVAT) == 0 ? "" : obj.InvoicePayableWithoutVAT)) + "</br>";
                                }
                            });

                            if (ProfitCurrencies_OpStatement[i - 1].BillID != 0) {
                                ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                                ReportHTML += '                                         <td>' + (ProfitCurrencies_OpStatement[i - 1].HouseNumber == 0 ? 'Not Specified' : ProfitCurrencies_OpStatement[i - 1].HouseNumber) + '</td>';
                                ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].ClientName == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].ClientName) + '</td>';
                                ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].GrossWeightSum == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].GrossWeightSum) + '</td>';
                                ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].VolumeSum == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].VolumeSum) + '</td>';
                                ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].NumberOfPackages == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].NumberOfPackages) + '</td>';
                                ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].POrC == 0 ? "" : (vwHouses_OpStatement_CL[Counter_Houses].POrC == 1 ? "C" : "P")) + '</td>';
                                ReportHTML += '                                         <td>' + HB_Income + " <b><u>HB/L Income : " + TotalReceivables + ' ' + $("#hDefaultCurrencyCode").val() + '</u></b></td>';
                                ReportHTML += '                                         <td>' + HB_Outcome + " <b><u>HB/L Outcome : " + TotalPayables + ' ' + $("#hDefaultCurrencyCode").val() + '</u></b></td>';
                                ReportHTML += '                                     </tr>';
                                Counter_Houses++;
                            }
                            TotalReceivables = 0;
                            TotalPayables = 0;
                            TotalReceivables += (Receivables * item.ExchangeRate);
                            TotalPayables += (Payables * item.ExchangeRate);
                            TotalPayables_All += (Payables * item.ExchangeRate);
                            TotalReceivables_All += (Receivables * item.ExchangeRate);
                        }
                        else {
                            TotalReceivables += (Receivables * item.ExchangeRate)
                            TotalPayables += (Payables * item.ExchangeRate);
                            TotalPayables_All += (Payables * item.ExchangeRate);
                            TotalReceivables_All += (Receivables * item.ExchangeRate);
                        }
                    }
                    if (i == (ProfitCurrencies_OpStatement.length - 1)) {
                        var HB_Income = "";
                        var HB_Outcome = "";
                        debugger;
                        $.each(ProfitCurrencies_OpStatement_Invoice, function (cnt, obj) {
                            if (obj.BillID != "0" && obj.BillID == item.BillID) {
                                HB_Income += ($("#cbWithVAT").prop("checked") ? (parseFloat(obj.InvoiceReceivableWithVAT) == 0 ? "" : obj.InvoiceReceivableWithVAT) : (parseFloat(obj.InvoiceReceivableWithoutVAT) == 0 ? "" : obj.InvoiceReceivableWithoutVAT)) + "</br>";
                                HB_Outcome += ($("#cbWithVAT").prop("checked") ? (parseFloat(obj.InvoicePayableWithVAT) == 0 ? "" : obj.InvoicePayableWithVAT) : (parseFloat(obj.InvoicePayableWithoutVAT) == 0 ? "" : obj.InvoicePayableWithoutVAT)) + "</br>";
                            }
                        });
                        if (item.BillID != 0 && vwHouses_OpStatement_CL[Counter_Houses] != undefined) {
                            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                            ReportHTML += '                                         <td>' + (item.HouseNumber == 0 ? "Not Specified" : item.HouseNumber) + '</td>';
                            ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].ClientName == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].ClientName) + '</td>';
                            ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].GrossWeightSum == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].GrossWeightSum) + '</td>';
                            ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].VolumeSum == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].VolumeSum) + '</td>';
                            ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].NumberOfPackages == 0 ? "" : vwHouses_OpStatement_CL[Counter_Houses].NumberOfPackages) + '</td>';
                            ReportHTML += '                                         <td>' + (vwHouses_OpStatement_CL[Counter_Houses].POrCCode == 0 ? "" : (vwHouses_OpStatement_CL[Counter_Houses].POrC == 1 ? "C" : "P")) + '</td>';
                            ReportHTML += '                                         <td>' + HB_Income + " <b><u>HB/L Income : " + TotalReceivables + ' ' + $("#hDefaultCurrencyCode").val() + '</u></b></td>';
                            ReportHTML += '                                         <td>' + HB_Outcome + " <b><u>HB/L Outcome : " + TotalPayables + ' ' + $("#hDefaultCurrencyCode").val() + '</u></b></td>';
                            ReportHTML += '                                     </tr>';
                            Counter_Houses++;
                        }
                    }
                } //EOF //Calculate Payables & Receivables For houses
                else { //Calculate Payables & Receivables For Master
                    MBL_IncomeTotal += (Receivables * item.ExchangeRate)
                    MBL_OutcomeTotal += (Payables * item.ExchangeRate);
                } //EOF //Calculate Payables & Receivables For Master
            });

            /******************************Master Row********************************/
            //if (pOperationHeader.ShipmentType == constConsolidationShipmentType) {
            //    var _MasterReceivablesCurrencies = "";
            //    var _MasterPayablesCurrencies = "";
            //    $.each(vwProfitCurrencies_OpStatement_OnlyMaster, function (cnt, obj) {
            //        debugger;
            //        _MasterReceivablesCurrencies += ($("#cbWithVAT").prop("checked") ? (parseFloat(obj.ReceivablesWithVAT) == 0 ? "" : obj.ReceivablesWithVAT) : (parseFloat(obj.ReceivablesWithoutVAT) == 0 ? "" : obj.ReceivablesWithoutVAT)) + "</br>";
            //        _MasterPayablesCurrencies += ($("#cbWithVAT").prop("checked") ? (parseFloat(obj.PayablesWithVAT) == 0 ? "" : obj.PayablesWithVAT) : (parseFloat(obj.PayablesWithoutVAT) == 0 ? "" : obj.PayablesWithoutVAT)) + "</br>";
            //    });
            //    ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            //    ReportHTML += '                                         <td>' + (pOperationHeader.MasterBL == 0 ? 'Master B/L' : pOperationHeader.MasterBL) + '</td>';
            //    ReportHTML += '                                         <td>' + pOperationHeader.ClientName + '</td>';
            //    ReportHTML += '                                         <td>' + ""/*pOperationHeader.GrossWeightSum*/ + '</td>';
            //    ReportHTML += '                                         <td>' + ""/*pOperationHeader.VolumeSum*/ + '</td>';
            //    ReportHTML += '                                         <td>' + ""/*pOperationHeader.NumberOfPackages*/ + '</td>';
            //    ReportHTML += '                                         <td>' + (pOperationHeader.POrC == 0 ? "" : (pOperationHeader.POrC == 1 ? "C" : "P")) + '</td>';
            //    ReportHTML += '                                         <td>' + _MasterReceivablesCurrencies + " <b><u>MBL Income : " + MBL_IncomeTotal + ' ' + $("#hDefaultCurrencyCode").val() + '</u></b></td>';
            //    ReportHTML += '                                         <td>' + _MasterPayablesCurrencies + " <b><u>MBL Outcome : " + MBL_OutcomeTotal + ' ' + $("#hDefaultCurrencyCode").val() + '</u></b></td>';
            //    ReportHTML += '                                     </tr>';
            //}
            /******************************EOF Master Row********************************/

            ReportHTML += '                             </tbody></table>';
            if (pOperationHeader.ShipmentType == constConsolidationShipmentType) { //not to print in houses oz numbers is not correct
                ReportHTML += '             <div class="row col-sx-12 m-l-sm"><div class="col-xs-3"><b>All HB/Ls Income Total</b></div><div class="col-xs-2 text-right">' + TotalReceivables_All + ' ' + $("#hDefaultCurrencyCode").val() + '</div>';
                ReportHTML += '             <div class="col-xs-3"><b>MB/L Income Total</b></div><div class="col-xs-2 text-right">' + MBL_IncomeTotal + ' ' + $("#hDefaultCurrencyCode").val() + '</div></div>';

                ReportHTML += '             <div class="row col-sx-12 m-l-sm"><div class="col-xs-3"><b>All HB/Ls Outcome Total</b></div><div class="col-xs-2 text-right">' + TotalPayables_All + ' ' + $("#hDefaultCurrencyCode").val() + '</div>';
                ReportHTML += '             <div class="col-xs-3"><b>MB/L Outcome Total</b></div><div class="col-xs-2 text-right">' + MBL_OutcomeTotal + ' ' + $("#hDefaultCurrencyCode").val() + '</div></div>';

                ReportHTML += '             <div class="row col-sx-12 m-t-md m-l-sm"><b class="m-r-md">Operation Profit </b>' + (TotalReceivables_All + MBL_IncomeTotal - TotalPayables_All - MBL_OutcomeTotal).toFixed(2) + ' ' + $("#hDefaultCurrencyCode").val() + '</div>';
            }
            ReportHTML += '         </body>';
            ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
            ReportHTML += '     </footer>';
            ReportHTML += '</html>';
            if (pOption == "Print" || pOption == undefined || pOption == null) {
                if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                    var mywindow = window.open('', '_blank');
                    mywindow.document.write(ReportHTML);
                    mywindow.document.close();
                }
            }
            else if (pOption == "Email") {
                DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
            }
        }
        else {

            /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
            //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
            ReportHTML += '<html>';
            ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
            ReportHTML += '         <body style="background-color:white;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
                ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //ReportHTML += '             <div class="float-right m-t-n-lg">' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
            //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
            //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
            ReportHTML += '             <div class="col-xs-12 m-t-n"><b>' + pBranchName + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
            if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
                ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
            else if (pDefaults.UnEditableCompanyName == "SWI" || pDefaults.UnEditableCompanyName == "ASL")
                ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

            //ReportHTML += '             <div> &nbsp; </div>'
            ReportHTML += '                 <table id="tblReportOperationCover" class="table table-striped b-t b-dark text-sm  table-bordered">'; //table-hover //style="border:solid #000 !Important;"
            ReportHTML += '                     <tbody>';
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Created By :</b> ' + (pOperationHeader.CreatorName == 0 ? '' : pOperationHeader.CreatorName) + (pOperationHeader.OperationManName != 0 ? ('<br>' + '<b>Operation Man :</b> ' + pOperationHeader.OperationManName) : "") + '</div><div class="col-xs-6"><b>Salesman :</b> ' + pOperationHeader.Salesman + '</div></td>';
            ReportHTML += '                         </tr>';
            //ReportHTML += '                       <tr class="" style="font-size:95%;">';
            //ReportHTML += '                             <td><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div><div class="col-xs-1"><b>' + GetTransportType(pOperationHeader.TransportType) + '</b></div><div class="col-xs-1"><b>' + GetDirectionType($("#hDirectionType").val()) + '</b></div><div class="col-xs-2"><b>' + pRepBLTypeShown + '</b></div></td>';
            //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + ' <b> / Open Date : </b>' + (pOpenDate == "01/01/1900" ? 'N/A' : pOpenDate) + '</div><div class="col-xs-6"><b>' + (pRepBLTypeShown == "DIRECT" ? pRepBLTypeShown + '</b>'
            //                                                                                                                                                    : (pRepBLTypeShown == "HOUSE" ? "Master Op. No.: </b>" + pMasterOperationCode
            //                                                                                                                                                    : "House Op.(s): </b>" + DocsOut_GetHouseOperationNumbersOnMaster())) + '</div></td>';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Oper. :</b> ' + (pOperationHeader.MasterOperationCode == 0 ? pOperationHeader.Code : pOperationHeader.MasterOperationCode) + (pDefaults.UnEditableCompanyName == "CFR" ? ("/" + pOperationHeader.RepTransportTypeShown + "/" + pOperationHeader.RepDirectionTypeShown) : "") + ' <b> / Open Date : </b>' + (pOpenDate == "01/01/1900" ? 'N/A' : pOpenDate) + '</div><div class="col-xs-6"><b>' + (pRepBLTypeShown == "DIRECT" ? pRepBLTypeShown + '</b>'
                : (pRepBLTypeShown == "HOUSE" ? "Master Op. No.: </b>" + pMasterOperationCode
                    : "&emsp;</b>")) + '</div></td>';
            ReportHTML += '                         </tr>';
            if (pDefaults.UnEditableCompanyName == "MEL") {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Quotation :</b> ' + (pOperationHeader.QuotationCode == 0 ? "N/A" : pOperationHeader.QuotationCode) + '</div><div class="col-xs-6"><b>Voyage :</b> ' + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : pOperationHeader.VoyageOrTruckNumber) + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            if (pDefaults.UnEditableCompanyName == "MED") {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>HS Code :</b> ' + (pOperationHeader.BusinessUnit == 0 ? "N/A" : pOperationHeader.BusinessUnit) + '</div><div class="col-xs-6"><b> </b> ' + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            if (pDefaults.UnEditableCompanyName == "BED") {
                ReportHTML += '                             <td style="text-align:left!Important;">';
                ReportHTML += '                                 <div class="col-xs-6">';
                ReportHTML += '                                     <b>Client :</b> ' + pClientName;
                ReportHTML += '                                     <br><b>Shipper :</b> ' + (pOperationHeader.ShipperName == 0 ? "" : pOperationHeader.ShipperName);
                ReportHTML += '                                     <br><b>Consignee :</b> ' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName);
                ReportHTML += '                                     <br><b>Agent :</b> ' + (pOperationHeader.AgentName == 0 ? "" : pOperationHeader.AgentName);
                ReportHTML += '                                 </div>';
                ReportHTML += '                                 <div class="col-xs-6">';
                ReportHTML += '                                     <b>Trucker :</b> ' + pTruckerName;
                ReportHTML += '                                     <br><b>Stuffing Date :</b> ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.StuffingDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.StuffingDate)) : "");
                ReportHTML += '                                     <br><b>Pickup Address :</b> ' + (pOperationHeader.PickupAddress == 0 ? "" : pOperationHeader.PickupAddress);
                ReportHTML += '                                     <br><b>GateInDate :</b> ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pTruckingOrderGateInDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pTruckingOrderGateInDate)) : "");
                ReportHTML += '                                 </div>';
                ReportHTML += '                             </td>';
            }
            else {
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Client :</b> ' + pClientName + '</div><div class="col-xs-6"><b>Invoices :</b> ' + pInvoices + '</div></td>';
            }
            ReportHTML += '                         </tr>';
            if (pDefaults.UnEditableCompanyName == "BAK") {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Shipper :</b> ' + (pOperationHeader.ShipperName == 0 ? "N/A" : pOperationHeader.ShipperName) + '</div><div class="col-xs-6 hide"><b>Label :</b> ' + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Cargo/Pkgs :</b> ' + (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + '</div><div class="col-xs-6"><b>Commodity :</b> ' + `${pCommodityName} - ${pOperationHeader.CommodityName2} - ${pOperationHeader.CommodityName3}` + '</div></td>';
            ReportHTML += '                         </tr>';
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Port Of Load :</b> ' + pPOLName + "/" + pOperationHeader.POLCountryName + '</div><div class="col-xs-6"><b>Port Of Discharge :</b> ' + pPODName + "/" + pOperationHeader.PODCountryName + '</div></td>';
            ReportHTML += '                         </tr>';
            if (pPickupAddress != "" || pDeliveryAddress != "") {
                ReportHTML += '                     <tr class="" style="font-size:95%;">';
                ReportHTML += '                         <td style="text-align:left!Important;"><div class="col-xs-6"><b>Pickup Address :</b> ' + pPickupAddress + '</div><div class="col-xs-6"><b>Delivery Address :</b> ' + pDeliveryAddress + '</div></td>';
                ReportHTML += '                     </tr>';
            }
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Line :</b> ' + pLineName + '</div>' + (pOperationHeader.TransportType == OceanTransportType ? ('<div class="col-xs-6"><b>Vessel :</b> ' + pVesselName + '</div>') : '') + '</td>';
            ReportHTML += '                         </tr>';
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'BL No. :</b> ' + pMasterBL + '</div><div class="col-xs-6">' + (pRepBLTypeShown == "DIRECT" ? '&nbsp;' : '<b>HBL :</b>' + (pRepBLTypeShown == "MASTER" ? pHouseBLs : /*House*/ pHouseNumber)) + '</div></td>';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'BL No. :</b> ' + pMasterBL + '</div><div class="col-xs-6">' + '<b>HBL :</b>' + (pRepBLTypeShown == "MASTER" ? pHouseBLs : /*House*/ pHouseNumber) + '</div></td>';
            ReportHTML += '                         </tr>';
            //ReportHTML += '                         <tr class="" style="font-size:95%;">';
            //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Shipment Vol. :</b> ' + pVolumeSum + ' CBM</div><div class="col-xs-6"><b>Salesman :</b> ' + pSalesman + '</div></td>';
            //ReportHTML += '                         </tr>';
            if (pDefaults.UnEditableCompanyName != "BED") {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Trucker :</b> ' + (pTruckerName == "" ? "N/A" : pTruckerName) + '<b> - Clearance Agent :</b> ' + (pCCAName == "" ? "N/A" : pCCAName) + '</div><div class="col-xs-6"><b>Agent :</b> ' + pAgentName + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            if (pRepBLTypeShown == "MASTER") {
                //ReportHTML += '                         <tr class="" style="font-size:95%;">';
                //ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-12"><b>House Clients :</b> ' + pHouseClients + '</div></td>';
                //ReportHTML += '                         </tr>';
            }
            //(Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualArrival)) < 1 ? "" : ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival)))
            if (pDefaults.UnEditableCompanyName == "MEL") {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Booking No :</b> ' + (pOperationHeader.BookingNumbers == 0 ? "N/A" : pOperationHeader.BookingNumbers) + '<b> - PO No :</b> ' + (pOperationHeader.PONumber == "" ? "N/A" : pOperationHeader.PONumber) + '</div><div class="col-xs-6"><b>' + 'ETA POL :</b> ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ETAPOLDate)) < 1 ? "N/A" : ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ETAPOLDate))) + '</b><b> - ETD POL :</b> ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) < 1 ? "N/A" : ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture))) + '</div></td>';
                ReportHTML += '                         </tr>';
            }

            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'ETD POL :</b> ' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? 'N/A' : pExpectedDeparture) + '</div><div class="col-xs-6"><b>Cutoff Date :</b> ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.CutOffDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.CutOffDate)) : "") + '</div></td>';
            ReportHTML += '                         </tr>';
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + 'Departure Date :</b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? 'N/A' : pActualDeparture) + '</div><div class="col-xs-6"><b>Arrival Date :</b> ' + (pActualArrival == "01/01/1900" || pActualArrival == "1/1/1900" ? 'N/A' : pActualArrival) + '</div></td>';
            ReportHTML += '                         </tr>';
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-12">' + (pDefaults.UnEditableCompanyName != "BED" ? ('<b>Certificate No :</b> ' + (pOperationHeader.CertificateNumber == 0 ? "N/A" : pOperationHeader.CertificateNumber)) : "") + '<b> - Packages :</b> ' + pOperationHeader.NumberOfPackages + 'x' + pOperationHeader.PackageTypeName + '<b> - GW :</b> ' + (pOperationHeader.GrossWeightSum + 'KG') + '<b> - CBM :</b> ' + pOperationHeader.Volume + ' CBM' + '</div></td>';
            ReportHTML += '                         </tr>';
            if (pDefaults.UnEditableCompanyName != "BED") {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + ' PO Number :</b> ' + pOperationHeader.PONumber + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            else {
                ReportHTML += '                         <tr>';
                ReportHTML += '                             <td style="text-align:left!Important;">';
                ReportHTML += '                                 <div class="col-xs-12">';
                ReportHTML += '                                     <b>Clearance Agent :</b> ' + (pOperationHeader.CustomsClearanceAgentName = 0 ? "" : pOperationHeader.CustomsClearanceAgentName);
                ReportHTML += '                                     <br><b>Custody :</b> ';//+ (pOperationHeader.ShipperName == 0 ? "" : pOperationHeader.ShipperName);
                ReportHTML += '                                     <br><b>Certificate No :</b> ' + (pOperationHeader.CertificateNumber == 0 ? "" : pOperationHeader.CertificateNumber);
                ReportHTML += '                                 </div>';
                ReportHTML += '                         </tr>';
            }
            if (pDefaults.UnEditableCompanyName == "CFR" || pDefaults.UnEditableCompanyName == "MED") //ahmed2022-12-28
            {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + ' ACID Number :</b> ' + (pOperationHeader.ACIDNumber == 0 ? "" : pOperationHeader.ACIDNumber) + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + ' C/D No :</b> ' + (pOperationHeader.SupplierReference == 0 ? "" : pOperationHeader.SupplierReference) + '</div></td>';
            ReportHTML += '                         </tr>';
            if (pDefaults.UnEditableCompanyName == "MED") //ahmed2022-12-28
            {
                ReportHTML += '                         <tr class="" style="font-size:95%;">';
                ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>' + ' WareHouse Location :</b> ' + (pOperationHeader.WareHouseLocation == 0 ? "" : pOperationHeader.WareHouseLocation) + '</div></td>';
                ReportHTML += '                         </tr>';
            }
            ReportHTML += '                     </tbody>';
            ReportHTML += '                 </table>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationStatement"
                || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit") {
                ReportHTML += '                         <table id="tblProfitCurrencies" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
                ReportHTML += '                             <thead>';
                ReportHTML += '                                 <tr>';
                ReportHTML += '                                     <th>Charge Type</th>';
                //ReportHTML += '                                     <th>Supplier</th>';
                ReportHTML += '                                     <th>Est.Cost</th>';
                ReportHTML += '                                     <th>Payables</th>';
                if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit")
                    ReportHTML += '                                 <th>Receivables</th>';
                else //OperationStatement
                    ReportHTML += '                                 <th>Invoices</th>';
                ReportHTML += '                                     <th>Currency</th>';
                ReportHTML += '                                     <th>Profit/Currency</th>';
                ReportHTML += '                                     <th>Debit/Credit</th>';
                ReportHTML += '                                 </tr>';
                ReportHTML += '                             </thead>';
                ReportHTML += '                             <tbody>';
                debugger;
                //$.each($("#tblPayables tr"), function (i, item) { debugger; });
                $.each(pProfitCurrencies, function (i, item) {
                    if (item.PayablesWithVAT != 0 || item.ReceivablesWithoutVAT != 0 || item.ReceivablesWithVAT != 0 || item.ReceivablesWithoutVAT != 0) {
                        ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                        ReportHTML += '                                         <td>' + item.ChargeTypeName + '</td>';
                        //ReportHTML += '                                         <td>' + (item.PartnerSupplierName == 0 ? "" : item.PartnerSupplierName) + '</td>';
                        ReportHTML += '                                         <td>' + item.QuotationCost + '</td>';
                        ReportHTML += '                                         <td>' + ($("#cbWithVAT").prop("checked") ? item.PayablesWithVAT : item.PayablesWithoutVAT) + '</td>';
                        ReportHTML += '                                         <td>' + ($("#cbWithVAT").prop("checked") ? item.ReceivablesWithVAT : item.ReceivablesWithoutVAT) + '</td>';
                        ReportHTML += '                                         <td>' + item.CurrencyCode + '</td>';
                        ReportHTML += '                                         <td>' + ($("#cbWithVAT").prop("checked") ? (item.ReceivablesWithVAT - item.PayablesWithVAT).toFixed(2) : (item.ReceivablesWithoutVAT - item.PayablesWithoutVAT).toFixed(2)) + '</td>';
                        ReportHTML += '                                         <td>' + item.AccNoteType + '</td>';
                        ReportHTML += '                                     </tr>';
                    }
                });
                ReportHTML += '                             </tbody>';
                ReportHTML += '                         </table>';
                if (pProfitCurrenciesSubtotal != "") {
                    ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"><b> Total Debit: ' + pDebitCurrenciesSubtotal + " =(" + pDebitInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                    ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"></br><b> Total Credit: ' + pCreditCurrenciesSubtotal + " =(" + pCreditInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                    ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"></br><b> Total Payables: ' + pPayablesCurrenciesSubtotal + " =(" + pPayablesInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                    ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"></br><b> Total Inv./Rec.: ' + pReceivablesOrInvoicesCurrenciesSubtotal + " =(" + pReceivablesInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                    ReportHTML += '                         <div class="col-xs-12 m-t-n text-right"></br><b> Total Profit: ' + pProfitCurrenciesSubtotal + " =(" + pProfitInDefaultCurrency + " " + $("#hDefaultCurrencyCode").val() + ")" + '</b></div>';
                }
            }
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationCover"
                || (pDefaults.UnEditableCompanyName == "BAK" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "OperationStatement")) {
                ReportHTML += '             <div class="m-t-n-xxs b-dark b-t b-r b-l b-b" style="width:100%;height:260px;"><span class="text-ul m-l-md"><b>Notes</b></span><br><p class="m-l-md">' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes.replace(/\n/g, "<br/>")) + '</p></div>';
                if (pDefaults.UnEditableCompanyName == "BED") {
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   اذن الشحن مختوم  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + ' فاتورة المصنع النهائية  ' + '  -   ' + '     موثقة    ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '     بيان عبوة المصنع النهائي    ' + '  -   ' + '      موثقة      ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   افراج جمركي نهائي  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   بوصلة  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '    فاتورة عميل     ' + '  -   ' + '   موثقة  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '     بيان عبوة عميل     ' + '  -   ' + '  موثقة  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '     شهادة منشأ    ' + '  -   ' + '  موثقة   ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   شهادة مصدر  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   بوليصة اصل مصدر  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   بوليصة اصل هاوس  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   تليكس ماستر  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   تليكس هاوس  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   صورة بوليصة بريد محلي  ' + '</label></div>'
                    ReportHTML += '             <div class="col-xs-4"><label><input type="checkbox" ' + (1 == 2 ? ' checked ' : '') + '>&nbsp;' + '   صورة بوليصة بريد دولي  ' + '</label></div>'
                }
            }
            if (pDefaults.UnEditableCompanyName == "MED") {
                ReportHTML += '                 <div class="" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
                ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + 'Export Executive' + '</b></div>';
                ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + 'Export Supervisor' + '</b></div>';
                ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + 'Export Manager' + '</b></div>';
                ReportHTML += '                 </div>'
            }
            if (pDefaults.UnEditableCompanyName == "BAK") {
                ReportHTML += '                 <div class="" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
                ReportHTML += '                     <div class="col-xs-4 text-center m-t"><b>' + "SIGNATURE" + '</b></div>';
                ReportHTML += '                     <div class="col-xs-4 text-center m-t"><b>' + "&emsp;" + '</b></div>';
                ReportHTML += '                     <div class="col-xs-4 text-center m-t"><b>' + "SIGNATURE" + '</b></div>';
                ReportHTML += '                 </div>'
            }

            if (pDefaults.UnEditableCompanyName == "LIO" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ExpectedProfit") {
                ReportHTML += '                 <div class="" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
                ReportHTML += '                     <div class="col-xs-4 text-center m-t"><b>' + "OPT.DEP." + '</b></div>';
                ReportHTML += '                     <div class="col-xs-4 text-center m-t"><b>' + "AUTHORIZED" + '</b></div>';
                ReportHTML += '                     <div class="col-xs-4 text-center m-t"><b>' + "ACCOUNT DPT." + '</b></div>';
                ReportHTML += '                 </div>'
            }
            ReportHTML += '         </body>';
            ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
            ReportHTML += '     </footer>';
            ReportHTML += '</html>';
            if (pOption == "Print" || pOption == undefined || pOption == null) {
                if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                    var mywindow = window.open('', '_blank');
                    mywindow.document.write(ReportHTML);
                    mywindow.document.close();
                }
            }
            else if (pOption == "Email") {
                DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
            }
        }
    }
}
function DocsOut_Print_OperationSummary(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pOperationCode = data[3];
    var pOpenDate = data[4];
    var pClientName = data[5];
    var pVolumeSum = data[6];
    var pSalesman = data[7];
    var pCommodityName = data[8];
    var pGrossWeightSum = data[9];
    var pPOLCodeAndName = data[10];
    var pPODCodeAndName = data[11];
    var pLineName = data[12];
    var pAgentName = data[13];
    var pIncotermName = data[14];
    var pActualDeparture = data[15];
    var pActualArrival = data[16]
    var pMasterBL = data[17];
    var pVesselName = data[18];
    //data[19] : objCvwProfitCurrencies.lstCVarvwProfitCurrencies
    var pHouseBLs = data[20]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pHouseClients = data[21];
    var pInvoices = data[22];
    var pContainerNumbers = data[23];
    var pClientEmail = data[24];
    var pContainerTypes = data[25];
    var pPackageTypes = data[26];
    var pShipmentType = data[27];
    var pProfitCurrenciesSubtotal = data[28];
    var pHouseNumber = data[29]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pRepBLTypeShown = data[30];
    var pMasterOperationCode = data[31];
    var pCCAName = data[32];
    var pTruckerName = data[33];
    var pPOLName = data[34];
    var pPODName = data[35];
    var pPayablesCurrenciesSubtotal = data[36];
    var pReceivablesOrInvoicesCurrenciesSubtotal = data[37];
    var pExpectedDeparture = data[38];
    var pActualDeparture = data[39];
    var pVoyageOrTruckNumber = data[40];
    var pPOrC = data[42]; //Prepaid or Collect
    var pProfitInDefaultCurrency = data[43];
    var pPayablesInDefaultCurrency = data[44];
    var pReceivablesInDefaultCurrency = data[45];
    var pPickupAddress = data[46];
    var pDeliveryAddress = data[47];
    var pShipperName = data[48];
    var pBLDate = data[49];
    var pSupplierName = data[50];
    var pIsDelivered = data[51];
    var pIsTrucking = data[52];
    var pIsInsurance = data[53];
    var pIsClearance = data[54];
    var pIsGenset = data[55];
    var pTruckingOrderGateOutDate = data[56];
    var pTruckingOrderStuffingDate = data[57];
    var pTruckingOrderGateInDate = data[58];
    var pTruckingOrderDelays = data[59];
    var pTruckingOrderPowerFromGateInTillActualSailing = data[60];
    var pTruckingOrderTruckerName = data[61];
    var pTruckingOrderGensetSupplierName = data[62];
    var pIsCourrier = data[63];
    var pDummy = data[64]; //This was the pIsOBL field
    var pIsTelexRelease = data[65];
    var pETAPOLDate = data[66];
    var pATAPOLDate = data[67];

    var pConsigneeName = data[68];
    var pConsigneeContactName = data[69];
    var pConsigneePhones = data[70];
    var pConsigneeFax = data[71];
    var pConsigneeEmail = data[72];
    var pConsigneeAddressLine1 = data[73];
    var pConsigneeAddressLine2 = data[74];
    var pConsigneeCityName = data[75];
    var pConsigneeCountryName = data[76];
    var pClientAddressLine1 = data[77];
    var pClientAddressLine2 = data[78]
    var pClientCityName = data[79];
    var pClientCountryName = data[80];
    var pClientPhones = data[81];
    var pClientFax = data[82];
    var pShipperAddressLine1 = data[83];
    var pShipperAddressLine2 = data[84];
    var pShipperCityName = data[85];
    var pShipperCountryName = data[86];
    var pShipperPhones = data[87];
    var pShipperFax = data[88];
    var pShipperEmail = data[89];
    var pNotify1Name = data[90];
    var pNotify1ContactName = data[91];
    var pNotify1Phones = data[92];
    var pNotify1Fax = data[93];
    var pNotify1Email = data[94];
    var pNotify1AddressLine1 = data[95];
    var pNotify1AddressLine2 = data[96];
    var pNotify1CityName = data[97];
    var pNotify1CountryName = data[98];
    var pDescriptionOfGoods = data[99];
    var pRoadOrContainerNumber = data[100];
    var pNumberOfPackages = data[101];
    var pCustomerReference = data[102];
    var pEnCompanyName = data[103];
    var pAddressLine1 = data[104];
    var pAddressLine2 = data[105];
    var pAddressLine3 = data[106];
    var pAddressLine4 = data[107];
    var pAddressLine5 = data[108];
    var pPhones = data[109];
    var pFaxes = data[110];
    var pEmail = data[111];
    var pWebsite = data[112];
    var pAgentAddressLine1 = data[113];
    var pAgentAddressLine2 = data[114];
    var pAgentCityName = data[115];
    var pAgentCountryName = data[116];
    var pAgentPhones = data[117];
    var pAgentFax = data[118];
    var pMoveTypeName = data[119];
    var pOperationHeader = JSON.parse(data[120]);

    //var pMainRoute = JSON.parse(data[121]);
    //var pPayables = JSON.parse(data[122]);
    //var pReceivables = JSON.parse(data[123]);
    //var ProfitCurrencies_OpStatement = JSON.parse(data[125]);
    //var ProfitCurrencies_OpStatement_Invoice = JSON.parse(data[126]);
    //var vwHouses_OpStatement_CL = JSON.parse(data[127]);
    //var vwProfitCurrencies_OpStatement_OnlyMaster = JSON.parse(data[128]);

    var pCreditCurrenciesSubtotal = data[129];
    var pCreditInDefaultCurrency = data[130];
    var pDebitCurrenciesSubtotal = data[131];
    var pDebitInDefaultCurrency = data[132];


    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    //ReportHTML += '             <div class="float-right m-t-n-lg">' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
        ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
    else if (pDefaults.UnEditableCompanyName == "SWI")
        ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

    //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
    //ReportHTML += '<div class="m-t-n-xxs" style="width:100%;height:20px;border:1px solid #000;">This is a rectangle!</div>';
    ReportHTML += '             <div class="col-xs-12 text-right"><label><input type="checkbox" ' + ($("#cbIsImport").prop("checked") ? ' checked ' : '') + ' disabled="disabled">&nbsp;IMP</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'
    ReportHTML += '                                           <label><input type="checkbox" ' + ($("#cbIsExport").prop("checked") ? ' checked ' : '') + ' disabled="disabled">&nbsp;EXP</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'
    ReportHTML += '                                           <label><input type="checkbox" ' + ($("#cbIsDomestic").prop("checked") ? ' checked ' : '') + ' disabled="disabled">&nbsp;DOM</label></div>'
    ReportHTML += '             <div class="col-xs-12 text-right"><b> JOB NO. : </b>' + pOperationCode + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-right"><b>' + pBranchName + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';

    ReportHTML += '             <div class="col-xs-12"><h5><b><u>SERVICE TYPE : ' + '' + '</u></b></h5></div>';
    ReportHTML += '             <div class="col-xs-12 m-l"><label><input type="checkbox" ' + ($("#cbIsOcean").prop("checked") ? ' checked ' : '') + ' disabled="disabled">&nbsp;SEA</label></div>'
    ReportHTML += '             <div class="col-xs-12 m-l"><label><input type="checkbox" ' + ($("#cbIsAir").prop("checked") ? ' checked ' : '') + ' disabled="disabled">&nbsp;AIR</label></div>'
    ReportHTML += '             <div class="col-xs-12 m-l"><label><input type="checkbox" ' + ($("#cbIsInland").prop("checked") ? ' checked ' : '') + ' disabled="disabled">&nbsp;INLAND</label></div>'

    ReportHTML += '             <div class="col-xs-12 text-center"><b> M/BL #: </b>' + (pMasterBL == "" ? 'N/A' : pMasterBL) + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> H/BL #: </b>' + (pRepBLTypeShown == "MASTER" ? (pHouseBLs == "" ? 'N/A' : pHouseBLs) : /*House*/ (pHouseNumber == "" ? 'N/A' : pHouseNumber)) + '</div>';
    //ReportHTML += '             <div class="col-xs-12 text-center"><b> BKG #: </b>' + '' + '</div>';

    var NoOfDifferentVolumeTypes = (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes.split('-').length : pPackageTypes.split('-').length)
    ReportHTML += '             <div class="col-xs-4 text-center"></div>';
    ReportHTML += '             <div class="col-xs-4 text-center">';
    ReportHTML += '                 <table id="tblReportOperationSummaryVolume" class="table table-striped b-t b-dark text-sm  table-bordered m-t" style="border:solid #000;">'; //table-hover //style="border:solid #000 !Important;"
    ReportHTML += '                     <tbody>';
    ReportHTML += '                         <tr class="" style="font-size:95%;">';
    ReportHTML += '                             <td ROWSPAN=' + NoOfDifferentVolumeTypes + '><b>Volume</b></td>';
    ReportHTML += '                             <td>' + (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes.split('-')[0] : pPackageTypes.split('-')[0]) + '</td>';
    ReportHTML += '                         </tr>';
    for (var i = 1; i < NoOfDifferentVolumeTypes; i++) {
        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td>' + (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes.split('-')[i] : pPackageTypes.split('-')[i]) + '</td>';
        ReportHTML += '                         </tr>';
    }
    ReportHTML += '                     </tbody>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>'; //of table
    ReportHTML += '             <div class="col-xs-4 text-center"></div>';
    ReportHTML += '             <div class="col-xs-12 text-center clear"><b> Client : </b>' + pClientName + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> Commodity : </b>' + `${pCommodityName} - ${pOperationHeader.CommodityName2} - ${pOperationHeader.CommodityName3}` + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> Carrier : </b>' + pLineName + '</div>';
    if ($("#cbIsOcean").prop("#checked")) {
        ReportHTML += '         <div class="col-xs-6 text-center"><b> Vessel : </b>' + pVesselName + '</div>';
        ReportHTML += '         <div class="col-xs-6 text-center"><b> Voy # : </b>' + pVoyageOrTruckNumber + '</div>';
    }
    //ReportHTML += '             <div class="col-xs-12 text-center clear"><b> Gate Out : </b>' + '' + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> POL : </b>' + pPOLCodeAndName + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> POD : </b>' + pPODCodeAndName + '</div>';
    if (pPickupAddress != "")
        ReportHTML += '         <div class="col-xs-12 text-center"><b> Pickup Address : </b>' + pPickupAddress + '</div>';
    if (pDeliveryAddress != "")
        ReportHTML += '         <div class="col-xs-12 text-center"><b> Delivery Address : </b>' + pDeliveryAddress + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> POD : </b>' + pPODCodeAndName + '</div>';
    //ReportHTML += '             <div class="col-xs-12 text-center"><b> Final Place : </b>' + pPODCodeAndName + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> ETA POL : </b>' + (pExpectedDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? 'N/A' : pExpectedDeparture) + '</div>';
    //ReportHTML += '             <div class="col-xs-12 text-center"><b> Cutoff : </b>' + (pExpectedDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? 'N/A' : pExpectedDeparture) + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> Sailing Date : </b>' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? 'N/A' : pActualDeparture) + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> Agent Name : </b>' + pAgentName + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b> Trucker (if any) : </b>' + pTruckerName + '</div>';
    //ReportHTML += '             <div class="col-xs-12 text-center"><b> Loading Date : </b>' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? 'N/A' : pActualDeparture) + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center"><b>Freight : </b><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Prepaid</label>&nbsp;&nbsp;&nbsp;&nbsp;'
    ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>'







    //ReportHTML += '                 <div class="m-t-n-xxs b-dark b-t b-r b-l b-b" style="width:100%;height:260px;"><span class="text-ul m-l-md"><b>Notes:</b></span></div>';
    ReportHTML += '             <div class="col-xs-12"><b><u>NOTES:</u></b> ' + (pOperationHeader.Notes == 0 ? "" : pOperationHeader.Notes) + '</div>';
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    ReportHTML += '     <div class="row m-t-lg text-muted small"> Reported By: ' + $("#sp-LoginName").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += ' <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ProofOfDelivery(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pOperationCode = data[3];
    var pOpenDate = data[4];
    var pClientName = data[5];
    var pVolumeSum = data[6];
    var pSalesman = data[7];
    var pCommodityName = data[8];
    var pGrossWeightSum = data[9];
    var pPOLCodeAndName = data[10];
    var pPODCodeAndName = data[11];
    var pLineName = data[12];
    var pAgentName = data[13];
    var pIncotermName = data[14];
    var pActualDeparture = data[15];
    var pActualArrival = data[16]
    var pMasterBL = data[17];
    var pVesselName = data[18];
    //data[19] : objCvwProfitCurrencies.lstCVarvwProfitCurrencies
    var pHouseBLs = data[20]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pHouseClients = data[21];
    var pInvoices = data[22];
    var pContainerNumbers = data[23];
    var pClientEmail = data[24];
    var pContainerTypes = data[25];
    var pPackageTypes = data[26];
    var pShipmentType = data[27];
    var pProfitCurrenciesSubtotal = data[28];
    var pHouseNumber = data[29]; //pHouseNumber :of the operation itself//pHouseBLs: in case of Master gets HBLs on it
    var pRepBLTypeShown = data[30];
    var pMasterOperationCode = data[31];
    var pCCAName = data[32];
    var pTruckerName = data[33];
    var pPOLName = data[34];
    var pPODName = data[35];
    var pPayablesCurrenciesSubtotal = data[36];
    var pReceivablesOrInvoicesCurrenciesSubtotal = data[37];
    var pExpectedDeparture = data[38];
    var pActualDeparture = data[39];
    var pVoyageOrTruckNumber = data[40];
    var pPOrC = data[42]; //Prepaid or Collect
    var pProfitInDefaultCurrency = data[43];
    var pPayablesInDefaultCurrency = data[44];
    var pReceivablesInDefaultCurrency = data[45];
    var pPickupAddress = data[46];
    var pDeliveryAddress = data[47];
    var pShipperName = data[48];
    var pBLDate = data[49];
    var pSupplierName = data[50];
    var pIsDelivered = data[51];
    var pIsTrucking = data[52];
    var pIsInsurance = data[53];
    var pIsClearance = data[54];
    var pIsGenset = data[55];
    var pTruckingOrderGateOutDate = data[56];
    var pTruckingOrderStuffingDate = data[57];
    var pTruckingOrderGateInDate = data[58];
    var pTruckingOrderDelays = data[59];
    var pTruckingOrderPowerFromGateInTillActualSailing = data[60];
    var pTruckingOrderTruckerName = data[61];
    var pTruckingOrderGensetSupplierName = data[62];
    var pIsCourrier = data[63];
    var pDummy = data[64]; //This was the pIsOBL field
    var pIsTelexRelease = data[65];
    var pETAPOLDate = data[66];
    var pATAPOLDate = data[67];

    var pConsigneeName = data[68];
    var pConsigneeContactName = data[69];
    var pConsigneePhones = data[70];
    var pConsigneeFax = data[71];
    var pConsigneeEmail = data[72];
    var pConsigneeAddressLine1 = data[73];
    var pConsigneeAddressLine2 = data[74];
    var pConsigneeCityName = data[75];
    var pConsigneeCountryName = data[76];
    var pClientAddressLine1 = data[77];
    var pClientAddressLine2 = data[78]
    var pClientCityName = data[79];
    var pClientCountryName = data[80];
    var pClientPhones = data[81];
    var pClientFax = data[82];
    var pShipperAddressLine1 = data[83];
    var pShipperAddressLine2 = data[84];
    var pShipperCityName = data[85];
    var pShipperCountryName = data[86];
    var pShipperPhones = data[87];
    var pShipperFax = data[88];
    var pShipperEmail = data[89];
    var pNotify1Name = data[90];
    var pNotify1ContactName = data[91];
    var pNotify1Phones = data[92];
    var pNotify1Fax = data[93];
    var pNotify1Email = data[94];
    var pNotify1AddressLine1 = data[95];
    var pNotify1AddressLine2 = data[96];
    var pNotify1CityName = data[97];
    var pNotify1CountryName = data[98];
    var pDescriptionOfGoods = data[99];
    var pRoadOrContainerNumber = data[100];
    var pNumberOfPackages = data[101];
    var pCustomerReference = data[102];
    var pEnCompanyName = data[103];
    var pAddressLine1 = data[104];
    var pAddressLine2 = data[105];
    var pAddressLine3 = data[106];
    var pAddressLine4 = data[107];
    var pAddressLine5 = data[108];
    var pPhones = data[109];
    var pFaxes = data[110];
    var pEmail = data[111];
    var pWebsite = data[112];
    var pAgentAddressLine1 = data[113];
    var pAgentAddressLine2 = data[114];
    var pAgentCityName = data[115];
    var pAgentCountryName = data[116];
    var pAgentPhones = data[117];
    var pAgentFax = data[118];
    var pMoveTypeName = data[119];
    var pOperationHeader = JSON.parse(data[120]);

    //var pMainRoute = JSON.parse(data[121]);
    //var pPayables = JSON.parse(data[122]);
    //var pReceivables = JSON.parse(data[123]);
    //var ProfitCurrencies_OpStatement = JSON.parse(data[125]);
    //var ProfitCurrencies_OpStatement_Invoice = JSON.parse(data[126]);
    //var vwHouses_OpStatement_CL = JSON.parse(data[127]);
    //var vwProfitCurrencies_OpStatement_OnlyMaster = JSON.parse(data[128]);

    var pCreditCurrenciesSubtotal = data[129];
    var pCreditInDefaultCurrency = data[130];
    var pDebitCurrenciesSubtotal = data[131];
    var pDebitInDefaultCurrency = data[132];

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    //ReportHTML += '             <div class="col-xs-12 m-l" style="width:95%; height:45%; border: 1px solid #000;border-radius: 25px;padding: 20px;">This is a rounded rectangle</div>';
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>Proof Of Deivery</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    //ReportHTML += '                 <div class="col-xs-12 text-center"><img src="/Content/Images/' + ($("#cbPrintHeaderInvoice").prop("checked") ? 'CompanyHeader-FRE-RIYADH.jpg' : 'CompanyHeader-Empty.jpg') + '" alt=""/></div>';
    ReportHTML += '                 <div class="col-xs-6"><img src="/Content/Images/' + (1 == 1 ? 'CompanyHeader-FRE-RIYADH.jpg' : 'CompanyHeader-Empty.jpg') + '" alt=""/></div>';
    ReportHTML += '                 <div class="col-xs-6">';
    ReportHTML += '                     <br><div class="col-xs-8"><b>POD Date : ' + '</b></div>' + '<div class="col-xs-4">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival)) : "") + '</div>';
    ReportHTML += '                 </div>';
    //ReportHTML += '                 <div class="col-xs-12 text-center m-t-n"><h3>Invoice (' + $("#tblInvoices" + pInvoiceTableSuffix + " #" + pID + " td.InvoiceNumber").text() + ')' + '</h3></div>';
    ReportHTML += '                 <div class="col-xs-12 text-center" style="clear:both;"><h3>' + 'PROOF OF DELIVERY' + '</h3></div>';

    //ReportHTML += '             <table class="col-xs-8 m-l b-t b-light text-sm table-bordered" style="text-align:left; width:auto; border:solid #000;">';
    ReportHTML += '             <div class="col-sm-5">';
    ReportHTML += '                 <table class="col-xs-5 b-light text-sm table-bordered" style="text-align:left;">';
    ReportHTML += '                     <td>';
    ReportHTML += '                         <b>Delivered To: </b><br>';
    ReportHTML += '                         <b>' + pOperationHeader.ClientName + '</b><br>';
    ReportHTML += '                         ' + (pOperationHeader.DeliveryAddress == "0" ? "" : (pOperationHeader.DeliveryAddress));
    //ReportHTML += '                         ' + (pClientStreetLine2 == "" ? "" : (", " + pClientStreetLine2 + '<br>'));
    //ReportHTML += '                         ' + (pClientCityName == "" ? "" : ("," + pClientCityName));
    //ReportHTML += '                         ' + (pClientCountryName == "" ? "" : ("," + pClientCountryName));
    ReportHTML += '                     </td>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-sm-4">';
    ReportHTML += '                 <b><i>&emsp;&emsp;&emsp;&emsp;References : </i></b><br>';
    ReportHTML += '                 <table class="col-xs-4 b-light text-sm table-bordered float-right" style="text-align:left;">';
    ReportHTML += '                     <td>';
    ReportHTML += '                         <b>' + 'Our Reference No. : ' + pOperationHeader.Code + '</b>';
    ReportHTML += '                         <br><b>' + (pDefaults.UnEditableCompanyName == "SWI" ? 'Swift Reference' : 'Client Reference') + ' : ' + (pOperationHeader.CustomerReference == 0 ? "" : pOperationHeader.CustomerReference) + '</b>';
    ReportHTML += '                     </td>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>';

    ReportHTML += '             <div class="m-l" style="clear:both;"><b>Gerneral Information</b>';
    ReportHTML += '                 <table class="col-xs-12 b-light text-sm table-bordered" style="text-align:left; width:98%;">';
    ReportHTML += '                     <td>';
    ReportHTML += '                         <div class="col-xs-6"><b>Shipper: </b>' + pShipperName + '</div>';
    ReportHTML += '                         <div class="col-xs-6"><b>POL: </b>' + pPOLName + '</div>';
    ReportHTML += '                         <div class="col-xs-6"><b>Consignee: </b>' + pConsigneeName + '</div>';
    ReportHTML += '                         <div class="col-xs-6"><b>POD: </b>' + pPODName + '</div>';
    ReportHTML += '                         <div class="col-xs-6"><b>Line: </b>' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</div>';
    ReportHTML += '                         <div class="col-xs-6"><b>DisCharge Port: </b>' + pPODName + '</div>';
    if (pOperationHeader.TransportType == OceanTransportType)
        ReportHTML += '                     <div class="col-xs-6"><b>Vessel-Voy: </b>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : (" - " + pOperationHeader.VoyageOrTruckNumber)) + '</div>';
    //if($("#cbPrintMBL").prop("checked"))
    ReportHTML += '                         <div class="col-xs-6"><b>' + (pOperationHeader.TransportType == AirTransportType ? "MAWB" : 'MB/L No.') + ': </b>' + pMasterBL + '</div>';
    if (pOperationHeader.HouseNumber != 0)
        ReportHTML += '                 <div class="col-xs-6"><b>HB/L No.:</b> ' + (pOperationHeader.HouseNumber == "" ? "N/A" : pOperationHeader.HouseNumber) + '</div>';
    //if ($("#cbPrintHBL").prop("checked")) {
    //    if (pHouseBLs != "0")//Master Operation so show all houses on it
    //        ReportHTML += '                 <div class="col-xs-6"><b>HBL</b>: ' + pHouseBLs + '</div>';
    //    else if (pHouseNumber != "0")
    //        ReportHTML += '                 <div class="col-xs-6"><b>HB/L No.:</b> ' + (pHouseNumber == "" ? "N/A" : pHouseNumber) + '</div>';
    //}
    ReportHTML += '                     <div class="col-xs-12 m-t"><b><u>Packages:</u></b>' + '</div>';
    ReportHTML += '                     <div class="col-xs-6"><b>Chargeable Wt.: </b>' + pOperationHeader.ChargeableWeightSum + ' KG</div>';
    ReportHTML += '                     <div class="col-xs-6"><b>Gross Wt.: </b>' + pOperationHeader.GrossWeightSum + ' KG</div>';
    ReportHTML += '                     <div class="col-xs-12"><b>Number Of Packages: </b>' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + '</div>';
    if (pOperationHeader.TransportType != 2)
        ReportHTML += '                     <div class="col-xs-12"><b>Containers No.s: </b>' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</div>';
    ReportHTML += '                     <div class="col-xs-12"><b>Description Of Goods: </b>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods) + '</div>';
    //ReportHTML += '                         <div class="col-xs-6"><b>Shipment Category: </b>' + pShipmentTypeCode + '</div>';

    ReportHTML += '                     </td>';
    ReportHTML += '                 </table>';
    ReportHTML += '             </div>';

    ReportHTML += '                     <div class="col-xs-12" style="clear:both;">';
    ReportHTML += '                         <table id="tblReportProofOfDelivery" class="m-t table table-striped b-t b-light text-sm table-bordered" style="">'; // table-hover
    ReportHTML += '                             <thead>';
    ReportHTML += '                                 <tr>';
    ReportHTML += '                                     <th colspan=2>Specific Delivery Packages</th>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                             </thead>';
    ReportHTML += '                             <tbody>';
    ReportHTML += '                                     <tr class="input-md" style="font-size:95%;">';
    ReportHTML += '                                         <td style="width:50%; text-align:left;">For Containers Cargo:<br>';
    ReportHTML += '                                             Container No. : ' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '<br>';
    ReportHTML += '                                             Weight : ' + pOperationHeader.GrossWeightSum + ' KG';
    ReportHTML += '                                         </td>';
    ReportHTML += '                                         <td style="width:50%; text-align:left;">For Break Bulk Cargo:<br>';
    ReportHTML += '                                             Package No. : <br>';
    ReportHTML += '                                             Weight : ' + pOperationHeader.GrossWeightSum + ' KG';
    ReportHTML += '                                         </td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';
    ReportHTML += '                     </div>'

    ReportHTML += '                         <div class="col-xs-12 m-t">We hereby confirm receipt of cargo in good order.</div>';

    ReportHTML += '                         <div class="col-xs-6">';
    ReportHTML += '                             <div style="height:130px;border:.5px solid #000;">';
    ReportHTML += '                                 &emsp;Received by: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Name: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Position & Mobile: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Date: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Place: ' + '' + '<br>';
    ReportHTML += '                             </div>';
    ReportHTML += '                         </div>';

    ReportHTML += '                         <div class="col-xs-6">';
    ReportHTML += '                             <div style="height:130px;border:.5px solid #000;">';
    ReportHTML += '                                 &emsp;Delivered by:' + '' + '<br>';
    ReportHTML += '                                 &emsp;Name of Driver: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Driver"s Phone: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Truck Number: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Date: ' + '' + '<br>';
    ReportHTML += '                                 &emsp;Place: ' + '' + '<br>';
    ReportHTML += '                             </div>';
    ReportHTML += '                         </div>';

    ReportHTML += '         </body>';

    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    //ReportHTML += '         <div class="col-xs-5 text-right">' + '<b>Issued by : </b>' + $("#hLoggedUserNameNotLogin").val() + ' / Freight World' + '</div>';

    if (pDefaults.UnEditableCompanyName == "FRE" || pDefaults.UnEditableCompanyName == "WAV") {
        ReportHTML += '         <div class="col-xs-12">' + '<hr style="border: solid 1px;">' + '</div>';
        ReportHTML += '         <div class="col-xs-12 m-t-n">' + 'Freight World' + '</div>';
        ReportHTML += '         <div class="col-xs-12">' + 'Next Building to Dar Al Kitab Printing Press, office No 6, First Floor,Omar Bin' + '</div>';
        ReportHTML += '         <div class="col-xs-12">' + 'Al-Khatab Street- POB 315826, Riyadh' + '</div>';
        ReportHTML += '         <div class="col-xs-12">' + 'Riyadh -KSA' + '</div>';
    }
    //if ($("#cbPrintFooterInvoice").prop("checked"))
    //ReportHTML += '         <div class="row text-center m-t"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    //ReportHTML += '         <div class="row text-right m-r m-t-sm">' + '  لاتعتبر الفاتورة مسددة إلا بايصال رسمى مختوم من الشركة  ' + '</div>';
    //ReportHTML += '         <div class="row text-right m-r">' + '  الاعتراض على اى بند من الفاتورة خلال 15 يوم من تاريخ استلام الفاتورة  ' + '</div>';
    ReportHTML += '     </footer>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_PaymentRequests(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pQuotationCode = data[2];  // (i.e Offer No.)
    //var objCvwPayables.lstCVarvwPayables = data[3];  
    var pPOLCodeAndName = data[4];
    var pPODCodeAndName = data[5];
    var pVolumeSum = data[6];
    var pLineName = data[7];
    var pExpectedDeparture = data[8];   //pExpectedDeparture.ToShortDateString()
    var pTransientTime = data[9];
    var pCommodity = data[10];
    var pSalesman = data[11];
    var pOperationCode = data[12];
    var pClientEmail = data[13];
    var pRecordsCount = data[14]; //number of payables //I read from table
    var pLineBankName = data[15];
    var pLineBankAccountNumber = data[16];
    var pPayablesSubTotals = JSON.parse(data[17]); //objCvwPayablesSubTotals.lstCVarvwPayablesSubTotals
    var pContainerTypes = data[18];
    var pPackageTypes = data[19];
    var pOperationHeader = JSON.parse(data[20]);
    var pMainRoute = JSON.parse(data[21]);
    var pMainRouteMaster = JSON.parse(data[22]);
    var pChargeTypeGroup = JSON.parse(data[23]);
    var pPayables = JSON.parse(data[24]);
    debugger;
    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA" || $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Operation Payables")
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
    else
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + ' / طلب دفع</h3></div> </br>';

    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
        ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
    else if (pDefaults.UnEditableCompanyName == "SWI")
        ReportHTML += '             <div class="col-xs-12"><b>Swift Ref. </b>' + (pOperationHeader.CustomerReference == 0 ? '' : pOperationHeader.Reference) + '</div>';

    ReportHTML += '             <div class="col-xs-12"><b>Date :</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
    ReportHTML += '             <div class="col-xs-4"><b>Oper.No. :</b> ' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '</div>';
    ReportHTML += '             <div class="col-xs-4"><b>Master B/L:</b> ' + (pOperationHeader.MasterBL == 0 ? "N/A" : pOperationHeader.MasterBL) + '</div>';
    ReportHTML += '             <div class="col-xs-4"><b>Offer No. :</b> ' + (pQuotationCode == 0 ? "N/A" : pQuotationCode) + '</div>';
    ReportHTML += '             <div class="col-xs-4"><b>From :</b> ' + (pDefaults.UnEditableCompanyName == "ELC" ? (pOperationHeader.OperationManName == 0 ? pLoggedUser.Name : pOperationHeader.OperationManName) : 'Operations') + '</div>';
    ReportHTML += '             <div class="col-xs-4"><b>To :</b> Accounting' + '</div>';
    ReportHTML += '             <div class="col-xs-4"><b>Opened By :</b> ' + pOperationHeader.CreatorName + '</div>';
    if (pDefaults.UnEditableCompanyName == "ELI")
        ReportHTML += '             <div class="col-xs-4"><b>Booking No :</b> ' + (pOperationHeader.BookingNumbers == 0 ? "" : pOperationHeader.BookingNumbers) + '</div>';
    ReportHTML += '             <div class="col-xs-12" style="clear:both;"><b>Client </b>' + pOperationHeader.ClientName + '</div>';
    if (pDefaults.UnEditableCompanyName == "WFE") {
        ReportHTML += '             <div class="col-xs-12" style="clear:both;"><b>Shipper </b>' + pOperationHeader.ShipperName + '</div>';
        ReportHTML += '             <div class="col-xs-12" style="clear:both;"><b>Consignee </b>' + pOperationHeader.ConsigneeName + '</div>';
    }
    //ReportHTML += '             <div class="col-xs-12"><b>Please pay to the order of Mr. </b></div>';
    ReportHTML += '             <div class="col-xs-9"><b>Description as follows : </b>'
        + (pContainerTypes == "N/A"
            ? (pPackageTypes == "N/A" ? "" : pPackageTypes)
            : pContainerTypes) + '</div>';
    if (pDefaults.UnEditableCompanyName == "ELC") {
        ReportHTML += '             <div class="col-xs-3 text-right"><b> (&emsp;&emsp;&emsp;&emsp;) نولون سيارة 1   ' + '<br>' + '  (&emsp;&emsp;&emsp;&emsp;) نولون سيارة 2  ' + '<br>' + '  (&emsp;&emsp;&emsp;&emsp;) نولون سيارة 3  ';
        ReportHTML += '             </b></div>';
    }
    ReportHTML += '             <div class="col-xs-6 m-l-lg" style="clear:both;"><label><input type="checkbox" ' + (pOperationHeader.POrC == 3 ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'
    ReportHTML += '                                           <label><input type="checkbox" ' + (pOperationHeader.POrC == 1 ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label>'
    ReportHTML += '             </div>'
    ////ReportHTML += '                 <section class="panel panel-default">';
    //ReportHTML += '                     <div class="table-responsive">';
    //ReportHTML += '                         <div> &nbsp; </div>'
    debugger;
    var pSelectedPayableIDs = GetAllSelectedIDsAsStringWithTableNameAndNameAttr('tblPayables', 'PrintPayable');
    var _BankName = "";
    var _BankAccountNumber = "";
    if (pDefaults.UnEditableCompanyName == "BED") { //Group for Bedaya
        ReportHTML += '                         <table id="tblReportPaymentRequest" style="clear:both;" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <th>Description</th>';
        ReportHTML += '                                     <th>Supplier</th>';
        ReportHTML += '                                     <th>Inv.No.</th>';
        ReportHTML += '                                     <th>Currency</th>';

        ReportHTML += '                                     <th>EstimateCost</th>';

        ReportHTML += '                                     <th>Act.Qty</th>';
        ReportHTML += '                                     <th>Act.UnitPrice</th>';

        ReportHTML += '                                     <th>Amt wo Tax</th>';
        ReportHTML += '                                     <th>Tax</th>';
        ReportHTML += '                                     <th>Deduction</th>';
        ReportHTML += '                                     <th>Amount</th>';
        ReportHTML += '                                     <th>DueDate</th>';

        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        let _CurrentChargeTypeGroupID = 0;
        let _CurrentPayableGroup = pPayables.filter(x => x.ChargeTypeGroupID == _CurrentChargeTypeGroupID);
        //charges without group
        $.each(_CurrentPayableGroup, function (i, item) {
            debugger;
            if (item.PartnerSupplierBankName != 0)
                _BankName = item.PartnerSupplierBankName;
            if (item.PartnerSupplierBankAccountNumber != 0)
                _BankAccountNumber = item.PartnerSupplierBankAccountNumber;
            if (i == 0) //1st item in the group of payable charge group
                ReportHTML += '                                     <tr style="font-size:95%;">' + "<th colspan=" + ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Operation Payables" ? 16 : 13) + ">Charge Category: " + "N/A" + "</th>" + '</tr>';
            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                                         <td>' + item.ChargeTypeName + '</td>';
            ReportHTML += '                                         <td>' + item.PartnerSupplierName + '</td>';
            ReportHTML += '                                         <td>' + item.SupplierInvoiceNo + '</td>';
            ReportHTML += '                                         <td class="CurrencyCode">' + item.CurrencyCode + '</td>';

            ReportHTML += '                                         <td class="Estimated">' + parseFloat(item.QuotationCost).toFixed(2) + '</td>';

            ReportHTML += '                                         <td>' + item.Quantity + '</td>';
            ReportHTML += '                                         <td>' + item.CostPrice.toFixed(2) + '</td>';
            ReportHTML += '                                         <td>' + parseFloat(item.AmountWithoutVAT).toFixed(2) + '</td>';
            ReportHTML += '                                         <td>' + parseFloat(item.TaxAmount).toFixed(2) + '</td>';
            ReportHTML += '                                         <td>' + parseFloat(item.DiscountAmount).toFixed(2) + '</td>';
            ReportHTML += '                                         <td>' + parseFloat(item.CostAmount).toFixed(2) + '</td>';
            ReportHTML += '                                         <td>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(item.EntryDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(item.EntryDate)) : "") + '</td>';

            ReportHTML += '                                     </tr>';
        });


        for (z = 0; z < pChargeTypeGroup.length; z++) {
            _CurrentChargeTypeGroupID = pChargeTypeGroup[z].ID;
            _CurrentPayableGroup = pPayables.filter(x => x.ChargeTypeGroupID == _CurrentChargeTypeGroupID);
            $.each(_CurrentPayableGroup, function (i, item) {
                debugger;
                if (item.PartnerSupplierBankName != 0)
                    _BankName = item.PartnerSupplierBankName;
                if (item.PartnerSupplierBankAccountNumber != 0)
                    _BankAccountNumber = item.PartnerSupplierBankAccountNumber;
                if (i == 0) //1st item in the group of payable charge group
                    ReportHTML += '                                     <tr style="font-size:95%;">' + "<th colspan=" + ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Operation Payables" ? 16 : 13) + ">Charge Category: " + item.ChargeTypeGroupName + "</th>" + '</tr>';
                ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                ReportHTML += '                                         <td>' + item.ChargeTypeName + '</td>';
                ReportHTML += '                                         <td>' + item.PartnerSupplierName + '</td>';
                ReportHTML += '                                         <td>' + item.SupplierInvoiceNo + '</td>';
                ReportHTML += '                                         <td class="CurrencyCode">' + item.CurrencyCode + '</td>';

                ReportHTML += '                                         <td class="Estimated">' + parseFloat(item.QuotationCost).toFixed(2) + '</td>';

                ReportHTML += '                                         <td>' + item.Quantity + '</td>';
                ReportHTML += '                                         <td>' + item.CostPrice.toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat(item.AmountWithoutVAT).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat(item.TaxAmount).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat(item.DiscountAmount).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat(item.CostAmount).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(item.EntryDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(item.EntryDate)) : "") + '</td>';

                ReportHTML += '                                     </tr>';

            });
        }
    }
    else { //Not Bedaya
        ReportHTML += '                         <table id="tblReportPaymentRequest" style="clear:both;" class="table table-striped b-t b-light text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <th>Description</th>';
        ReportHTML += '                                     <th>Supplier</th>';
        ReportHTML += '                                     <th>Inv.No.</th>';
        ReportHTML += '                                     <th>Currency</th>';
        if (pDefaults.UnEditableCompanyName == "ELC") {
            ReportHTML += '                                     <th>Quantity</th>';
            ReportHTML += '                                     <th>UnitPrice</th>';
        }
        ReportHTML += '                                     <th>Amt wo Tax</th>';
        ReportHTML += '                                     <th>Tax</th>';
        ReportHTML += '                                     <th>Deduction</th>';
        ReportHTML += '                                     <th>Amount</th>';
        ReportHTML += '                                     <th>DueDate</th>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Operation Payables") {
            ReportHTML += '                                     <th>Estimated</th>';
            ReportHTML += '                                     <th>Approved</th>';
            ReportHTML += '                                     <th>Pay.Status</th>';
        }
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        $.each($("#tblPayables tbody tr"), function (i, item) {
            debugger;
            if (
                ($(item).find("input[name=PrintPayable]").prop("checked") || pSelectedPayableIDs == "")
                && ($(item).find("td.PayableCostAmount").text() != 0)
                && ($(item).find("td.PayableOperation").attr("val") == $("#slDocsOutOperations").val() || $(item).find("td.PayableMasterOperation").attr("val") == $("#slDocsOutOperations").val()) //this condition is to handle getting the payables of master/house in case a house is selected in printing document
            ) {
                if ($(item).find("td.PartnerSupplierBankName").text() != 0)
                    _BankName = $(item).find("td.PartnerSupplierBankName").text();
                if ($(item).find("td.PartnerSupplierBankAccountNumber").text() != 0)
                    _BankAccountNumber = $(item).find("td.PartnerSupplierBankAccountNumber").text();
                ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                ReportHTML += '                                         <td>' + $(item).find("td.Payable").text() + '</td>';
                ReportHTML += '                                         <td>' + $(item).find("td.PayableSupplier").text() + '</td>';
                //ReportHTML += '                                         <td>' + $(item).find("td.PartnerSupplierBankName").text() + '</td>';
                //ReportHTML += '                                         <td>' + $(item).find("td.PartnerSupplierBankAccountNumber").text() + '</td>';
                ReportHTML += '                                         <td>' + $(item).find("td.PayableSupplierInvoiceNo").text() + '</td>';
                ReportHTML += '                                         <td class="CurrencyCode">' + $(item).find("td.PayableCurrency").text() + '</td>';
                if (pDefaults.UnEditableCompanyName == "ELC") {
                    ReportHTML += '                                         <td>' + $(item).find("td.PayableQuantity").text() + '</td>';
                    ReportHTML += '                                         <td>' + $(item).find("td.PayableCostPrice").text() + '</td>';
                }
                ReportHTML += '                                         <td>' + parseFloat($(item).find("td.PayableAmountWithoutVAT").text()).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat($(item).find("td.PayableTaxAmount").text()).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat($(item).find("td.PayableDiscountAmount").text()).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + parseFloat($(item).find("td.PayableCostAmount").text()).toFixed(2) + '</td>';
                ReportHTML += '                                         <td>' + $(item).find("td.PayableEntryDate").text() + '</td>';
                if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Operation Payables") {
                    ReportHTML += '                                         <td class="Estimated">' + parseFloat($(item).find("td.PayableQuotationCost").text()).toFixed(2) + '</td>';
                    ReportHTML += '                                         <td>' + ($(item).find("td.IsApproved").text() == "true" ? "Yes" : "No") + '</td>';
                    ReportHTML += '                                         <td>' + $(item).find("td.PayableStatus").text() + '</td>';
                }
                ReportHTML += '                                     </tr>';
            }
        });
    }
    //$.each(JSON.parse(data[3]), function (i, item) {
    //    debugger;
    //    ReportHTML += '                                     <tr class="" style="font-size:95%;">';
    //    ReportHTML += '                                         <td>' + item.ChargeTypeName + '</td>';
    //    ReportHTML += '                                         <td>' + item.CurrencyCode + '</td>';
    //    ReportHTML += '                                         <td>' + item.CostAmountSubTotal.toFixed(2) + '</td>';
    //    ReportHTML += '                                     </tr>';
    //});
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';

    if (pDefaults.UnEditableCompanyName == "BED") {
        for (var i = 0; i < pPayables.length; i++) //i concatenate the cost currency with the supplier name to group by and get totals
            pPayables[i].ChassisNumber = pPayables[i].CurrencyCode + " " + (pPayables[i].ChargeTypeGroupName == 0 ? "NoCategory" : pPayables[i].ChargeTypeGroupName); //Chassis here is used as Currency + ChargeGroup
        var _TotalCostPerCategory = CalculateSumOfArrayWithGroupBy(pPayables, "CostAmount", "ChassisNumber");
        ReportHTML += '<div class="col-xs-12 m-t-n text-right"><b>Category Totals: ' + _TotalCostPerCategory.replace(/ /g, "&nbsp;").replace(/,/g, "<br />") + '</b></div>';
    }
    var _SeparatedTotalsByGroup = CalculateSumOfArrayWithGroupBy(pPayables, "CostAmount", "SaleCurrencyCode");

    var pTotalSummary = DocsOut_PaymentRequests_CalculateSubtotals(pPayablesSubTotals);
    //ReportHTML += '                         <div class="col-xs-12 m-t-n"><b>' + $("#lblPayablesSubTotals").html() + '</b></div>';
    ReportHTML += '                         <div class="col-xs-12 text-right"><b>' + pTotalSummary + '</b></div>';
    //ReportHTML += '                     </div>'; //of table-responsive
    ////ReportHTML += '                 </section>';
    //ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
    ReportHTML += '             <div class="col-xs-6 m-t"><b>Bank Name :</b> ' + _BankName + '</div>';
    ReportHTML += '             <div class="col-xs-6 m-t"><b>Account No :</b> ' + _BankAccountNumber + '</div>';
    ReportHTML += '             <div class="col-xs-6"><b>P.O.L :</b> ' + pPOLCodeAndName + '</div>';
    ReportHTML += '             <div class="col-xs-6"><b>P.O.D :</b> ' + pPODCodeAndName + '</div>';
    if (pDefaults.UnEditableCompanyName == "ELI") {
        ReportHTML += '             <div class="col-xs-6"><b>Pickup Address :</b> ' + pOperationHeader.PickupAddress + '</div>';
        ReportHTML += '             <div class="col-xs-6"><b>Delivery Address :</b> ' + pOperationHeader.DeliveryAddress + '</div>';
    }

    ReportHTML += '             <div class="col-xs-6"><b>Commodity :</b> ' + (pCommodity == "" ? 'N/A' : pCommodity) + '</div>';
    ReportHTML += '             <div class="col-xs-6"><b>Volume :</b> ' + pVolumeSum + ' CBM</div>';
    ReportHTML += '             <div class="col-xs-6"><b>Line :</b> ' + (pLineName == "" ? 'N/A' : pLineName) + '</div>';
    ReportHTML += '             <div class="col-xs-6"><b>ETS :</b> ' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? 'N/A' : pExpectedDeparture) + '</div>';
    //ReportHTML += '             <div class="col-xs-6"><b>T/T :</b> ' + (pTransientTime == 0 ? 'N/A' : pTransientTime + ' Days') + '</div>';
    ReportHTML += '             <div class="col-xs-6"><b>T/T :</b> ' + (pMainRouteMaster == undefined ? (pMainRoute.TransientTime == 0 ? "N/A" : (pMainRoute.TransientTime + ' Days')) : (pMainRouteMaster.TransientTime == 0 ? "N/A" : (pMainRouteMaster.TransientTime + ' Days'))) + '</div>';
    ReportHTML += '             <div class="col-xs-6"><b>Salesman :</b> ' + pSalesman + '</b></div>';
    ReportHTML += '             <div class="col-xs-12"><b>Customer Service :</b> ' + (pOperationHeader.CreatorName == 0 ? '' : pOperationHeader.CreatorName) + '</div>';
    ReportHTML += '             <div class="col-xs-12"><b>Approval :</b> ' + '' + '</div>';
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if (pDefaults.UnEditableCompanyName == "ELC") {
        ReportHTML += '                 <div class="" style="clear:both;">';
        ReportHTML += '                     <div class="col-xs-3 m-t text-center"><b>' + '   المدير العام   ' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 m-t text-center"><b>' + '   المدير المالي   ' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 m-t text-center"><b>' + '   أمين خزينة   ' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 m-t text-center"><b>' + '   تصفية السيد   ' + '</b></div>';
        ReportHTML += '                 </div>'
        ReportHTML += '                 <div class="" style="clear:both;">';
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + "&emsp;<br>" + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + "&emsp;<br>" + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + "&emsp;<br>" + '</b></div>';
        ReportHTML += '                     <div class="col-xs-3 text-center"><b>' + "&emsp;<br>" + '</b></div>';
        ReportHTML += '                 </div>'
    }
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ShippingAndPreShippingDeclaration(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    //data[32] : objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62]; //POD
    var pVolumeSum = data[63];
    var pExpectedDeparture = data[64];  //POL
    var pETAPOLDate = data[65];
    var pMasterOperationCode = data[66];
    var pCommodityName = data[67];
    var pAgreedRate = data[68];
    var pOperationHeader = JSON.parse(data[69]);

    var pNotify2Name = data[70];
    var pNotify2ContactName = data[71];
    var pNotify2Phones = data[72];
    var pNotify2Fax = data[73];
    var pNotify2Email = data[74];
    var pNotify2AddressLine1 = data[75];
    var pNotify2AddressLine2 = data[76];
    var pNotify2CityName = data[77];
    var pNotify2CountryName = data[78];
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>

    if (pDefaults.UnEditableCompanyName == "NIL") {

        var ReportHTML = '';
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        //ReportHTML += '             <div class="col-xs-6 m-t-n"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6 m-t-n"><b>Operation No. :</b> ' + pOperationCode + '</div>';

        {
            ReportHTML += '                         <table id="tblShippingDeclaration" class="m-t-n table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Company Name</th>';
            ReportHTML += '                                     <th colspan=3>' + pEnCompanyName + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Your Name</th>';
            ReportHTML += '                                     <th colspan=3>' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Telephone / Fax No.</th>';
            ReportHTML += '                                     <th colspan=3>' + (pPhones == 0 ? "" : pPhones) + ' / ' + (pFaxes == 0 ? "" : pFaxes) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Email Address</th>';
            ReportHTML += '                                     <th colspan=3>' + (pEmail == 0 ? "" : pEmail) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Name & Address of Shipper</th>';
            ReportHTML += '                                     <th colspan=3>' + pShipperName
                + ((pShipperPhones.trim() == "" && pShipperFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pShipperPhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pShipperPhones)) + (pShipperFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pShipperFax)) + '</div>'))
                + ((pShipperAddressLine1.trim() == "" && pShipperAddressLine2.trim() == "" && pShipperCityName.trim() == "" && pShipperCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1.trim() == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2.trim() == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName.trim() == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>'))
                + '</th>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Name & Address of Consignee</th>';
            ReportHTML += '                                     <th colspan=3>' + pConsigneeName
                + ((pConsigneePhones.trim() == "" && pConsigneeFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pConsigneePhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pConsigneePhones)) + (pConsigneeFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pConsigneeFax)) + '</div>'))
                + ((pConsigneeAddressLine1.trim() == "" && pConsigneeAddressLine2.trim() == "" && pConsigneeCityName.trim() == "" && pConsigneeCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1.trim() == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2.trim() == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName.trim() == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>'))
                + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>P.O.L.</th>';
            ReportHTML += '                                     <th colspan=3>' + pOperationHeader.POLName + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>P.O.D.</th>';
            ReportHTML += '                                     <th colspan=3>' + pOperationHeader.PODName + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Earliest date of departure</th>';
            ReportHTML += '                                     <th colspan=3>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</th>';
            ReportHTML += '                                 </tr>';
            if (pOperationHeader.TransportType == OceanTransportType) {
                ReportHTML += '                                 <tr>';
                ReportHTML += '                                     <th>Vessel Name / Voy. No.</th>';
                ReportHTML += '                                     <th colspan=3>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : (" / " + pOperationHeader.VoyageOrTruckNumber)) + '</th>';
                ReportHTML += '                                 </tr>';
            }
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Number of cartons</th>';
            ReportHTML += '                                     <th colspan=3>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Commodity</th>';
            ReportHTML += '                                     <th colspan=3>' + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Container Types</th>';
            ReportHTML += '                                     <th colspan=3>' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Container Numbers</th>';
            ReportHTML += '                                     <th colspan=3>' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Cargo Weight</th>';
            ReportHTML += '                                     <th colspan=3>' + 'G.W. : ' + pOperationHeader.GrossWeightSum + ' KGM' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Dangerous Cargo (Y/N)</th>';
            ReportHTML += '                                     <th style="text-align:right;">Please mark (√) on the appropriate column</th>';
            ReportHTML += '                                     <th>' + 'Yes <input type="checkbox" />' + '</th>';
            ReportHTML += '                                     <th>' + 'No <input type="checkbox" />' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Out of Gauge - Dimension</th>';
            ReportHTML += '                                     <th colspan=3>' + '' + '</th>';
            ReportHTML += '                                 </tr>';

            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th rowspan=5>Prepaid / Collect [Please mark (√) on the appropriate column]</th>';
            ReportHTML += '                                     <th>' + 'Item' + '</th>';
            ReportHTML += '                                     <th>' + 'Prepaid' + '</th>';
            ReportHTML += '                                     <th>' + 'Collect' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td>' + 'Origin Doc Fee' + '</td>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td>' + 'Origin THC' + '</td>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td>' + 'Basic Freight' + '</td>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td>' + 'Destination Surcharge' + '</td>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                     <th>' + '<input type="checkbox" />' + '</th>';
            ReportHTML += '                                 </tr>';


            //ReportHTML += '                                 <tr>';
            //ReportHTML += '                                     <th>Gate Out Date(Reefer)</th>';
            //ReportHTML += '                                     <th colspan=3>' + '' + '</th>';
            //ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Other remarks/Requirement of shipment</th>';
            ReportHTML += '                                     <th colspan=3>' + 'NEED FREE TIME 12 DAYS' + '</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
            //ReportHTML += '                         <div> &nbsp; </div>'
        }
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                         </div>';
        //ReportHTML += '                     </div>'; //of table-responsive
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        //ReportHTML += '             <div class="col-xs-8 m-l m-t-n"><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
        //ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>';
        //ReportHTML += '             <div class="col-xs-4 m-t-n float-right"><b><i>Signature & Stamp</i></b></div>';
        ReportHTML += '             <div class="m-t-n">';
        ReportHTML += '                 For clarification on the above or other export issues, please send your query to: sea.ops@nilelogistics.com or call Tel: 202-22692714 Dax: 202-22692719 for assistance';
        ReportHTML += '             </div>';
        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12 hide" style="width:100%; position:absolute; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } // if (pDefaults.UnEditableCompanyName == "NIL") {
    else if (pDefaults.UnEditableCompanyName == "ELI") {

        var ReportHTML = '';
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        ReportHTML += '             <div class="col-xs-6 m-t-n"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6 m-t-n"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="m-t-sm b-dark b-t b-r b-l b-b" style="width:100%;height:53%;font-size:90%;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-7" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:24%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' <u>Fax:</u> ' + (pShipperFax == "" ? "N/A" : pShipperFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        ReportHTML += (pShipperPhones.trim() == "" && pShipperFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pShipperPhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pShipperPhones)) + (pShipperFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pShipperFax)) + '</div>');
        //ReportHTML += (pShipperAddressLine1.trim() == "" && pShipperAddressLine2.trim() == "" && pShipperCityName.trim() == "" && pShipperCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1.trim() == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2.trim() == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName.trim() == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>');
        ReportHTML += '                            <div class="col-xs-12">' + (pOperationHeader.ShipperAddress == 0 ? "" : pOperationHeader.ShipperAddress.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:24%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Consignee:</u></b> ' + pConsigneeName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' <u>Fax:</u> ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += (pConsigneePhones.trim() == "" && pConsigneeFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pConsigneePhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pConsigneePhones)) + (pConsigneeFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pConsigneeFax)) + '</div>');
        //ReportHTML += (pConsigneeAddressLine1.trim() == "" && pConsigneeAddressLine2.trim() == "" && pConsigneeCityName.trim() == "" && pConsigneeCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1.trim() == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2.trim() == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName.trim() == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>');
        ReportHTML += '                            <div class="col-xs-12">' + (pOperationHeader.ConsigneeAddress == 0 ? "" : pOperationHeader.ConsigneeAddress.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:24%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify:</u></b> ' + pNotify1Name + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' <u>Fax:</u> ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += (pNotify1Phones.trim() == "" && pNotify1Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify1Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify1Phones)) + (pNotify1Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify1Fax)) + '</div>');
        //ReportHTML += (pNotify1AddressLine1.trim() == "" && pNotify1AddressLine2.trim() == "" && pNotify1CityName.trim() == "" && pNotify1CountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1.trim() == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2.trim() == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName.trim() == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>');
        ReportHTML += '                            <div class="col-xs-12">' + (pOperationHeader.Notify1Address == 0 ? "" : pOperationHeader.Notify1Address.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:28%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"><b><u>Line:</u></b> ' + pLineName + '</div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '                     <div class="col-xs-6" style="height:25%;"></div>';
        else
            ReportHTML += '                     <div class="col-xs-6" style="height:25%;">&emsp;</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"><b><u>POL:</u></b> ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"></div>';

        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"><b><u>POD:</u></b> ' + pPODCodeAndName + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"></div>';

        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"><b><u>Final Place Of Delivery:</u></b> ' + (pOperationHeader.DeliveryAddress == 0 ? '' : pOperationHeader.DeliveryAddress) + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:25%;"></div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        /**************************************2nd half of table*****************************************/
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="height:100%;">';
        //ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     <div class="b-dark row" style="height:23%;">'; //shipper adjacent
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark row" style="height:23%;">'; //consignee adjacent
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark row" style="height:54%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify 2:</u></b> ' + pNotify2Name + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify2Phones == "" ? "N/A" : pNotify2Phones) + ' <u>Fax:</u> ' + (pNotify2Fax == "" ? "N/A" : pNotify2Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify2AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify2AddressLine2 == "" ? "" : pNotify2AddressLine2 + ' ') + (pNotify2CityName == "" ? "" : ', ' + pNotify2CityName + ', ') + pNotify2CountryName + '</div>';
        ReportHTML += (pNotify2Phones.trim() == "" && pNotify2Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify2Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify2Phones)) + (pNotify2Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify2Fax)) + '</div>');
        //ReportHTML += (pNotify2AddressLine1.trim() == "" && pNotify2AddressLine2.trim() == "" && pNotify2CityName.trim() == "" && pNotify2CountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pNotify2AddressLine1.trim() == "" ? "" : pNotify2AddressLine1 + ' ') + (pNotify2AddressLine2.trim() == "" ? "" : pNotify2AddressLine2 + ' ') + (pNotify2CityName.trim() == "" ? "" : ', ' + pNotify2CityName + ', ') + pNotify2CountryName + '</div>');
        ReportHTML += '<div class="col-xs-12">' + (pOperationHeader.Notify2Address == 0 ? "" : pOperationHeader.Notify2Address.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                     </div>';
        //ReportHTML += '                     <div class="b-dark b-b row" style="height:20%;">';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Line:</u></b> ' + pLineName + '</div>';
        //if ($("#cbIsOcean").prop("checked"))
        //    ReportHTML += '                     <div class="col-xs-6" style="height:50%;"><b><u>Vessel:</u></b> ' + pVesselName + '</div>';
        //else
        //    ReportHTML += '                     <div class="col-xs-6" style="height:50%;">&emsp;</div>';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Departure:</u></b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>ETA POL:</u></b> ' + (pETAPOLDate == "01/01/1900" || pETAPOLDate == "1/1/1900" ? "N/A" : pETAPOLDate) + '</div>';
        //ReportHTML += '                     </div>';
        //ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        //ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POL:</u></b> ' + pPOLCodeAndName + '</div>';
        //ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POD:</u></b> ' + pPODCodeAndName + '</div>';
        //ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '             </div>';

        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        ReportHTML += '<div> &nbsp; </div>'//no final shipping declaration for air

        ReportHTML += '                         <table id="tblOperationContainersAndPackages_Pre" style="height:20%;" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration")
            ReportHTML += '                                     <th>Marks & Numbers</th>';
        ReportHTML += '                                     <th>GOODS DESCRIPTION</th>'; //pPackageTypes + GeneralDescriptionOfGoods
        ReportHTML += '                                     <th style="width:10%;">TNW(KG)</th>';
        ReportHTML += '                                     <th style="width:10%;">TGW(KG)</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        if ($("#cbWithAttachment").prop("checked")) {
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration")
                ReportHTML += '                                     <td>' + ' See Attachment' + '</td>';
            ReportHTML += '                                     <td>' + ' See Attachment' + '</td>';
            ReportHTML += '                                     <td>' + ' </td>';
            ReportHTML += '                                     <td>' + ' </td>';
            ReportHTML += '                                 </tr>';
        }
        else {
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration")
                ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods == 0
                ? ((pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + (pDescriptionOfGoods == "N/A" || pDescriptionOfGoods == 0 ? "" : (': ' + pDescriptionOfGoods)))
                : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")
            ) + '</td>';
            ReportHTML += '                                     <td>' + pNetWeightSum + ' KG</td>';
            ReportHTML += '                                     <td>' + pGrossWeightSum + ' KG</td>';
            ReportHTML += '                                 </tr>';
        }
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';

        //ReportHTML += '                         <div> &nbsp; </div>'
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                         </div>';
        //ReportHTML += '                     </div>'; //of table-responsive
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '             <div class="col-xs-8 m-t-n"><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
        ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>';
        ReportHTML += '             <div class="col-xs-4 m-t-n text-center"><b><i>Signature & Stamp</i></b></div>';
        ReportHTML += '             <div class="col-xs-8 m-t-n text-center">&emsp;</div>';
        ReportHTML += '             <div class="col-xs-4 m-t-n text-center"><b><i>' + pOperationHeader.CreatorName + '</i></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-n" style="clear:both;">';
        ReportHTML += '                 <b>Special Instructions:</b><br>';
        ReportHTML += '                 <span class="m-l">-Number Of Bills required (3)Originals (3)Copies.</span>';
        ReportHTML += '             </div>';
        /******************************Attachment*********************************/
        if ($("#cbWithAttachment").prop("checked")) {
            ReportHTML += '         <div class="break"></div>';
            ReportHTML += '         <table id="tblOperationContainersAndPackages_Pre" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '             <thead>';
            ReportHTML += '                 <tr>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration")
                ReportHTML += '                     <th>Marks & Numbers</th>';
            ReportHTML += '                     <th>GOODS DESCRIPTION</th>'; //pPackageTypes + GeneralDescriptionOfGoods
            ReportHTML += '                     <th style="width:10%;">TNW(KG)</th>';
            ReportHTML += '                     <th style="width:10%;">TGW(KG)</th>';
            ReportHTML += '                 </tr>';
            ReportHTML += '             </thead>';
            ReportHTML += '             <tbody>';
            ReportHTML += '                 <tr class="" style="font-size:95%;">';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration")
                ReportHTML += '                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + '</td>';
            ReportHTML += '                     <td>' + (pOperationHeader.DescriptionOfGoods == 0
                ? ((pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + (pDescriptionOfGoods == "N/A" || pDescriptionOfGoods == 0 ? "" : (': ' + pDescriptionOfGoods)))
                : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")
            ) + '</td>';
            ReportHTML += '                     <td>' + pNetWeightSum + ' KG</td>';
            ReportHTML += '                     <td>' + pGrossWeightSum + ' KG</td>';
            ReportHTML += '                 </tr>';
            ReportHTML += '             </tbody>';
            ReportHTML += '         </table>';
        }
        /******************************EOF Attachment*********************************/
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        //    ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "ELI") {
    else if (pDefaults.UnEditableCompanyName == "GLS") {

        var ReportHTML = '';
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        ReportHTML += '             <div class="col-xs-6 m-t-n"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6 m-t-n"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="m-t-sm b-dark b-t b-r b-l b-b" style="width:100%;height:40%;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-7" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:23%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' <u>Fax:</u> ' + (pShipperFax == "" ? "N/A" : pShipperFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        ReportHTML += (pShipperPhones.trim() == "" && pShipperFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pShipperPhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pShipperPhones)) + (pShipperFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pShipperFax)) + '</div>');
        ReportHTML += (pShipperAddressLine1.trim() == "" && pShipperAddressLine2.trim() == "" && pShipperCityName.trim() == "" && pShipperCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1.trim() == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2.trim() == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName.trim() == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:23%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Consignee:</u></b> ' + pConsigneeName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' <u>Fax:</u> ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += (pConsigneePhones.trim() == "" && pConsigneeFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pConsigneePhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pConsigneePhones)) + (pConsigneeFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pConsigneeFax)) + '</div>');
        ReportHTML += (pConsigneeAddressLine1.trim() == "" && pConsigneeAddressLine2.trim() == "" && pConsigneeCityName.trim() == "" && pConsigneeCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1.trim() == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2.trim() == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName.trim() == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:23%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify:</u></b> ' + pNotify1Name + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' <u>Fax:</u> ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += (pNotify1Phones.trim() == "" && pNotify1Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify1Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify1Phones)) + (pNotify1Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify1Fax)) + '</div>');
        ReportHTML += (pNotify1AddressLine1.trim() == "" && pNotify1AddressLine2.trim() == "" && pNotify1CityName.trim() == "" && pNotify1CountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1.trim() == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2.trim() == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName.trim() == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:20%;">';
        var ETAPOLDate = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ETAPOLDate));
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>ETS:</u></b>' + (ETAPOLDate == "01/01/1900" || pOperationHeader.ETAPOLDate == "1/1/1900" ? "N/A" : pOperationHeader.ETAPOLDate) + '</div>';
        ReportHTML += '                     <div class="col-xs-6" style="height:50%;"><b><u>Vessel:</u></b> ' + pVesselName + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>T.T:</u></b> ' + (pOperationHeader.TransientTime == 0 ? "" : pOperationHeader.TransientTime) + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Free Time @POD:</u></b> </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POL:</u></b> ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POD:</u></b> ' + pPODCodeAndName + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="height:100%;">';
        ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-lg"><h4>' + pEnCompanyName + '</h4></div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine1 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine2 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine3 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine4 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine5 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Phone(s) :</u> ' + pPhones + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Fax :</u> ' + pFaxes + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + pEmail + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><b><u>TO:</u></b> ' + '' + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><b><u>ATTN:</u></b> ' + '' + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><b><u>FAX:</u></b> ' + '' + '</div>';
        ReportHTML += '                 </div>';
        ReportHTML += '             </div>';

        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        ReportHTML += '<div> &nbsp; </div>'//no final shipping declaration for air

        { //PreShippingDeclaration or air in all cases
            ReportHTML += '                        <div class="row col-xs-12"> <table id="tblOperationContainersAndPackages_Pre" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Marks & Numbers</th>';
            ReportHTML += '                                     <th>DESCRIPTION Of GOODS </th>'; //pPackageTypes + GeneralDescriptionOfGoods
            ReportHTML += '                                     <th>Weight</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + ' </td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods == 0
                ? ((pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + (pDescriptionOfGoods == "N/A" || pDescriptionOfGoods == 0 ? "" : (': ' + pDescriptionOfGoods)))
                : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")
            ) + '</td>';
            ReportHTML += '                                     <td>' + pGrossWeightSum + ' KG</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table></div>';
        }
        ReportHTML += '                        <div class="row col-xs-12"> <table id="tblOperationContainersAndPackages_Pre" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>Container Type</th>';
        ReportHTML += '                                     <th>Freight Agreed</th>'; //pPackageTypes + GeneralDescriptionOfGoods
        ReportHTML += '                                     <th>THC</th>';
        ReportHTML += '                                     <th>Freight Type\ Payable</th>';
        ReportHTML += '                                     <th>No. BL required</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        debugger;
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td>' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + ' </td>';
        ReportHTML += '                                     <td></td>';
        ReportHTML += '                                     <td></td>';
        ReportHTML += '                                     <td>' + (pPOrC == "P" ? "PREPAID" : (pPOrC == "C" ? "COLLECT" : "NOT SPECIFIED")) + ' </td>';
        ReportHTML += '                                     <td>' + (pOperationHeader.NumberOfHousesConnected == 0 ? "" : pOperationHeader.NumberOfHousesConnected) + ' </td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table></div>';

        //ReportHTML += '             <div class="col-xs-8 m-l m-t-n"><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
        //ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>';
        //ReportHTML += '             <div class="col-xs-4 m-t-n float-right"><b><i>Signature & Stamp</i></b></div>';
        //ReportHTML += '             <div class="col-xs-12 m-t-xs">';
        //ReportHTML += '                 <b>Special Instructions:</b><br>';
        //ReportHTML += '                 <span class="m-l">-Number Of Bills required (3)Originals (3)Copies.</span>';
        //ReportHTML += '             </div>';
        ReportHTML += '         </body>';
        //{
        //    ReportHTML += '     <footer class="footer col-xs-12 hide" style="width:100%; position:absolute; bottom:0;">';
        //    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        //    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        //        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        //    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        //        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        //    ReportHTML += '     </footer>';
        //}
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "GLS") {
    else { //All other companies

        var ReportHTML = '';
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-6 m-t-n"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6 m-t-n"><b>Operation No. :</b> ' + pOperationCode + (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG" ? (" / Ref: " + pOperationHeader.Reference) : "") + (pDefaults.UnEditableCompanyName == "CFR" ? (" / Packages: " + pOperationHeader.NumberOfPackages + "x" + pOperationHeader.PackageTypeName) : "") + '</div>';
        if (pDefaults.UnEditableCompanyName == "MAR") {
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration")
                ReportHTML += '             <div class="col-xs-12"><b>Booking No.: </b>' + (pOperationHeader.BookingNumbers == 0 ? '' : pOperationHeader.BookingNumbers) + '</div>';
            else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration")
                ReportHTML += '             <div class="col-xs-12"><b>Containers: </b>' + (pOperationHeader.ContainerTypes == 0 ? '' : pOperationHeader.ContainerTypes) + '</div>';
        }
        ReportHTML += '             <div class="m-t-sm b-dark b-t b-r b-l b-b" style="width:100%;height:40%;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-7" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:23%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' <u>Fax:</u> ' + (pShipperFax == "" ? "N/A" : pShipperFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        ReportHTML += (pShipperPhones.trim() == "" && pShipperFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pShipperPhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pShipperPhones)) + (pShipperFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pShipperFax)) + '</div>');
        ReportHTML += (pShipperAddressLine1.trim() == "" && pShipperAddressLine2.trim() == "" && pShipperCityName.trim() == "" && pShipperCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1.trim() == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2.trim() == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName.trim() == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:23%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Consignee:</u></b> ' + pConsigneeName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' <u>Fax:</u> ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += (pConsigneePhones.trim() == "" && pConsigneeFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pConsigneePhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pConsigneePhones)) + (pConsigneeFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pConsigneeFax)) + '</div>');
        ReportHTML += (pConsigneeAddressLine1.trim() == "" && pConsigneeAddressLine2.trim() == "" && pConsigneeCityName.trim() == "" && pConsigneeCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1.trim() == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2.trim() == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName.trim() == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:23%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify:</u></b> ' + pNotify1Name + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' <u>Fax:</u> ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += (pNotify1Phones.trim() == "" && pNotify1Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify1Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify1Phones)) + (pNotify1Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify1Fax)) + '</div>');
        ReportHTML += (pNotify1AddressLine1.trim() == "" && pNotify1AddressLine2.trim() == "" && pNotify1CityName.trim() == "" && pNotify1CountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1.trim() == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2.trim() == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName.trim() == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:20%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Line:</u></b> ' + pLineName + '</div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '                     <div class="col-xs-6" style="height:50%;"><b><u>Vessel:</u></b> ' + pVesselName + '</div>';
        else
            ReportHTML += '                     <div class="col-xs-6" style="height:50%;">&emsp;</div>';
        if (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") {
            ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Free Time:</u></b> ' + (pOperationHeader.FreeTime == 0 ? "N/A" : pOperationHeader.FreeTime) + '</div>';
            ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Voy.No:</u></b> ' + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : pOperationHeader.VoyageOrTruckNumber) + '</div>';
        }
        else {
            ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Departure:</u></b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
            ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>ETA POL:</u></b> ' + (pETAPOLDate == "01/01/1900" || pETAPOLDate == "1/1/1900" ? "N/A" : pETAPOLDate) + '</div>';
        }
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POL:</u></b> ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POD:</u></b> ' + pPODCodeAndName + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="height:100%;">';
        //01111444405
        if (pDefaults.UnEditableCompanyName != "MAR" && pDefaults.UnEditableCompanyName != "ILS" && pDefaults.UnEditableCompanyName != "ILSEG")
            ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><h4>' + pEnCompanyName + '</h4></div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine1 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine2 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine3 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine4 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine5 + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Phone(s) :</u> ' + pPhones + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Fax :</u> ' + pFaxes + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG" ? pLoggedUser.Email : pEmail) + '</div>';
        ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><b><u>TO:</u></b> ' + '' + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><b><u>ATTN:</u></b> ' + '' + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><b><u>FAX:</u></b> ' + '' + '</div>';
        ReportHTML += '                 </div>';
        ReportHTML += '             </div>';

        ReportHTML += '<div> &nbsp; </div>'//no final shipping declaration for air
        if (pDefaults.UnEditableCompanyName == "CQL" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration") { //PreShippingDeclaration or air in all cases
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Container(s)</th>';
            ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
            ReportHTML += '                                     <th>NetWgt(KG)</th>';
            ReportHTML += '                                     <th>GrossWgt(KG)</th>';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
                ReportHTML += '                                     <th>VGM(KG)</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            $.each(JSON.parse(data[32]), function (i, item) { //no final shipping declaration for air
                if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                    ReportHTML += '                                     <td>' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + '</td>';
                    //ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + ": " + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + (item.DescriptionOfGoods == 0 ? "" : (": " + item.DescriptionOfGoods)) + '</td>';
                    ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.VGM + '</td>';
                    ReportHTML += '                                 </tr>';
                }
                else { //final LCL (no final for air)
                    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                    ReportHTML += '                                     <td>' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                    //ReportHTML += '                                     <td>' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td>' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + (item.DescriptionOfGoods == 0 ? "" : (": " + item.DescriptionOfGoods)) + '</td>';
                    ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                    ReportHTML += '                                 </tr>';
                }
            });
            ReportHTML += '                                 <tr>';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") //to add the totals row according to FCL or LCL
                ReportHTML += '                                 <td colspan=2><b>Totals:</b> ' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td><td><b>TVGM: ' + pVGMSum + ' KG</b></td>';
            else
                ReportHTML += '                                 <td colspan=2><b>Totals:</b> ' + pPackageTypes + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
            //ReportHTML += '                         <table id="tblOperationContainersAndPackages_Pre" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            //ReportHTML += '                             <thead>';
            //ReportHTML += '                                 <tr>';
            //if (pDefaults.UnEditableCompanyName == "CQL" )
            //    ReportHTML += '                                 <th>COMMODITY</th>';
            //ReportHTML += '                                     <th>GOODS DESCRIPTION</th>'; //pPackageTypes + GeneralDescriptionOfGoods
            //ReportHTML += '                                     <th>TNW(KG)</th>';
            //ReportHTML += '                                     <th>TGW(KG)</th>';
            //ReportHTML += '                                 </tr>';
            //ReportHTML += '                             </thead>';
            //ReportHTML += '                             <tbody>';
            //ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            //if (pDefaults.UnEditableCompanyName == "CQL")
            //    ReportHTML += '                                 <td>' + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName) + '</td>';
            //ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods == 0
            //                                                                ? ((pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + (pDescriptionOfGoods == "N/A" || pDescriptionOfGoods == 0 ? "" : (': ' + pDescriptionOfGoods)))
            //                                                                : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")
            //                                                            ) + '</td>';
            //ReportHTML += '                                     <td>' + pNetWeightSum + ' KG</td>';
            //ReportHTML += '                                     <td>' + pGrossWeightSum + ' KG</td>';
            //ReportHTML += '                                 </tr>';
            //ReportHTML += '                             </tbody>';
            //ReportHTML += '                         </table>';
            ////ReportHTML += '                         <div> &nbsp; </div>'
        }
        else if (
            $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration" && !$("#cbIsAir").prop("checked")) { // table is shown only in final shipping
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Container(s)</th>';
            ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
            //if (pDefaults.UnEditableCompanyName == "ILS"
            //    && (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            //    ) {
            //    ReportHTML += '                                     <th>PackageType</th>';
            //    ReportHTML += '                                     <th>HS.Code</th>';
            //}
            ReportHTML += '                                     <th>NetWgt(KG)</th>';
            ReportHTML += '                                     <th>GrossWgt(KG)</th>';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                ReportHTML += '                                     <th>VGM(KG)</th>';
                if (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG"
                    //&& (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
                ) {
                    ReportHTML += '                                     <th>PackageType</th>';
                    ReportHTML += '                                     <th>HS.Code</th>';
                }
            }
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            $.each(JSON.parse(data[32]), function (i, item) { //no final shipping declaration for air
                if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                    ReportHTML += '                                     <td>' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + " (" + item.ContainerTypeCode + ")" + '</td>';
                    //ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + ": " + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + (item.DescriptionOfGoods == 0 ? "" : (": " + item.DescriptionOfGoods)) + '</td>';
                    ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.VGM + '</td>';
                    if (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") {
                        ReportHTML += '                                     <td>' + (item.PackageTypeNameOnContainer == 0 ? "" : item.PackageTypeNameOnContainer) + '</td>';
                        ReportHTML += '                                     <td>' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit) + '</td>';
                    }
                    ReportHTML += '                                 </tr>';
                }
                else { //final LCL (no final for air)
                    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                    ReportHTML += '                                     <td>' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                    //ReportHTML += '                                     <td>' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td>' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + (item.DescriptionOfGoods == 0 ? "" : (": " + item.DescriptionOfGoods)) + '</td>';
                    ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                    ReportHTML += '                                 </tr>';
                }
            });
            ReportHTML += '                                 <tr>';
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") //to add the totals row according to FCL or LCL
                ReportHTML += '                                 <td colspan=2><b>Totals:</b> ' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + (pDefaults.UnEditableCompanyName == "BED" ? (pOperationHeader.Description == 0 ? "" : (" - " + pOperationHeader.Description)) : "") + '</td>' + '<td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td><td><b>TVGM: ' + pVGMSum + ' KG</b></td>' + (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG" ? "<td></td><td></td>" : "");
            else
                ReportHTML += '                                 <td colspan=2><b>Totals:</b> ' + pPackageTypes + (pDefaults.UnEditableCompanyName == "BED" ? (pOperationHeader.Description == 0 ? "" : (" - " + pOperationHeader.Description)) : "") + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
        }
        else { //PreShippingDeclaration or air in all cases
            ReportHTML += '                         <table id="tblOperationContainersAndPackages_Pre" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            if (pDefaults.UnEditableCompanyName == "CQL" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration")
                ReportHTML += '                                 <th>COMMODITY</th>';
            if (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") {
                ReportHTML += '                                     <th>ContainerTypes</th>';
                ReportHTML += '                                     <th>PackageType</th>';
                ReportHTML += '                                     <th>HS.Code</th>';
            }
            ReportHTML += '                                     <th>GOODS DESCRIPTION</th>'; //pPackageTypes + GeneralDescriptionOfGoods
            ReportHTML += '                                     <th>TNW(KG)</th>';
            ReportHTML += '                                     <th>TGW(KG)</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            //ReportHTML += '                                     <td>' + (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + ': ' + pDescriptionOfGoods.replace(/\n/g, "<br />") + '</td>';
            if (pDefaults.UnEditableCompanyName == "CQL" && $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration")
                ReportHTML += '                                 <td>' + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName) + '</td>';
            if (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") {
                ReportHTML += '                                 <td>' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '</td>';
                ReportHTML += '                                 <td>' + (pOperationHeader.PackageTypeName == 0 ? "" : pOperationHeader.PackageTypeName) + '</td>';
                ReportHTML += '                                 <td>' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit) + '</td>';
            }
            ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods == 0
                ? ((pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + (pDescriptionOfGoods == "N/A" || pDescriptionOfGoods == 0 ? "" : (': ' + pDescriptionOfGoods)))
                : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")
            )
                + '</td>';
            ReportHTML += '                                     <td>' + pNetWeightSum + ' KG</td>';
            ReportHTML += '                                     <td>' + pGrossWeightSum + ' KG</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
            //ReportHTML += '                         <div> &nbsp; </div>'
        }
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                         </div>';
        //ReportHTML += '                     </div>'; //of table-responsive
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '             <div class="col-xs-8 m-l m-t-n"><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
        ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>';
        ReportHTML += '             <div class="col-xs-4 m-t-n float-right"><b><i>Signature & Stamp</i></b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-xs">';
        ReportHTML += '                 <b>Special Instructions:</b><br>';
        //ReportHTML += '                 <span class="m-l">-Number Of Bills required (3)Originals (3)Copies.</span>';
        //ReportHTML += '                 <span class="m-l">-Number Of Bills required (3)' + ($("#slPrintType").val() == "Telex Release" ? 'Telex Release' : 'Originals') + ' (3)Copies.</span>';
        if ($("#slPrintType").val() == "Original" || $("#slPrintType").val() == "Copy" || $("#slPrintType").val() == "")
            ReportHTML += '                 <span class="m-l">-Number Of Bills required (3)Originals (3)Copies.</span>';
        else
            ReportHTML += '                 <span class="m-l">-' + $("#slPrintType").val() + '</span>';
        ReportHTML += '             </div>';
        ReportHTML += '         </body>';
        if (pDefaults.UnEditableCompanyName == "BAL" || pDefaults.UnEditableCompanyName == "BHE") {
            ReportHTML += '     <footer class="footer col-xs-12 m-t-lg" style="width:100%; position:absolute; bottom:0;">';
            //ReportHTML += '         <hr style="border-width: 1px;" />';
            //ReportHTML += '         <div class="col-xs-12 small m-t">All business undertaken subject to our EIFFA standard trading conDitions, which will remain paramount, and is incorporate, into all contracts to which we are a party. Our StandardTrading Conditions are available from our offices on request.</div>';
            //ReportHTML += '         <div class="col-xs-12 small text-right ">  الخدمات المقدمة من قبل شركتناخاضعة لشروط شعبة النقل الدولى المصريةالتى تعتبر واجبة النفاذ و جزأ لا يتجزأ من أى عقد نحن طرف به و المتوفرة عند الطلب  </div>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row text-center"><img src="/Content/Images/DocsOutFooter_BAL.jpg" alt="footer"/></div>';
            ReportHTML += '     </footer>';
        }
        else {
            ReportHTML += '     <footer class="footer col-xs-12 hide" style="width:100%; position:absolute; bottom:0;">';
            //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
                ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
            ReportHTML += '     </footer>';
        } //EOF All other companies
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
}
function DocsOut_Print_ShippingAndPreShippingDeclaration_SeaGate(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pOperationContainersAndPackages = JSON.parse(data[32]); //objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62]; //POD
    var pVolumeSum = data[63];
    var pExpectedDeparture = data[64];  //POL
    var pETAPOLDate = data[65];
    var pMasterOperationCode = data[66];
    var pCommodityName = data[67];
    var pAgreedRate = data[68];
    var pOperationHeader = JSON.parse(data[69]);

    var pNotify2Name = data[70];
    var pNotify2ContactName = data[71];
    var pNotify2Phones = data[72];
    var pNotify2Fax = data[73];
    var pNotify2Email = data[74];
    var pNotify2AddressLine1 = data[75];
    var pNotify2AddressLine2 = data[76];
    var pNotify2CityName = data[77];
    var pNotify2CountryName = data[78];


    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div>';

    ReportHTML += '             <div class="col-xs-12 text-right m-t-n"><b><u>JOB# :</u> </b>' + pOperationCode + '</div>';
    ReportHTML += '                         <table id="tblOperationPartners" class=" table table-striped b-light table-bordered" text-sm">'; //table-hover 
    ReportHTML += '                             <tbody>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=5 style="border-left-color:white!Important; border-top-color:white!Important;"></td>';
    ReportHTML += '                                     <td colspan=3>' + '<label><input type="checkbox" ' + ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "PreShippingDeclaration" ? ' checked ' : '') + ' disabled="disabled">&nbsp;Primary</label>&nbsp;&nbsp;&nbsp;&nbsp;'
    ReportHTML += '                                                        <label><input type="checkbox" ' + ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration" ? ' checked ' : '') + ' disabled="disabled">&nbsp;Final</label>' + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>OPS.EXECUTIVE</b></td>';
    ReportHTML += '                                     <td>' + $("#sp-LoginName").text() + '</td>';
    //ReportHTML += '                                     <td colspan=3><b>EMAIL</b></td>';
    ReportHTML += '                                     <td colspan=6></td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>SHIPPER:</b></td>';
    ReportHTML += '                                     <td colspan=7>' + pShipperName + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>ADDRESS:</b></td>';
    ReportHTML += '                                     <td colspan=7>' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') /*+ (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName*/ + '</td>';
    //ReportHTML += '                                     <td colspan=7>' + (pOperationHeader.ShipperAddress == 0 ? "" : pOperationHeader.ShipperAddress) + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>TELE:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pShipperPhones + '</td>';
    ReportHTML += '                                     <td><b>FAX:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pShipperFax + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>COUNTRY:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pShipperCountryName + '</td>';
    ReportHTML += '                                     <td><b>CITY:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pShipperCityName + '</td>';
    ReportHTML += '                                 </tr>';


    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>CONSIGNEE:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pConsigneeName + '</td>';
    ReportHTML += '                                     <td><b>NOTIFY:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pNotify1Name + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>ADDRESS:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') /*+ (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName*/ + '</td>';
    //ReportHTML += '                                     <td colspan=7>' + (pOperationHeader.ConsigneeAddress == 0 ? "" : pOperationHeader.ConsigneeAddress) + '</td>';
    ReportHTML += '                                     <td><b>ADDRESS:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') /*+ (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName*/ + '</td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>TELE:</b></td>';
    ReportHTML += '                                     <td>' + pConsigneePhones + '</td>';
    ReportHTML += '                                     <td><b>FAX:</b></td>';
    ReportHTML += '                                     <td>' + pConsigneeFax + '</td>';
    ReportHTML += '                                     <td><b>TELE:</b></td>';
    ReportHTML += '                                     <td>' + pNotify1Phones + '</td>';
    ReportHTML += '                                     <td><b>FAX:</b></td>';
    ReportHTML += '                                     <td>' + pNotify1Fax + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>COUNTRY:</b></td>';
    ReportHTML += '                                     <td>' + pConsigneeCountryName + '</td>';
    ReportHTML += '                                     <td><b>CITY:</b></td>';
    ReportHTML += '                                     <td>' + pConsigneeCityName + '</td>';
    ReportHTML += '                                     <td><b>COUNTRY:</b></td>';
    ReportHTML += '                                     <td>' + pNotify1CountryName + '</td>';
    ReportHTML += '                                     <td><b>CITY:</b></td>';
    ReportHTML += '                                     <td>' + pNotify1CityName + '</td>';
    ReportHTML += '                                 </tr>';


    ReportHTML += '                                 <tr class="" style="height:2px;">';
    ReportHTML += '                                     <td colspan=8></td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>RATE/UNIT</b></td>';
    ReportHTML += '                                     <td colspan=3>' + ' ' + '</td>';
    ReportHTML += '                                     <td><b>FREIGHT:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + '<label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Prepaid</label>&nbsp;&nbsp;&nbsp;&nbsp;'
    ReportHTML += '                                                        <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label>' + '</td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="height:2px;">';
    ReportHTML += '                                     <td colspan=8></td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>CARRIER:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pLineName + '</td>';
    ReportHTML += '                                     <td colspan=4>' + ' ' + '</td>';
    ReportHTML += '                                 </tr>';


    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>POL:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pPOLCodeAndName + '</td>';
    ReportHTML += '                                     <td><b>POD:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pPODCodeAndName + '</td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>FINALPLACE:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pDeliveryCountryName + ' ' + pDeliveryCityName + '</td>';
    ReportHTML += '                                     <td><b>BOOKING #:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pBookingNumber + '</td>';
    ReportHTML += '                                 </tr>';


    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>VESSEL:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pVesselName + ' <b>Voy#:</b>' + pVoyageOrTruckNumber + '</td>';
    ReportHTML += '                                     <td><b>ETD:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? "N/A" : pExpectedDeparture) + '</td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>EQUIP.TYPE:</b></td>';
    ReportHTML += '                                     <td colspan=3>' + (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + '</td>';
    ReportHTML += '                                     <td><b>Volume(CBM)</b></td>';
    ReportHTML += '                                     <td colspan=3>' + pVolumeSum + '</td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="height:2px;">';
    ReportHTML += '                                     <td colspan=8></td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=4><b>IMO DETAILS(IF ANY):</b></td>';
    ReportHTML += '                                     <td colspan=4><b>REEFER SETTINGS(IF ANY):</b></td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td><b>PRODUCT:</b></td>'; //PackageTypeIDOnContainer
    ReportHTML += '                                     <td><b>UN#:</b></td>';
    ReportHTML += '                                     <td><b>CLASS#:</b></td>';
    ReportHTML += '                                     <td><b>FLASHpt(C):</b></td>';
    ReportHTML += '                                     <td colspan=1><b>MIN TMP(C)</b></td>';
    ReportHTML += '                                     <td colspan=1><b>MAX TMP</b></td>';
    ReportHTML += '                                     <td colspan=1><b>HUM</b></td>';
    ReportHTML += '                                     <td colspan=1><b>VENT</b></td>';
    ReportHTML += '                                 </tr>';
    for (var i = 0; i < pOperationContainersAndPackages.length; i++)
        if (pOperationContainersAndPackages[i].IsIMO || pOperationContainersAndPackages[i].IsReefer) {
            ReportHTML += '                         <tr class="" style="font-size:95%;">';
            ReportHTML += '                             <td>' + (pOperationContainersAndPackages[i].PackageTypeNameOnContainer == 0 ? "" : pOperationContainersAndPackages[i].PackageTypeNameOnContainer) + '</td>'; //PackageTypeIDOnContainer
            ReportHTML += '                             <td>' + (pOperationContainersAndPackages[i].UNNumber == 0 ? "" : pOperationContainersAndPackages[i].UNNumber) + '</td>';
            ReportHTML += '                             <td>' + (pOperationContainersAndPackages[i].IMOClass == 0 ? "" : pOperationContainersAndPackages[i].IMOClass) + '</td>';
            ReportHTML += '                             <td>' + (pOperationContainersAndPackages[i].FlashPoint == 0 ? "" : pOperationContainersAndPackages[i].FlashPoint) + '</td>';
            ReportHTML += '                             <td colspan=1>' + (pOperationContainersAndPackages[i].MinTemp == 0 ? "" : pOperationContainersAndPackages[i].MinTemp) + '</td>';
            ReportHTML += '                             <td colspan=1>' + (pOperationContainersAndPackages[i].MaxTemp == 0 ? "" : pOperationContainersAndPackages[i].MaxTemp) + '</b></td>';
            ReportHTML += '                             <td colspan=1>' + (pOperationContainersAndPackages[i].Humidity == 0 ? "" : pOperationContainersAndPackages[i].Humidity) + '</td>';
            ReportHTML += '                             <td colspan=1>' + (pOperationContainersAndPackages[i].Ventilation == 0 ? "" : pOperationContainersAndPackages[i].Ventilation) + '</b></td>';
            ReportHTML += '                         </tr>';
        }

    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    ReportHTML += '                                     <td colspan=8>';
    ReportHTML += '                                         <b>PARTICULARS FURNISHED BY SHIPPER<br>';
    ReportHTML += '                                            DESCRIPTION OF GOODS, KIND OF PACKAGES, MARKS & NUMBERS</b>';
    ReportHTML += '                                     </td>';
    ReportHTML += '                                 </tr>';


    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") //to add the totals row according to FCL or LCL
        ReportHTML += '                                 <td colspan=8>' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + ' TNW: ' + pNetWeightSum + 'KG - TGW:' + pGrossWeightSum + 'KG - TGW:' + pVGMSum + 'KG';
    else
        ReportHTML += '                                 <td colspan=8>' + pPackageTypes + ' TNW:' + pNetWeightSum + 'KG - TGW:' + pGrossWeightSum + 'KG';
    //ReportHTML += '                                         <br><br><br><br>SHIPPED ON BOARD &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; DECLARED CLEAN BY SHIPPER';
    ReportHTML += '                                         <br>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '<br> DECLARED CLEAN BY SHIPPER';
    ReportHTML += '                                         <br>SHIPPER STOW, WEIGHT, LOAD AND COUNT';
    ReportHTML += '                                     </td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="height:2px;">';
    ReportHTML += '                                     <td colspan=8></td>';
    ReportHTML += '                                 </tr>';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration" && !$("#cbIsAir").prop("checked")) { // table is shown only in final shipping
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>Container(s)</th>';
        ReportHTML += '                                     <th>SEAL#</th>';
        ReportHTML += '                                     <th>LOT#</th>';
        ReportHTML += '                                     <th colspan=3>NO & TYPE OF PKG</th>';
        ReportHTML += '                                     <th>NetWgt(KG)</th>';
        ReportHTML += '                                     <th>GrossWgt(KG)</th>';
        ReportHTML += '                                 </tr>';

        $.each(pOperationContainersAndPackages, function (i, item) { //no final shipping declaration for air
            if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                                     <td>' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + '</td>';
                ReportHTML += '                                     <td>' + (item.CarrierSeal == 0 ? "N/A" : item.CarrierSeal) + '</td>';
                ReportHTML += '                                     <td>' + (item.LotNumber == 0 ? "N/A" : item.LotNumber) + '</td>';
                ReportHTML += '                                     <td colspan=3>' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + '</td>';
                ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                ReportHTML += '                                 </tr>';
            }
            else { //final LCL (no final for air)
                ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                                     <td>' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                ReportHTML += '                                     <td>' + item.CarrierSeal + '</td>';
                ReportHTML += '                                     <td colspan=4>' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + '</td>';
                ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                ReportHTML += '                                 </tr>';
            }
        });
        ReportHTML += '                                 <tr>';
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") //to add the totals row according to FCL or LCL
            ReportHTML += '                                 <td colspan=6><b>Totals:</b> ' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + '</td><td><b>TNW:' + pNetWeightSum + 'KG</b></td><td><b>TGW:' + pGrossWeightSum + ' KG</b></td>';
        else
            ReportHTML += '                                 <td colspan=6><b>Totals:</b> ' + pPackageTypes + '</td><td><b>TNW:' + pNetWeightSum + 'KG</b></td><td><b>TGW:' + pGrossWeightSum + 'KG</b></td>';
        ReportHTML += '                                 </tr>';
    }

    else { // tblOperationContainersAndPackages_Pre : PreShippingDeclaration or air in all cases
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th colspan=6>GOODS DESCRIPTION</th>'; //pPackageTypes + GeneralDescriptionOfGoods
        ReportHTML += '                                     <th>TNW(KG)</th>';
        ReportHTML += '                                     <th>TGW(KG)</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td colspan=6>' + (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL" ? pContainerTypes : pPackageTypes) + ': ' + pDescriptionOfGoods.replace(/\n/g, "<br />") + '</td>';
        ReportHTML += '                                     <td>' + pNetWeightSum + ' KG</td>';
        ReportHTML += '                                     <td>' + pGrossWeightSum + ' KG</td>';
        ReportHTML += '                                 </tr>';
    }

    ReportHTML += '                                 <tr class="" style="height:95%;">';
    ReportHTML += '                                     <td colspan=8><b>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;SIGNED ON BEHALF OF THE SHIPPER</b><br><br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;_______________________________</td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                                 <tr class="" style="height:95%;">';
    ReportHTML += '                                     <td colspan=8><b>We declare that all above-mentioned particulars are correct & typically matching declaration sent by shipper without any whomever responsibility on us.</b></td>';
    ReportHTML += '                                 </tr>';

    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';

    ReportHTML += '         </body>';

    ReportHTML += '     <footer class="footer col-xs-12 hide" style="width:100%; position:absolute; bottom:0;">';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ShippingAndPreShippingDeclaration_OAO(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pOperationContainersAndPackages = JSON.parse(data[32]); //objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62]; //POD
    var pVolumeSum = data[63];
    var pExpectedDeparture = data[64];  //POL
    var pETAPOLDate = data[65];
    var pMasterOperationCode = data[66];
    var pCommodityName = data[67];
    var pAgreedRate = data[68];
    var pOperationHeader = JSON.parse(data[69]);

    var pNotify2Name = data[70];
    var pNotify2ContactName = data[71];
    var pNotify2Phones = data[72];
    var pNotify2Fax = data[73];
    var pNotify2Email = data[74];
    var pNotify2AddressLine1 = data[75];
    var pNotify2AddressLine2 = data[76];
    var pNotify2CityName = data[77];
    var pNotify2CountryName = data[78];

    var pDescriptionOfGoodsOnContainers = "";
    $.each(pOperationContainersAndPackages, function (i, item) {
        pDescriptionOfGoodsOnContainers += (item.DescriptionOfGoods == 0 ? "" : (item.DescriptionOfGoods.replace(/\n/g, "<br/>") + " "));
    });
    if (1 == 1) { //if (pDefaults.UnEditableCompanyName == "OAO") {

        var ReportHTML = '';
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</div> </br>';
        ReportHTML += '             <div class="col-xs-4"></div><div class="col-xs-8 text-center m-t-n-lg m-l-n-lg"><h3><div style="width:300px; border:1px solid #000;">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</div></h3></div> </br>';

        //ReportHTML += '             <div class="col-xs-6 m-t-n"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6 m-t-n"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="col-xs-12">&emsp;</div>'; //if i removed this line the list symbol in the next line goes to right maybe bescause the above m-t-n-lg class
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>•	 Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>•	' + ($("#cbIsAir").prop("checked") ? 'Airline' : ($("#cbIsOcean").prop("checked") ? 'Shipping line' : 'Trucker')) + ': </b> ' + pLineName + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>•	Agreed Rate: </b> ' + (pAgreedRate == 0 ? "Not Specified" : pAgreedRate) + '</div>';
        ReportHTML += '             <div class="col-xs-12"><b>•	Date: </b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div>';

        ReportHTML += '             <div class="b-dark b-t b-r b-l b-b" style="width:100%;height:30%;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-7" style="height:100%;font-size:85%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
        ////ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        ////ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + '</div>';
        ////ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        ////ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' <u>Fax:</u> ' + (pShipperFax == "" ? "N/A" : pShipperFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        ReportHTML += (pShipperPhones.trim() == "" && pShipperFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pShipperPhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pShipperPhones)) + (pShipperFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pShipperFax)) + '</div>');
        ReportHTML += (pShipperAddressLine1.trim() == "" && pShipperAddressLine2.trim() == "" && pShipperCityName.trim() == "" && pShipperCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1.trim() == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2.trim() == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName.trim() == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Consignee:</u></b> ' + pConsigneeName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' <u>Fax:</u> ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += (pConsigneePhones.trim() == "" && pConsigneeFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pConsigneePhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pConsigneePhones)) + (pConsigneeFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pConsigneeFax)) + '</div>');
        ReportHTML += (pConsigneeAddressLine1.trim() == "" && pConsigneeAddressLine2.trim() == "" && pConsigneeCityName.trim() == "" && pConsigneeCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1.trim() == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2.trim() == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName.trim() == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify:</u></b> ' + pNotify1Name + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' <u>Fax:</u> ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += (pNotify1Phones.trim() == "" && pNotify1Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify1Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify1Phones)) + (pNotify1Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify1Fax)) + '</div>');
        ReportHTML += (pNotify1AddressLine1.trim() == "" && pNotify1AddressLine2.trim() == "" && pNotify1CityName.trim() == "" && pNotify1CountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1.trim() == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2.trim() == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName.trim() == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>');
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:11%;">';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Line:</u></b> ' + pLineName + '</div>';
        if ($("#cbIsOcean").prop("checked"))
            ReportHTML += '                     <div class="col-xs-6" style="height:50%;"><b><u>Vessel:</u></b> ' + pVesselName + '</div>';
        else
            ReportHTML += '                     <div class="col-xs-6" style="height:50%;">&emsp;</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>' + ($("#cbIsOcean").prop("checked") ? 'Date of Sailing' : 'ATD') + ':</u></b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>ETA POL:</u></b> ' + (pETAPOLDate == "01/01/1900" || pETAPOLDate == "1/1/1900" ? "N/A" : pETAPOLDate) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POL:</u></b> ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POD:</u></b> ' + pPODCodeAndName + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="height:100%;">';
        //ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-lg"><h4>' + pEnCompanyName + '</h4></div>';
        if (pDefaults.UnEditableCompanyName == "OAO") {
            //ReportHTML += '                     <div class="col-xs-12 text-center"><h4>' + 'OSMAN AHMED OSMAN<br>LOGISTICS SERVICES' + '</h4></div>';
            //ReportHTML += '                     <div class="col-xs-12 m-l-n">' + 'Head Office: 20, Nasser St. - Elzaiteiat.'/*pAddressLine1*/ + '</div>';
            //ReportHTML += '                     <div class="col-xs-12 m-l-n">' + 'Suez, Egypt.'/*pAddressLine2*/ + '</div>';
            //ReportHTML += '                     <div class="col-xs-12 m-l-n">E-mail : <u>' + pEmail + '</u></div>';
            //ReportHTML += '                     <br>';
            //ReportHTML += '                     <div class="col-xs-12 m-l-n">' + 'Alexandria: 29 El Ghorfa El Togarya St, El Raml, Alexandria.<br>Tel & Fax : +2034800077'/*pAddressLine2*/ + '</div>';
            //ReportHTML += '                     <br>';
            //ReportHTML += '                     <div class="col-xs-12 text-center"><u>' + pWebsite + '</u></div>';

            ReportHTML += '                     <div class="col-xs-12 text-center"><h4>' + 'OPAL<br>LOGISTICS SERVICES' + '</h4></div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + 'Head Office: Maadi Star Building Corniche El Nile, Maadi' + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + 'Cairo, Egypt.'/*pAddressLine2*/ + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">E-mail : <u>' + pEmail + '</u></div>';
            //ReportHTML += '                     <br>';
            //ReportHTML += '                     <div class="col-xs-12 m-l-n">' + 'Alexandria: 29 El Ghorfa El Togarya St, El Raml, Alexandria.<br>Tel & Fax : +2034800077'/*pAddressLine2*/ + '</div>';
            //ReportHTML += '                     <br>';
            ReportHTML += '                     <div class="col-xs-12 text-center"><u>' + pWebsite + '</u></div>';
        }
        else {
            ReportHTML += '                     <div class="col-xs-12 m-l-lg"><h4>' + pEnCompanyName + '</h4></div>';
            if (pAddressLine1 != 0 && pAddressLine1 != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine1 + '</div>';
            if (pAddressLine2 != 0 && pAddressLine2 != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine2 + '</div>';
            if (pAddressLine3 != 0 && pAddressLine3 != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine3 + '</div>';
            if (pAddressLine4 != 0 && pAddressLine4 != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine4 + '</div>';
            if (pAddressLine5 != 0 && pAddressLine5 != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine5 + '</div>';
            if (pPhones != 0 && pPhones != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Phone(s) :</u> ' + pPhones + '</div>';
            if (pFaxes != 0 && pFaxes != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Fax :</u> ' + pFaxes + '</div>';
            if (pEmail != 0 && pEmail != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + pEmail + '</div>';
            if (pWebsite != 0 && pWebsite != "")
                ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
        }
        ReportHTML += '                 </div>';
        ReportHTML += '             </div>';

        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'//no final shipping declaration for air
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration" && $("#cbIsOcean").prop("checked") && (pShipmentType == "FCL" || pShipmentType == "CONSOL")) { // table is shown only in final shipping
        if ($("#cbIsOcean").prop("checked") && (pShipmentType == "FCL" || pShipmentType == "CONSOL")) { // table is shown only in final shipping
            ReportHTML += '                         <table id="tblOperationContainersAndPackagesFirstRow" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>MARKS & NOs.</th>';
            ReportHTML += '                                     <th>DESCRIPTION OF GOODS</th>';
            if (pDefaults.UnEditableCompanyName == "STR")
                ReportHTML += '                                     <th>Packages</th>';
            ReportHTML += '                                     <th>WEIGHT</th>';
            //if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
            //ReportHTML += '                                     <th>VGM(KG)</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            ReportHTML += '                                     <td>' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes)
                //+ (pOperationContainersAndPackages[0]["IsReefer"] ? ("<br>MinTemp:" + pOperationContainersAndPackages[0]["MinTemp"] + "C " + "Max:" + pOperationContainersAndPackages[0]["MaxTemp"] + "C " + "Vent:" + pOperationContainersAndPackages[0]["Ventilation"] + " Humid:" + pOperationContainersAndPackages[0]["Humidity"]) : "")
                + '</td>';
            if (pDefaults.UnEditableCompanyName == "STR")
                ReportHTML += '                                     <td>' + (pOperationHeader.Description == 0 ? "" : pOperationHeader.Description) + '</td>';
            else
                ReportHTML += '                                     <td>' + (pOperationHeader.Description != 0 ? pOperationHeader.Description : (pOperationContainersAndPackages[0]["DescriptionOfGoods"] == 0 ? "" : pOperationContainersAndPackages[0]["DescriptionOfGoods"].replace(/\n/g, "<br/>"))) + '</td>';
            if (pDefaults.UnEditableCompanyName == "STR")
                ReportHTML += '                                     <td>' + (pOperationHeader.NumberOfPackages + (pOperationHeader.PackageTypeName == 0 ? "" : (' x ' + pOperationHeader.PackageTypeName))) + '</td>';
            ReportHTML += '                                     <td>' + "N.W. : " + pOperationHeader.NetWeightSum + ' KGS <br>' + "G.W. : " + pOperationHeader.GrossWeightSum + ' KGS' + '</td>';
            //ReportHTML += '                                     <td>' + item.VGM + '</td>';
            ReportHTML += '                                 </tr>';

            ReportHTML += '                                  <tr>';
            ReportHTML += '                                     <td colspan=2 rowspan=2 style="border-left:1px solid #FFF!Important; border-bottom:1px solid #FFF!Important;">';
            ReportHTML += '                                         <div style="width:95%;border:1px solid #000; text-align:left;">';
            ReportHTML += '                                             <b><u>Special Instructions:</u></b><br>';
            ReportHTML += '                                             &emsp;(1)	Freight Term [' + (pPOrC == "P" ? "PREPAID" : (pPOrC == "C" ? "COLLECT" : "NOT SPECIFIED")) + '].<br>';
            ReportHTML += '                                             &emsp;(2)	Freight to be declared on bill of lading (Yes/No).<br>';
            ReportHTML += '                                             &emsp;(3)	Number of bills of lading required (3) original (3) copies.';
            ReportHTML += '                                             <br><br>';
            ReportHTML += '                                         </div>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                     <td><b><u>Authorize</u>' + '<br><br><br>' + '</b></td>';
            ReportHTML += '                                  </tr>';
            ReportHTML += '                                  <tr>';
            ReportHTML += '                                     <td><b><u>Stamp and signature:</u>' + '<br><br><br>' + '</b></td>';
            ReportHTML += '                                  </tr>';
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
            if (pOperationContainersAndPackages[0]["IsReefer"]) { //IsReefer = true
                ReportHTML += '                         <table id="tblReeferPropertiesFirstRow" style="width:90%;" class="m-t-n m-l-lg table table-striped b-light b-a text-sm table-bordered">'; //table-hover
                ReportHTML += '                             <thead>';
                ReportHTML += '                                 <tr>';
                ReportHTML += '                                     <th>Ventilation</th>';
                ReportHTML += '                                     <th>Max Temp (C)</th>';
                ReportHTML += '                                     <th>Min Temp (C)</th>';
                ReportHTML += '                                     <th>Humidity</th>';
                ReportHTML += '                                 </tr>';
                ReportHTML += '                             </thead>';
                ReportHTML += '                             <tbody>';
                ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                                     <td>' + (pOperationContainersAndPackages[0]["Ventilation"] == 0 ? "" : pOperationContainersAndPackages[0]["Ventilation"]) + '</td>';
                ReportHTML += '                                     <td>' + pOperationContainersAndPackages[0]["MaxTemp"] + '</td>';
                ReportHTML += '                                     <td>' + pOperationContainersAndPackages[0]["MinTemp"] + '</td>';
                ReportHTML += '                                     <td>' + (pOperationContainersAndPackages[0]["Humidity"] == 0 ? "" : pOperationContainersAndPackages[0]["Humidity"]) + '</td>';
                ReportHTML += '                                 </tr>';
                ReportHTML += '                             </tbody>';
                ReportHTML += '                         </table>';
            }
            /*************Containers Table**************/
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() == "ShippingDeclaration") { //final
                if ($("#cbWithAttachment").prop("checked")) {
                    ReportHTML += '         <div class="col-xs-12 m-t-lg text-center"><b>Please, See Attachment.</b></div>';
                    ReportHTML += '         <div class="break"></div>';
                }
                ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="m-t-n table table-striped b-light b-a text-sm table-bordered">'; //table-hover
                ReportHTML += '                             <thead>';
                ReportHTML += '                                 <tr>';
                ReportHTML += '                                     <th>Container</th>';
                if (pDefaults.UnEditableCompanyName == "STR")
                    ReportHTML += '                                     <th>Goods Desc.</th>';
                else
                    ReportHTML += '                                     <th>Packages</th>';
                ReportHTML += '                                     <th>NetWgt(KG)</th>';
                ReportHTML += '                                     <th>GrossWgt(KG)</th>';
                //if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
                //ReportHTML += '                                     <th>VGM(KG)</th>';
                ReportHTML += '                                 </tr>';
                ReportHTML += '                             </thead>';
                ReportHTML += '                             <tbody style="font-size:90%;">';
                var pExtraPackagesTotalRepeatedInEachRowForOperation = "";
                $.each(pOperationContainersAndPackages, function (i, item) { //no final shipping declaration for air
                    ReportHTML += '                                 <tr class="">';
                    ReportHTML += '                                     <td>' + (item.ContainerTypeCode + (item.MarksAndNumbers == 0 ? "" : (":" + item.MarksAndNumbers)))
                        //ReportHTML += '                                     <td>' + item.ContainerTypeCode + (item.MarksAndNumbers == 0 ? "" : (':' + item.MarksAndNumbers))
                        //+ (item.IsReefer && !item.IsNOR ? ("<br>MinTemp:" + item.MinTemp + "C " + "Max:" + item.MaxTemp + "C " + "Vent:" + item.Ventilation + " Humid:" + item.Humidity) : "")
                        + '</td>';
                    if (pDefaults.UnEditableCompanyName == "STR")
                        ReportHTML += '                                     <td>' + (item.DescriptionOfGoods == 0 ? "" : item.DescriptionOfGoods) + '</td>';
                    else
                        ReportHTML += '                                     <td>' + (item.PackageTypeNameOnContainer == "0" ? "" : (item.NumberOfPackagesOnContainer + 'x' + item.PackageTypeNameOnContainer + (item.ExtraPackages == 0 ? "" : ('-' + item.ExtraPackages)))) + '</td>';
                    ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                    //ReportHTML += '                                     <td>' + item.VGM + '</td>';
                    ReportHTML += '                                 </tr>';
                    pExtraPackagesTotalRepeatedInEachRowForOperation = item.ExtraPackagesTotalRepeatedInEachRowForOperation;
                });
                ReportHTML += '                                 <tr>';
                ReportHTML += '                                     <td colspan=2><b>Totals:</b> ' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + (pExtraPackagesTotalRepeatedInEachRowForOperation == "0" ? "" : (" - Extra:" + pExtraPackagesTotalRepeatedInEachRowForOperation)) + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td>';
                ReportHTML += '                                 </tr>';
                ReportHTML += '                             </tbody>';
                ReportHTML += '                         </table>';
            }
        } //of if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.Name").text() != "PreShippingDeclaration" && $("#cbIsOcean").prop("checked") && (pShipmentType == "FCL" || pShipmentType == "CONSOL")) { // table is shown only in final shipping

        ReportHTML += '         </body>';

        ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
        ReportHTML += "<br><br><br><br><br><br><br><br>"; //not to override body
        //ReportHTML += '           <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
        //ReportHTML += '           <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '         </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }//EOF if (pDefaults.UnEditableCompanyName == "OAO") {
}
function DocsOut_Print_ShippingDeclaration_DangerousAir_BK(data, pDocumentTypeID, pOption) {
    //debugger;
    //var RecordsExist = data[0];
    //var MissingMandatoryFields = data[1];
    //var pOperationCode = data[2];
    //var pShipperName = data[3];
    //var pShipperContactName = data[4];
    //var pShipperPhones = data[5];
    //var pShipperFax = data[6];
    //var pShipperEmail = data[7];
    //var pConsigneeName = data[8];
    //var pConsigneeContactName = data[9];
    //var pConsigneePhones = data[10];
    //var pConsigneeFax = data[11];
    //var pConsigneeEmail = data[12];
    //var pNotify1Name = data[13];
    //var pNotify1ContactName = data[14];
    //var pNotify1Phones = data[15];
    //var pNotify1Fax = data[16];
    //var pNotify1Email = data[17];
    //var pLineName = data[18];
    //var pVoyageOrTruckNumber = data[19];
    //var pVesselName = data[20];
    //var pActualDeparture = data[21];
    //var pPOLCodeAndName = data[22];
    //var pPODCodeAndName = data[23];
    //var pEnCompanyName = data[24];
    //var pArCompanyName = data[25];
    //var pPOrC = data[26];
    //var pAddressLine1 = data[27];
    //var pAddressLine2 = data[28];
    //var pAddressLine3 = data[29];
    //var pAddressLine4 = data[30];
    //var pAddressLine5 = data[31];
    ////data[32] : objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    //var pPhones = data[33];
    //var pFaxes = data[34];
    //var pEmail = data[35];
    //var pWebsite = data[36];
    //var pClientEmail = data[37];
    //var pContainerTypes = data[38];
    //var pPackageTypes = data[39];
    //var pShipmentType = data[40];
    //var pGrossWeightSum = data[41];
    //var pDescriptionOfGoods = data[42];
    //var pRoadOrContainerNumber = data[43];
    //var pPackageTypesOnContainersTotals = data[44];

    //var pShipperAddressLine1 = data[45];
    //var pShipperAddressLine2 = data[46];
    //var pShipperCityName = data[47];
    //var pShipperCountryName = data[48];

    //var pConsigneeAddressLine1 = data[49];
    //var pConsigneeAddressLine2 = data[50];
    //var pConsigneeCityName = data[51];
    //var pConsigneeCountryName = data[52];

    //var pNotify1AddressLine1 = data[53];
    //var pNotify1AddressLine2 = data[54];
    //var pNotify1CityName = data[55];
    //var pNotify1CountryName = data[56];

    //var pNetWeightSum = data[57];
    //var pVGMSum = data[58];

    //var pDeliveryCountryName = data[59];
    //var pDeliveryCityName = data[60];
    //var pBookingNumber = data[61];
    //var pExpectedArrival = data[62]; //POD
    //var pVolumeSum = data[63];
    //var pExpectedDeparture = data[64];  //POL
    //var pETAPOLDate = data[65];
    //var pMasterOperationCode = data[66];
    //var pCommodityName = data[67];
    //var pAgreedRate = data[68];
    //var pOperationHeader = JSON.parse(data[69]);

    //var pNotify2Name = data[70];
    //var pNotify2ContactName = data[71];
    //var pNotify2Phones = data[72];
    //var pNotify2Fax = data[73];
    //var pNotify2Email = data[74];
    //var pNotify2AddressLine1 = data[75];
    //var pNotify2AddressLine2 = data[76];
    //var pNotify2CityName = data[77];
    //var pNotify2CountryName = data[78];
    ////<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>

    //
    //var ReportHTML = '';
    //ReportHTML += '<html>';
    //ReportHTML += '     <head>';
    //ReportHTML += '     <meta http-equiv=Content-Type content="text/html; charset=UTF-8">';
    //ReportHTML += '         <title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" />';
    //ReportHTML += '         <style type="text/css">';
    //ReportHTML += '             <!--';
    //ReportHTML += '             span.cls_002{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_002{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_002_modified{font-family:Arial,serif;font-size:10px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_002_modified{font-family:Arial,serif;font-size:10px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_003{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_003{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_004{font-family:Arial,serif;font-size:6.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    //ReportHTML += '             div.cls_004{font-family:Arial,serif;font-size:6.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    //ReportHTML += '             span.cls_005{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_005{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_006{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    //ReportHTML += '             div.cls_006{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    //ReportHTML += '             span.cls_016{font-family:Arial,serif;font-size:11.2px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_016{font-family:Arial,serif;font-size:11.2px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_017{font-family:Arial,serif;font-size:10.3px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_017{font-family:Arial,serif;font-size:10.3px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_007{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_007{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_008{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    //ReportHTML += '             div.cls_008{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    //ReportHTML += '             span.cls_009{font-family:Arial,serif;font-size:5.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_009{font-family:Arial,serif;font-size:5.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_010{font-family:Arial,serif;font-size:9.0px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_010{font-family:Arial,serif;font-size:9.0px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_011{font-family:Arial,serif;font-size:9.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_011{font-family:Arial,serif;font-size:9.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_013{font-family:Arial,serif;font-size:9.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_013{font-family:Arial,serif;font-size:9.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_014{font-family:Arial,serif;font-size:5.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_014{font-family:Arial,serif;font-size:5.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_015{font-family:Arial,serif;font-size:6.1px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_015{font-family:Arial,serif;font-size:6.1px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_012{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_012{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    //ReportHTML += '             span.cls_018{font-family:Arial,serif;font-size:6.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             div.cls_018{font-family:Arial,serif;font-size:6.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    //ReportHTML += '             -->';
    //ReportHTML += '         </style>';
    ////ReportHTML += '         <script type="text/javascript" src="C:\Users\sherif\Desktop\AWB Shipping Declartion\ShippersDecColumnsColorPrinter_files/wz_jsgraphics.js"></script>';
    //ReportHTML += '     </head>';
    //ReportHTML += '     <body>';
    //ReportHTML += '         <div style="position:absolute;left:50%;margin-left:-306px;top:0px;width:612px;height:792px;border-style:none;overflow:hidden">';
    //ReportHTML += '             <div style="position:absolute;left:0px;top:0px;">';
    //ReportHTML += '             <img src="/Content/Images/DangerShippingDecBackground.jpg" alt="logo" width=612 height=792></div>';
    //ReportHTML += '             <div style="position:absolute;left:48.25px;top:44.69px;" class="cls_002"><span class="cls_002">SHIPPER&apos;S DECLARATION FOR DANGEROUS GOODS</span></div>';
    ////ReportHTML += '             <div style="position:absolute;left:314.94px;top:44.69px;" class="cls_002"><span class="cls_002">(Provide at least three copies to the airline.)</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50.80px;top:59.28px;height:60px;width:225px;overflow:hidden;text-overflow:ellipsis;" class="cls_003">';
    //ReportHTML += '                 <span class="cls_007" id="spanShipper">';
    //ReportHTML += '                     Shipper<b>';
    //if (pOperationHeader.ShipperName != 0)
    //    ReportHTML += '                 ' + "<br>" + pOperationHeader.ShipperName;
    //if (pOperationHeader.ShipperAddress != 0)
    //    ReportHTML += '                 ' + "<br>" + pOperationHeader.ShipperAddress;
    //if (pOperationHeader.ShipperPhonesAndFaxes != 0)
    //    ReportHTML += '                 ' + "<br>" + pOperationHeader.ShipperPhonesAndFaxes;
    //ReportHTML += '                 </b></span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:290.20px;top:67.53px;" class="cls_003"><span class="cls_007" id="spanAWBNumber">Air Waybill No. <b>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:290.54px;top:88.73px;" class="cls_003"><span class="cls_003" id="spanPageNumber">Page <b>1</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:333.47px;top:88.73px;" class="cls_003"><span class="cls_003" id="spanTotalPageNumber">of <b>1</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:363.66px;top:88.73px;" class="cls_003"><span class="cls_003">Pages</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:290.99px;top:104.79px;" class="cls_003"><span class="cls_003" id="spanShipperReferenceNumber">Shipper&apos;s Reference Number <b>' + (pOperationHeader.CustomerReference == 0 ? "" :pOperationHeader.CustomerReference) + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:365.95px;top:115.94px;" class="cls_004"><span class="cls_004">(optional)</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50.80px;top:129.12px;height:60px;width:225px;overflow:hidden;text-overflow:ellipsis;" class="cls_003">';
    //ReportHTML += '                 <span class="cls_007" id="spanConsignee">';
    //ReportHTML += '                     Consignee<b>';
    //if (pOperationHeader.ConsigneeName != 0)
    //    ReportHTML += '                 ' + "<br>" + pOperationHeader.ConsigneeName;
    //if (pOperationHeader.ConsigneeAddress != 0)
    //    ReportHTML += '                 ' + "<br>" + pOperationHeader.ConsigneeAddress;
    //if (pOperationHeader.ConsigneePhonesAndFaxes != 0)
    //    ReportHTML += '                 ' + "<br>" + pOperationHeader.ConsigneePhonesAndFaxes;
    //ReportHTML += '                 </b></span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:287.08px;top:133.86px;" class="cls_005">';
    //ReportHTML += '             	<span class="cls_005" id="spanLogo">';
    //ReportHTML += '             		<img src="/Content/Images/EgyptAirLogo.png" style="position:absolute;left:90px;top:5px;">';
    //ReportHTML += '             	</span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:49.35px;top:199.94px;" class="cls_006"><span class="cls_006">Two completed and signed copies of this Declaration must</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:297.34px;top:198.64px;" class="cls_016"><span class="cls_016">WARNING</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:49.35px;top:209.98px;" class="cls_006"><span class="cls_006">be handed to the operator</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:48.80px;top:230.22px;" class="cls_002"><span class="cls_002">TRANSPORT DETAILS</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:297.14px;top:231.17px;" class="cls_017"><span class="cls_017">Failure to comply with all respects with the applicable</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:48.80px;top:245.56px;" class="cls_007"><span class="cls_007">This shipment is within the</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:166.27px;top:244.36px;" class="cls_003"><span class="cls_003" id="spanAirportOfDeparture">Airport of Departure <br><b>' + pOperationHeader.POLCode + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:297.12px;top:243.48px;" class="cls_017"><span class="cls_017">Dangerous Goods Regulations may be in breach of</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:48.80px;top:254.53px;" class="cls_007"><span class="cls_007">limitations prescribed for:</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:297.10px;top:255.80px;" class="cls_017"><span class="cls_017">the applicable law, subject to legal penalties.</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:48.80px;top:263.50px;" class="cls_008"><span class="cls_008">(delete non applicable)</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:55.38px;top:277.06px;" class="cls_007"><span class="cls_007">PASSENGER</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:115.86px;top:277.19px;" class="cls_007"><span class="cls_007">CARGO</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:55.38px;top:284.50px;" class="cls_007"><span class="cls_007">AND CARGO</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:115.86px;top:284.63px;" class="cls_007"><span class="cls_007">AIRCRAFT</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:55.38px;top:291.94px;" class="cls_007"><span class="cls_007">AIRCRAFT</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:115.86px;top:292.06px;" class="cls_007"><span class="cls_007">ONLY</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:295.45px;top:303.81px;" class="cls_003"><span class="cls_003">Shipment type:</span><span class="cls_009"> </span><span class="cls_004">(delete non-applicable)</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:49.13px;top:309.95px;" class="cls_003"><span class="cls_003" id="spanAirportOfDestination">Airport of Destination: <b>' + pOperationHeader.PODCode + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:302.14px;top:314.99px;" class="cls_007"><span class="cls_007">NON-RADIOACTIVE</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:387.59px;top:314.77px;" class="cls_007"><span class="cls_007">RADIOACTIVE</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:59.32px;top:333.35px;" class="cls_010"><span class="cls_010">NATURE AND QUANTITY OF DANGEROUS GOODS</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:81.53px;top:350.16px;" class="cls_011"><span class="cls_011">Dangerous Goods Identification</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:53.51px;top:367.16px;" class="cls_007"><span class="cls_007">UN</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:338.90px;top:363.82px;" class="cls_013"><span class="cls_013">Quantity and</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:443.27px;top:363.82px;" class="cls_013"><span class="cls_013">Packing</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:231.77px;top:371.34px;" class="cls_014"><span class="cls_014">Class</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:270.44px;top:373.89px;" class="cls_015"><span class="cls_015">Pack-</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:507.68px;top:369.00px;" class="cls_013">';
    //ReportHTML += '                 <span class="cls_013">Authorization</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-16px;top:41px;height:170px;width:83px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanShippingDeclarationAuthorization">';
    //ReportHTML += '                     <b>' + pOperationHeader.ShippingDeclarationAuthorization.replace(/\n/g, '<br/>') + '</b>';
    //ReportHTML += '                 </span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:55.59px;top:376.13px;" class="cls_007"><span class="cls_007">or</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:225.69px;top:378.08px;" class="cls_014"><span class="cls_014">or Division</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:328.48px;top:374.04px;" class="cls_013">';
    //ReportHTML += '                 <span class="cls_013">type of packaging</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-23px;top:36px;height:170px;width:128px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanQuantityAndTypeOfPacking">';
    //ReportHTML += '                     <b>' + pOperationHeader.QuantityAndTypeOfPacking.replace(/\n/g, '<br/>') + '</b>';
    //ReportHTML += '                 </span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:451.29px;top:374.04px;" class="cls_013">';
    //ReportHTML += '                  <span class="cls_013">Inst.</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-18px;top:36px;height:170px;width:58px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanPackingInstruction">';
    //ReportHTML += '                     <b>' + pOperationHeader.PackingInstruction.replace(/\n/g, '<br/>') + '</b>';
    //ReportHTML += '                 </span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:101.54px;top:378.38px;" class="cls_013">';
    //ReportHTML += '                 <span class="cls_013">Proper Shipping Name</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-17px;top:31px;height:170px;width:135px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanUNorIDnumber">';
    //ReportHTML += '                     <b>' + pOperationHeader.ProperShippingName.replace(/\n/g, '<br/>') + '</b>';
    //ReportHTML += '                 </span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:273.98px;top:381.16px;" class="cls_015"><span class="cls_015">ing</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:55.17px;top:385.10px;" class="cls_007"><span class="cls_007">ID</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:224.76px;top:384.82px;" class="cls_014"><span class="cls_014">(Subsidiary</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:269.44px;top:388.43px;" class="cls_015">';
    //ReportHTML += '                 <span class="cls_015">Group</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-7px;top:22px;height:170px;width:40px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanPackingGroup">';
    //ReportHTML += '                     <b>' + pOperationHeader.PackingGroup.replace(/\n/g, "<br/>") + '<b>';
    //ReportHTML += '                 </span>'
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:232.40px;top:391.56px;" class="cls_014">';
    //ReportHTML += '                 <span class="cls_014">Risk)</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-12px;top:18px;height:170px;width:40px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanUNorIDnumber">';
    //ReportHTML += '                     <b>' + pOperationHeader.ClassOrDivision.replace(/\n/g, "<br/>") + '<b>';
    //ReportHTML += '                 </span>'
    //ReportHTML +=               '</div>';
    //ReportHTML += '             <div style="position:absolute;left:53.09px;top:394.07px;" class="cls_007">';
    //ReportHTML += '                 <span class="cls_007">No.</span>';
    //ReportHTML += '                 <span style="position:absolute;left:-8px;top:15px;height:170px;width:40px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanUNorIDnumber">';
    //ReportHTML += '                     <b>' + pOperationHeader.UNOrID.replace(/\n/g, "<br/>") + '<b>';
    //ReportHTML += '                 </span>'
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:46.21px;top:583.34px;height:35px;width:530px;overflow:hidden;text-overflow:ellipsis;" class="cls_012">';
    //ReportHTML += '                 <span class="cls_012" id="spanAdditionalHandlingInformation">';
    //ReportHTML += '                     Additional Handling Information <br><b>' + (pOperationHeader.HandlingInformation == 0 ? "" : pOperationHeader.HandlingInformation) + '</b>';
    //ReportHTML += '             	</span>';
    //ReportHTML += '             </div>';
    //ReportHTML += '             <div style="position:absolute;left:380px;top:638.97px;" class="cls_003"><span class="cls_003" id="spanSignatory">Name/Title of Signatory <br><b>' + $("#hLoggedUserNameNotLogin").val() + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:640.44px;" class="cls_002_modified"><span class="cls_002_modified">I hereby declare that the contents of this consignment are fully</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:650.48px;" class="cls_002_modified"><span class="cls_002_modified">and accurately described above by the proper shipping name,</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:660.52px;" class="cls_002_modified"><span class="cls_002_modified">and are classified, packaged, marked and labelled/placarded,</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:380px;top:663.06px;" class="cls_003"><span class="cls_003" id="spanPlaceAndDate">Place and Date <br><b>' + pOperationHeader.POLName + ' ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:670.56px;" class="cls_002_modified"><span class="cls_002_modified">and are in all respects in proper condition for transport according</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:680.60px;" class="cls_002_modified"><span class="cls_002_modified">to applicable International and national governmental regulations.</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:380px;top:688.49px;" class="cls_003"><span class="cls_003" id="spanSignature">Signature <br><br><b>' + $("#hLoggedUserNameNotLogin").val() + '</b></span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:690.64px;" class="cls_002_modified"><span class="cls_002_modified">I declare that all of the applicable air transport requirements</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:50px;top:700.68px;" class="cls_002_modified"><span class="cls_002_modified">have been met.</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:380px;top:697.74px;" class="cls_004"><span class="cls_004">(see warning above)</span></div>';
    ////ReportHTML += '             <div style="position:absolute;left:251.84px;top:699.42px;" class="cls_018"><span class="cls_018" id="spanEmergenyTelephone">Emergency Telephone Number</span></div>';
    ////ReportHTML += '             <div style="position:absolute;left:46.33px;top:724.07px;" class="cls_018"><span class="cls_018">FOR RADIOACTIVE MATERIAL SHIPMENT ACCEPTABLE FOR PASSENGER AIRCRAFT, THE SHIPMENT CONTAINS RADIOACTIVE MATERIAL INTENDED FOR USE IN OR</span></div>';
    ////ReportHTML += '             <div style="position:absolute;left:48.15px;top:731.92px;" class="cls_018"><span class="cls_018">INCIDENT TO RESEARCH, MEDICAL DIAGNOSIS, OR TREATMENT. ADR EUROPEAN TRANSPORT STATEMENT: CARRIAGE IN ACCORDANCE WITH 1.1.4.2.1</span></div>';
    //ReportHTML += '         </div>';
    //ReportHTML += '     </body>';
    //ReportHTML += '</html>';
    //if (pOption == "Print" || pOption == undefined || pOption == null) {
    //    var mywindow = window.open('', '_blank');
    //    mywindow.document.write(ReportHTML);
    //    mywindow.document.close();
    //}
    //else if (pOption == "Email") {
    //    DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    //}
}
function DocsOut_Print_ShippingDeclaration_DangerousAir(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    //data[32] : objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62]; //POD
    var pVolumeSum = data[63];
    var pExpectedDeparture = data[64];  //POL
    var pETAPOLDate = data[65];
    var pMasterOperationCode = data[66];
    var pCommodityName = data[67];
    var pAgreedRate = data[68];
    var pOperationHeader = JSON.parse(data[69]);

    var pNotify2Name = data[70];
    var pNotify2ContactName = data[71];
    var pNotify2Phones = data[72];
    var pNotify2Fax = data[73];
    var pNotify2Email = data[74];
    var pNotify2AddressLine1 = data[75];
    var pNotify2AddressLine2 = data[76];
    var pNotify2CityName = data[77];
    var pNotify2CountryName = data[78];
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>


    var ReportHTML = '';
    ReportHTML += '<html>';
    ReportHTML += '     <head>';
    ReportHTML += '     <meta http-equiv=Content-Type content="text/html; charset=UTF-8">';
    ReportHTML += '         <title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" />';
    ReportHTML += '         <style type="text/css">';
    ReportHTML += '             <!--';
    ReportHTML += '             span.cls_002{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_002{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_002_modified{font-family:Arial,serif;font-size:10px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_002_modified{font-family:Arial,serif;font-size:10px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_003{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_003{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_004{font-family:Arial,serif;font-size:6.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    ReportHTML += '             div.cls_004{font-family:Arial,serif;font-size:6.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    ReportHTML += '             span.cls_005{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_005{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_006{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    ReportHTML += '             div.cls_006{font-family:Arial,serif;font-size:8.4px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    ReportHTML += '             span.cls_016{font-family:Arial,serif;font-size:11.2px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_016{font-family:Arial,serif;font-size:11.2px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_017{font-family:Arial,serif;font-size:10.3px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_017{font-family:Arial,serif;font-size:10.3px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_007{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_007{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_008{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    ReportHTML += '             div.cls_008{font-family:Arial,serif;font-size:7.5px;color:rgb(43,42,41);font-weight:normal;font-style:italic;text-decoration: none}';
    ReportHTML += '             span.cls_009{font-family:Arial,serif;font-size:5.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_009{font-family:Arial,serif;font-size:5.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_010{font-family:Arial,serif;font-size:9.0px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_010{font-family:Arial,serif;font-size:9.0px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_011{font-family:Arial,serif;font-size:9.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_011{font-family:Arial,serif;font-size:9.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_013{font-family:Arial,serif;font-size:9.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_013{font-family:Arial,serif;font-size:9.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_014{font-family:Arial,serif;font-size:5.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_014{font-family:Arial,serif;font-size:5.7px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_015{font-family:Arial,serif;font-size:6.1px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_015{font-family:Arial,serif;font-size:6.1px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_012{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_012{font-family:Arial,serif;font-size:8.8px;color:rgb(43,42,41);font-weight:bold;font-style:normal;text-decoration: none}';
    ReportHTML += '             span.cls_018{font-family:Arial,serif;font-size:6.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             div.cls_018{font-family:Arial,serif;font-size:6.6px;color:rgb(43,42,41);font-weight:normal;font-style:normal;text-decoration: none}';
    ReportHTML += '             -->';
    ReportHTML += '         </style>';
    //ReportHTML += '         <script type="text/javascript" src="C:\Users\sherif\Desktop\AWB Shipping Declartion\ShippersDecColumnsColorPrinter_files/wz_jsgraphics.js"></script>';
    ReportHTML += '     </head>';
    ReportHTML += '     <body>';


    ReportHTML += '         <input id="imgSelect" type="file" class="hidden-print" accept="image/*" onchange="loadFile(event)">';
    //ReportHTML += '             		<img id="output"/  style="position:relative;left:100px;top:5px; width:100px; height:50px;" alt="' + pOperationHeader.AirlineName + '">';
    //ReportHTML += '             		<script>';
    //ReportHTML += '             		  var loadFile = function(event) {';
    //ReportHTML += '             		    var reader = new FileReader();';
    //ReportHTML += '             		    reader.onload = function(){';
    //ReportHTML += '             		      var output = document.getElementById("output");';
    //ReportHTML += '             		      output.src = reader.result;';
    //ReportHTML += '                         $("#imgSelect").remove();'
    //ReportHTML += '             		    };';
    //ReportHTML += '             		    reader.readAsDataURL(event.target.files[0]);';
    //ReportHTML += '             		  };';
    //ReportHTML += '             		</script>';



    ReportHTML += '         <div style="position:absolute;left:50%;margin-left:-306px;top:17px;width:612px;height:792px;border-style:none;">';
    ReportHTML += '             <div style="position:absolute;left:0px;top:0px;">';
    //ReportHTML += '             <img src="/Content/Images/DangerShippingDecBackground.jpg" alt="logo" width=612px; height=792px;></div>';
    ReportHTML += '             <img src="/Content/Images/DangerShippingDecBackground.jpg" alt="logo" width=612></div>';
    ReportHTML += '             <div style="position:absolute;left:32px;top:0px;" class="cls_002"><span class="cls_002">SHIPPER&apos;S DECLARATION FOR DANGEROUS GOODS</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:314.94px;top:44.69px;" class="cls_002"><span class="cls_002">(Provide at least three copies to the airline.)</span></div>';
    ReportHTML += '             <div style="position:absolute;left:32px;top:14px;height:80px;width:275px;overflow:hidden;text-overflow:ellipsis;" class="cls_003">';
    ReportHTML += '                 <span class="cls_007" id="spanShipper">';
    ReportHTML += '                     <b>Shipper</b>';
    if (pOperationHeader.ShipperName != 0)
        ReportHTML += '                 ' + "<br>" + pOperationHeader.ShipperName;
    if (pOperationHeader.ShipperAddress != 0)
        ReportHTML += '                 ' + "<br>" + pOperationHeader.ShipperAddress;
    if (pOperationHeader.ShipperPhonesAndFaxes != 0)
        ReportHTML += '                 ' + "<br>" + pOperationHeader.ShipperPhonesAndFaxes;
    ReportHTML += '                 </span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:315px;top:15px;" class="cls_003"><span class="cls_007" id="spanAWBNumber">Air Waybill No. <b>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:315px;top:43px;" class="cls_003"><span class="cls_003" id="spanPageNumber">Page <b>1</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:368px;top:43px;" class="cls_003"><span class="cls_003" id="spanTotalPageNumber">of <b>1</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:389px;top:43px;" class="cls_003"><span class="cls_003">Pages</span></div>';
    ReportHTML += '             <div style="position:absolute;left:315px;top:58px;" class="cls_003"><span class="cls_003" id="spanShipperReferenceNumber">' + (pDefaults.UnEditableCompanyName == "SWI" ? 'Swift Reference' : 'Shipper&apos;s Reference Number') + ' <b>' + (pOperationHeader.CustomerReference == 0 ? "" : pOperationHeader.CustomerReference) + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:390px;top:67px;" class="cls_004"><span class="cls_004">(optional)</span></div>';
    ReportHTML += '             <div style="position:absolute;left:32px;top:96px;height:80px;width:275px;overflow:hidden;text-overflow:ellipsis;" class="cls_003">';
    ReportHTML += '                 <span class="cls_007" id="spanConsignee">';
    ReportHTML += '                     <b>Consignee</b>';
    if (pOperationHeader.ConsigneeName != 0)
        ReportHTML += '                 ' + "<br>" + pOperationHeader.ConsigneeName;
    if (pOperationHeader.ConsigneeAddress != 0)
        ReportHTML += '                 ' + "<br>" + pOperationHeader.ConsigneeAddress;
    if (pOperationHeader.ConsigneePhonesAndFaxes != 0)
        ReportHTML += '                 ' + "<br>" + pOperationHeader.ConsigneePhonesAndFaxes;
    ReportHTML += '                 </span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:287.08px;top:103px;" class="cls_005">';
    ReportHTML += '             	<span class="cls_005" id="spanLogo">';
    //ReportHTML += '             		<img src="/Content/Images/EgyptAirLogo.png" style="position:relative;left:100px;top:5px; width:100px; height:50px;" alt="'+pOperationHeader.AirlineName+'">';
    //ReportHTML += '             		<input id="imgSelect" type="file" accept="image/*" onchange="loadFile(event)">';
    ReportHTML += '             		<img id="output"/  style="position:relative;left:100px;top:5px; width:100px; height:50px;" alt="' + pOperationHeader.AirlineName + '">';
    ReportHTML += '             		<script>';
    ReportHTML += '             		  var loadFile = function(event) {';
    ReportHTML += '             		    var reader = new FileReader();';
    ReportHTML += '             		    reader.onload = function(){';
    ReportHTML += '             		      var output = document.getElementById("output");';
    ReportHTML += '             		      output.src = reader.result;';
    ReportHTML += '                         $("#imgSelect").remove();'
    ReportHTML += '             		    };';
    ReportHTML += '             		    reader.readAsDataURL(event.target.files[0]);';
    ReportHTML += '             		  };';
    ReportHTML += '             		</script>';

    ReportHTML += '             	</span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:32px;top:178px;" class="cls_006"><span class="cls_006">Two completed and signed copies of this Declaration must</span></div>';
    ReportHTML += '             <div style="position:absolute;left:310px;top:173px;" class="cls_016"><span class="cls_016">WARNING</span></div>';
    ReportHTML += '             <div style="position:absolute;left:32px;top:190px;" class="cls_006"><span class="cls_006">be handed to the operator</span></div>';
    ReportHTML += '             <div style="position:absolute;left:40px;top:208px;" class="cls_002"><span class="cls_002">TRANSPORT DETAILS</span></div>';
    ReportHTML += '             <div style="position:absolute;left:310px;top:198px;" class="cls_017"><span class="cls_017">Failure to comply with all respects with the applicable</span></div>';
    ReportHTML += '             <div style="position:absolute;left:40px;top:228.56px;" class="cls_007"><span class="cls_007">This shipment is within the</span></div>';
    ReportHTML += '             <div style="position:absolute;left:173px;top:227.36px;" class="cls_003"><span class="cls_003" id="spanAirportOfDeparture">Airport of Departure <br><b>' + pOperationHeader.POLCode + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:310px;top:211.31px;" class="cls_017"><span class="cls_017">Dangerous Goods Regulations may be in breach of</span></div>';
    ReportHTML += '             <div style="position:absolute;left:40px;top:237.53px;" class="cls_007"><span class="cls_007">limitations prescribed for:</span></div>';
    ReportHTML += '             <div style="position:absolute;left:310px;top:223px;" class="cls_017"><span class="cls_017">the applicable law, subject to legal penalties.</span></div>';
    ReportHTML += '             <div style="position:absolute;left:40px;top:246.50px;" class="cls_008"><span class="cls_008">(delete non applicable)</span></div>';
    ReportHTML += '             <div style="position:absolute;left:55.38px;top:260.06px;" class="cls_007"><span class="cls_007">PASSENGER</span></div>';
    ReportHTML += '             <div style="position:absolute;left:115.86px;top:260.19px;" class="cls_007"><span class="cls_007">CARGO</span></div>';
    ReportHTML += '             <div style="position:absolute;left:55.38px;top:267.50px;" class="cls_007"><span class="cls_007">AND CARGO</span></div>';
    ReportHTML += '             <div style="position:absolute;left:115.86px;top:267.63px;" class="cls_007"><span class="cls_007">AIRCRAFT</span></div>';
    ReportHTML += '             <div style="position:absolute;left:55.38px;top:274.94px;" class="cls_007"><span class="cls_007">AIRCRAFT</span></div>';
    ReportHTML += '             <div style="position:absolute;left:115.86px;top:276.06px;" class="cls_007"><span class="cls_007">ONLY</span></div>';
    ReportHTML += '             <div style="position:absolute;left:315px;top:294px;" class="cls_003"><span class="cls_003">Shipment type:</span><span class="cls_009"> </span><span class="cls_004">(delete non-applicable)</span></div>';
    ReportHTML += '             <div style="position:absolute;left:38px;top:301px;" class="cls_003"><span class="cls_003" id="spanAirportOfDestination">Airport of Destination: <b>' + pOperationHeader.PODCode + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:320px;top:310.5px;" class="cls_007"><span class="cls_007">NON-RADIOACTIVE</span></div>';
    ReportHTML += '             <div style="position:absolute;left:430px;top:310.5px;" class="cls_007"><span class="cls_007">RADIOACTIVE</span></div>';
    ReportHTML += '             <div style="position:absolute;left:38px;top:335px;" class="cls_010"><span class="cls_010">NATURE AND QUANTITY OF DANGEROUS GOODS</span></div>';
    ReportHTML += '             <div style="position:absolute;left:81.53px;top:356px;" class="cls_011"><span class="cls_011">Dangerous Goods Identification</span></div>';
    ReportHTML += '             <div style="position:absolute;left:33.51px;top:387.16px;" class="cls_007"><span class="cls_007">UN</span></div>';
    ReportHTML += '             <div style="position:absolute;left:365px;top:383.82px;" class="cls_013"><span class="cls_013">Quantity and</span></div>';
    ReportHTML += '             <div style="position:absolute;left:463px;top:383.82px;" class="cls_013"><span class="cls_013">Packing</span></div>';
    ReportHTML += '             <div style="position:absolute;left:255px;top:391.34px;" class="cls_014"><span class="cls_014">Class</span></div>';
    ReportHTML += '             <div style="position:absolute;left:300px;top:394px;" class="cls_015"><span class="cls_015">Pack-</span></div>';
    ReportHTML += '             <div style="position:absolute;left:518px;top:390.00px;" class="cls_013">';
    ReportHTML += '                 <span class="cls_013">Authorization</span>';
    ReportHTML += '                 <span style="position:absolute;left:-16px;top:41px;height:220px;width:83px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanShippingDeclarationAuthorization">';
    ReportHTML += '                     <b>' + pOperationHeader.ShippingDeclarationAuthorization.replace(/\n/g, '<br/>') + '</b>';
    ReportHTML += '                 </span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:35.59px;top:396.13px;" class="cls_007"><span class="cls_007">or</span></div>';
    ReportHTML += '             <div style="position:absolute;left:247px;top:398.08px;" class="cls_014"><span class="cls_014">or Division</span></div>';
    ReportHTML += '             <div style="position:absolute;left:354px;top:394.04px;" class="cls_013">';
    ReportHTML += '                 <span class="cls_013">type of packaging</span>';
    ReportHTML += '                 <span style="position:absolute;left:-23px;top:36px;height:220px;width:128px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanQuantityAndTypeOfPacking">';
    ReportHTML += '                     <b>' + pOperationHeader.QuantityAndTypeOfPacking.replace(/\n/g, '<br/>') + '</b>';
    ReportHTML += '                 </span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:473px;top:394.04px;" class="cls_013">';
    ReportHTML += '                  <span class="cls_013">Inst.</span>';
    ReportHTML += '                 <span style="position:absolute;left:-10px;top:36px;height:220px;width:37px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanPackingInstruction">';
    ReportHTML += '                     <b>' + pOperationHeader.PackingInstruction.replace(/\n/g, '<br/>') + '</b>';
    ReportHTML += '                 </span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:90px;top:398.38px;" class="cls_013">';
    ReportHTML += '                 <span class="cls_013">Proper Shipping Name</span>';
    ReportHTML += '                 <span style="position:absolute;left:-30px;top:31px;height:220px;width:170px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanUNorIDnumber">';
    ReportHTML += '                     <b>' + pOperationHeader.ProperShippingName.replace(/\n/g, '<br/>') + '</b>';
    ReportHTML += '                 </span>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:304px;top:401.16px;" class="cls_015"><span class="cls_015">ing</span></div>';
    ReportHTML += '             <div style="position:absolute;left:35.17px;top:405.10px;" class="cls_007"><span class="cls_007">ID</span></div>';
    ReportHTML += '             <div style="position:absolute;left:246px;top:404.82px;" class="cls_014"><span class="cls_014">(Subsidiary</span></div>';
    ReportHTML += '             <div style="position:absolute;left:300px;top:408.43px;" class="cls_015">';
    ReportHTML += '                 <span class="cls_015">Group</span>';
    ReportHTML += '                 <span style="position:absolute;left:-5px;top:22px;height:220px;width:32px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanPackingGroup">';
    ReportHTML += '                     <b>' + pOperationHeader.PackingGroup.replace(/\n/g, "<br/>") + '<b>';
    ReportHTML += '                 </span>'
    ReportHTML += '             </div>';
    ReportHTML += '             <div style="position:absolute;left:255px;top:411.56px;" class="cls_014">';
    ReportHTML += '                 <span class="cls_014">Risk)</span>';
    ReportHTML += '                 <span style="position:absolute;left:-22px;top:18px;height:220px;width:60px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanUNorIDnumber">';
    ReportHTML += '                     <b>' + pOperationHeader.ClassOrDivision.replace(/\n/g, "<br/>") + '<b>';
    ReportHTML += '                 </span>'
    ReportHTML += '</div>';
    ReportHTML += '             <div style="position:absolute;left:36.09px;top:414.07px;" class="cls_007">';
    ReportHTML += '                 <span class="cls_007">No.</span>';
    ReportHTML += '                 <span style="position:absolute;left:-8px;top:15px;height:220px;width:28px;overflow:hidden;text-overflow:ellipsis;" class="cls_007" id="spanUNorIDnumber">';
    ReportHTML += '                     <b>' + pOperationHeader.UNOrID.replace(/\n/g, "<br/>") + '<b>';
    ReportHTML += '                 </span>'
    ReportHTML += '             </div>';



    ReportHTML += '             <div style="position:absolute;left:32px;top:650px;height:45px;width:550px;overflow:hidden;text-overflow:ellipsis;" class="cls_012">';
    ReportHTML += '                 <span class="cls_012" id="spanAdditionalHandlingInformation">';
    ReportHTML += '                     Additional Handling Information <br><b>' + (pOperationHeader.HandlingInformation == 0 ? "" : pOperationHeader.HandlingInformation) + '</b>';
    ReportHTML += '             	</span>';
    ReportHTML += '             </div>';

    ReportHTML += '             <div style="position:absolute;left:380px;top:718.97px;" class="cls_003"><span class="cls_003" id="spanSignatory">Name/Title of Signatory <br><b>' + $("#hLoggedUserNameNotLogin").val() + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:720.44px;" class="cls_002_modified"><span class="cls_002_modified">I hereby declare that the contents of this consignment are fully</span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:730.48px;" class="cls_002_modified"><span class="cls_002_modified">and accurately described above by the proper shipping name,</span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:740.52px;" class="cls_002_modified"><span class="cls_002_modified">and are classified, packaged, marked and labelled/placarded,</span></div>';
    ReportHTML += '             <div style="position:absolute;left:380px;top:743.06px;" class="cls_003"><span class="cls_003" id="spanPlaceAndDate">Place and Date <br><b>' + pOperationHeader.POLName + ' ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:750.56px;" class="cls_002_modified"><span class="cls_002_modified">and are in all respects in proper condition for transport according</span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:760.60px;" class="cls_002_modified"><span class="cls_002_modified">to applicable International and national governmental regulations.</span></div>';
    ReportHTML += '             <div style="position:absolute;left:380px;top:768.49px;" class="cls_003"><span class="cls_003" id="spanSignature">Signature <br><br><b>' + $("#hLoggedUserNameNotLogin").val() + '</b></span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:770.64px;" class="cls_002_modified"><span class="cls_002_modified">I declare that all of the applicable air transport requirements</span></div>';
    ReportHTML += '             <div style="position:absolute;left:30px;top:780.68px;" class="cls_002_modified"><span class="cls_002_modified">have been met.</span></div>';
    ReportHTML += '             <div style="position:absolute;left:380px;top:777.74px;" class="cls_004"><span class="cls_004">(see warning above)</span></div>';














    //ReportHTML += '             <div style="position:absolute;left:251.84px;top:699.42px;" class="cls_018"><span class="cls_018" id="spanEmergenyTelephone">Emergency Telephone Number</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:46.33px;top:724.07px;" class="cls_018"><span class="cls_018">FOR RADIOACTIVE MATERIAL SHIPMENT ACCEPTABLE FOR PASSENGER AIRCRAFT, THE SHIPMENT CONTAINS RADIOACTIVE MATERIAL INTENDED FOR USE IN OR</span></div>';
    //ReportHTML += '             <div style="position:absolute;left:48.15px;top:731.92px;" class="cls_018"><span class="cls_018">INCIDENT TO RESEARCH, MEDICAL DIAGNOSIS, OR TREATMENT. ADR EUROPEAN TRANSPORT STATEMENT: CARRIAGE IN ACCORDANCE WITH 1.1.4.2.1</span></div>';
    ReportHTML += '         </div>';
    ReportHTML += '     </body>';
    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ShippingAdvice(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pConsigneeName = data[4];
    var pNotify1Name = data[5];
    var pActualDeparture = data[6];
    var pExpectedArrival = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pContainerNumbers = data[11];
    var pDescriptionOfGoods = data[12];
    var pDimensions = data[13];
    var pVesselName = data[14];
    var pGrossWeightSum = data[15].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    var pNetWeightSum = data[16];
    var pClientEmail = data[17];
    var pLineName = data[18];
    var pMasterBL = data[19];
    var pBranchName = data[20];
    var pBookingNumber = data[21];


    //var pActualDeparture = data[21];
    //var pPOLCodeAndName = data[22];
    //var pPODCodeAndName = data[23];
    //var pEnCompanyName = data[24];
    //var pArCompanyName = data[25];
    //var pPOrC = data[26];


    var ReportHTML = '';
    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
        ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
    //ReportHTML += '             <div class="col-xs-12"><b>' + data[2] + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t"><b>Shipper : </b>' + pShipperName + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>Consignee : </b>' + pConsigneeName + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>Notify : </b>' + pNotify1Name + '</div>';
    if ($("#cbIsOcean").prop("checked")) {
        ReportHTML += '         <div class="col-xs-12 m-l m-t-xs"><b>Vessel Name : </b>' + pVesselName + '</div>';
        ReportHTML += '         <div class="col-xs-12 m-l m-t-xs"><b>Voyage No. : </b>' + pVoyageOrTruckNumber + '</div>';
        ReportHTML += '         <div class="col-xs-12 m-l m-t-xs"><b>Port Of Loading : </b>' + pPOLCodeAndName + '</div>';
        ReportHTML += '         <div class="col-xs-12 m-l m-t-xs"><b>Port Of Discharge : </b>' + pPODCodeAndName + '</div>';
        ReportHTML += '         <div class="col-xs-12 m-l m-t-xs"><b>Container No(s) : </b>' + pContainerNumbers + '</div>';
    }
    else
        if ($("#cbIsAir").prop("checked")) {
            ReportHTML += '     <div class="col-xs-12 m-l m-t-xs"><b>Flight Date : </b>' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
            ReportHTML += '     <div class="col-xs-12 m-l m-t-xs"><b>Air Port Of Departure : </b>' + pPOLCodeAndName + '</div>';
            ReportHTML += '     <div class="col-xs-12 m-l m-t-xs"><b>Air Port Of Discharge : </b>' + pPODCodeAndName + '</div>';
            ReportHTML += '     <div class="col-xs-12 m-l m-t-xs"><b>Dimensions(cm) : </b>' + pDimensions + '</sup></div>';
        }
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>Description Of Goods: </b>' + pDescriptionOfGoods + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>TGW : </b>' + pGrossWeightSum + ' KG</div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>TNW : </b>' + pNetWeightSum + ' KG</div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>ATS : </b>' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>ETA : </b>' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div>';

    ReportHTML += '             <div class="col-xs-12 m-t-lg"><b>Operation Dept.</b></div>';
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
    //ReportHTML += '         <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ShipmentDetails(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pConsigneeName = data[4];
    var pNotify1Name = data[5];
    var pActualDeparture = data[6];
    var pExpectedArrival = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pContainerNumbers = data[11];
    var pDescriptionOfGoods = data[12];
    var pDimensions = data[13];
    var pVesselName = data[14];
    var pGrossWeightSum = data[15].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    var pNetWeightSum = data[16];
    var pClientEmail = data[17];
    var pLineName = data[18];
    var pMasterBL = data[19];
    var pBranchName = data[20];
    var pBookingNumber = data[21];
    var pPickupAddress = data[22];
    var pDeliveryAddress = data[23];

    //var pActualDeparture = data[21];
    //var pPOLCodeAndName = data[22];
    //var pPODCodeAndName = data[23];
    //var pEnCompanyName = data[24];
    //var pArCompanyName = data[25];
    //var pPOrC = data[26];


    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';

    //ReportHTML += '             <div class="col-xs-12"><b>' + data[2] + ' on: ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
    ReportHTML += '             <div class="col-xs-12 m-t-sm">';
    if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
        ReportHTML += '             <div class="col-xs-6"><b><u>OUR REF :</u> ' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
    else
        ReportHTML += '                 <div class="col-xs-6"><b><u>OUR REF :</u> </b>' + '' + '</div>';
    ReportHTML += '                 <div class="col-xs-6"><b><u>Receiver :</u> </b>' + pConsigneeName + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-12 m-t-sm">';
    ReportHTML += '                 <div class="col-xs-6 m-t-sm"><b><u>Shipper :</u> </b>' + pShipperName + '</div>';
    ReportHTML += '                 <div class="col-xs-6 m-t-sm"><b><u>Shipping Line :</u> </b>' + pLineName + '</div>';
    ReportHTML += '             </div>';

    ReportHTML += '             <br><br>';
    ReportHTML += '             <div class="row m-l m-t b-dark b-t b-r b-l b-b" style="width:100%;height:0px; clear:both;"></div>';
    ReportHTML += '             <div class="col-xs-12 text-center m-t-sm">';
    ReportHTML += '                 <div class="col-xs-2 m-t-sm"><b><u>Booking NO.</u> </b>' + '</div>';
    ReportHTML += '                 <div class="col-xs-2 m-t-sm"><b><u>B/L NO.</u> </b>' + '</div>';
    ReportHTML += '                 <div class="col-xs-4 m-t-sm"><b><u>CONT NO.</u> </b>' + '</div>';
    ReportHTML += '                 <div class="col-xs-2 m-t-sm"><b><u>Order NO.</u> </b>' + '</div>';
    ReportHTML += '                 <div class="col-xs-2 m-t-sm"><b><u>CFR NO.</u> </b>' + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-12 text-center">';
    ReportHTML += '                 <div class="col-xs-2">' + pBookingNumber + '</div>';
    ReportHTML += '                 <div class="col-xs-2">' + pMasterBL + '</div>';
    ReportHTML += '                 <div class="col-xs-4">' + pContainerNumbers + '</div>';
    ReportHTML += '                 <div class="col-xs-2">' + '' + '</div>';
    ReportHTML += '                 <div class="col-xs-2">' + '' + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <br><br>';
    ReportHTML += '             <div class="row m-l m-t b-dark b-t b-r b-l b-b" style="width:100%;height:0px; clear:both;"></div>';
    ReportHTML += '             <br><br>';


    ReportHTML += '             <div class="col-xs-12 m-t-sm">';
    ReportHTML += '                 <div class="col-xs-4"><b>M/V : </b>' + '' + '</div>';
    ReportHTML += '                 <div class="col-xs-4"><b>VOY NO. </b>' + pVoyageOrTruckNumber + '</div>';
    //ReportHTML += '                 <div class="col-xs-4"><b>Shipped on Board Date : </b>' + '' + '</div>';
    ReportHTML += '                 <div class="col-xs-4"><b>ATS : </b>' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-12 m-t-sm">';
    ReportHTML += '                 <div class="col-xs-4"><b>POL : </b>' + pPOLCodeAndName + '</div>';
    ReportHTML += '                 <div class="col-xs-4"><b>POD : </b>' + pPODCodeAndName + '</div>';
    ReportHTML += '                 <div class="col-xs-4"><b>ETA : </b>' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <div class="col-xs-12 m-t-sm">';
    if (pPickupAddress != "")
        ReportHTML += '                 <div class="col-xs-12"><b>Pickup Address : </b>' + pPickupAddress + '</div>';
    if (pDeliveryAddress != "")
        ReportHTML += '                 <div class="col-xs-12"><b>Delivery Address : </b>' + pDeliveryAddress + '</div>';
    ReportHTML += '             </div>';
    ReportHTML += '             <br><br>';
    ReportHTML += '             <div class="row m-l m-t b-dark b-t b-r b-l b-b" style="width:100%;height:0px; clear:both;"></div>';

    ReportHTML += '             <div class="col-xs-12 m-l m-t"><b>' + pDefaults.UnEditableCompanyName + '</b></div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t"><b>' + 'ABC XYZ' + '</b></div>';
    ReportHTML += '             <div class="col-xs-12 m-l m-t"><b>' + pBranchName + ' in : ' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';

    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    //ReportHTML += '         <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_BookingConfirmation(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pConsigneeName = data[4];
    var pLineName = data[5];
    var pActualDeparture = data[6];
    var pExpectedArrival = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pContainerTypes = data[11];
    var pDescriptionOfGoods = data[12];
    var pVesselName = data[13];
    var pGrossWeightSum = data[14].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    var pPackageTypes = data[15];
    var pPOrC = data[16];
    var pExpectedDeparture = data[17];
    var pClientEmail = data[18];
    var pOperationContainersAndPackages = JSON.parse(data[19]);
    var pOperationHeader = JSON.parse(data[20]);
    var pOperationTracking = JSON.parse(data[21]);
    //var pVesselName = data[21];

    //var pActualDeparture = data[21];
    //var pPOLCodeAndName = data[22];
    //var pPODCodeAndName = data[23];
    //var pEnCompanyName = data[24];
    //var pArCompanyName = data[25];
    //var pPOrC = data[26];

    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    if (pDefaults.UnEditableCompanyName == "TEU") {
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-6"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-6">';
        ReportHTML += '                 <div class="col-xs-12"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div></hr>';
        ReportHTML += '                 <div class="col-xs-12"><h4>Date : ' + ConvertDateFormat(FormattedTodaysDate) + '</h4></div></hr>';
        ReportHTML += '                 <div class="col-xs-12"><h4>Operation No. : ' + pOperationCode + '</h4></div>';
        ReportHTML += '             </div>';

        ReportHTML += '             <div class="col-xs-12"><b><h4>Booking Details: </h4></b>' + '' + '</div>';

        ReportHTML += '                         <table id="tblBookingConfirmation" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Shipper</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.ShipperName == 0 ? "" : pOperationHeader.ShipperName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Consignee</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Agent</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.AgentName == 0 ? "" : pOperationHeader.AgentName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Shipping Line</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.ShippingLineName == 0 ? "" : pOperationHeader.ShippingLineName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Booking Number</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.BookingNumbers == 0 ? "" : pOperationHeader.BookingNumbers) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Vessel</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Voy.No.</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : pOperationHeader.VoyageOrTruckNumber) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>POL</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>POD</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.PODName == 0 ? "" : pOperationHeader.PODName) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Cutoff Date</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.CutOffDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.CutOffDate)) : "") + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>ETD</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>ETA</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Transit Time</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.TransientTime == 0 ? "" : pOperationHeader.TransientTime) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>No of Containers</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Cargo Desc.</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.Description == 0 ? "" : pOperationHeader.Description) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <td style="width:20%;text-align:left;"><b>Gross Weight</b></td>';
        ReportHTML += '                                     <td style="text-align:left;">' + (pOperationHeader.GrossWeightSum == 0 ? "" : pOperationHeader.GrossWeightSum) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';

        ReportHTML += '                 <div class="col-xs-12 m-t"><b>Notes : </b>' + '' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	This Booking Confirmation forms a contract between TEU and the Merchant.' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	The Merchant is liable for all resulting increased charges, costs, expenses, losses and damages whatsoever if the description of the Goods provided at the time of booking or as amended is inaccurate, unless the inaccuracy is a result of an error or omission on the part of the Carrier, its servants or agents.' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	Goods include any packaging and any packing materials used to secure the cargo in the Container. It is the Merchant’s responsibility to ensure that packaging and packing materials, especially timber, comply with all applicable requirements and their import is permitted in the country of destination. The weight of packaging and packing must be included in the total weight declared for each Container.' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	Freight and charges are based on the instructions provided at the date of this Booking Confirmation and may change if the shipper’s instructions change.' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	There are cancellation fees will incur on Merchant if cancel shipment after get booking.' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	All above Dates Are Estimated According to the Shipping Line.' + '</div>';
        ReportHTML += '                 <div class="col-xs-12 m-t">' + '-	THC as Per Official Receipts' + '</div>';

        ReportHTML += '         </body>';
        ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '           <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
        //ReportHTML += '           <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '         </footer>';

        ReportHTML += '</html>';
    } //if (pDefaults.UnEditableCompanyName == "TEU") {
    else if (pDefaults.UnEditableCompanyName == "DYN") { //BookingConformation/ShippingAdvice/ArrivalNotice
        let reportTitle = $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text();
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Shipping Advice")
            reportTitle = "On Board Confirmation";
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + reportTitle + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div><div class="col-xs-6 text-right"><b>Date :</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + reportTitle + '</h3></div> </br>';
        //ReportHTML += '             <div> &nbsp; </div>'
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '                 <table id="tblBookingConfirmation" class="table table-striped b-t b-light  table-bordered">'; /* text-sm table-hover*/ //style="border:solid #000 !Important;"
        ReportHTML += '                     <tbody>';
        //ReportHTML += '                         <tr class="" style="font-size:120%;">';
        ReportHTML += '                         <tr class="" style="font-size:120%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b><div class="col-xs-3">Shipper</div>:</b>' + pShipperName + '</div><div class="col-xs-6"><b><div class="col-xs-3">Consignee</div>:</b> ' + pConsigneeName + '</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                         <tr class="" style="font-size:120%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b><div class="col-xs-3">POL</div>:</b>' + pPOLCodeAndName + '</div><div class="col-xs-6"><b><div class="col-xs-3">POD</div>:</b> ' + pPODCodeAndName + '</div></td>';
        ReportHTML += '                         </tr>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Shipping Advice") {
            ReportHTML += '                         <tr class="" style="font-size:120%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b><div class="col-xs-3">Onboard</div>:</b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div><div class="col-xs-6"><b><div class="col-xs-3">ETA</div>:</b> ' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div></td>';
            ReportHTML += '                         </tr>';
        }
        else if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() == "Arrival Notification") {
            ReportHTML += '                         <tr class="" style="font-size:120%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b><div class="col-xs-3">Onboard</div>:</b>' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div><div class="col-xs-6"><b><div class="col-xs-3">Arrival</div>:</b>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival)) : "") + '</div></td>';
            ReportHTML += '                         </tr>';
        }
        else { //BookingConfirmation
            ReportHTML += '                         <tr class="" style="font-size:120%;">';
            ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b><div class="col-xs-3">ETS</div>:</b>' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? "N/A" : pExpectedDeparture) + '</div><div class="col-xs-6"><b><div class="col-xs-3">ETA</div>:</b>' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div></td>';
            ReportHTML += '                         </tr>';
        }
        ReportHTML += '                         <tr class="" style="font-size:120%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b><div class="col-xs-3">Containers</div>:</b>' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '</div><div class="col-xs-6"><b><div class="col-xs-3">Carrier</div>:</b> ' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</div></td>';
        ReportHTML += '                         </tr>';

        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';

        ReportHTML += '                 <div class="col-xs-12 m-l"><b>**All rates are subject to change & space availability upon booking.</b></div>';
        ReportHTML += '                 <div class="col-xs-12 m-l"><b>**Due to worldwide situation flights and vessels voyages may be postponed or canceled without prior notice.</b></div>';

        ReportHTML += '         </body>';
        ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '           <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
        //ReportHTML += '           <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '         </footer>';

        ReportHTML += '</html>';
    } //if (pDefaults.UnEditableCompanyName == "DYN")
    else { //Other Companies
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '             <div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div><div class="col-xs-6 text-right"><b>Date :</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
        ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        //ReportHTML += '             <div> &nbsp; </div>'
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '                 <table id="tblBookingConfirmation" class="table table-striped b-t b-light text-sm  table-bordered">'; /*table-hover*/ //style="border:solid #000 !Important;"
        ReportHTML += '                     <tbody>';
        //ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                         <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Shipper :</b> ' + pShipperName + '</div><div class="col-xs-6"><b>Consignee :</b> ' + pConsigneeName + '</div></td>';
        ReportHTML += '                         </tr>';
        if ($("#cbIsOcean").prop("checked")) {
            ReportHTML += '                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                         <td style="text-align:left!Important;"><div class="col-xs-6"><b>Shipping Line :</b> ' + pLineName + '</div><div class="col-xs-6"><b>No. of Containers :</b> ' + pContainerTypes + '</div></td>';
            ReportHTML += '                     </tr>';
            ReportHTML += '                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                         <td style="text-align:left!Important;"><div class="col-xs-6"><b>Vessel Name :</b> ' + pVesselName + '</div><div class="col-xs-6"><b>Voyage No. :</b> ' + pVoyageOrTruckNumber + '</div></td>';
            ReportHTML += '                     </tr>';
            if ($("#cbIsExport").prop("checked")) { //Export Ocean
                ReportHTML += '                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                     <td style="text-align:left!Important;"><div class="col-xs-6"><b>Cut Off :</b> ' + '' + '</div><div class="col-xs-6"><b>Final SI :</b> ' + '' + '</div></td>';
                ReportHTML += '                 </tr>';
                ReportHTML += '                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                     <td style="text-align:left!Important;"><div class="col-xs-6"><b>Stuffing Date :</b> ' + '' + '</div><div class="col-xs-6"><b>Stuffing Place :</b> ' + '' + '</div></td>';
                ReportHTML += '                 </tr>';
            } //EOF if export ocean
            ReportHTML += '                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                         <td style="text-align:left!Important;"><div class="col-xs-6"><b>E.T.S :</b> ' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? "N/A" : pExpectedDeparture) + '</div><div class="col-xs-6"><b>E.T.A :</b> ' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div></td>';
            ReportHTML += '                     </tr>';
            ReportHTML += '                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                         <td style="text-align:left!Important;"><div class="col-xs-6"><b>P.O.L :</b> ' + pPOLCodeAndName + '</div><div class="col-xs-6"><b>P.O.D :</b> ' + pPODCodeAndName + '</div></td>';
            ReportHTML += '                     </tr>';
        }
        else
            if ($("#cbIsAir").prop("checked")) {
                ReportHTML += '                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                     <td style="text-align:left!Important;"><div class="col-xs-6"><b>Air Line :</b> ' + pLineName + '</div><div class="col-xs-6"><b>No. of Packages :</b> ' + pPackageTypes + '</div></td>';
                ReportHTML += '                 </tr>';
                if ($("#cbIsExport").prop("checked")) { //Export Air
                    ReportHTML += '             <tr class="" style="font-size:95%;">';
                    ReportHTML += '                 <td style="text-align:left!Important;"><div class="col-xs-6"><b>Flight Date :</b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div><div class="col-xs-6"><b>Flight No. :</b> ' + pVoyageOrTruckNumber + '</div></td>';
                    ReportHTML += '             </tr>';
                    ReportHTML += '             <tr class="" style="font-size:95%;">';
                    ReportHTML += '                 <td style="text-align:left!Important;"><div class="col-xs-6"><b>E.T.A :</b> ' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div><div class="col-xs-6"><b>Stuffing Place :</b> ' + '' + '</div></td>';
                    ReportHTML += '             </tr>';
                } // EOF if export air
                else { //Import Air
                    ReportHTML += '             <tr class="" style="font-size:95%;">';
                    ReportHTML += '                 <td style="text-align:left!Important;"><div class="col-xs-6"><b>Stuffing Date :</b> ' + '' + '</div><div class="col-xs-6"><b>Stuffing Place :</b> ' + '' + '</div></td>';
                    ReportHTML += '             </tr>';
                    ReportHTML += '             <tr class="" style="font-size:95%;">';
                    ReportHTML += '                 <td style="text-align:left!Important;"><div class="col-xs-6"><b>E.T.S :</b> ' + (pExpectedDeparture == "01/01/1900" || pExpectedDeparture == "1/1/1900" ? "N/A" : pExpectedDeparture) + '</div><div class="col-xs-6"><b>E.T.A :</b> ' + (pExpectedArrival == "01/01/1900" || pExpectedArrival == "1/1/1900" ? "N/A" : pExpectedArrival) + '</div></td>';
                    ReportHTML += '             </tr>';
                } //else Import Air
                ReportHTML += '                 <tr class="" style="font-size:95%;">';
                ReportHTML += '                     <td style="text-align:left!Important;"><div class="col-xs-6"><b>Air Port of Departure :</b> ' + pPOLCodeAndName + '</div><div class="col-xs-6"><b>Air Port of Destination :</b> ' + pPODCodeAndName + '</div></td>';
                ReportHTML += '                 </tr>';
            }//else if air

        ReportHTML += '                         <tr class="" style="font-size:95%;">';
        ReportHTML += '                             <td style="text-align:left!Important;"><div class="col-xs-6"><b>Cargo Description :</b> ' + pDescriptionOfGoods + '</div><div class="col-xs-6"><b>Gross Weight :</b> ' + pGrossWeightSum + ' KG</div></td>';
        ReportHTML += '                         </tr>';
        ReportHTML += '                     </tbody>';
        ReportHTML += '                 </table>';

        if (pDefaults.UnEditableCompanyName == "OAO" || pDefaults.UnEditableCompanyName == "STR") {
            if ($("#cbIsOcean").prop("checked") && (pOperationHeader.ShipmentTypeCode == "FCL" || pOperationHeader.ShipmentTypeCode == "CONSOL")) { // table is shown only in final shipping
                ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
                ReportHTML += '                             <thead>';
                ReportHTML += '                                 <tr>';
                ReportHTML += '                                     <th>Container(s)</th>';
                ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
                ReportHTML += '                                     <th>NetWgt(KG)</th>';
                ReportHTML += '                                     <th>GrossWgt(KG)</th>';
                //if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL")
                //ReportHTML += '                                     <th>VGM(KG)</th>';
                ReportHTML += '                                 </tr>';
                ReportHTML += '                             </thead>';
                ReportHTML += '                             <tbody>';
                $.each(pOperationContainersAndPackages, function (i, item) { //no final shipping declaration for air
                    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
                    ReportHTML += '                                     <td>' + (item.MarksAndNumbers == 0 ? "" : item.MarksAndNumbers)
                        + (item.IsReefer & !item.IsNOR ? ("<br>MinTemp:" + item.MinTemp + "C " + "Max:" + item.MaxTemp + "C " + "Vent:" + item.Ventilation + " Humid:" + item.Humidity) : "")
                        + '</td>';
                    //ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + ": " + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td>' + (item.PackageTypeNameOnContainer == "0" ? "" : (item.NumberOfPackagesOnContainer + 'x' + item.PackageTypeNameOnContainer) + (item.DescriptionOfGoods == 0 ? "" : (": " + item.DescriptionOfGoods))) + '</td>';
                    ReportHTML += '                                     <td>' + item.NetWeight + '</td>';
                    ReportHTML += '                                     <td>' + item.GrossWeight + '</td>';
                    //ReportHTML += '                                     <td>' + item.VGM + '</td>';
                    ReportHTML += '                                 </tr>';

                });
                //ReportHTML += '                                 <tr>';
                //ReportHTML += '                                     <td colspan=2><b>Totals:</b> ' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td>';
                //ReportHTML += '                                 </tr>';

                ReportHTML += '                             </tbody>';
                ReportHTML += '                         </table>';
            }//if ($("#cbIsOcean").prop("checked") && (pOperationHeader.ShipmentTypeCode == "FCL" || pOperationHeader.ShipmentTypeCode == "CONSOL")) { // table is shown only in final shipping
        }//if (pDefaults.UnEditableCompanyName == "OAO" || pDefaults.UnEditableCompanyName == "STR") {

        ReportHTML += '                 <div class="col-xs-12 m-l m-t"><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'
        ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>'

        ReportHTML += '                 <div class="col-xs-12 m-l m-t-xs"><b>Rate : </b>' + '' + '</div>';
        if ($("#cbIsAir").prop("checked")) //Air
            ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>BL Fees : </b>' + '' + '</div>';
        else { //Ocean
            ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>THC : </b>' + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As Per Official Receipts' + '</div>';
            ReportHTML += '             <div class="col-xs-12 m-l m-t-xs"><b>BL Fees : </b>' + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Days' + '</div>';
        }
        ReportHTML += '                 <div class="col-xs-12 m-t-lg"><b>NB: All above Dates Are Estimated According To the Shipping Line.</b></div>';
        ReportHTML += '                 <div class="col-xs-12 m-l"><b>Instructions & Subject to Change.</b></div>';

        ReportHTML += '         </body>';
        ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '           <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
        //ReportHTML += '           <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '         </footer>';

        ReportHTML += '</html>';
    }//EOF Other Companies
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_TruckingOrder(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pTruckingOrderClientName = data[3];
    var pTruckingOrderClientAddress = data[4];
    var pTruckingOrderClientContactName = data[5];
    var pTruckingOrderGensetSupplierName = data[6];
    var pTruckingOrderCCAName = data[7];
    var pTruckingOrderQuantity = data[8];
    var pTruckingOrderGateInPort = data[9];
    var pTruckingOrderGateOutPort = data[10];
    var pTruckingOrderGateInDate = data[11];
    var pTruckingOrderGateOutDate = data[12];
    var pTruckingOrderStuffingDate = data[13];
    var pTruckingOrderDeliveryDate = data[14];
    var pTruckingOrderBookingNumber = data[15];
    var pTruckingOrderDelays = data[16];
    var pTruckingOrderPowerFromGateInTillActualSailing = data[17];
    var pLineName = data[18];
    var pTruckingOrderTruckerName = data[19];
    var pIsGenset = data[20];
    var pTruckingOrderContactPerson = data[21];
    var pTruckingOrderPickupAddress = data[22];
    var pTruckingOrderDeliveryAddress = data[23];
    var pCCAContactName = data[24];
    var pCCAPhones = data[25];
    var pTruckingOrderContactPersonPhones = data[26];
    var pTruckingOrderLoadingTime = data[27];
    var pTruckingOrderNotes = data[28];
    var pOperationHeader = JSON.parse(data[29]);
    var pOperationContainerAndPAckages = JSON.parse(data[30]);
    var pTruckingOrder = JSON.parse(data[31]);

    if (pDefaults.UnEditableCompanyName == "ELI") {

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h2><b>' + ' طلب نقل ' + '-' + ($("#cbPrintAsBosla").prop("checked") ? '  بوصلة  ' : '  شهادة  ') + '</b></h2></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h2><b>' + ' طلب نقل ' + '-' + ($("#cbPrintAsBosla").prop("checked") ? '  بوصلة  ' : '  شهادة  ') + '</b></h2></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderGateOutPort + '<b><span class="float-right">' + ' : سحب ميناء   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderGateInPort + '<b><span class="float-right">' + ' : دخول ميناء   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '<b><span class="float-right">' + ' : رقم العملية   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderBookingNumber + '<b><span class="float-right">' + ' : رقم الحجز   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + (pTruckingOrder.length == 0 ? "" : pTruckingOrder[0].EquipmentModelName) + '<b><span class="float-right">' + ' :  النوع   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right m-t-lg" style="font-size:14px;">' + pTruckingOrderTruckerName + '<b><span class="float-right">' + ' / السادة شركة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-center" style="font-size:16px;">' + '<b>' + ' ،،، تحية طيبة وبعد   ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right m-t-lg" style="font-size:14px;">' + pTruckingOrderQuantity + '<b> <span class="float-right">' + ' : الرجاء التكرم بعمل اللازم لنقل   ' + '<span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderClientName + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        if (pDefaults.UnEditableCompanyName != "ELI")
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ClientAddress == 0 ? "" : pOperationHeader.ClientAddress) + '<b><span class="float-right">' /*+ ' / العنوان   ' */ + '</span></b></div>';
        if (pOperationHeader.TransportType != AirTransportType && pOperationHeader.ShippingLineName != 0)
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ShippingLineName == 0 ? "" : pOperationHeader.ShippingLineName) + '<b><span class="float-right">' + ' / على خط ملاحى   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + '<b>' + ' ميعاد التحميل  ' + ' / ' + ' يوم  ' + getDayInLetters(pTruckingOrderStuffingDate, 2) + ' ' + pTruckingOrderStuffingDate + '  الساعة  ' + ' / ' + pTruckingOrderLoadingTime + '</b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderPickupAddress + '<b><span class="float-right">' + ' / عنوان التحميل مفصلا  ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderDeliveryAddress + '<b><span class="float-right">' + ' / عنوان التسليم مفصلا  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderPickupAddress + (pTruckingOrderDeliveryAddress == "" ? "" : (' --> ' + pTruckingOrderDeliveryAddress)) + '<b><span class="float-right">' + ' / العنوان مفصلا  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderContactPerson + '<b><span class="float-right">' + ' / مندوب العمل أو مسؤول التحميل   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderContactPersonPhones + '<b><span class="float-right">' + ' / رقم التليفون   ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '<b><span class="float-right">' + ' / ملحوظات هامة   ' + '</span></b></div>';

        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + '<b><span class="float-right">' + ($('#slRoutingCCATruckingOrder  option:selected').text() == "<--Select-->" ? "" : $('#slRoutingCCATruckingOrder  option:selected').text()) + ' : اسم المستخلص   ' + '</span></b></div>';

        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + '<b><span class="float-right">' + ' : ملحوظات هامة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:15px; clear:both;"">' + '<b><span class="float-right">' + '    ضرورة ارسال الحاويات صباحا مع اسرار السائق على توقيع مسئول الشحن على مواعيد حضور وانصراف السيارة_  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:15px; clear:both;"">' + '<b><span class="float-right">' + 'نظافة الحاويات وسلامتها داخليا وخارجيا مسئولية شركة النقل مسئولية كاملة وفى حال عدم مطابقتها للمواصفات يتم ارجاعها_  ' + '</span></b></div>';


        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '             <div class="col-xs-7 text-center m-t-lg" style="font-size:16px;">' + '' + '<b>' + '    مقدمه لسيادتكم  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + $("#hDefaultCompanyName").val() + '<b>' /*+ '  /  شركة   '*/ + '</b></div>';
        ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + '' + '<b>' + '  /  المسؤول    ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-7 text-center m-t-lg" style="font-size:16px; clear:both;">' + '<b>' + ' ،،،،،،،،، وتفضلوا بقبول وافر الاحترام والتقدير   ' + '</b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        ReportHTML += '         <div class="row text-right m-r" style="font-size:20px;"><b>   برجاء  تسليم  اصل موازين المصنع  + علوم  الميزان  الي قسم التخليص    </b></div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "ELI") {
    else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") { //other companies

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h2><b>' + 'Trucking Order' + '</b></h2></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h2><b>' + 'Trucking Order' + '</b></h2></div>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-6" style="font-size:14px;">' + '<b>' + '  Gate-In : ' + '</b>' + pTruckingOrderGateInPort + '</div>';
        ReportHTML += '             <div class="col-xs-6" style="font-size:14px;">' + '<b>' + '  Gate-Out :  ' + '</b>' + pTruckingOrderGateOutPort + '</div>';
        ReportHTML += '             <div class="col-xs-6" style="font-size:14px;">' + '<b>' + '  Booking Number :  ' + '</b>' + pTruckingOrderBookingNumber + '</div>';
        ReportHTML += '             <div class="col-xs-6" style="font-size:14px;">' + '<b>' + '  Operation :   ' + '</b>' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg" style="font-size:14px;"><br>' + '<b>' + ' Dear Messers / ' + '</b>' + pTruckingOrderTruckerName + '</div>';
        ReportHTML += '             <div class="col-xs-12 text-center" style="font-size:16px;">' + '<b>' + '&emsp;<br>' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-t-lg" style="font-size:14px;">' + '<b>' + '  Please, Do the necessary regulations for :  ' + '</b>' + pTruckingOrderQuantity + '</div>';
        //ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + pTruckingOrderClientName + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        if (pDefaults.UnEditableCompanyName == "CQL") {
            if (pOperationHeader.DirectionType == 2)//Export
                ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + (pOperationHeader.ShipperLocalName == 0 ? "" : pOperationHeader.ShipperLocalName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
            else if (pOperationHeader.DirectionType == 1)//Import
                ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + (pOperationHeader.ConsigneeLocalName == 0 ? "" : pOperationHeader.ConsigneeLocalName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        }
        else
            ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + '<b>' + ' Client :  ' + '</b>' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '</div>';
        if (pDefaults.UnEditableCompanyName != "ELI")
            ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + (pOperationHeader.ClientAddress == 0 ? "" : pOperationHeader.ClientAddress) + '</div>';
        if (pCCAContactName != 0 && pCCAContactName != "") {
            ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + '<b>' + ' Clearance Agent :  ' + '</b>' + (pCCAContactName == 0 ? "" : pCCAContactName) + '</div>';
            ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + '<b>' + ' Clearance Agent Phones :   ' + '</b>' + (pCCAPhones == 0 ? "" : pCCAPhones) + '</div>';
        }
        if (pOperationHeader.TransportType != AirTransportType && pOperationHeader.ShippingLineName != 0)
            ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + '<b>' + ' Line :   ' + (pOperationHeader.ShippingLineName == 0 ? "" : pOperationHeader.ShippingLineName) + '</b></div>';
        ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + '<b>' + ' StuffingDate :  ' + pTruckingOrderStuffingDate + ' - Loading Time  ' + '  ' + pTruckingOrderLoadingTime + '</b></div>';
        //ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + pTruckingOrderPickupAddress + '<b><span class="float-right">' + ' / عنوان التحميل مفصلا  ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + pTruckingOrderDeliveryAddress + '<b><span class="float-right">' + ' / عنوان التسليم مفصلا  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12" style="font-size:14px; clear:both;"">' + '<b>' + ' Address :  ' + '</b>' + pTruckingOrderPickupAddress + (pTruckingOrderDeliveryAddress == "" ? "" : (' --> ' + pTruckingOrderDeliveryAddress)) + '</div>';
        ReportHTML += '             <div class="col-xs-12" style="font-size:14px; clear:both;"">' + '<b>' + ' Contact Person :  ' + '</b>' + pTruckingOrderContactPerson + '</div>';
        ReportHTML += '             <div class="col-xs-12" style="font-size:14px; clear:both;"">' + '<b>' + ' Contact Person Phones : ' + '</b>' + pTruckingOrderContactPersonPhones + '</div>';
        //ReportHTML += '             <div class="col-xs-12" style="font-size:14px;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '<b><span class="float-right">' + ' / ملحوظات هامة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12" style="font-size:14px; clear:both;"">' + '<b>' + ' Notes:  ' + '</b>' + '</div>';
        ReportHTML += '             <div class="col-xs-12" style="font-size:14px; clear:both;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '</div>';

        ReportHTML += '             <div class="col-xs-12 m-t-sm" style="font-size:16px; clear:both;"><br>' + $("#hDefaultCompanyName").val() + '<b>' /*+ '  /  شركة   '*/ + '</b></div>';
        if (pDefaults.UnEditableCompanyName != "BME") {
            //ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + '' + '<b>' + '  /  المسؤول    ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-12 m-t-lg" style="font-size:16px; clear:both;">' + '<b>' + ' Thanks and best regards ......... ' + '</b></div>';
        }
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA")
    else if (pDefaults.UnEditableCompanyName == "ELC") {

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h2><b>' + ' بوليصة نقل ' + '-' + ($("#cbPrintAsBosla").prop("checked") ? '  بوصلة  ' : '  شهادة  ') + '</b></h2></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h2><b>' + ' بوليصة نقل ' + '-' + ($("#cbPrintAsBosla").prop("checked") ? '  بوصلة  ' : '  شهادة  ') + '</b></h2></div>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        /////////////ELC Start

        ReportHTML += '             <div class="row col-xs-12">';

        ReportHTML += '             <div class="col-xs-2">';
        ReportHTML += '             <div class=" row col-xs-12 text-right" style="font-size:14px;">  <div style=" float: right; height: 20px;  width: 20px;  background-color: white;  border-style: solid;  border-color: black;  border-width: 1px;  border-radius: 5px;"><b><span style="font-size: 20px;margin-left: 50px;"> دخيلة </span></b></div></div><br>';
        ReportHTML += '             <div class=" row col-xs-12 text-right" style="font-size:14px;">  <div style=" float: right; height: 20px;  width: 20px;  background-color: white;  border-style: solid;  border-color: black;  border-width: 1px;  border-radius: 5px;"><b><span style="font-size: 20px;margin-left: 40px;"> اسكندرية </span></b></div></div>';
        ReportHTML += '             </div>';
        ReportHTML += '             <div class="col-xs-6">';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderStuffingDate + '<b><span class="float-right"> : تاريخ الوصول للعميل   </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pOperationHeader.ClientName + '<b><span class="float-right">  : اسم العميل </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderClientAddress + '<b><span class="float-right"> : العنوان   </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pCCAPhones + '<b><span class="float-right"> : رقم التليفون   </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderQuantity + '<b><span class="float-right">' + ' : عدد الحاويات   ' + '</span></b></div>';
        ReportHTML += '             </div>';
        ReportHTML += '             <div class="col-xs-4">';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + getTodaysDateInddMMyyyyFormat() + '<b><span class="float-right">  : تحريرا فى    </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrder[0].DriverName + '<b><span class="float-right"> : اسم السائق   </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrder[0].VoyageOrTruckNumber + '<b><span class="float-right"> : رقم السيارة</span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderPickupAddress + '<b><span class="float-right">  : الجهة  </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderBookingNumber + '<b><span class="float-right">  : رقم اذن الشحن  </span></b></div>';
        ReportHTML += '             </div>';

        ReportHTML += '             </div>';
        ReportHTML += '             <div class=" row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right" style="font-size:24px;">  إي.إل.سي  إكسبريس  </span></b></div>';
        ReportHTML += '             <div class=" row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right" style="font-size:24px; text-decoration: underline;"> E.L.C Express For International Logistics  </span></b></div>';
        ReportHTML += '             <div class=" row col-xs-12 text-center" style="font-size:14px;"><b><span style="font-size:24px;">' + pTruckingOrder[0].BillNumber + ' بوليصة نقل ' + '</span></b></div>';


        ReportHTML += '             <div class="row col-xs-12">';
        ReportHTML += '             <div class="col-xs-2">';
        ReportHTML += '             <div class=" row col-xs-12 text-right" style="font-size:14px;">  <div style=" float: right; height: 20px;  width: 20px;  background-color: white;  border-style: solid;  border-color: black;  border-width: 1px;  border-radius: 5px;"><b><span style="font-size: 20px;margin-left: 50px;"> دخيلة </span></b></div></div><br>';
        ReportHTML += '             <div class=" row col-xs-12 text-right" style="font-size:14px;">  <div style=" float: right; height: 20px;  width: 20px;  background-color: white;  border-style: solid;  border-color: black;  border-width: 1px;  border-radius: 5px;"><b><span style="font-size: 20px;margin-left: 40px;"> اسكندرية </span></b></div></div>';
        ReportHTML += '             </div>';
        ReportHTML += '             <div class="col-xs-6" style="margin-top:30px;">';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right">' + ' : رقم البطاقة   ' + '</span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right">' + '  : رقم الرخصة  ' + '</span></b></div>';
        ReportHTML += '             </div>';
        ReportHTML += '             <div class="col-xs-4">';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + getTodaysDateInddMMyyyyFormat() + '<b><span class="float-right">' + '  : تحريرا فى    ' + '</span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrder[0].TruckerName + '<b><span class="float-right">' + ' : اسم الراسل   ' + '</span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrder[0].DriverName + '<b><span class="float-right">' + '  : اسم السائق  ' + '</span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrder[0].DriverPhones + '<b><span class="float-right">' + '  : رقم االسائق  ' + '</span></b></div>';
        ReportHTML += '             </div>';
        ReportHTML += '             </div>';

        ReportHTML += '            <hr style="border-top:1px solid #171717;width:80%;"> ';
        //ReportHTML += '            <hr style="border-top:1px solid #171717;width:80%;> ';

        ReportHTML += '             <div class="row col-xs-12">';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;"><b><span class="float-right">' + ' : الساعة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderStuffingDate + '<b><span class="float-right">' + ': تاريخ الوصول للعميل' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-1 text-right" style="font-size:14px;"><b><span class="float-right">   </span></b></div>';
        ReportHTML += '             <div class="col-xs-11 text-right" style="font-size:14px;">' + pOperationHeader.ClientName + '<b><span class="float-right">' + ' : اسم العميل   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderPickupAddress + '<b><span class="float-right">' + '  : الجهة  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderClientAddress + '<b><span class="float-right">' + '  : العنوان  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderNotes + '<b><span class="float-right">' + '  : ملاحظات  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pCCAPhones + '<b><span class="float-right">' + '  : رقم التليفون  ' + '</span></b></div>';

        //ReportHTML += '             <div class="col-xs-4"><span class="float-right"></span>';
        //ReportHTML += '             </div>';
        //ReportHTML += '             <div class="col-xs-4" style="margin-top:30px;">';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right">' + ' : الساعة   ' + '</span></b></div>';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderPickupAddress + '<b><span class="float-right">' + '  : الجهة  ' + '</span></b></div>';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right"></span></b></div>';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderNotes + '<b><span class="float-right">' + '  : ملاحظات  ' + '</span></b></div>';
        //ReportHTML += '             </div>';
        //ReportHTML += '             <div class="col-xs-4">';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderStuffingDate + '<b><span class="float-right">' + ': تاريخ الوصول للعميل' + '</span></b></div>';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pOperationHeader.ClientName + '<b><span class="float-right">' + ' : اسم العميل   ' + '</span></b></div>';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderClientAddress + '<b><span class="float-right">' + '  : العنوان  ' + '</span></b></div>';
        //ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;">' + pCCAPhones + '<b><span class="float-right">' + '  : رقم التليفون  ' + '</span></b></div>';
        //ReportHTML += '             </div>';
        ReportHTML += '             </div>';

        ReportHTML += '            <hr style="border-top:1px solid #171717;width:80%;"> ';
        ReportHTML += '             <div class=" row col-xs-12 text-center" style="font-size:14px;"><b><span style="font-size:18px;"> بيانات الحاويات والبضاعة </span></b></div>';

        ReportHTML += '             <div class=" row col-xs-12 " style="margin-left: 6px; ">';
        ReportHTML += '                         <table id="tblContainers" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
        ReportHTML += '                                 <tr class="" style="">';
        ReportHTML += '                                     <td rowspan="2">' + '<b>ملاحظات</b>' + '</td>';
        ReportHTML += '                                     <td rowspan="2">' + '<b>أرقام الحاويات' + '</b></td>';
        ReportHTML += '                                     <td rowspan="2">' + '<b>رقم الاذن' + '</b></td>';
        ReportHTML += '                                     <td colspan="2">' + '<b>الوزن' + '</b></td>';
        ReportHTML += '                                     <td rowspan="2">' + '<b>عدد الطرود' + '</b></td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="">';
        ReportHTML += '                                     <td>طن</td>';
        ReportHTML += '                                     <td>كيلو</td>';
        ReportHTML += '                                 </tr>';
        $.each(pOperationContainerAndPAckages, function (i, item) {
            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
            ReportHTML += '                                         <td>' + (item.ContainerNumber == 0 ? '' : item.ContainerNumber) + '</td>';
            ReportHTML += '                                         <td> ' + (item.BookingNumber == 0 ? '' : item.BookingNumber) + '</td>';
            ReportHTML += '                                         <td>' + (item.GrossWeight == 0 ? '' : (item.GrossWeight / 1000)) + '</td>';
            ReportHTML += '                                         <td>' + (item.GrossWeight == 0 ? '' : item.GrossWeight) + '</td>';
            ReportHTML += '                                         <td>' + (item.NumberOfPackagesOnContainer == 0 ? '' : item.NumberOfPackagesOnContainer) + ' x ' + (item.PackageTypeNameOnContainer == 0 ? '' : item.PackageTypeNameOnContainer) + '</td>';
        });

        ReportHTML += '            </table> </div>';

        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right">.أتعهد أنا الموقع على هذه البوليصة والموضح بياناتي بعاليه بأنني استملت مشمول هذا الايصال وأصبح بصفة أمانة طرفي بحالة جيدة  وأصبحت مسئولا عنها متضامنا مع صاحب السيارة مسئولية تامه ضد كافة الأخطار أو الحوادث أو السرقات والضياع أو التلف أو أي شىء أخر </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right"> : ملاحظات  </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right">      فى حالة وجود عجز بالبضاعة يتم حجز السيارة بمكان التعتيق وعمل الاجراءات القانونية وعدم خروجها من المخزن وعمل تحفظ عليها    </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right"> .هذه البوليصة هي ايصال اسلام للسائق وصاحب السيارة حتى لو لم يوقعوا عليها ويعتبر خروجهم من الميناء بالبضاعة بمثابة استلام لها وتسليمها فى المكان والميعاد المحدد </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span class="float-right"> .فى حالة التأخر عن ارسال البضاعة أو عودة الحاويات فارغة أكون مسئول عن أى غرامات تحدث تبعة ذلك مع تعهدى بعودة الحاويات وتسليمها الى الجمارك  </span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;"><b><span class="float-right">' + ' : توقيع السائق   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;"><b><span class="float-right">' + ' : توقيع مندوب النقل   ' + '</span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-center" style="font-size:14px;"><b><span> استلام مخازن المرسل اليه  </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span> /استلمت أنا السيد    </span></b></div>';
        ReportHTML += '             <div class="row col-xs-12 text-right" style="font-size:14px;"><b><span> البضاعة الموضحة بعاليه بحالة جيدة ومطابقة للعدد والوزن    </span></b></div>';


        ReportHTML += '             <div class=" row col-xs-12 ">';
        ReportHTML += '                         <table id="tblCustomers" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important; margin-left: 6px; ">';  //table-hover
        ReportHTML += '                                 <tr class="" style="">';
        ReportHTML += '                                     <td>' + '<b>خروج من العميل</b>' + '</td>';
        ReportHTML += '                                     <td>' + '<b>وصول للعميل</b>' + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="">';
        ReportHTML += '                                     <td>' + '<b style="float:right;">التاريخ</b><br><br><b style="float:right;">الساعة</b>' + '</td>';
        ReportHTML += '                                     <td>' + '<b style="float:right;">التاريخ</b><br><br><b style="float:right;">الساعة</b>' + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                         </table></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;"><b><span class="float-right">' + ' : توقيع مستلم البضاعة   ' + '</span></b></div>';

        ////////////ELC END

        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        //if (pCCAContactName != 0 && pCCAContactName != "") {
        //    ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pCCAContactName == 0 ? "" : pCCAContactName) + '<b><span class="float-right">' + ' / المخلص   ' + '</span></b></div>';
        //    ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pCCAPhones == 0 ? "" : pCCAPhones) + '<b><span class="float-right">' + ' / تليفون المخلص   ' + '</span></b></div>';
        //}
        //if (pOperationHeader.TransportType != AirTransportType && pOperationHeader.ShippingLineName != 0)
        //    ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ShippingLineName == 0 ? "" : pOperationHeader.ShippingLineName) + '<b><span class="float-right">' + ' / على خط ملاحى   ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + '<b>' + ' میعاد التحمیل  ' + ' / ' + ' يوم  ' + getDayInLetters(pTruckingOrderStuffingDate, 2) + ' ' + pTruckingOrderStuffingDate + '  الساعة  ' + ' / ' + pTruckingOrderLoadingTime + '</b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderPickupAddress + (pTruckingOrderDeliveryAddress == "" ? "" : (' --> ' + pTruckingOrderDeliveryAddress)) + '<b><span class="float-right">' + ' / العنوان مفصلا  ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderContactPerson + '<b><span class="float-right">' + ' / مندوب العمل أو مسؤول التحميل   ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderContactPersonPhones + '<b><span class="float-right">' + ' / رقم التليفون   ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + '<b><span class="float-right">' + ' : ملحوظات هامة   ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '</div>';
        //if (pDefaults.UnEditableCompanyName != "BME")
        //    ReportHTML += '             <div class="col-xs-7 text-center m-t-lg" style="font-size:16px;">' + '' + '<b>' + '    مقدمه لسيادتكم  ' + '</b></div>';
        //ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + $("#hDefaultCompanyName").val() + '<b>' /*+ '  /  شركة   '*/ + '</b></div>';
        //if (pDefaults.UnEditableCompanyName != "BME") {
        //    ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + '' + '<b>' + '  /  المسؤول    ' + '</b></div>';
        //    ReportHTML += '             <div class="col-xs-7 text-center m-t-lg" style="font-size:16px; clear:both;">' + '<b>' + ' ،،،،،،،،، وتفضلوا بقبول وافر الاحترام والتقدير   ' + '</b></div>';
        //}
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    }
    else { //other companies

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h2><b>' + ' تكليف نقل ' + '-' + ($("#cbPrintAsBosla").prop("checked") ? '  بوصلة  ' : '  شهادة  ') + '</b></h2></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h2><b>' + ' تكليف نقل ' + '-' + ($("#cbPrintAsBosla").prop("checked") ? '  بوصلة  ' : '  شهادة  ') + '</b></h2></div>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderGateOutPort + '<b><span class="float-right">' + ' : سحب ميناء   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderGateInPort + '<b><span class="float-right">' + ' : دخول ميناء   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + (pOperationHeader.Code == 0 ? pOperationHeader.MasterOperationCode : pOperationHeader.Code) + '<b><span class="float-right">' + ' : رقم العملية   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-6 text-right" style="font-size:14px;">' + pTruckingOrderBookingNumber + '<b><span class="float-right">' + ' : رقم الحجز   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right m-t-lg" style="font-size:14px;">' + pTruckingOrderTruckerName + '<b><span class="float-right">' + ' / السادة شركة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-center" style="font-size:16px;">' + '<b>' + ' ،،، تحية طيبة وبعد   ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right m-t-lg" style="font-size:14px;">' + pTruckingOrderQuantity + '<b> <span class="float-right">' + ' : الرجاء التكرم بعمل اللازم لنقل   ' + '<span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderClientName + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        if (pDefaults.UnEditableCompanyName == "CQL") {
            if (pOperationHeader.DirectionType == 2)//Export
                ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ShipperLocalName == 0 ? "" : pOperationHeader.ShipperLocalName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
            else if (pOperationHeader.DirectionType == 1)//Import
                ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ConsigneeLocalName == 0 ? "" : pOperationHeader.ConsigneeLocalName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        }
        else
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ClientName == 0 ? "" : pOperationHeader.ClientName) + '<b><span class="float-right">' + ' / باسم شركة   ' + '</span></b></div>';
        if (pDefaults.UnEditableCompanyName != "ELI")
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ClientAddress == 0 ? "" : pOperationHeader.ClientAddress) + '<b><span class="float-right">' /*+ ' / العنوان   ' */ + '</span></b></div>';
        if (pCCAContactName != 0 && pCCAContactName != "") {
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pCCAContactName == 0 ? "" : pCCAContactName) + '<b><span class="float-right">' + ' / المخلص   ' + '</span></b></div>';
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pCCAPhones == 0 ? "" : pCCAPhones) + '<b><span class="float-right">' + ' / تليفون المخلص   ' + '</span></b></div>';
        }
        if (pOperationHeader.TransportType != AirTransportType && pOperationHeader.ShippingLineName != 0)
            ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pOperationHeader.ShippingLineName == 0 ? "" : pOperationHeader.ShippingLineName) + '<b><span class="float-right">' + ' / على خط ملاحى   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + '<b>' + ' میعاد التحمیل  ' + ' / ' + ' يوم  ' + getDayInLetters(pTruckingOrderStuffingDate, 2) + ' ' + pTruckingOrderStuffingDate + '  الساعة  ' + ' / ' + pTruckingOrderLoadingTime + '</b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderPickupAddress + '<b><span class="float-right">' + ' / عنوان التحميل مفصلا  ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + pTruckingOrderDeliveryAddress + '<b><span class="float-right">' + ' / عنوان التسليم مفصلا  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderPickupAddress + (pTruckingOrderDeliveryAddress == "" ? "" : (' --> ' + pTruckingOrderDeliveryAddress)) + '<b><span class="float-right">' + ' / العنوان مفصلا  ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderContactPerson + '<b><span class="float-right">' + ' / مندوب العمل أو مسؤول التحميل   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + pTruckingOrderContactPersonPhones + '<b><span class="float-right">' + ' / رقم التليفون   ' + '</span></b></div>';
        //ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '<b><span class="float-right">' + ' / ملحوظات هامة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;"">' + '<b><span class="float-right">' + ' : ملحوظات هامة   ' + '</span></b></div>';
        ReportHTML += '             <div class="col-xs-12 text-right" style="font-size:14px; clear:both;">' + (pTruckingOrderNotes == 0 ? "" : pTruckingOrderNotes.replace(/\n/g, "<br/>")) + '</div>';
        if (pDefaults.UnEditableCompanyName != "BME")
            ReportHTML += '             <div class="col-xs-7 text-center m-t-lg" style="font-size:16px;">' + '' + '<b>' + '    مقدمه لسيادتكم  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + $("#hDefaultCompanyName").val() + '<b>' /*+ '  /  شركة   '*/ + '</b></div>';
        if (pDefaults.UnEditableCompanyName != "BME") {
            ReportHTML += '             <div class="col-xs-7 text-center m-t-sm" style="font-size:16px; clear:both;">' + '' + '<b>' + '  /  المسؤول    ' + '</b></div>';
            ReportHTML += '             <div class="col-xs-7 text-center m-t-lg" style="font-size:16px; clear:both;">' + '<b>' + ' ،،،،،،،،، وتفضلوا بقبول وافر الاحترام والتقدير   ' + '</b></div>';
        }
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_Print_Manifest(data, pDocumentTypeID, pOption) {
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pOperationHeader = JSON.parse(data[2]);
    var pHouses = JSON.parse(data[3]);
    var pContainersAndPackages = JSON.parse(data[4]);

    //var pDescriptionOfGoodsOnContainers = "";
    //$.each(JSON.parse(pOperationContainersAndPackages), function (i, item) {
    //    pDescriptionOfGoodsOnContainers += (item.DescriptionOfGoods == 0 ? "" : (item.DescriptionOfGoods + " "));
    //});
    //if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC") {

    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if (pDefaults.UnEditableCompanyName == "GLS") {
        debugger;
        //if ($('#ChForConsignee2' + $('#slDocsOutOperations').val() + '').prop('checked') || (pHouses.length>0? (pHouses[0].ConsigneeName != 0):false))
        //{
        var counter = 0;
        for (counter = 0; counter < 2; counter++) {
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
                ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
                ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';
            }
            else //header not printed so leave place for header on the original company paper
                ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';

            var TotalWeight = 0
            $.each(pHouses, function (i, item) {
                if (item.GrossWeightSum > 0)
                    TotalWeight += item.GrossWeightSum
            });

            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">MBL NO</div>';
            ReportHTML += '             <div class="col-xs-10">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">POL</div>';
            ReportHTML += '             <div class="col-xs-10">' + pOperationHeader.POLName + '</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">POD</div>';
            ReportHTML += '             <div class="col-xs-10">' + pOperationHeader.PODName + '</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">Date</div>';
            ReportHTML += '             <div class="col-xs-10">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">Vessel</div>';
            ReportHTML += '             <div class="col-xs-10">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">Seal Number</div>';
            if (pContainersAndPackages[0] != undefined)
                ReportHTML += '             <div class="col-xs-10">' + (pContainersAndPackages[0].CarrierSeal == 0 ? "" : pContainersAndPackages[0].CarrierSeal) + '</div></div>';
            //ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">SEAL NO</div>';
            //ReportHTML += '             <div class="col-xs-10">asd</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">Containers NO</div>';
            ReportHTML += '             <div class="col-xs-10">' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">Total Weight</div>';
            ReportHTML += '             <div class="col-xs-10">' + TotalWeight + ' KGS</div></div>';
            ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-2">Total Pcs</div>';
            //ReportHTML += '             <div class="col-xs-10">' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + (pOperationHeader.ContainerTypes == 0 ? "" : (" - " + pOperationHeader.ContainerTypes)) + '</div></div>';
            ReportHTML += '             <div class="col-xs-10">' + (pOperationHeader.NumberOfPackages == 0 ? '' : pOperationHeader.NumberOfPackages) + ' x ' + (pOperationHeader.PackageTypeName == 0 ? "" : pOperationHeader.PackageTypeName) + (pOperationHeader.ContainerTypes == 0 ? "" : (" - " + pOperationHeader.ContainerTypes)) + '</div></div>';


            ReportHTML += '                         <table id="tblHouses" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td>' + '<b>HBL No.</b>' + '</td>';
            ReportHTML += '                                     <td>' + '<b>CNEE' + '</b></td>';
            ReportHTML += '                                     <td>' + '<b>PCS' + '</b></td>';
            ReportHTML += '                                     <td>' + '<b>Desc Of Goods' + '</b></td>';
            ReportHTML += '                                     <td>' + '<b>GROSS WEIGHT' + '</b></td>';
            ReportHTML += '                                     <td>' + '<b>VOLUME' + '</b></td>';
            ReportHTML += '                                 </tr>';
            $.each(pHouses, function (i, item) {

                ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                if (counter == 0) {
                    ReportHTML += '                                         <td> ' + (item.HouseNumber == 0 ? '' : item.HouseNumber) + '</td>';
                    ReportHTML += '                                         <td>' + (item.ConsigneeName == 0 ? '' : item.ConsigneeName) + '</td>';
                    ReportHTML += '                                         <td>' + (item.NumberOfPackages == 0 ? '' : item.NumberOfPackages) + ' x ' + (item.PackageTypeName == 0 ? '' : item.PackageTypeName) + '</td>';
                    ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
                    ReportHTML += '                                         <td>' + (item.GrossWeightSum + ' KGS') + '</td>';
                    ReportHTML += '                                         <td>' + (item.VolumeSum + ' CBM') + '</td>';

                }
                else {
                    if ($('#ChForConsignee2' + pHouses[i].ID + '').prop('checked')) {
                        ReportHTML += '                                         <td> ' + (item.HouseNumber == 0 ? '' : item.HouseNumber) + '</td>';
                        ReportHTML += '                                         <td>' + (item.ConsigneeName == 0 ? '' : item.ConsigneeName) + '</td>';
                        ReportHTML += '                                         <td>' + (item.NumberOfPackages == 0 ? '' : item.NumberOfPackages) + ' x ' + (item.PackageTypeName == 0 ? '' : item.PackageTypeName) + '</td>';
                        ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
                        ReportHTML += '                                         <td>' + (item.GrossWeightSum + ' KGS') + '</td>';
                        ReportHTML += '                                         <td>' + (item.VolumeSum + ' CBM') + '</td>';
                    }
                    else {
                        ReportHTML += '                                         <td> ' + (item.HouseNumber == 0 ? '' : item.HouseNumber) + '</td>';
                        ReportHTML += '                                         <td>' + (item.Consignee2Name == 0 ? '' : item.Consignee2Name) + '</td>';
                        ReportHTML += '                                         <td>' + (item.NumberOfPackages == 0 ? '' : item.NumberOfPackages) + ' x ' + (item.PackageTypeName == 0 ? '' : item.PackageTypeName) + '</td>';
                        ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
                        ReportHTML += '                                         <td>' + (item.GrossWeightSum + ' KGS') + '</td>';
                        ReportHTML += '                                         <td>' + (item.VolumeSum + ' CBM') + '</td>';
                    }

                }
                ReportHTML += '                                     </tr>';
            });
            ReportHTML += '                         </table>';

            ReportHTML += '         <div class="break"></div>';
        }
    } //if (pDefaults.UnEditableCompanyName == "GLS")
    else if (pDefaults.UnEditableCompanyName == "NEW") {
        debugger;
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';

        ReportHTML += '             <div class="col-xs-4">' + '<b>M/V: </b>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</div>';
        ReportHTML += '             <div class="col-xs-4">' + '<b>FROM: </b>' + (pOperationHeader.POLName + ", " + pOperationHeader.POLCountryName) + '</div>';
        ReportHTML += '             <div class="col-xs-4">' + '<b>TO: </b>' + (pOperationHeader.PODName + ", " + pOperationHeader.PODCountryName) + '</div>';
        ReportHTML += '             <div class="col-xs-8">' + '<b>MASTER NAME: </b>' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit) + '</div>';
        ReportHTML += '             <div class="col-xs-4">' + '<b>FLAG: </b>' + (pOperationHeader.VesselNotes == 0 ? "" : pOperationHeader.VesselNotes) + '</div>';


        ReportHTML += '                         <table id="tblHouses" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
        ReportHTML += '                                 <tr class="" style="">';
        ReportHTML += '                                     <th style="width:5%;">' + 'B/L No' + '</th>';
        ReportHTML += '                                     <th style="">' + 'SHIPPER' + '</th>';
        ReportHTML += '                                     <th style="">' + 'CONSIGNEE' + '</th>';
        ReportHTML += '                                     <th style="">' + 'NOTIFY' + '</th>';
        ReportHTML += '                                     <th>' + 'DESC OF GOODS</b>' + '</th>';
        ReportHTML += '                                     <th>' + 'WEIGHT' + '</th>';
        ReportHTML += '                                     <th>' + 'FREIGHT' + '</th>';
        ReportHTML += '                                 </tr>';
        var _GrossWeightSum = 0.0;
        $.each(pHouses, function (i, item) {
            _GrossWeightSum += item.GrossWeightSum;
            ReportHTML += '                                     <tr class="" style="font-size:95%;">';
            ReportHTML += '                                         <td style="">' + (item.HouseNumber == 0 ? '' : item.HouseNumber) + '</td>';
            ReportHTML += '                                         <td style="">' + (item.ShipperName == 0 ? '' : item.ShipperName) + '</td>';
            ReportHTML += '                                         <td style="">' + (item.ConsigneeName == 0 ? 'TO ORDER' : item.ConsigneeName) + '</td>';
            ReportHTML += '                                         <td style="">' + (item.Notify1Name == 0 ? '' : item.Notify1Name) + '</td>';
            ReportHTML += '                                         <td style="">' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods) + '</td>';//.replace(/\n/g, "<br/>")
            ReportHTML += '                                         <td style="">' + (item.GrossWeightSum == 0 ? '' : item.GrossWeightSum.toFixed(3)) + '</td>';
            ReportHTML += '                                         <td style="">' + (item.POrCName == 0 ? '' : item.POrCName) + '</td>';
            //ReportHTML += '                                         <td>' + (item.GrossWeightSum + ' KGM') + '<br>' + (item.VolumeSum + ' CBM') + '</td>';
            //ReportHTML += '                                         <td>' + (item.ContainerNumbers == 0 ? '' : item.ContainerNumbers) + '<br>POL: ' + pOperationHeader.POLName + '</td>';
            //ReportHTML += '                                         <td>' + (item.PackageTypes == 0
            //                                                                ? (item.PackageTypesOnContainersTotals == 0 ? "" : item.PackageTypesOnContainersTotals)
            //                                                                : item.PackageTypes) + '</td>';
            ReportHTML += '                                     </tr>';
        });
        ReportHTML += '                                     <tr class="" style="font-size:95%;">';
        ReportHTML += '                                         <td style="" colspan=4>' + '<b>GRAND TOTAL</b>' + '</td>';
        ReportHTML += '                                         <td style="" colspan=3>' + '<b>' + _GrossWeightSum.toFixed(3) + ' MT' + '</b>' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                         </table>';

        ReportHTML += '             <div style="font-size:110%;" class="col-xs-12 text-right">' + '<b>' + '   الباخرة واردة بعقد مشارطة و التفريغ مسؤؤلية المستلمين   ' + '</b>' + '</div>'
        //ReportHTML += '                         <table id="tblManifestFooter" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
        //ReportHTML += '                                 <tr class="" style="">';
        //ReportHTML += '                                     <td><b>' + 'Totals :' + '</b></td>';
        //ReportHTML += '                                     <td><b>' + 'No. Of Bills : ' + pHouses.length + '</b></td>';
        //ReportHTML += '                                     <td><b>' + 'Weight : ' + pOperationHeader.GrossWeightSum + ' KGM' + '</b></td>';
        //ReportHTML += '                                     <td><b>' + 'Volume : ' + pOperationHeader.VolumeSum + ' CBM' + '</b></td>';
        //ReportHTML += '                                 </tr>';
        //ReportHTML += '                         </table>';

    } //else if (pDefaults.UnEditableCompanyName == "NEW")
    else if (pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG") {
        debugger;
        //if ($('#ChForConsignee2' + $('#slDocsOutOperations').val() + '').prop('checked') || (pHouses.length > 0 ? (pHouses[0].ConsigneeName != 0) : false)) {
        var counter = 0;
        for (counter = 0; counter < 1; counter++) { //for (counter = 0; counter < 2; counter++) {
            //if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            //    ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
            //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            //    ReportHTML += '             <div class="col-xs-9 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            //    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';
            //}
            //else //header not printed so leave place for header on the original company paper
            //    ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';


            ReportHTML += '                 <div class="col-xs-9 m-t"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div>';
            ReportHTML += '                 <div class="col-xs-3">';
            ReportHTML += '                         <table id="tblCONSOL" class="table table-striped text-sm  table-bordered">'; //style="border:solid #000 !Important;"
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="text-align:left;background-color:grey!Important;"><b>' + 'CONSOL' + '</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td style="text-align:left;">' + pOperationHeader.Reference + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                         <table id="tblMBL" class="table table-striped text-sm table-bordered m-t-n">'; //style="border:solid #000 !Important;"
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="text-align:left;background-color:grey!Important;"><b>' + (pOperationHeader.TransportType == AirTransportType ? "MAWB" : "MBL") + '</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td style="text-align:left;">' + pOperationHeader.MasterBL + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                         <table id="tblDate" class="table table-striped text-sm  table-bordered m-t-n">'; //style="border:solid #000 !Important;"
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="text-align:left;background-color:grey!Important;"><b>' + 'Date' + '</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td style="text-align:left;">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.BLDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.BLDate)) : "") + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-12">';
            ReportHTML += '                     <table id="tblManifestHeader" class="table table-striped table-bordered">'; //style="border:solid #000 !Important;"
            ReportHTML += '                                 <th style="text-align:left;background-color:grey!Important;">' + (pOperationHeader.TransportType == AirTransportType ? "Air" : "Ocean") + ' Freight Manifest' + '</th>';
            ReportHTML += '                     </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-12 m-t-n">';
            ReportHTML += '                     <table id="tblManifestHeader" class="table table-striped table-bordered">'; //style="border:solid #000 !Important;"
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'CONSOL DETAILS' + '<span class="float-right">PRINTED BY:' + pLoggedUser.Name + '</span>' + '</td>';
            ReportHTML += '                     </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t-n" style="height:15%;font-size:85%;">';
            ReportHTML += '                     <table id="tblExportAgent" style="height:100%;" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="height:10%;">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'EXPORT AGENT' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="height:90%;vertical-align:top;">';
            ReportHTML += '                                 <td style="text-align:left;">';
            ReportHTML += '                                     ' + (pOperationHeader.ShipperName == 0 ? "" : pOperationHeader.ShipperName);
            ReportHTML += '                                     <br>' + (pOperationHeader.ShipperAddress == 0 ? "" : pOperationHeader.ShipperAddress.replace(/\n/g, "<br/>"));
            ReportHTML += '                                     <br>' + (pOperationHeader.ShipperPhonesAndFaxes == 0 ? "" : pOperationHeader.ShipperPhonesAndFaxes);
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t-n" style="height:15%;font-size:85%;">';
            ReportHTML += '                     <table id="tblImportAgent" style="height:100%;" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="height:10%;">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'IMPORT AGENT' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="height:90%;vertical-align:top;">';
            ReportHTML += '                                 <td style="text-align:left;">';
            ReportHTML += '                                     ' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName);
            ReportHTML += '                                     <br>' + (pOperationHeader.ConsigneeAddress == 0 ? "" : pOperationHeader.ConsigneeAddress.replace(/\n/g, "<br/>"));
            ReportHTML += '                                     <br>' + (pOperationHeader.ConsigneePhonesAndFaxes == 0 ? "" : pOperationHeader.ConsigneePhonesAndFaxes);
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t-n" style="height:15%;font-size:85%;">';
            ReportHTML += '                     <table id="tblCFS" style="height:100%;" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="height:10%;">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'DEPARTURE CFS' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="height:90%;vertical-align:top;">';
            ReportHTML += '                                 <td style="text-align:left;">' + '' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-2 m-t" style="">';
            ReportHTML += '                     <table id="tblTotalWeight" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'TOTAL WGT' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + pOperationHeader.GrossWeightSum + ' KG' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-2 m-t" style="">';
            ReportHTML += '                     <table id="tblChargeable" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'CHARGEABLE' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + pOperationHeader.ChargeableWeightSum + ' KG' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t" style="">';
            ReportHTML += '                     <table id="tblCarrier" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'CARRIER' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t" style="">';
            ReportHTML += '                     <table id="tblCustomsEntryNumber" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'CUSTOMS ENTRY NUMBER' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + '<br>' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-2 m-t-n" style="clear:both;">';
            ReportHTML += '                     <table id="tblNumberOfPackages" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'PACKAGES' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + pOperationHeader.NumberOfPackages + ' ' + (pOperationHeader.PackageTypeName == 0 ? "" : pOperationHeader.PackageTypeName) + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-2 m-t-n" style="">';
            ReportHTML += '                     <table id="tblMasterFreight" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'MASTER FRT' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + (pOperationHeader.MoveTypeName == 0 ? "<br>" : pOperationHeader.MoveTypeName) + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t-n" style="">';
            ReportHTML += '                     <table id="tblOrigin" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'ORIGIN' + '<span class="float-right">ETD</span>' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + pOperationHeader.POLName + '<span class="float-right">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</span>' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-4 m-t-n" style="">';
            ReportHTML += '                     <table id="tblDestination" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'DESTINATION' + '<span class="float-right">ETA</span>' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">' + pOperationHeader.PODName + '<span class="float-right">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</span>' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-12 m-t-n" style="clear:both;">';
            ReportHTML += '                     <table id="tblRoutingInformation" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'ROUTING INFORMATION' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">'
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'MODE' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'DATE' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'CARRIER' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-1"><b>' + 'LOAD' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-1"><b>' + 'DISCH.' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'ETD' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'ETA' + '</b></div>';
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">'
            ReportHTML += '                                     <div class="col-xs-2">' + pOperationHeader.VoyageOrTruckNumber + "/" + pOperationHeader.RepTransportTypeShown + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</div>';
            ReportHTML += '                                     <div class="col-xs-2">' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</div>';
            ReportHTML += '                                     <div class="col-xs-1">' + (pOperationHeader.POLCode == 0 ? "" : pOperationHeader.POLCode) + '</div>';
            ReportHTML += '                                     <div class="col-xs-1">' + (pOperationHeader.PODCode == 0 ? "" : pOperationHeader.PODCode) + '</div>'; //(pOperationHeader.DeliveryCityName == 0 ? pOperationHeader.PODName : pOperationHeader.DeliveryCityName)
            ReportHTML += '                                     <div class="col-xs-2">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedDeparture)) : "") + '</div>';
            ReportHTML += '                                     <div class="col-xs-2">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</div>';
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';

            ReportHTML += '                 <div class="col-xs-12 m-t-n" style="clear:both;">';
            ReportHTML += '                     <table id="tblShipmentDetails" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr class="" style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">' + 'SHIPMENT DETAILS' + '</td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">'
            ReportHTML += '                                     <div class="col-xs-1"><b>' + '' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-3"><b>' + '' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'SHIPPER' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'CONSIGNEE' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'NATURE OF GOODS' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'HANDLING INSTR' + '</b></div>';
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">'
            ReportHTML += '                                     <div class="col-xs-1">';
            ReportHTML += '                                         <b>' + (pOperationHeader.TransportType == AirTransportType ? "HAWB:" : "HBL:") + '</b>';
            ReportHTML += '                                         <br><b>Job Ref:</b>';
            ReportHTML += '                                         <br><b>Wgt/Pkg:</b>';
            ReportHTML += '                                         <br><b>Origin:</b>';
            ReportHTML += '                                         <br><b>Destination:</b>';
            ReportHTML += '                                         <br><b>Shippers Ref:</b>';
            ReportHTML += '                                         <br><b>Service Level:</b>';
            ReportHTML += '                                         <br><b>Master</b>';
            //ReportHTML += '                                         <br><b>INSPECTION</b>';
            ReportHTML += '                                     </div>';
            ReportHTML += '                                     <div class="col-xs-3">';
            ReportHTML += '                                         ' + (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber);
            ReportHTML += '                                         <br>' + (pOperationHeader.Reference == 0 ? "" : pOperationHeader.Reference);
            ReportHTML += '                                         <br>' + pOperationHeader.GrossWeightSum + " KG" + (pOperationHeader.PackageTypeName == 0 ? "" : (" / " + pOperationHeader.NumberOfPackages + " " + pOperationHeader.PackageTypeName));
            ReportHTML += '                                         <br>' + (pOperationHeader.POLCode == 0 ? "" : pOperationHeader.POLCode);
            ReportHTML += '                                         <br>' + (pOperationHeader.PODCode == 0 ? "" : pOperationHeader.PODCode);
            ReportHTML += '                                         <br>';
            ReportHTML += '                                         <br>' + (pOperationHeader.MoveTypeName == 0 ? "" : pOperationHeader.MoveTypeName);
            ReportHTML += '                                         <br>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL);
            ReportHTML += '                                     </div>';
            ReportHTML += '                                     <div class="col-xs-2">';
            ReportHTML += '                                         ' + (pOperationHeader.ShipperName == 0 ? "" : pOperationHeader.ShipperName);
            ReportHTML += '                                         <br>' + (pOperationHeader.ShipperAddress == 0 ? "" : pOperationHeader.ShipperAddress.replace(/\n/g, "<br/>"));
            ReportHTML += '                                         <br>' + (pOperationHeader.ShipperPhonesAndFaxes == 0 ? "" : pOperationHeader.ShipperPhonesAndFaxes);
            ReportHTML += '                                     </div>';
            ReportHTML += '                                     <div class="col-xs-2">';
            ReportHTML += '                                         ' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName);
            ReportHTML += '                                         <br>' + (pOperationHeader.ConsigneeAddress == 0 ? "" : pOperationHeader.ConsigneeAddress.replace(/\n/g, "<br/>"));
            ReportHTML += '                                         <br>' + (pOperationHeader.ConsigneePhonesAndFaxes == 0 ? "" : pOperationHeader.ConsigneePhonesAndFaxes);
            ReportHTML += '                                     </div>';
            ReportHTML += '                                     <div class="col-xs-2">';
            ReportHTML += '                                         ' + '<b>Release:</b>';
            ReportHTML += '                                         <br>' + (pOperationHeader.POrCName == 0 ? "" : pOperationHeader.POrCName);
            ReportHTML += '                                         <br>' + '<b>Type:</b>';
            ReportHTML += '                                         <br>' + (pOperationHeader.MoveTypeName == 0 ? "" : pOperationHeader.MoveTypeName);
            ReportHTML += '                                         <br>' + '<b>Goods Desc:</b>';
            ReportHTML += '                                         <br>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods); //.replace(/\n/g, "<br/>")
            ReportHTML += '                                     </div>';
            ReportHTML += '                                     <div class="col-xs-2">';
            ReportHTML += '                                         <br><br><br><br>' + '<b>Marks And Numbers:</b>';
            ReportHTML += '                                         <br>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers);
            ReportHTML += '                                     </div>';
            //ReportHTML += '                                     <div class="col-xs-2">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</div>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';


            ReportHTML += '                 <div class="col-xs-12 m-t-n" style="">';
            ReportHTML += '                     <table id="tblPackages" style="" class="table table-striped table-bordered text-sm">'; //style="border:solid #000 !Important;"
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;background-color:grey!Important;">'
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'PACKAGES' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-3"><b>' + 'DESCRIPTION' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-3"><b>' + 'DIMENSION(L*W*H)' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'ITEM NO' + '</b></div>';
            ReportHTML += '                                     <div class="col-xs-2"><b>' + 'CONTAINER' + '</b></div>';
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                             <tr style="">';
            ReportHTML += '                                 <td style="text-align:left;">'
            for (var z = 0; z < pContainersAndPackages.length; z++) {
                ReportHTML += '                                     <div class="col-xs-2">' + pContainersAndPackages[z].Quantity + " " + (pContainersAndPackages[z].PackageTypeName == 0 ? "" : pContainersAndPackages[z].PackageTypeName) + '</b></div>';
                ReportHTML += '                                     <div class="col-xs-3">' + (pContainersAndPackages[z].DescriptionOfGoods == 0 ? "" : pContainersAndPackages[z].DescriptionOfGoods) + '</div>';
                ReportHTML += '                                     <div class="col-xs-3">' + (pContainersAndPackages[z].Height + "x" + pContainersAndPackages[z].Width + "x" + pContainersAndPackages[z].Height) + '</div>';
                ReportHTML += '                                     <div class="col-xs-2">' + '<br>' + '</div>';
                ReportHTML += '                                     <div class="col-xs-2">' + '<br>' + '</div>';
            }
            ReportHTML += '                                 </td>';
            ReportHTML += '                             </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';
            ReportHTML += '                 <div class="col-xs-12 m-t-n">';
            ReportHTML += '                         <table id="tblFooter" class="table table-striped text-sm  table-bordered">'; //style="border:solid #000 !Important;"
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <td style="text-align:left;font-size:60%;">';
            ReportHTML += '                                         Unless otherwise agreed in a written contract signed by XPO Global Forwarding France or its affiliates, all services provided by XPO are subject to the limitations of liability and other provisions of XPO’s Standard Customer Terms and Conditions along with the terms of any applicable bills of lading, waybills, powers of attorney or other documents';
            ReportHTML += '                                         that are referenced therein, each of which are incorporated herein by reference. Copies of the XPO Standard Customer Terms and Conditions can be found at www.xpo.com/business-terms or may be obtained by emailing stc@xpo.com. Carrier should notify XPO Global Forwarding France immediately if it discovers or has reasonable grounds for';
            ReportHTML += '                                         suspecting that any of the information on this manifest is incorrect or inaccurate or does not otherwise match the cargo physically in the possession of carrier. By agreeing to accept these instructions, the carrier named herein agrees to the XPO Standard Supplier Terms and Conditions, which are incorporated herein by reference, unless the parties';
            ReportHTML += '                                         have already entered into an agreement that is currently in force, in which case the terms of that agreement will apply. Copies of the XPO Standard Supplier Terms and Conditions are available by contacting stc@xpo.com.';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '                 </div>';
        }
    } //else if (pDefaults.UnEditableCompanyName == "ILS" /*&& pOperationHeader.TransportType == AirTransportType*/) {
    else //other companies
    {
        debugger;
        //if ($('#ChForConsignee2' + $('#slDocsOutOperations').val() + '').prop('checked') || (pHouses.length > 0 ? (pHouses[0].ConsigneeName != 0) : false)) {
        var counter = 0;
        for (counter = 0; counter < 2; counter++) {
            if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
                ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
                ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';
            }
            else //header not printed so leave place for header on the original company paper
                ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' CARGO MANIFEST ' + '</b></h3></div>';
            if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
                ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
            ReportHTML += '                         <table id="tblManifestHeader" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td><b>' + 'MASTER B/L' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'VESSEL NAME' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'DATE' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'PLACE OF DISCHARGE' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'POL' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'POD' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'Cont.Type' + '</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</td>';
            ReportHTML += '                                     <td>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</td>';
            ReportHTML += '                                     <td>' + pOperationHeader.PODName + '</td>';
            ReportHTML += '                                     <td>' + pOperationHeader.POLName + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.DeliveryCityName == 0 ? pOperationHeader.PODName : pOperationHeader.DeliveryCityName) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';

            ReportHTML += '                         <table id="tblHouses" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="text-align:left;">' + '<b>1-SHIPPER<br>2-CONSIGNEE<br>3-NOTIFY PARTY' + '</b></td>';
            ReportHTML += '                                     <td>' + '<b>DESCRIPTION OF GOODS</b>' + '</td>';
            ReportHTML += '                                     <td>' + '<b>WEIGHT <br>&<br> CBM' + '</b></td>';
            ReportHTML += '                                     <td>' + '<b>CNTR NO. <br>&<br> POL' + '</b></td>';
            ReportHTML += '                                 </tr>';
            $.each(pHouses, function (i, item) {

                ReportHTML += '                                     <tr class="" style="font-size:95%;">';
                if (counter == 0) {
                    ReportHTML += '                                         <td style="text-align:left;">'
                        + '<b>HBL:</b> ' + (item.HouseNumber == 0 ? '' : item.HouseNumber)
                        + '<b><br>SHPR:</b> ' + (item.ShipperName == 0 ? '' : item.ShipperName)
                        + '<b><br>CNEE:</b> ' + (item.ConsigneeName == 0 ? '' : item.ConsigneeName)
                        + '<b><br>NOTIFY:</b> ' + (item.Notify1Name == 0 ? 'SAME AS CONSIGNEE' : item.Notify1Name)
                        + '</td>';
                }
                else {
                    if ($('#ChForConsignee2' + pHouses[i].ID + '').prop('checked')) {
                        ReportHTML += '                                         <td style="text-align:left;">'
                            + '<b>HBL:</b> ' + (item.HouseNumber == 0 ? '' : item.HouseNumber)
                            + '<b><br>SHPR:</b> ' + (item.ShipperName == 0 ? '' : item.ShipperName)
                            + '<b><br>CNEE:</b> ' + (item.ConsigneeName == 0 ? '' : item.ConsigneeName)
                            + '<b><br>NOTIFY:</b> ' + (item.Notify1Name == 0 ? 'SAME AS CONSIGNEE' : item.Notify1Name)
                            + '</td>';
                    }
                    else {
                        ReportHTML += '                                         <td style="text-align:left;">'
                            + '<b>HBL:</b> ' + (item.HouseNumber == 0 ? '' : item.HouseNumber)
                            + '<b><br>SHPR:</b> ' + (item.ShipperName == 0 ? '' : item.ShipperName)
                            + '<b><br>CNEE:</b> ' + (item.Consignee2Name == 0 ? '' : item.Consignee2Name)
                            + '<b><br>NOTIFY:</b> ' + (item.Notify1Name == 0 ? 'SAME AS CONSIGNEE' : item.Notify1Name)
                            + '</td>';
                    }

                }


                //ReportHTML += '                                         <td>' + (pOperationHeader.DirectionType == 1 ? (item.ConsigneeName == 0 ? '' : item.ConsigneeName) : (item.ShipperName == 0 ? '' : item.ShipperName)) + '</td>';
                ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
                ReportHTML += '                                         <td>' + (item.GrossWeightSum + ' KGM') + '<br>' + (item.VolumeSum + ' CBM') + '</td>';

                ReportHTML += '                                         <td>' + (item.ContainerNumbers == 0 ? '' : item.ContainerNumbers) + '<br>POL: ' + pOperationHeader.POLName + '</td>';
                //ReportHTML += '                                         <td>' + (item.PackageTypes == 0
                //                                                                ? (item.PackageTypesOnContainersTotals == 0 ? "" : item.PackageTypesOnContainersTotals)
                //                                                                : item.PackageTypes) + '</td>';
                ReportHTML += '                                     </tr>';
            });
            ReportHTML += '                         </table>';

            ReportHTML += '                         <table id="tblManifestFooter" class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td><b>' + 'Totals :' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'No. Of Bills : ' + pHouses.length + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'Weight : ' + pOperationHeader.GrossWeightSum + ' KGM' + '</b></td>';
            ReportHTML += '                                     <td><b>' + 'Volume : ' + pOperationHeader.VolumeSum + ' CBM' + '</b></td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
            ReportHTML += '         <div class="break"></div>';
        }
    } //else //other companies
    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0;">';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ManifestModify(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pRecordsExist = data[0];
    var pMissingMandatoryFields = data[1];
    var pBranchName = data[2];
    var pEnCompanyName = data[3];
    var pArCompanyName = data[4];
    var pContainerNumbers = data[5];
    var pGrossWeightSum = data[6];
    var pVolumeSum = data[7];
    var pVesselName = data[8];
    var pPOLCodeAndName = data[9];
    var pPODCodeAndName = data[10];
    var pLineName = data[11];
    var pExpectedArrival = data[12]; //pExpectedArrival.ToShortDateString()
    var pClientName = data[13];
    var pClientEmail = data[14];
    var pDescriptionOfGoods = data[15];
    var pActualArrival = data[16];
    var pMasterBL = data[17];
    var pNumberOfPackages = data[18];
    var pDeliveryAddress = data[19];
    var pOperationHeader = JSON.parse(data[20]);
    if (pDefaults.UnEditableCompanyName == "GLS") {

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' طلب تعديل بيانات بقائمة الشحن ' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br></br></br></br></br><h3><b>' + ' طلب تعديل بيانات بقائمة الشحن ' + '</b></h3></div>';
        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '             <div class="col-xs-12 text-right">';
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table table-striped b-t b-light text-sm  table-bordered">';  //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>' + ' البيان بعد التعديل ' + '</th>';
        ReportHTML += '                                     <th>' + ' البيان الحالى ' + '</th>';
        ReportHTML += '                                     <th>' + ' نوع البيان ' + '</th>';



        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td></td>';
        ReportHTML += '                                         <td>' + (pVesselName == "N/A" ? "" : pVesselName) + '</td>';
        ReportHTML += '                                         <th>' + ' اسم الباخرة ' + '</th>';
        ReportHTML += '                                     </tr>';
        //ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        //ReportHTML += '                                         <td>' + (pOperationHeader.Consignee2Name == 0 ? "" : pOperationHeader.Consignee2Name) + '</td>';
        //ReportHTML += '                                         <td>' + (pClientName == "N/A" ? "" : pClientName) + '</td>';
        //ReportHTML += '                                         <th>' + ' اسم المستفيد ' + '</th>';
        //ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.Consignee2Name == 0 ? "" : pOperationHeader.Consignee2Name) + '</td>';
        //ReportHTML += '                                         <td>' + (pClientName == "N/A" ? "" : pClientName) + '</td>';
        ReportHTML += '                                         <th>' + ' اسم المستفيد ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                         <td>' + (pActualArrival == '01/01/1900' ? '' : pActualArrival) + '</td>';
        ReportHTML += '                                         <th>' + ' تاريخ الوصول ' + '</th>';

        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td></td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</td>';
        ReportHTML += '                                         <th>' + ' رقم البوليصة  ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td></td>';
        //ReportHTML += '                                         <td>' + (pOperationHeader.NumberOfPackages == 0 ? (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) : pOperationHeader.NumberOfPackages) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + " x " + pOperationHeader.PackageTypeName + '</td>';
        ReportHTML += '                                         <th>' + ' العدد  ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td></td>';
        ReportHTML += '                                         <td>' + pGrossWeightSum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' KGM' + '</td>';
        ReportHTML += '                                         <th>' + ' الوزن ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:16px;">';
        ReportHTML += '                                         <td></td>';
        ReportHTML += '                                         <td></td>';
        ReportHTML += '                                         <th>' + ' بيانات أخري ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table></div>';
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' بيانات تملأ بمعرفة التوكيل ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' بيانات تملأ بمعرفة المنافيستو ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' وذلك دون أدنى مسئولية على التوكيل الملاحي ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' المأمور ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' الأسم ' + '</b></div>';
        //ReportHTML += '                     </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm">' + '<b style="font-size:15px;">' + ' ولكم جزيل الشكر والاحترام ' + '</b></div>';

        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF if (pDefaults.UnEditableCompanyName == "GLS")
    else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + 'Manifest Modify' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' Manifest Modify Request ' + '</b></h3></div>';
        ReportHTML += '             <div class="col-xs-12 m-l">' /*+ pClientName*/ + '<b>' + 'Messers / Customs Authority' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l">' + '<b>' + 'The following data is changed : ' + '</b></div>';
        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table table-striped b-t b-light text-sm  table-bordered">';  //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>' + ' Item ' + '</th>';
        ReportHTML += '                                     <th>' + ' Current Data ' + '</th>';
        ReportHTML += '                                     <th style="width:40%;">' + ' Modification ' + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Vessel ' + '</th>';
        ReportHTML += '                                         <td>' + pVesselName + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Client ' + '</th>';
        ReportHTML += '                                         <td>' + pClientName + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.Consignee2Name == 0 ? "" : pOperationHeader.Consignee2Name) + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Arrival Date ' + '</th>';
        ReportHTML += '                                         <td>' + (pActualArrival == '01/01/1900' ? 'N/A' : pActualArrival) + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' POD ' + '</th>';
        ReportHTML += '                                         <td>' + pPODCodeAndName + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' MBL ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' HBL ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Packages ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Gross Weight ' + '</th>';
        ReportHTML += '                                         <td>' + pGrossWeightSum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' KGM' + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Goods Decription ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods) + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Containers' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.ContainerNumbers == 0 ? (pOperationHeader.ContainerNumber == 0 ? "" : pOperationHeader.ContainerNumber) : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Delivery Address ' + '</th>';
        ReportHTML += '                                         <td>' + pDeliveryAddress + '</td>';
        ReportHTML += '                                         <td>' + '' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        { //other companies
            ReportHTML += '                         <div class="col-xs-12 text-center">' + '<h4><b>' + ' Data editted by the agent ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-12"><b>' + ' Agent   ' + '</b></div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-center m-t-sm">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + '<h4><b>' + ' Data edited by the customs authority ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-center m-t-sm">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-left m-t-sm"><b>' + ' Department Manager  ' + '</b></div>';
        }
        //ReportHTML += '                     </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF else if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA")
    else { //Other Companies

        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' طلب تعديل بيانات بقائمة الشحن ' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' طلب تعديل بيانات بقائمة الشحن ' + '</b></h3></div>';
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC" || pDefaults.UnEditableCompanyName == "ILS" || pDefaults.UnEditableCompanyName == "ILSEG")
            ReportHTML += '             <div class="col-xs-12"><b>Ref. </b>' + (pOperationHeader.Reference == 0 ? '' : pOperationHeader.Reference) + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-l text-right">' /*+ pClientName*/ + '<b>' + ' ( السادة / مسؤولى الجمارك ( المنافستو المركزى  ' + '</b></div>';
        ReportHTML += '             <div class="col-xs-12 m-l text-right">' + '<b>' + ' : يرجى التفضل و التكرم بالتعديل طبقا للبيانات التالية  ' + '</b></div>';
        ////ReportHTML += '             <div class="col-xs-4"><b></b>' + '' + '</div>';
        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        //ReportHTML += '<div> &nbsp; </div>'
        ReportHTML += '                         <table id="tblDeliveryOrder" class="table table-striped b-t b-light text-sm  table-bordered">';  //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>' + ' البيان بعد التعديل ' + '</th>';
        ReportHTML += '                                     <th>' + ' البيان الحالى ' + '</th>';
        ReportHTML += '                                     <th>' + ' نوع البيان ' + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + pVesselName + '</td>';
        ReportHTML += '                                         <th>' + ' اسم الباخرة ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        if (pDefaults.UnEditableCompanyName == "MAR") {
            ReportHTML += '                                         <td>' + (pOperationHeader.Notify1Name == 0 ? "//" : pOperationHeader.Notify1Name) + '</td>';
            ReportHTML += '                                         <td>' + (pOperationHeader.ConsigneeName == 0 ? "//" : pOperationHeader.ConsigneeName) + '</td>';
        }
        else {
            ReportHTML += '                                         <td>' + (pOperationHeader.Consignee2Name == 0 ? "//" : pOperationHeader.Consignee2Name) + '</td>';
            ReportHTML += '                                         <td>' + pClientName + '</td>';
        }
        ReportHTML += '                                         <th>' + ' اسم صاحب الشأن ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + (pActualArrival == '01/01/1900' ? 'N/A' : pActualArrival) + '</td>';
        ReportHTML += '                                         <th>' + ' تاريخ الوصول ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + pPODCodeAndName + '</td>';
        ReportHTML += '                                         <th>' + ' ميناء الوصول ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '</td>';
        ReportHTML += '                                         <th>' + ' رقم البوليصة الكلية ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</td>';
        ReportHTML += '                                         <th>' + ' رقم البوليصة الفرعية ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <th>' + ' عدد الطرود ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + pGrossWeightSum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' KGM' + '</td>';
        ReportHTML += '                                         <th>' + ' الوزن ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        //ReportHTML += '                                         <td>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods) + '</td>';
        ReportHTML += '                                         <th>' + ' وصف البضاعة ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.ContainerNumbers == 0 ? (pOperationHeader.ContainerNumber == 0 ? "" : pOperationHeader.ContainerNumber) : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                         <th>' + ' حاوية رقم ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + '//' + '</td>';
        ReportHTML += '                                         <td>' + pDeliveryAddress + '</td>';
        ReportHTML += '                                         <th>' + ' الوجهة النهائية ' + '</th>';
        ReportHTML += '                                     </tr>';
        //ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        //ReportHTML += '                                         <td>' + '' + '</td>';
        //ReportHTML += '                                         <td>' + '' + '</td>';
        //ReportHTML += '                                         <th>' + ' مكان التخزين ' + '</th>';
        //ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                     </div>';//of table-responsive
        if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC") {
            ReportHTML += '                         <div class="col-xs-12 text-right"><h4><b>' + '  يرجى التكرم بالتعديل طبقا للبيانات الموضحة أعلاه مع العلم بأن أى مصروفات أو غرامات يتحملها صاحب الشأن مباشرة دون أدنى مسئولية على التوكيل الملاحى   ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-12 text-left m-t-sm"><h4><b>' + (pDefaults.CompanyLocalName == 0 ? (pDefaults.CompanyName == 0 ? "" : pDefaults.CompanyName) : pDefaults.CompanyLocalName) + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-2"></div><div class="col-xs-8" style="height:.5px;border:.5px solid #000;"></div><div class="col-xs-2"></div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + '<h4><b>' + ' بيانات تحرر بمعرفة المنافستو المركزى ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-4 text-right">' + '<h4><b>' + ' :رئيس القسم  ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-8 text-right">' + '<h4><b>' + ' :المأمور  ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-4 text-right">' + '<h4><b>' + ' :الاسم  ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-8 text-right">' + '<h4><b>' + ' :الاسم  ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-4 text-right">' + '<h4><b>' + ' :التوقيع  ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-8 text-right">' + '<h4><b>' + ' :التوقيع  ' + '</b></h4></div>';

        } //if (pDefaults.UnEditableCompanyName == "DSE" || pDefaults.UnEditableCompanyName == "DSC")
        else if (pDefaults.UnEditableCompanyName == "PFS") {
            ReportHTML += '                         <div class="col-xs-12 text-left m-t-sm"><h4><b>' + (pDefaults.CompanyLocalName == 0 ? (pDefaults.CompanyName == 0 ? "" : pDefaults.CompanyName) : pDefaults.CompanyLocalName) + '</b></h4></div>';
        }
        else { //other companies
            ReportHTML += '                         <div class="col-xs-12 text-center">' + '<h4><b>' + ' بيانات تحرر بمعرفة الوكيل ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-12 text-right"><b>' + ' اسم مندوب التوكيل  ' + '</b></div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-center m-t-sm">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + '<h4><b>' + ' بيانات تحرر بمعرفة المنافستو المركزى ' + '</b></h4></div>';
            ReportHTML += '                         <div class="col-xs-12 text-center">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-center m-t-sm">' + ' ......................................................................................................................................................................................................................................... ' + '</div>';
            ReportHTML += '                         <div class="col-xs-12 text-left m-t-sm"><b>' + ' رئيس القسم  ' + '</b></div>';
        }
        //ReportHTML += '                     </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF else { //Other Companies
}
function DocsOut_Print_OperationTracking(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pConsigneeName = data[4];
    var pLineName = data[5];
    var pActualDeparture = data[6];
    var pExpectedArrival = data[7];
    var pPOLCodeAndName = data[8];
    var pPODCodeAndName = data[9];
    var pVoyageOrTruckNumber = data[10];
    var pContainerTypes = data[11];
    var pDescriptionOfGoods = data[12];
    var pVesselName = data[13];
    var pGrossWeightSum = data[14].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    var pPackageTypes = data[15];
    var pPOrC = data[16];
    var pExpectedDeparture = data[17];
    var pClientEmail = data[18];
    var pOperationContainersAndPackages = JSON.parse(data[19]);
    var pOperationHeader = JSON.parse(data[20]);
    var pOperationTracking = JSON.parse(data[21]);

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //$("#tblDocsOut tr[id=60] td.IsPrintISOCode input[type=checkbox]").prop('checked')
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div><div class="col-xs-6 text-right"><b>Date :</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
    //ReportHTML += '             <div> &nbsp; </div>'

    ReportHTML += '                         <table id="tblOperationTrackingDocsOut" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
    ReportHTML += '                             <thead>';
    ReportHTML += '                                 <tr>';
    ReportHTML += '                                     <th>Stage</th>';
    ReportHTML += '                                     <th>Date</th>';
    ReportHTML += '                                     <th>Notes</th>';
    //ReportHTML += '                                     <th>Done(Y/N)</th>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                             </thead>';
    ReportHTML += '                             <tbody>';
    $.each(pOperationTracking, function (i, item) { //no final shipping declaration for air
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td>' + item.TrackingStageName + '</td>';
        ReportHTML += '                                     <td>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(item.TrackingDate)) < 1 ? "" : ConvertDateFormat(GetDateWithFormatMDY(item.TrackingDate))) + '</td>';
        ReportHTML += '                                     <td>' + (item.Notes == 0 ? "" : item.Notes) + '</td>';
        //ReportHTML += '                                     <td>' + (item.Done ? "Y" : "N") + '</td>';
        ReportHTML += '                                 </tr>';

    });

    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';

    ReportHTML += '         </body>';
    ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    //ReportHTML += '           <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
    //ReportHTML += '           <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '         </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_ShippingPermission(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var VesselName = data[0];
    var POLName = data[1];
    var PODName = data[2];
    var DescriptionOfGoods = data[3];
    var PackageTypes = data[4];
    var OperationContainersAndPackages = JSON.parse(data[5]);
    var Serials = JSON.parse(data[6]);
    var ContainerPackages = JSON.parse(data[7]);
    var vwRoutings = JSON.parse(data[8]);
    var pOperationHeader = JSON.parse(data[9]);
    ////////

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';

    ReportHTML += '             <div class="row col-xs-12"><div class="col-xs-4"><b>MATES RECEIPT ايصال كبير الضباط</b> </div>';
    ReportHTML += '             <div class="col-xs-4 text-right"><b> ' + Serials[0].Serial + ' رقم </b> </div> <div class="col-xs-4 text-right"><b>SHIPPING ORDER اذن شحن</b> </div> </div>';
    ReportHTML += '             <div class=" row col-xs-12 text-right">' + (ConvertDateFormat(GetDateWithFormatMDY(vwRoutings[0].ActualArrival)).toString() == "01/01/1900" ? "" : ConvertDateFormat(GetDateWithFormatMDY(vwRoutings[0].ActualArrival)).toString()) + ' <b>الاسكندرية فى </b> </div>';

    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-3 text-left"> <b>Shipped On Board The M/V </b> </div> <div class="col-xs-6 text-center"> ' + VesselName + ' </div> <div class="col-xs-3 text-right"> <b>استملت على الباخرة </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-3 text-left"> <b>From </b> </div> <div class="col-xs-6 text-center"> ' + POLName + ' </div> <div class="col-xs-3 text-right"> <b>من</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-3 text-left"> <b>To</b> </div> <div class="col-xs-6 text-center"> ' + PODName + ' </div> <div class="col-xs-3 text-right"> <b>الي </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-3 text-left"> <b>The Following Goods </b> </div> <div class="col-xs-6 text-center"><span></span> </div> <div class="col-xs-3 text-right"> <b>البضاعة التالية </b></div></div> ';
    if (pDefaults.UnEditableCompanyName == "MAR")
        ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-3 text-left"> <b>Shipper</b> </div> <div class="col-xs-6 text-center"> ' + (pOperationHeader.ShipperName == 0 ? "" : pOperationHeader.ShipperName) + ' </div> <div class="col-xs-3 text-right"> <b>   الشاحن  </b></div></div> ';

    //ReportHTML += '             <div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div><div class="col-xs-6 text-right"><b>Date :</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div>';
    //ReportHTML += '             <div class="col-xs-12 text-center text-ul"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
    //ReportHTML += '             <div class="col-xs-6"><b>SHIPPING ORDER اذن شحن</b> </div><div class="col-xs-6 text-right"><b>Date :</b> </div>';
    ReportHTML += '       <div class="row col-xs-12" style="margin-left:4px;">';
    ReportHTML += '                         <table id="tblOperationTrackingDocsOut" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
    ReportHTML += '                             <thead>';
    ReportHTML += '                                 <tr>';
    ReportHTML += '                                     <th>Packages طرود</th>';
    ReportHTML += '                                     <th>Description Of Goods وصف البضاعة</th>';
    if (pDefaults.UnEditableCompanyName == "MAR")
        ReportHTML += '                                     <th>GW الوزن</th>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                             </thead>';
    ReportHTML += '                             <tbody>';
    //$.each(OperationContainersAndPackages, function (i, item) { //no final shipping declaration for air
    //    ReportHTML += '                                 <tr class="" style="font-size:95%;">';
    //    ReportHTML += '                                     <td>' + (item.NumberOfPackagesOnContainer == 0 ? '' : item.NumberOfPackagesOnContainer) + ' x ' + (item.PackageTypeNameOnContainer == 0 ? '' : item.PackageTypeNameOnContainer) + '</td>';
    //    ReportHTML += '                                     <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
    //    ReportHTML += '                                 </tr>';
    //});
    //ContainerPackages
    $.each(ContainerPackages, function (i, item) { //no final shipping declaration for air
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td>' + (item.Quantity == 0 ? '' : item.Quantity) + ' x ' + (item.PackageTypeName == 0 ? '' : item.PackageTypeName) + '</td>';
        ReportHTML += '                                     <td>' + (item.DescriptionOfGoods == 0 ? '' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
        if (pDefaults.UnEditableCompanyName == "MAR")
            ReportHTML += '                                     <td>' + item.GrossWeight + " KG" + '</td>';
        ReportHTML += '                                 </tr>';
    });
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table></div>';


    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Subject Of All Clauses & Condition Of </b> </div><div class="col-xs-6 text-right"> <b>خاضع لجميع بنود بوليصة الشحن</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Bill Of Lading </b> </div><div class="col-xs-6 text-right"> <b></b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>N.B:- The Receipt Must Not Be  </b> </div><div class="col-xs-6 text-right"> <b> ملحوظه: لا يجب تسليم الايصال الا اذا</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Delivered Unless Cargo Is Already On </b> </div><div class="col-xs-6 text-right"> <b> كانت البضاعة فعلا على الباخرة وعدد</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Board And Number Of Packages  </b> </div><div class="col-xs-6 text-right"> <b> </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Written In Letters  </b> </div><div class="col-xs-6 text-right"> <b>الطرود بالحروف</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>IMPORTANT : Shippers Of The Herein  </b> </div><div class="col-xs-6 text-right"> <b>ملحوظة هامة: تخطر شاحني البضائع</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Mentioned Goods Are Warned That Any  </b> </div><div class="col-xs-6 text-right"> <b> </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Remarks Appearing On The Mates  </b> </div><div class="col-xs-6 text-right"> <b>المبينه فى اذن الشحن هذا بأن اية ملاحظة </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Receipt Concerning The Condition Of  </b> </div><div class="col-xs-6 text-right"> <b> </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>The Cargo Will:-Variable Be</b> </div><div class="col-xs-6 text-right"> <b>واردة من ايصال كبير ضباط الباخرة عن</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>ReProduced On The Respective Bill Of  </b> </div><div class="col-xs-6 text-right"> <b>حالة الشحنة تدرج فى بوليصة الشحن </b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Lading And No Guarantee In Place There  </b> </div><div class="col-xs-6 text-right"> <b>الخاصة بها دون تغير ولا يقبل ضمان</b></div></div> ';
    ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Of Will Be Accepted.</b> </div><div class="col-xs-6 text-right"> <b>عوضا عن ذلك</b></div></div> ';



    ReportHTML += '         </body>';
    ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '         </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_DeliveryPermission(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    var pMainRoute = JSON.parse(data[2]);
    var pMainRouteMaster = data[3] == null ? 0 : JSON.parse(data[3]);

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + 'Delivery Permission' + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
    ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';

    ReportHTML += '             <div class="col-xs-12 text-center"><h3>' + (pOperationHeader.MasterOperationCode == 0 ? pOperationHeader.Code : pOperationHeader.MasterOperationCode) + '<b>' + ' إذن تسليم ' + '</b></h3></div>';
    ReportHTML += '             <div class="col-xs-12 m-t text-center"><h4>' + '<b>' + ' المرجو من أمين مخازن الإيداع أن يسلم بموجب هذا الإذن  ' + '</b></h4></div>';

    ReportHTML += '             <div class="col-xs-11 m-t text-right"><b> ' + pOperationHeader.ClientName + '  </b> </div> <div class="col-xs-1 m-t text-right"><b>  إلي   </b> </div> </div>';

    ReportHTML += '             <div class="col-xs-2 m-t text-right"><b> ' + (pMainRouteMaster == 0 ? pMainRoute.RoadNumber : pMainRouteMaster.RoadNumber) + '  </b> </div> <div class="col-xs-2 m-t text-right"><b>    طريق رقم     </b> </div> </div>';

    ReportHTML += '             <div class="col-xs-5 m-t m-b text-right"><b> ' + (pMainRouteMaster == 0 ? pMainRoute.AirlineName : pMainRouteMaster.AirlineName) + '  </b> </div> <div class="col-xs-3 m-t text-right"><b>    البضاعة الاتي بيانها و المودعة      </b> </div> </div>';

    ReportHTML += '                 <div class="col-xs-12" style="">';
    ReportHTML += '                         <table id="tblDeliveryPermission" style="height:150px;" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
    ReportHTML += '                             <thead>';
    ReportHTML += '                                 <tr>';
    ReportHTML += '                                     <th>  ملاحظات  </th>';
    ReportHTML += '                                     <th>   بوليصة  </th>';
    ReportHTML += '                                     <th>   عدد  </th>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                             </thead>';
    ReportHTML += '                             <tbody>';
    ReportHTML += '                                 <tr class="" style="">';
    ReportHTML += '                                     <td>' + '' + '</td>';
    //ReportHTML += '                                     <td>' + pOperationHeader.MasterBL + '<br>' + (pOperationHeader.HouseNumber == 0 ? '' : pOperationHeader.HouseNumber) + '</td>';
    //ReportHTML += '                                     <td>' + pOperationHeader.NumberOfPackages + ' x ' + (pOperationHeader.PackageTypeName == 0 ? '' : pOperationHeader.PackageTypeName) + '</td>';
    //ReportHTML += '                                     <td>' + pOperationHeader.MasterBL + '<br>' + (pMainRouteMaster.MasterBL == 0 ? '' : pMainRouteMaster.MasterBL) + '</td>';
    ReportHTML += '                                     <td>' + (pMainRouteMaster.MasterBL == 0 ? '' : pMainRouteMaster.MasterBL) + '<br>' + pOperationHeader.HouseNumber + '</td>';
    ReportHTML += '                                     <td>' + pOperationHeader.PackageTypes + '</td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';
    ReportHTML += '                 </div>';

    ReportHTML += '                 <div class="m-t" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
    ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + '  خاتم الشركة  ' + '</b></div>';
    ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + '  التوقيع  ' + '</b></div>';
    ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + '   /  &emsp;  / &emsp;    القاهرة في           ' + '</b></div>';
    ReportHTML += '                 </div>'

    //ReportHTML += '             <div class=" row col-xs-12 text-right">' + (ConvertDateFormat(GetDateWithFormatMDY(vwRoutings[0].ActualArrival)).toString() == "01/01/1900" ? "" : ConvertDateFormat(GetDateWithFormatMDY(vwRoutings[0].ActualArrival)).toString()) + ' <b>الاسكندرية فى </b> </div>';

    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Subject Of All Clauses & Condition Of </b> </div><div class="col-xs-6 text-right"> <b>خاضع لجميع بنود بوليصة الشحن</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Bill Of Lading </b> </div><div class="col-xs-6 text-right"> <b></b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>N.B:- The Receipt Must Not Be  </b> </div><div class="col-xs-6 text-right"> <b> ملحوظه: لا يجب تسليم الايصال الا اذا</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Delivered Unless Cargo Is Already On </b> </div><div class="col-xs-6 text-right"> <b> كانت البضاعة فعلا على الباخرة وعدد</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Board And Number Of Packages  </b> </div><div class="col-xs-6 text-right"> <b> </b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Written In Letters  </b> </div><div class="col-xs-6 text-right"> <b>الطرود بالحروف</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>IMPORTANT : Shippers Of The Herein  </b> </div><div class="col-xs-6 text-right"> <b>ملحوظة هامة: تخطر شاحني البضائع</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Mentioned Goods Are Warned That Any  </b> </div><div class="col-xs-6 text-right"> <b> </b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Remarks Appearing On The Mates  </b> </div><div class="col-xs-6 text-right"> <b>المبينه فى اذن الشحن هذا بأن اية ملاحظة </b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Receipt Concerning The Condition Of  </b> </div><div class="col-xs-6 text-right"> <b> </b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>The Cargo Will:-Variable Be</b> </div><div class="col-xs-6 text-right"> <b>واردة من ايصال كبير ضباط الباخرة عن</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>ReProduced On The Respective Bill Of  </b> </div><div class="col-xs-6 text-right"> <b>حالة الشحنة تدرج فى بوليصة الشحن </b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Lading And No Guarantee In Place There  </b> </div><div class="col-xs-6 text-right"> <b>الخاصة بها دون تغير ولا يقبل ضمان</b></div></div> ';
    //ReportHTML += '       <div class="row col-xs-12"><div class="col-xs-6 text-left"> <b>Of Will Be Accepted.</b> </div><div class="col-xs-6 text-right"> <b>عوضا عن ذلك</b></div></div> ';



    ReportHTML += '         </body>';
    ReportHTML += '         <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '         </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_AWB(data, pDocumentTypeID, pOption, IsA4Paper) {
    if (IsA4Paper == 0 || $("#slPrintType").val().toUpperCase() == "ORIGINAL") {
        //if the spaces to be changed then take a copy from the function for each condition([IsA4Paper == 0] for Venus Printer & [$("#slPrintType").val().toUpperCase() == "ORIGINAL"] for normal printers)
        DocsOut_Print_AWBBillDoc(data, pDocumentTypeID, pOption);
    }
    else {
        DocsOut_Print_AWBA4Paper(data, pDocumentTypeID, pOption);
    }
}
function DocsOut_Print_AWBBillDoc(data, pDocumentTypeID, pOption) {
    $('#billpattern').removeClass('hide');
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pOperationContainerAndPackages = JSON.parse(data[32]);
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62];
    var pVolumeSum = data[63];
    var pHouseNumber = data[64];

    var pAgentName = data[65];
    var pAgentContactName = data[66];
    var pAgentPhones = data[67];
    var pAgentFax = data[68];
    var pAgentEmail = data[69];
    var pAgentAddressLine1 = data[70];
    var pAgentAddressLine2 = data[71];
    var pAgentCityName = data[72];
    var pAgentCountryName = data[73];
    var pPickupAddress = data[74];
    var pDeliveryAddress = data[75];
    var pETAPOLDate = data[76];
    var pCustomerReference = data[77];
    var pMasterBL = data[78];
    var pRepBLTypeShown = data[79];
    var pBranchName = data[80];
    var pOperationHeader = JSON.parse(data[81]);

    var pPrintedBills = JSON.parse(data[82]);
    var pShipperBankAccount = data[83];
    var pConsigneeBankAccount = data[84];
    var pPayable = JSON.parse(data[85]);

    var pOperationContainerAndPackages_GLS = JSON.parse(data[86]); //kk:by kelany (it seems to be getting cargo on master when printing for house: ask why?)

    var maxLinesAllowedInTable = 21;
    var pIsPrintLines = false; //($("#cbPrintLogo").prop("checked") ? true : false);
    debugger;
    //var pDefaultsHeader = JSON.parse(pData[0]);
    ////TODO: Handle if Print other voyage instead

    //pDescriptionOfGoods.replace(/\n/g, "<br />")
    //ReportHTML += '<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>';
    //ReportHTML += '<hr style="width:100%;height:0px;border:.5px solid #000;">';
    ////the next line is to draw a line by div
    //ReportHTML += '                 <div class="m-l m-t" style="height:0px;border:' + (pIsPrintLines ? ".5px" : "0px") + ' solid blue;"></div>';
    /////////////////// preapare packgage ////////////////////
    var ChargeableWeight = "";
    var GrossWeight = "";
    var Quantity = "";
    var Rate = "";
    //var IsMinimum = "";
    var PckgTtl = "";
    var DescriptionOfGoods = "";
    //loop
    $.each(pOperationContainerAndPackages, function (i, item) {
        if (i == 0) {
            ChargeableWeight = item.ChargeableWeight + "</br>";
            GrossWeight = item.GrossWeight + "</br>";
            Quantity = item.Quantity + item.MarksAndNumbers + "</br>";
            Rate = item.Rate + "</br>";
            PckgTtl = (item.Rate == "0" || item.Rate == null ? "AS AGREED" : (item.IsMinimum == true ? item.Rate : (item.GrossWeight > item.ChargeableWeight ? item.GrossWeight * item.Rate : item.ChargeableWeight * item.Rate))) + "</br>";
            DescriptionOfGoods = item.DescriptionOfGoods + "</br>";
        }
        else {
            ChargeableWeight = ChargeableWeight + item.ChargeableWeight + "</br>";
            GrossWeight = GrossWeight + item.GrossWeight + "</br>";
            Quantity = Quantity + item.Quantity + "</br>";
            Rate = Rate + item.Rate + "</br>";
            PckgTtl = PckgTtl + (item.Rate == "0" || item.Rate == null ? "AS AGREED" : (item.IsMinimum == true ? item.Rate : (item.GrossWeight > item.ChargeableWeight ? item.GrossWeight * item.Rate : item.ChargeableWeight * item.Rate))) + "</br>";
            DescriptionOfGoods = DescriptionOfGoods + item.DescriptionOfGoods + "</br>";
        }


    });

    /////////////////// end preapare packgage ////////////////////

    /////////////////// preapare payable ////////////////////
    var PayableStr;
    var PayableShStr = " ";
    var PayableCount = 0;
    var _SH = 0;
    //loop
    $.each(pPayable, function (i, item) {
        if (item.ChargeTypeCode == "SH") {
            _SH += parseFloat(item.CostAmount);
            //PayableShStr = "&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp" + (item.CostPrice == 0 ? PayableShStr : item.ChargeTypeCode + "=" + item.CostPrice + "&nbsp");
            PayableShStr = "&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp" + (_SH == 0 ? PayableShStr : item.ChargeTypeCode + "=" + _SH + "&nbsp");
        }
        else {


            if (i == 0) {
                //PayableStr = (item.CostPrice == 0 ? PayableStr : item.ChargeTypeCode + "=" + item.CostPrice + "&nbsp");
                PayableStr = (item.CostAmount == 0 ? PayableStr : item.ChargeTypeCode + "=" + item.CostAmount + "&nbsp");
            }
            else {
                //PayableStr = (item.CostPrice == 0 ? PayableStr : PayableStr + item.ChargeTypeCode + "=" + item.CostPrice + "&nbsp");
                PayableStr = (item.CostAmount == 0 ? PayableStr : PayableStr + item.ChargeTypeCode + "=" + item.CostAmount + "&nbsp");
            }
            //PayableCount = (item.CostPrice == 0 ? PayableCount : PayableCount + 1);
            PayableCount = (item.CostAmount == 0 ? PayableCount : PayableCount + 1);
            if (PayableCount == 4) {
                PayableCount == 0
                PayableStr = PayableStr + "</br>"
            }
        }
    });
    PayableStr = PayableStr + "</br>" + PayableShStr;
    /////////////////// end preapare payable ////////////////////
    var ReportHTML = ' ';
    //   var htmlcontent = $('#billpattern').html();
    //  $(htmlcontent).load("/Content/HTML/AirLineBillPattern.html");
    //  ReportHTML += $(htmlcontent).html();
    //  console.log($(htmlcontent).html());



    //ReportHTML += '<html>';
    //ReportHTML += '     <head><title>' + 'Print AWB' + (pIsPrintLines ? " With Logo" : "Without Logo") + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    //ReportHTML += '         <body style="background-color:white;">';
    $.each(pPrintedBills, function (i, item) { //loop for the case that i wanted to print multiple AWBs at a time 
        if (i > 0)
            //    ReportHTML += '         <div class="break"></div>';
            ////ReportHTML += '<div style="height:3.5cm!important;"></div>'//pull-in   // pull-out
            //ReportHTML += '             <div id="tt" class="" style="height:97%; width:100%; margin-left:11.42%;">';//width = 21 old margin (2.4/21)*100=11.42 //width = 21  margin (1.8/21)*100=8.57
            //ReportHTML += '<div style="height:9%!important; width:100%;"></div>'//9.25//old (3.1/30.3)*100=10.23// (2.5/30.3)*100=8.25
            //ReportHTML += '                 <div class="col-xs-6 b-blue ' + (pIsPrintLines ? "b-t b-r" : "") + '" style="height:37.29%;width:43.80%;">';// (11.3/30.3)*100 ,width =//39//42//old 43.80 //old (9.2/19.2)*100=47.91
            //ReportHTML += '                     <div class="b-blue row" style="height:0%; font-size:13px;"><b>';//  (0/11.3)*100=0// old (0.6/11.3)*100=5.30// old (1.1/11.3)*100=9.73
            //ReportHTML += ($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp &nbsp" + item.POLCode.replace(/\n/g, "<br />") + "&nbsp  &nbsp" + item.HouseNumber;
            //ReportHTML += '                     </b></div>';

            //-------------header 1--------------
            $('#header1_box').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp" + item.POLCode.replace(/\n/g, "<br />") + "&nbsp  &nbsp" + item.MAWBSuffix);
        $('#header1_box').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + item.POLCode.replace(/\n/g, "<br />") + "&nbsp  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + item.HouseNumber);

        $('#Header2_box').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp &nbsp-&nbsp &nbsp" + item.MAWBSuffix);

        $('#AirWayBill_box').html(($("#hIsBillM").val() == "1" ? item.AirlineName : "H.AWB"));

        $('#Shipper_box').html(pShipperName + "<span style='float:right;'>" + pShipperBankAccount + "</span><br>"
            + (item.ShipperAddress == "0" || item.ShipperAddress == "" ? "" : item.ShipperAddress.replace(/\n/g, "<br />") + '</br>')
            //+ (item.ShipperPhone == "0" || item.ShipperPhone == "" ? "" : 'TEL:' + item.ShipperPhone + ' ')
            //+ (item.ShipperFax == "0" || item.ShipperFax == "" ? "" : 'FAX:' + item.ShipperFax + ' ')
            + (item.ShipperPhonesAndFaxes == "0" || item.ShipperPhonesAndFaxes == "" ? "" : item.ShipperPhonesAndFaxes + ' ')
        );

        $('#Consignee_box').html(//*******
            '<br/>' + pConsigneeName + "<span style='float:right!important;'><br/>" + pConsigneeBankAccount + "</span><br>"
            + (item.ConsigneeAddress == "0" ? "" : item.ConsigneeAddress.replace(/\n/g, "<br />") + '</br>') // (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ')
            //+ (item.ConsigneePhone == "0" ? "" : 'TEL:' + item.ConsigneePhone + ' ')//(pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ')
            //+ (item.ConsigneeFax == "0" ? "" : 'FAX:' + item.ConsigneeFax + ' ')
            + (item.ConsigneePhonesAndFaxes == "0" || item.ConsigneePhonesAndFaxes == "" ? "" : item.ConsigneePhonesAndFaxes + ' ')
        );

        $('#IssueCarrier_box').html(pEnCompanyName + "<br>"//+ pAgentName //*********
            + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1 + ' ')
            + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2 + ' ')
            + (pAgentCityName == "" ? "" : ', ' + pAgentCityName + ', ')
            + pAgentCountryName);


        $('#AccountingInformation_Box').html('<br>' + (item.POrC == 3 ? "PP" : "CC") + "<br>" + (item.AccountingInformation == 0 ? "" : item.AccountingInformation.replace(/\n/g, "<br />")));


        $('#AgentCode_Box').html('<br/>90-4-7016');

        $('#AccountNo_box').html('  ');

        $('#AirportOfDeparture_box').html('<br/>' + item.POLCode.replace(/\n/g, "<br />") + " INT A/P");


        $('#to1_box').html(item.Via1Code.slice(2, 5).replace(/\n/g, "<br />"));
        $('#ByFirstCarrier_box').html(item.AirlineCode1.replace(/\n/g, "<br />"));
        $('#to2_box').html(item.Via2Code.slice(2, 5).replace(/\n/g, "<br />"));



        $('#by1_box').html((item.AirlineCode2 == "" ? "" : item.AirlineCode2.replace(/\n/g, "<br />")) + item.Via3Code.slice(2, 5).replace(/\n/g, "<br />"));
        $('#to3_box').html((item.AirlineCode3 == "" ? "" : item.AirlineCode3.replace(/\n/g, "<br />")));



        $('#by2_box').html((item.CurrencyCode == "" ? "    " : item.CurrencyCode + "&nbsp;") + ' ' + (item.POrC == 3 ? "P " : "C "));



        $('#currencyCPCPC_box').html(

            (item.POrC == 3 ? "P&nbsp;&nbsp;&nbsp;&nbsp;" : "&nbsp;&nbsp;&nbsp;&nbsp;")//"  " : item.WT_VALL;
            + (item.POrC != 3 ? "C&nbsp;&nbsp;&nbsp;&nbsp;" : "&nbsp;&nbsp;&nbsp;&nbsp;")//"  " : item.WT_VALL;
            + (item.POrC == 3 ? "P&nbsp;&nbsp;&nbsp;&nbsp;" : "&nbsp;&nbsp;&nbsp;&nbsp;")//item.WT_VALL_Other;
            + (item.POrC != 3 ? "C " : " "));//item.WT_VALL_Other;);



        $('#DeclaredValue1_box').html("&nbsp;&nbsp;&nbsp;NDV");

        $('#DeclaredValue2_box').html("NCV");

        $('#ReferenceNo_box').html((item.ReferenceNumnber == 0 ? "" : item.ReferenceNumnber));
        $('#OptionalShippingInformation_box').html((item.OptionalShippingInformation == 0 ? "" : item.OptionalShippingInformation)); //*************
        //$('#AirPortOfDestination_box').html((item.PODCode == 0 ? " " : item.PODName));
        $('#AirPortOfDestination_box').html((item.PODCode == 0 ? " " : item.PODCode));

        $('#RequestedFlight_box').html("&nbsp;&nbsp;&nbsp;" + item.FlightNo.replace(/\n/g, "<br />"));
        $('#RequestedFlightDate_box').html("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + ConvertDateFormat(GetDateWithFormatMDY(item.BLDate)));
        //$('#AccountOfInsurance_box').html("&nbsp &nbsp" + item.AmountOfInsurance);
        $('#AccountOfInsurance_box').html("&nbsp &nbsp" + item.AmountOfInsurance == 0 ? 'XXXXXX' : item.AmountOfInsurance);


        $('#HandlingInformation_Box').html((item.HandlingInformation == 0 ? "" : '<br/>' + item.HandlingInformation.replace(/\n/g, "<br />")));

        $('#SCI_Box').html((item.SCI == undefined ? '' : '')); //**********

        var ChargeableWeight = "";
        var GrossWeight = "";
        var Quantity = "";
        var Rate = "";
        var PckgTtl = "";
        var DescriptionOfGoods = "";
        //////loop
        $.each(pOperationContainerAndPackages, function (i, PckgItem) {
            ChargeableWeight = ChargeableWeight + PckgItem.ChargeableWeight + "</br>";
            GrossWeight = GrossWeight + PckgItem.GrossWeight + "</br>";
            Quantity = Quantity + PckgItem.Quantity + "</br>";
            Rate = Rate + PckgItem.Rate + "</br>";
            PckgTtl = PckgTtl + (PckgItem.Rate == "0" || PckgItem.Rate == null ? "AS AGREED" : (PckgItem.GrossWeight > PckgItem.ChargeableWeight ? PckgItem.GrossWeight * PckgItem.Rate : PckgItem.ChargeableWeight * PckgItem.Rate)) + "</br>";
            DescriptionOfGoods = DescriptionOfGoods + PckgItem.DescriptionOfGoods + "</br>";

        });





        $('#RCP_box').html('<br/>' + Quantity);
        $('#GrossWeight_box').html('<br/>' + GrossWeight);
        $('#ChargeableWeight_box').html('<br/>' + ChargeableWeight);
        $('#RateCharges_box').html('<br/>' + Rate);
        $('#Total_box').html('<br/><br/>' + PckgTtl); //total
        $('#DescriptionOfGoods_box').html((item.CommodityName == '0' ? item.Description.replace(/\n/g, "<br />") : item.CommodityName + '</br>' + item.Description.replace(/\n/g, "<br />")));




        $('#prepaid_box').html((item.POrC == 3 ? (item.WeightCharge == "0" ? "" : item.WeightCharge) : "  "));
        $('#Collect_box').html((item.POrC != 3 ? (item.WeightCharge == "0" ? "" : item.WeightCharge) : "  "));
        $('#OtherCharges_box').html(PayableStr);
        $('#ValutationCharge_Prepaid_box').html((item.POrC == 3 ? (item.ValuationCharge == "0" ? "" : item.ValuationCharge) : "  "));
        $('#ValidationCharge_Collect_Box').html((item.POrC != 3 ? (item.ValuationCharge == "0" ? "" : item.ValuationCharge) : "  "));
        //$('#Tax1_box').html((item.POrC == 3 ? (item.Tax == "0" ? "" : item.Tax) : "  "));
        //$('#Tax2_box').html((item.POrC != 3 ? (item.Tax == "0" ? "" : item.Tax) : "  "));
        $('#Tax1_box').html((item.POrC == 3 ? ($("#txtTax").val() == 0 ? "" : $("#txtTax").val()) : "  "));
        $('#Tax2_box').html((item.POrC != 3 ? ($("#txtTax").val() == 0 ? "" : $("#txtTax").val()) : "  "))
        $('#TotalDueAgent1_box').html((item.POrC == 3 ? (item.OtherChargesDueAgent == "0" ? "" : item.OtherChargesDueAgent) : "  "));
        $('#TotalDueAgent2_box').html((item.POrC != 3 ? (item.OtherChargesDueAgent == "0" ? "" : item.OtherChargesDueAgent) : "  "));
        $('#TotalDueCarrier1_box').html("<br/>" + (item.POrC == 3 ? (item.OtherChargesDueCarrier == "0" ? "" : item.OtherChargesDueCarrier) : "  "));
        $('#TotalDueCarrier2_box').html("<br/>" + (item.POrC != 3 ? (item.OtherChargesDueCarrier == "0" ? "" : item.OtherChargesDueCarrier) : "  "));


        //var BillTtl = (item.WeightCharge + item.Tax + item.OtherChargesDueCarrier);
        var BillTtl = (item.WeightCharge + parseFloat($("#txtTax").val() == 0 ? 0 : $("#txtTax").val()) + item.OtherChargesDueCarrier);
        $('#TotalPrepaid_box').html("<br/><br/>" + (item.POrC == 3 ? BillTtl : " "));
        $('#TotalCollect_box').html((item.POrC != 3 ? BillTtl : " "));


        $('#SignDate_box').html(ConvertDateFormat(GetDateWithFormatMDY(item.BLDate)).toString());
        $('#SignPlace_box').html(item.POLCode.replace(/\n/g, "<br />") + " A/P");
        $('#SignUser_box').html($("#hLoggedUserNameNotLogin").val().toString()); //********



    }); //of $.each(pPrintedBills, function (i, item) { //loop for the case that i wanted to print multiple AWBs at a time


    ReportHTML = $('#billpattern').html();
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
    $('#billpattern').addClass('hide');
}
function DocsOut_Print_AWBA4Paper(data, pDocumentTypeID, pOption) {
    $('#billpattern1').removeClass('hide');
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pOperationContainerAndPackages = JSON.parse(data[32]);
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62];
    var pVolumeSum = data[63];
    var pHouseNumber = data[64];

    var pAgentName = data[65];
    var pAgentContactName = data[66];
    var pAgentPhones = data[67];
    var pAgentFax = data[68];
    var pAgentEmail = data[69];
    var pAgentAddressLine1 = data[70];
    var pAgentAddressLine2 = data[71];
    var pAgentCityName = data[72];
    var pAgentCountryName = data[73];
    var pPickupAddress = data[74];
    var pDeliveryAddress = data[75];
    var pETAPOLDate = data[76];
    var pCustomerReference = data[77];
    var pMasterBL = data[78];
    var pRepBLTypeShown = data[79];
    var pBranchName = data[80];
    var pOperationHeader = JSON.parse(data[81]);

    var pPrintedBills = JSON.parse(data[82]);
    var pShipperBankAccount = data[83];
    var pConsigneeBankAccount = data[84];
    var pPayable = JSON.parse(data[85]);

    var pOperationContainerAndPackages_GLS = JSON.parse(data[86]); //kk:by kelany (it seems to be getting cargo on master when printing for house: ask why?)

    var maxLinesAllowedInTable = 21;
    var pIsPrintLines = false; //($("#cbPrintLogo").prop("checked") ? true : false);
    debugger;
    //var pDefaultsHeader = JSON.parse(pData[0]);
    ////TODO: Handle if Print other voyage instead

    //pDescriptionOfGoods.replace(/\n/g, "<br />")
    //ReportHTML += '<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>';
    //ReportHTML += '<hr style="width:100%;height:0px;border:.5px solid #000;">';
    ////the next line is to draw a line by div
    //ReportHTML += '                 <div class="m-l m-t" style="height:0px;border:' + (pIsPrintLines ? ".5px" : "0px") + ' solid blue;"></div>';
    /////////////////// preapare packgage ////////////////////
    var ChargeableWeight = "";
    var GrossWeight = "";
    var Quantity = "";
    var Rate = "";
    //var IsMinimum = "";
    var PckgTtl = "";
    var DescriptionOfGoods = "";
    //loop
    $.each(pOperationContainerAndPackages, function (i, item) {
        if (i == 0) {
            ChargeableWeight = item.ChargeableWeight + "</br>";
            GrossWeight = item.GrossWeight + "</br>";
            Quantity = item.Quantity + item.MarksAndNumbers + "</br>";
            Rate = item.Rate + "</br>";
            PckgTtl = (item.Rate == "0" || item.Rate == null ? "AS AGREED" : (item.IsMinimum == true ? item.Rate : (item.GrossWeight > item.ChargeableWeight ? item.GrossWeight * item.Rate : item.ChargeableWeight * item.Rate))) + "</br>";
            DescriptionOfGoods = item.DescriptionOfGoods + "</br>";
        }
        else {
            ChargeableWeight = ChargeableWeight + item.ChargeableWeight + "</br>";
            GrossWeight = GrossWeight + item.GrossWeight + "</br>";
            Quantity = Quantity + item.Quantity + "</br>";
            Rate = Rate + item.Rate + "</br>";
            PckgTtl = PckgTtl + (item.Rate == "0" || item.Rate == null ? "AS AGREED" : (item.IsMinimum == true ? item.Rate : (item.GrossWeight > item.ChargeableWeight ? item.GrossWeight * item.Rate : item.ChargeableWeight * item.Rate))) + "</br>";
            DescriptionOfGoods = DescriptionOfGoods + item.DescriptionOfGoods + "</br>";
        }


    });

    /////////////////// end preapare packgage ////////////////////

    /////////////////// preapare payable ////////////////////
    var PayableStr;
    var PayableShStr = " ";
    var PayableCount = 0;
    var _SH = 0;
    var TotalCostAmount = 0;
    //loop
    $.each(pPayable, function (i, item) {
        TotalCostAmount += parseFloat(item.CostAmount);
        if (item.ChargeTypeCode == "SH") {
            _SH += parseFloat(item.CostAmount);
            //PayableShStr = "&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp" + (item.CostPrice == 0 ? PayableShStr : item.ChargeTypeCode + "=" + item.CostPrice + "&nbsp");
            PayableShStr = "&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp" + (_SH == 0 ? PayableShStr : item.ChargeTypeCode + "=" + _SH + "&nbsp");
        }
        else {


            if (i == 0) {
                //PayableStr = (item.CostPrice == 0 ? PayableStr : item.ChargeTypeCode + "=" + item.CostPrice + "&nbsp");
                PayableStr = (item.CostAmount == 0 ? PayableStr : item.ChargeTypeCode + "=" + item.CostAmount + "&nbsp");
            }
            else {
                //PayableStr = (item.CostPrice == 0 ? PayableStr : PayableStr + item.ChargeTypeCode + "=" + item.CostPrice + "&nbsp");
                PayableStr = (item.CostAmount == 0 ? PayableStr : PayableStr + item.ChargeTypeCode + "=" + item.CostAmount + "&nbsp");
            }
            PayableCount = (item.CostPrice == 0 ? PayableCount : PayableCount + 1);
            PayableCount = (item.CostAmount == 0 ? PayableCount : PayableCount + 1);
            if (PayableCount == 4) {
                PayableCount == 0
                PayableStr = PayableStr + "</br>"
            }
        }
    });
    PayableStr = PayableStr + "</br>" + PayableShStr;
    /////////////////// end preapare payable ////////////////////
    var ReportHTML = ' ';
    //   var htmlcontent = $('#billpattern').html();
    //  $(htmlcontent).load("/Content/HTML/AirLineBillPattern.html");
    //  ReportHTML += $(htmlcontent).html();
    //  console.log($(htmlcontent).html());



    //ReportHTML += '<html>';
    //ReportHTML += '     <head><title>' + 'Print AWB' + (pIsPrintLines ? " With Logo" : "Without Logo") + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    //ReportHTML += '         <body style="background-color:white;">';
    $.each(pPrintedBills, function (i, item) { //loop for the case that i wanted to print multiple AWBs at a time 
        if (i > 0)
            //    ReportHTML += '         <div class="break"></div>';
            ////ReportHTML += '<div style="height:3.5cm!important;"></div>'//pull-in   // pull-out
            //ReportHTML += '             <div id="tt" class="" style="height:97%; width:100%; margin-left:11.42%;">';//width = 21 old margin (2.4/21)*100=11.42 //width = 21  margin (1.8/21)*100=8.57
            //ReportHTML += '<div style="height:9%!important; width:100%;"></div>'//9.25//old (3.1/30.3)*100=10.23// (2.5/30.3)*100=8.25
            //ReportHTML += '                 <div class="col-xs-6 b-blue ' + (pIsPrintLines ? "b-t b-r" : "") + '" style="height:37.29%;width:43.80%;">';// (11.3/30.3)*100 ,width =//39//42//old 43.80 //old (9.2/19.2)*100=47.91
            //ReportHTML += '                     <div class="b-blue row" style="height:0%; font-size:13px;"><b>';//  (0/11.3)*100=0// old (0.6/11.3)*100=5.30// old (1.1/11.3)*100=9.73
            //ReportHTML += ($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp &nbsp" + item.POLCode.replace(/\n/g, "<br />") + "&nbsp  &nbsp" + item.HouseNumber;
            //ReportHTML += '                     </b></div>';


            $('#header1_box1Sup1').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 "));
        $('#header1_box1Sup1').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 "));
        $('#header1_box1Sup1').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 "));
        $('#header1_box1Sup2').html(item.POLCode.replace(/\n/g, "<br />"));
        $('#header1_box1Sup3').html(item.MAWBSuffix + "<span style='float:right;'>" + ($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp &nbsp-&nbsp &nbsp" + item.MAWBSuffix + "</span>");
        // $('#Header2_box2').html(($("#hIsBillM").val() == "1" ? item.AirlinePrefix : "0 ") + "&nbsp &nbsp-&nbsp &nbsp" + item.HouseNumber);

        $('#AirWayBill_box1').html(($("#hIsBillM").val() == "1" ? item.AirlineName : "H.AWB"));

        $('#Shipper_box1').html(pShipperName + '<br>' +
            (item.ShipperAddress == "0" || item.ShipperAddress == "" ? "" : item.ShipperAddress.replace(/\n/g, "<br />") + '</br>')
            //+ (item.ShipperPhone == "0" || item.ShipperPhone == "" ? "" : 'TEL:' + item.ShipperPhone + ' ')
            //+ (item.ShipperFax == "0" || item.ShipperFax == "" ? "" : 'FAX:' + item.ShipperFax + ' ')
            + (item.ShipperPhonesAndFaxes == "0" || item.ShipperPhonesAndFaxes == "" ? "" : item.ShipperPhonesAndFaxes + ' ')
        );

        //$('#ShipperName_Box1').html('<br>' + pShipperName);
        $('#ShipperName_Box1').html('<br> ');

        $('#ShipperAccount_box1').html(pShipperBankAccount);

        $('#Consignee_box1').html(pConsigneeName +
            '<br>' + (item.ConsigneeAddress == "0" ? "" : item.ConsigneeAddress.replace(/\n/g, "<br />") + '</br>') // (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ')
            //+ (item.ConsigneePhone == "0" ? "" : 'TEL:' + item.ConsigneePhone + ' ')//(pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ')
            //+ (item.ConsigneeFax == "0" ? "" : 'FAX:' + item.ConsigneeFax + ' ')
            + (item.ConsigneePhonesAndFaxes == "0" || item.ConsigneePhonesAndFaxes == "" ? "" : item.ConsigneePhonesAndFaxes + ' ')
        );
        //$('#ConsigneeName_Box1').html('<br>' + pConsigneeName);
        $('#ConsigneeName_Box1').html('<br> ');
        $('#ConsigneeAccount_box1').html(pConsigneeBankAccount);
        //-----------

        $('#IssueCarrier_box1').html(pEnCompanyName + "<br>"//+ pAgentName //*********
            + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1 + ' ')
            + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2 + ' ')
            + (pAgentCityName == "" ? "" : ', ' + pAgentCityName + ', ')
            + pAgentCountryName);


        $('#AccountingInformation_Box1').html('<br>' + (item.POrC == 3 ? "PP" : "CC") + "<br>" + (item.AccountingInformation == 0 ? "" : item.AccountingInformation.replace(/\n/g, "<br />")));

        if (pDefaults.UnEditableCompanyName == "DGL") {
            $('#AgentCode_Box1').html('90-4-7227');
        }
        else {
            $('#AgentCode_Box1').html('90-4-7016');
        }

        $('#AccountNo_box1').html('  ');

        $('#AirportOfDeparture_box1').html(item.POLCode.replace(/\n/g, "<br />") + " INT A/P");
        //***************************

        //kk
        if (pDefaults.UnEditableCompanyName == "DGL") {
            $('#to1_box1').html((item.PODCode == 0 ? " " : item.PODCode));
        }
        else {
            $('#to1_box1').html(item.Via1Code.slice(2, 5).replace(/\n/g, "<br />"));
        }




        //$('#to1_box1').html(item.Via1Code.slice(2, 5).replace(/\n/g, "<br />"));
        $('#ByFirstCarrier_box1').html(item.AirlineCode1.replace(/\n/g, "<br />"));
        $('#to2_box1').html(item.Via2Code.slice(2, 5).replace(/\n/g, "<br />"));
        $('#by1_box1').html((item.AirlineCode2 == "" ? "" : item.AirlineCode2.replace(/\n/g, "<br />")));
        $('#to3_box1').html(item.Via3Code.slice(2, 5).replace(/\n/g, "<br />"));
        $('#by2_box1').html((item.AirlineCode3 == "" ? "" : item.AirlineCode3.replace(/\n/g, "<br />")));
        //kk
        if (pDefaults.UnEditableCompanyName == "DGL") {
            $('#p1_box1').html(item.POrCCode == 0 ? "" : (item.POrCCode + "" + item.POrCCode));
            $('#p2_box1').html(item.POrCCode == "P" ? "X" : "");
            $('#p3_box1').html(item.POrCCode == "C" ? "X" : "");
            $('#p4_box1').html(item.POrCCode == "P" ? "X" : "");
            $('#p5_box1').html(item.POrCCode == "C" ? "X" : "");
        }
        else {
            $('#p1_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
            $('#p2_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
            $('#p3_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
            $('#p4_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
            $('#p5_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
        }

        $('#currency_box1').html((item.CurrencyCode == "" ? " " : item.CurrencyCode));
        //$('#p1_box1').html((item.POrC == 3 ? "P " : "C "));
        //$('#p2_box1').html((item.POrC == 3 ? "P" : " "));
        //$('#p3_box1').html((item.POrC != 3 ? "C" : " "));
        //$('#p4_box1').html((item.POrC == 3 ? "P" : " "));
        //$('#p5_box1').html((item.POrC != 3 ? "C " : " "));

        //$('#p1_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
        //$('#p2_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
        //$('#p3_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
        //$('#p4_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
        //$('#p5_box1').html(item.POrCCode == 0 ? "" : item.POrCCode);
        //**********************************
        $('#DeclaredValue1_box1').html("NDV");

        $('#DeclaredValue2_box1').html("NCV");
        //**********************************
        $('#ReferenceNo_box1').html((item.ReferenceNumnber == 0 ? "" : item.ReferenceNumnber));
        $('#OptionalShippingInformation_box1').html((item.OptionalShippingInformation == 0 ? "" : item.OptionalShippingInformation)); //*************
        //$('#AirPortOfDestination_box1').html((item.PODCode == 0 ? " " : item.PODName));
        if (pDefaults.UnEditableCompanyName == "DGL") {
            $('#AirPortOfDestination_box1').html((item.PODName == 0 ? " " : item.PODName));
        }
        else {
            $('#AirPortOfDestination_box1').html((item.PODCode == 0 ? " " : item.PODCode));
        }


        $('#RequestedFlight_box1').html(item.FlightNo.replace(/\n/g, "<br />"));
        $('#RequestedFlightDate_box1').html(ConvertDateFormat(GetDateWithFormatMDY(item.BLDate)));
        $('#AccountOfInsurance_box1').html(item.AmountOfInsurance == 0 ? 'XXXXXX' : item.AmountOfInsurance);


        $('#HandlingInformation_Box1').html((item.HandlingInformation == 0 ? "" : '<br/>' + item.HandlingInformation.replace(/\n/g, "<br />")));

        //*************************************
        $('#SCI_box1').html((item.SCI == undefined ? '' : '')); //**********

        var ChargeableWeight = "";
        var GrossWeight = "";
        var Quantity = "";
        var Rate = "";
        var PckgTtl = "";
        var DescriptionOfGoods = "";
        var RateClass = "";
        var WeightUnit = "";
        //////loop
        var Total_PckgTtl = 0;
        $.each(pOperationContainerAndPackages, function (i, PckgItem) {
            ChargeableWeight = ChargeableWeight + PckgItem.ChargeableWeight + "</br>";
            GrossWeight = GrossWeight + PckgItem.GrossWeight + "</br>";
            Quantity = Quantity + PckgItem.Quantity + "</br>";
            Rate = Rate + PckgItem.Rate + "</br>";
            Total_PckgTtl += (PckgItem.Rate == "0" || PckgItem.Rate == null ? "AS AGREED" : (PckgItem.GrossWeight > PckgItem.ChargeableWeight ? PckgItem.GrossWeight * PckgItem.Rate : PckgItem.ChargeableWeight * PckgItem.Rate));
            PckgTtl = PckgTtl + (PckgItem.Rate == "0" || PckgItem.Rate == null ? "AS AGREED" : (PckgItem.GrossWeight > PckgItem.ChargeableWeight ? PckgItem.GrossWeight * PckgItem.Rate : PckgItem.ChargeableWeight * PckgItem.Rate)) + "</br>";
            DescriptionOfGoods = DescriptionOfGoods + PckgItem.DescriptionOfGoods + "</br>";
            RateClass = RateClass + PckgItem.RateClass + "</br>";
            WeightUnit = WeightUnit + PckgItem.WeightUnit + "</br>";
        });


        //***********************
        //kk
        if (pDefaults.UnEditableCompanyName == "DGL") {
            //RateClass_box1      
            //KG_box1      
            if (RateClass == 0 || RateClass == "0" || RateClass == "")
                $('#KG_box1').html(RateClass);
            else
                $('#KG_box1').html(RateClass);
            if (WeightUnit == 0 || WeightUnit == "0" || WeightUnit == "")
                $('#RateClass_box1').html(WeightUnit);
            else
                $('#RateClass_box1').html(WeightUnit);

            $('#txtTotalFooter').html(Total_PckgTtl);
            $('#OtherCharges_box1').html(PayableStr);
            if (item.POrC == 3)//Prepaid
            {
                $('#TotalDueCarrier1_box1_Prepaid').html(TotalCostAmount);//Prepaid
                $('#prepaid_box1_B').html(Total_PckgTtl);//Prepaid
                $('#TotalPrepaid_box1').html(Total_PckgTtl + TotalCostAmount);//Collect

            }
            else//Collect
            {
                $('#TotalDueCarrier2_box1_Collect').html(TotalCostAmount);//Collect
                $('#Collect_box1_B').html(Total_PckgTtl);//Collect
                $('#TotalPrepaid_box1').html(Total_PckgTtl + TotalCostAmount);//Collect

            }

        }


        $('#RCP_box1').html(Quantity);
        $('#GrossWeight_box1').html(GrossWeight);
        $('#ChargeableWeight_box1').html(ChargeableWeight);
        $('#RateCharges_box1').html(Rate);
        $('#Total_box1').html(PckgTtl); //total
        $('#DescriptionOfGoods_box1').html((item.CommodityName == '0' ? item.Description.replace(/\n/g, "<br />") : item.CommodityName + '</br>' + item.Description.replace(/\n/g, "<br />")));


        //***********************

        $('#prepaid_box1').html((item.POrC == 3 ? (item.WeightCharge == "0" ? "" : item.WeightCharge) : "  "));
        $('#Collect_box1').html((item.POrC != 3 ? (item.WeightCharge == "0" ? "" : item.WeightCharge) : "  "));

        $('#ValutationCharge_Prepaid_box1').html((item.POrC == 3 ? (item.ValuationCharge == "0" ? "" : item.ValuationCharge) : "  "));
        $('#ValidationCharge_Collect_Box1').html((item.POrC != 3 ? (item.ValuationCharge == "0" ? "" : item.ValuationCharge) : "  "));
        //$('#Tax1_box1').html((item.POrC == 3 ? (item.Tax == "0" ? "" : item.Tax) : "  "));
        //$('#Tax2_box1').html((item.POrC != 3 ? (item.Tax == "0" ? "" : item.Tax) : "  "));
        $('#Tax1_box1').html((item.POrC == 3 ? ($("#txtTax").val() == 0 ? "" : $("#txtTax").val()) : "  "));
        $('#Tax2_box1').html((item.POrC != 3 ? ($("#txtTax").val() == 0 ? "" : $("#txtTax").val()) : "  "))
        $('#TotalDueAgent1_box1').html((item.POrC == 3 ? (item.OtherChargesDueAgent == "0" ? "" : item.OtherChargesDueAgent) : "  "));
        $('#TotalDueAgent2_box1').html((item.POrC != 3 ? (item.OtherChargesDueAgent == "0" ? "" : item.OtherChargesDueAgent) : "  "));
        $('#TotalDueCarrier1_box1').html((item.POrC == 3 ? (item.OtherChargesDueCarrier == "0" ? "" : item.OtherChargesDueCarrier) : "  "));
        $('#TotalDueCarrier2_box1').html((item.POrC != 3 ? (item.OtherChargesDueCarrier == "0" ? "" : item.OtherChargesDueCarrier) : "  "));


        //var BillTtl = (item.WeightCharge + item.Tax + item.OtherChargesDueCarrier);
        var BillTtl = (item.WeightCharge + parseFloat($("#txtTax").val() == 0 ? 0 : $("#txtTax").val()) + item.OtherChargesDueCarrier);
        $('#TotalPrepaid_box1').html((item.POrC == 3 ? BillTtl : " "));
        $('#TotalCollect_box1').html((item.POrC != 3 ? BillTtl : " "));
        if (item.POrC == 3)//Prepaid
        {
            $('#TotalPrepaid_box1').html(Total_PckgTtl + TotalCostAmount);//Collect

        }
        else//Collect
        {
            $('#TotalPrepaid_box1').html(Total_PckgTtl + TotalCostAmount);//Collect

        }

        $('#SignDate_box1').html(ConvertDateFormat(GetDateWithFormatMDY(item.BLDate)).toString());
        $('#SignPlace_box1').html(item.POLCode.replace(/\n/g, "<br />") + " A/P");
        $('#SignUser_box1').html($("#hLoggedUserNameNotLogin").val().toString()); //********



    }); //of $.each(pPrintedBills, function (i, item) { //loop for the case that i wanted to print multiple AWBs at a time


    //var ReportHTML_DGL = $('#billpattern1').html();
    //kk
    var ReportHTML_DGL = "";
    if (pDefaults.UnEditableCompanyName == "DGL") {
        if ($('#cbPrintOriginal1').prop('checked')) {
            $('#FooterCopy_Bill').html("Original 1 (For Issuing Carrier)");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintCopy5').prop('checked')) {
            $('#FooterCopy_Bill').html("Copy 5 (Extra Copy) ");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintOriginal2').prop('checked')) {
            $('#FooterCopy_Bill').html("Original 2 (For Consignee)");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintCopy6').prop('checked')) {
            $('#FooterCopy_Bill').html("Copy 6 (Extra Copy) ");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintOriginal3').prop('checked')) {
            $('#FooterCopy_Bill').html(" Original 3 (For Shipper) ");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintCopy7').prop('checked')) {
            $('#FooterCopy_Bill').html("Copy 7 (Extra Copy) ");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            //ReportHTML += '         <div class="break"></div>'; //to start a new page
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintCopy4').prop('checked')) {
            $('#FooterCopy_Bill').html("Copy 4 (Delivery Receipt)");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintCopy8').prop('checked')) {
            $('#FooterCopy_Bill').html("Copy 8 (For Agent)");
            ReportHTML_DGL = $('#billpattern1').html();
            ReportHTML += ReportHTML_DGL;
            ReportHTML += '        <p style="page-break-before: always">';
        }
        if ($('#cbPrintMoreExtra').prop('checked')) {
            var NumOfCopies = $('#NumPrintMoreExtra').val();
            var cnt = 0;
            for (cnt = 0; cnt < NumOfCopies; cnt++) {
                $('#FooterCopy_Bill').html("Copy");
                ReportHTML_DGL = $('#billpattern1').html();
                ReportHTML += ReportHTML_DGL;
                //ReportHTML += '         <div class="row col-sm-12" style="margin-left:300">Copy</div>';
                ReportHTML += '        <p style="page-break-before: always">';
            }

        }

        //ReportHTML += ReportHTML.substring((ReportHTML.length - 37), ReportHTML.length);
        ReportHTML = ReportHTML.substring(1, (ReportHTML.length - 37));
        ReportHTML = '<html><body>' + ReportHTML + '</body></html>'
    }
    else {
        ReportHTML = $('#billpattern1').html();
    }


    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
    $('#billpattern1').addClass('hide');
}
function DocsOut_Print_HBL_SGA(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pOperationContainerAndPackages = JSON.parse(data[32]);
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62];
    var pVolumeSum = data[63];
    var pHouseNumber = data[64];

    var pAgentName = data[65];
    var pAgentContactName = data[66];
    var pAgentPhones = data[67];
    var pAgentFax = data[68];
    var pAgentEmail = data[69];
    var pAgentAddressLine1 = data[70];
    var pAgentAddressLine2 = data[71];
    var pAgentCityName = data[72];
    var pAgentCountryName = data[73];
    var pPickupAddress = data[74];
    var pDeliveryAddress = data[75];
    var pETAPOLDate = data[76];
    var pCustomerReference = data[77];
    var pMasterBL = data[78];
    var pRepBLTypeShown = data[79];
    var pBranchName = data[80];
    var pOperationHeader = JSON.parse(data[81]);

    var pPrintedBills = JSON.parse(data[82]);
    var pShipperBankAccount = data[83];
    var pConsigneeBankAccount = data[84];
    var pPayable = JSON.parse(data[85]);

    var pOperationContainerAndPackages_GLS = JSON.parse(data[86]); //kk:by kelany (it seems to be getting cargo on master when printing for house: ask why?)

    var pNotify2Name = data[87];
    var pNotify2ContactName = data[88];
    var pNotify2Phones = data[89];
    var pNotify2Fax = data[90];
    var pNotify2Email = data[91];
    var pNotify2AddressLine1 = data[92];
    var pNotify2AddressLine2 = data[93];
    var pNotify2CityName = data[94];
    var pNotify2CountryName = data[95];

    var pShipper = JSON.parse(data[96]);
    var pConsignee = JSON.parse(data[97]);
    var pAgent = JSON.parse(data[98]);
    var pNotify1 = JSON.parse(data[99]);

    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
    ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-lg hide"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';

    ReportHTML += '             <div class="col-xs-12 m-t-n-md m-l-n text-right"><b></b> ' + pHouseNumber + '</div>';

    ReportHTML += '             <div class="m-t-n" style="width:100%;height:40%;">';
    ReportHTML += '                 <div class="m-t-n-xxs col-xs-7" style="height:100%;">';
    ReportHTML += '                     <div class="row" style="height:27%;">';
    ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u></u></b> ' + pShipperName + '</div>';
    //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
    //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + '</div>';
    //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
    //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
    //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + ' <u>Fax:</u> ' + pShipperFax + '</div>';
    ReportHTML += '                         <div class="col-xs-12"><u></u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
    ReportHTML += '                     </div>';
    ReportHTML += '                     <div class=" row" style="height:27%;">';
    ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u></u></b> ' + pConsigneeName + '</div>';
    ReportHTML += '                         <div class="col-xs-12"><u></u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
    ReportHTML += '                     </div>';
    ReportHTML += '                     <div class=" row" style="height:22%;">';
    ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u></u></b> ' + pNotify1Name + '</div>';
    ReportHTML += '                         <div class="col-xs-12"><u></u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
    ReportHTML += '                     </div>';
    ReportHTML += '                     <div class=" row" style="height:7%;">';
    ReportHTML += '                         <div class="col-xs-12" style="height:100%;"><b><u></u></b> ' + pPickupAddress + '</div>';
    //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Departure:</u></b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
    ReportHTML += '                     </div>';
    ReportHTML += '                     <div class="m-t-n-xxs row" style="height:7%;">';
    ReportHTML += '                         <div class="col-xs-4" style="height:50%;"><b><u></u></b> ' + pVesselName + '</div>';
    ReportHTML += '                         <div class="col-xs-4" style="height:50%;"><b><u></u></b> ' + pVoyageOrTruckNumber + '</div>';
    ReportHTML += '                         <div class="col-xs-4" style="height:50%;"><b><u></u></b> ' + pPOLCodeAndName.split('(')[0].trim() + '</div>';
    ReportHTML += '                     </div>';
    ReportHTML += '                     <div class="m-t-n-xxs row" style="height:7%;">';
    ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u></u></b> ' + pPODCodeAndName.split('(')[0].trim() + '</div>';
    ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u></u></b> ' + pDeliveryAddress + '</div>';
    ReportHTML += '                     </div>';
    ReportHTML += '                 </div>';
    ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="height:100%;">';
    //ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
    ReportHTML += '                     <div class="col-xs-12 m-l-lg"><br><br><br><br><br><h4>' + 'Agent' + '</h4></div>';
    ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAgentName + '</div>';
    ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAgentAddressLine1 + '</div>';
    ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAgentAddressLine2 + '</div>';
    ReportHTML += '                     <div class="col-xs-12 m-l-n"><u></u> ' + pAgentCountryName + '-' + pAgentCityName + '</div>';
    ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Phone(s) :</u> ' + pAgentPhones + '</div>';
    ReportHTML += '                 </div>';
    ReportHTML += '             </div>';

    ////ReportHTML += '                 <section class="panel panel-default">';
    //ReportHTML += '                     <div class="table-responsive">';
    ReportHTML += '<div> &nbsp; </div>'//no final shipping declaration for air
    ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-striped text-sm m-t-n-sm">';
    ReportHTML += '                             <thead>';
    //ReportHTML += '                                 <tr>';
    //ReportHTML += '                                     <th>Container(s)</th>';
    //ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
    //ReportHTML += '                                     <th>NetWgt(KG)</th>';
    //ReportHTML += '                                     <th>GrossWgt(KG)</th>';
    //ReportHTML += '                                     <th>VGM(KG)</th>';
    //ReportHTML += '                                 </tr>';
    ReportHTML += '                             </thead>';
    ReportHTML += '                             <tbody>';
    $.each(pOperationContainerAndPackages, function (i, item) { //this report is not for air
        if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            ReportHTML += '                                     <td style="width:20%; border-color:white!Important; vertical-align: top;">' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + '<br>T.W.' + item.TareWeight + 'KGS' + (item.CarrierSeal == 0 ? "" : ('<br>Seal #' + item.CarrierSeal)) + '</td>';
            ReportHTML += '                                     <td style="width:25%; border-color:white!Important; vertical-align: top;">' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + '</td>';
            ReportHTML += '                                     <td style="width:30%; border-color:white!Important; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            ReportHTML += '                                     <td style="width:15%; border-color:white!Important; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
            ReportHTML += '                                     <td style="width:10%; border-color:white!Important; vertical-align: top;">' + /*'VGM: ' + item.VGM + ' Kgm' +*/ '</td>'; //Supposed to be measurement
            ReportHTML += '                                 </tr>';
        }
        else { //final LCL (no final for air)
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            ReportHTML += '                                     <td style="width:13%; border-color:white!Important; vertical-align: top;">' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
            ReportHTML += '                                     <td style="width:25%; border-color:white!Important; vertical-align: top;">' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + '</td>';
            ReportHTML += '                                     <td style="width:25%; border-color:white!Important; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            ReportHTML += '                                     <td style="width:15%; border-color:white!Important; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
            ReportHTML += '                                     <td style="width:17%; border-color:white!Important; vertical-align: top;">' + item.Length + 'cm x ' + item.Width + 'cm x ' + item.Height + 'cm' + '</td>';
            ReportHTML += '                                 </tr>';
        }
    });
    ReportHTML += '                                 <tr>';
    //if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") //to add the totals row according to FCL or LCL
    //    ReportHTML += '                                 <td colspan=2><b>Totals:</b> ' + pContainerTypes + " <b>/</b> " + (pPackageTypesOnContainersTotals == "0" ? "" : pPackageTypesOnContainersTotals) + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td><td><b>TVGM: ' + pVGMSum + ' KG</b></td>';
    //else
    //    ReportHTML += '                                 <td colspan=2><b>Totals:</b> ' + pPackageTypes + '</td><td><b>TNW: ' + pNetWeightSum + ' KG</b></td><td><b>TGW: ' + pGrossWeightSum + ' KG</b></td>';
    ReportHTML += '                                 </tr>';
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table>';
    //ReportHTML += '                     </div>'; //of table-responsive
    ////ReportHTML += '                 </section>';
    ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
    //ReportHTML += '             <div class="col-xs-8 m-l m-t-n"><label><input type="checkbox" ' + (pPOrC == 'P' ? ' checked ' : '') + ' disabled="disabled">&nbsp;PrePaid</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
    //ReportHTML += '                                           <label><input type="checkbox" ' + (pPOrC == 'C' ? ' checked ' : '') + ' disabled="disabled">&nbsp;Collect</label></div>';
    //ReportHTML += '             <div class="col-xs-4 m-t-n float-right"><b><i>Signature & Stamp</i></b></div>';
    //ReportHTML += '             <div class="col-xs-12 m-t-xs">';
    //ReportHTML += '                 <b>Special Instructions:</b><br>';
    //ReportHTML += '                 <span class="m-l">-Number Of Bills required (3)Originals (3)Copies.</span>';
    //ReportHTML += '             </div">';
    ReportHTML += '         </body>';

    ReportHTML += '         <footer class="footer col-xs-12 hide" style="width:100%; position:absolute; bottom:0;">';
    //ReportHTML += '           <div class="row m-l">Please apply to our office with the original B/L to release your Delivery Order / Letter as soon as possible.</div>';
    //ReportHTML += '           <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '         </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        var mywindow = window.open('', '_blank');
        mywindow.document.write(ReportHTML);
        mywindow.document.close();
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
function DocsOut_Print_HBL_LAT(data, pDocumentTypeID, pOption) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pContainersAndPackages = data[32]; //objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62];
    var pVolumeSum = data[63];
    var pHouseNumber = data[64];

    var pAgentName = data[65];
    var pAgentContactName = data[66];
    var pAgentPhones = data[67];
    var pAgentFax = data[68];
    var pAgentEmail = data[69];
    var pAgentAddressLine1 = data[70];
    var pAgentAddressLine2 = data[71];
    var pAgentCityName = data[72];
    var pAgentCountryName = data[73];
    var pPickupAddress = data[74];
    var pDeliveryAddress = data[75];
    var pETAPOLDate = data[76];
    var pCustomerReference = data[77];
    var pMasterBL = data[78];
    var pRepBLTypeShown = data[79];
    var pBranchName = data[80];
    var pOperationHeader = JSON.parse(data[81]);

    var pPrintedBills = JSON.parse(data[82]);
    var pShipperBankAccount = data[83];
    var pConsigneeBankAccount = data[84];
    var pPayable = JSON.parse(data[85]);

    var pOperationContainerAndPackages_GLS = JSON.parse(data[86]); //kk:by kelany (it seems to be getting cargo on master when printing for house: ask why?)

    var pNotify2Name = data[87];
    var pNotify2ContactName = data[88];
    var pNotify2Phones = data[89];
    var pNotify2Fax = data[90];
    var pNotify2Email = data[91];
    var pNotify2AddressLine1 = data[92];
    var pNotify2AddressLine2 = data[93];
    var pNotify2CityName = data[94];
    var pNotify2CountryName = data[95];

    var pShipper = JSON.parse(data[96]);
    var pConsignee = JSON.parse(data[97]);
    var pAgent = JSON.parse(data[98]);
    var pNotify1 = JSON.parse(data[99]);

    var pIsPrintLines = false;
    var maxContainersWithoutAttachment = 12;

    var pContainerTypesInMutipleRows = "";
    for (var i = 0; i < pContainerTypes.split('-').length; i++)
        pContainerTypesInMutipleRows += ((i != 0 ? "<br>" : "") + pContainerTypes.split('-')[i]);

    var ReportHTML = '';
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    if (pDefaults.UnEditableCompanyName == "GLS" || pDefaults.UnEditableCompanyName == "GLD") {
        if (pOperationHeader.DirectionType == 1) // Import
        {

            ReportHTML += '<html>';
            ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
            ReportHTML += '         <body style="background-color:white;">';
            //        ReportHTML += '         <div class="break"></div>'; //to start a new page

            ReportHTML += '             <div class="row col-xs-12 m-t-n-lg m-l-md"><b style="font-size:18px;">COPY BILL OF LADING</b><b style="font-size:12px;"> NOT NEGOTIABLE UNLESS CONSIGNED ‘TO ORDER’</b></div>';
            ReportHTML += '             <div class="row col-xs-12 m-t-sm b-dark ">';
            ReportHTML += '                 <div class="col-xs-7" style="">';
            ReportHTML += '                   <div class="row col-xs-12 " >';
            //ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
            ReportHTML += '                     <div class="b-blue" style="">';
            ReportHTML += '                         <b><u>Shipper:</u></b>&nbsp;' + "<br><u>Address:</u>&nbsp;"
            ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                   </div><hr style="border-top:1px solid #0e0b0b;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="b-blue" style="">';
            ReportHTML += '                         <b><u>Consignee:</u>&nbsp;</b>' + pOperationHeader.Consignee2Name + "<br><u>Address:</u>" + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName;
            ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + pConsigneePhones + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     </div><hr style="border-top:1px solid #0e0b0b;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="b-blue">';
            ReportHTML += '                         <b><u>Notify Party:</u>&nbsp;</b>' + "<br><u>Address:</u>"
            ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     </div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px;">';




            ReportHTML += '                 </div>';
            ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="">';
            ReportHTML += '                     <div class="col-xs-12 m-l-lg"><h4>BILL OF LADING</h4></div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><b>B/L #:</b> ' + pHouseNumber + '</div>';
            ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><b>Delivery Agent :</b></div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-lg"><h4>' + pEnCompanyName + '</h4></div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine1 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine2 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine3 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine4 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine5 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Phone(s) :</u> ' + pPhones + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Fax :</u> ' + pFaxes + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + pEmail + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
            ReportHTML += '                 </div>';
            ReportHTML += '             </div>';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-striped text-sm">';
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Place Of Receipt</th>';
            ReportHTML += '                                     <th>Port Of Loading</th>';
            ReportHTML += '                                     <th>Vessel</th>';
            ReportHTML += '                                     <th>Port Of Discharge</th>';
            ReportHTML += '                                     <th>Place Of Delivery</th>';
            ReportHTML += '                                     <th>No. Of Bill of Lading</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr class="" style="font-size:100%;">';
            ReportHTML += '                                     <td>' + pPODCodeAndName + '</td>';
            ReportHTML += '                                     <td>' + pPOLCodeAndName + '</td>';
            ReportHTML += '                                     <td>' + pVesselName + '</td>';
            ReportHTML += '                                     <td>' + pPODCodeAndName + '</td>';
            ReportHTML += '                                     <td>' + pPODCodeAndName + '</td>';
            //ReportHTML += '                                     <td>' + pOperationHeader.DeliveryCityName + ':' + pOperationHeader.DeliveryCityCode + '</td>';
            ReportHTML += '                                     <td>' + pHouseNumber + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '             </tbody></table></div>';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                         <table id="tbl2" class="table table-striped text-sm">';
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Marks & Numbers</th>';
            ReportHTML += '                                     <th>No. of Pkgs</th>';
            ReportHTML += '                                     <th>Cargo Description</th>';
            ReportHTML += '                                     <th>Weight</th>';
            ReportHTML += '                                     <th>Vol.</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr class="" style="font-size:100%;">';
            //ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "N/A" : pOperationHeader.MarksAndNumbers) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? (pOperationHeader.ContainerNumber == 0 ? "N/A" : pOperationHeader.ContainerNumber) : pOperationHeader.MarksAndNumbers) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.NumberOfPackages == "0" ? "N/A" : pOperationHeader.NumberOfPackages) + (pOperationHeader.PackageTypeName == 0 ? "" : ('x' + pOperationHeader.PackageTypeName)) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            ReportHTML += '                                     <td>' + pGrossWeightSum + ' KGM' + '</td>';
            ReportHTML += '                                     <td>' + pVolumeSum + 'CBM' + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '             </tbody></table></div>';

            ReportHTML += '                   <div class="row col-xs-12 m-t-md" style="text-align:center;"> <h1>نسخة اصلية من البوليصة الفرعية</h1> </div>';
            ReportHTML += '                   <hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="col-xs-5 b-blue">';
            ReportHTML += '                         <p class=""><u>Freight charges</u>&nbsp;<br> Freight ' + (pPOrC == 'P' ? ' Prepaid ' : (pPOrC == 'C' ? ' Collect ' : '')) + '</p>';
            ReportHTML += '<br><br><br><br><br><hr style="border-top:1px solid #0e0b0b;">';
            ReportHTML += '<p>The contract evidenced by or contained in this Bill of Lading is governed by the law of Egypt and any claim or dispute arising hereunder or in connectio herewith shall be determined by the Courts in Egypt and not other Court.</p>';
            ReportHTML += '                     </div>';
            var reciever = "by the Carrier the Goods as specified above in apparent good order and condition unless otherwise stated to be transported to such place as agreed, autorised or permitted herein and subject to all the terms and conditions appearing on the front and reverse of this Bill of Lading to which the Merchant agrees by accepting this Bill of Lading, any local privileges and customs notwithstanding. The particulars given above as stated by the shipper and the weight, measure, quantity, condition, contents and value of the Goods are unknown to the Carrier. In WITNESS whereof one (1) original Bill of Lading must be surrendered duly endorsed in exchange for the Goods or delivery order. The contract evidenced by or contained in this Bill of Lading shall be governed by the law of Singapore and any claim or dispute arising hereunder or in connection herewith shall (without prejudice to the Carrier’s right to commence proceedings in any other jurisdiction) be subject to the jurisdiction of the Courts of Singapore"
            ReportHTML += '                     <div class="col-xs-7 b-blue">';
            ReportHTML += '                         <p class=""><u>RECEIVED</u>&nbsp;<br>' + reciever + '</p>';
            ReportHTML += '                     </div></div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';


            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                         <p>"All business is undertaken subject to company name  © Standard Trading Conditions, which will remain paramount and is incorporated into all contracts to which we are a party, Our Standard Trading Conditions are available from our offices on request."        </p>';
            ReportHTML += '                     </div>';

            //ReportHTML += '<div class="col-xs-12 m-l-md">Excess value declaration refer to clause 6 (4)(B) + (C) on reverse side</div>';
            ReportHTML += '         </body>';


            ReportHTML += '</html>';

            if (pOption == "Print" || pOption == undefined || pOption == null) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
            else if (pOption == "Email") {
                DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
            }
        }
        else//Export
        {
            ReportHTML += '<html>';
            ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
            ReportHTML += '         <body style="background-color:white;">';
            //        ReportHTML += '         <div class="break"></div>'; //to start a new page

            ReportHTML += '             <div class="row col-xs-12 m-t-n-lg m-l-md"><b style="font-size:18px;">COPY BILL OF LADING</b><b style="font-size:12px;"> NOT NEGOTIABLE UNLESS CONSIGNED ‘TO ORDER’</b></div>';
            var BOLading = $('#slPrintType').val() == "" ? "DRAFT " : $('#slPrintType  option:selected').text().split(" ")[0];
            ReportHTML += '                   <div class="row col-xs-12 " >';
            ReportHTML += '     <br><div style="font-size:18px;" class="m-l-md">' + BOLading + ' BILL OF LADING NOT NEGOTIABLE UNLESS CONSIGNED "TO ORDER"</div>';

            ReportHTML += '                     </div>';

            ReportHTML += '             <div class="row col-xs-12 m-t-sm b-dark ">';
            ReportHTML += '                 <div class="col-xs-7" style="">';
            ReportHTML += '                   <div class="row col-xs-12 " >';
            //ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
            ReportHTML += '                     <div class="b-blue" style="">';
            //ReportHTML += '                         <b><u>Shipper:</u></b>&nbsp;' + pShipperName + "<br><u>Address:</u>&nbsp;" + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName;
            //ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + pShipperPhones + '</p>';
            ReportHTML += '                         <b><u>Shipper:</u></b>&nbsp;' + pShipperName + "<br><u>Address:</u>&nbsp;" + (pShipper.Address == null || pShipper.Address == 0 ? "" : pShipper.Address.replace(/\n/g, "<br/>"));
            ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + (pShipper.PhonesAndFaxes == null || pShipper.PhonesAndFaxes == 0 ? "" : pShipper.PhonesAndFaxes) + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                   </div><hr style="border-top:1px solid #0e0b0b;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="b-blue" style="">';
            //ReportHTML += '                         <b><u>Consignee:</u>&nbsp;</b>' + pConsigneeName + "<br><u>Address:</u>" + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName;
            //ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + pConsigneePhones + '</p>';
            ReportHTML += '                         <b><u>Consignee:</u></b>&nbsp;' + pConsigneeName + "<br><u>Address:</u>&nbsp;" + (pConsignee.Address == null || pConsignee.Address == 0 ? "" : pConsignee.Address.replace(/\n/g, "<br/>"));
            ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + (pConsignee.PhonesAndFaxes == null || pConsignee.PhonesAndFaxes == 0 ? "" : pConsignee.PhonesAndFaxes) + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     </div><hr style="border-top:1px solid #0e0b0b;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="b-blue">';
            //ReportHTML += '                         <b><u>Notify Party:</u>&nbsp;</b>' + pConsigneeName + "<br><u>Address:</u>" + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName;
            //ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + pConsigneePhones + '</p>';
            ReportHTML += '                         <b><u>Notify Party:</u></b>&nbsp;' + pNotify1Name + "<br><u>Address:</u>&nbsp;" + (pNotify1.Address == null || pNotify1.Address == 0 ? "" : pNotify1.Address.replace(/\n/g, "<br/>"));
            ReportHTML += '                         <p class=""><u>Phones:</u>&nbsp;' + (pNotify1.PhonesAndFaxes == null || pNotify1.PhonesAndFaxes == 0 ? "" : pNotify1.PhonesAndFaxes) + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     </div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px;">';


            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="b-blue">';
            ReportHTML += '                         <p class=""><u>Place Of Receipt:</u>&nbsp;<br>' + pPOLCodeAndName + '</p>';
            ReportHTML += '                     </div></div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="col-xs-6 b-blue">';
            ReportHTML += '                         <p class=""><u>Vessel:</u>&nbsp;<br>' + pVesselName + '</p>';
            ReportHTML += '                     </div>';

            ReportHTML += '                     <div class="col-xs-6 b-blue">';
            ReportHTML += '                         <p class=""><u>Port of Loading:</u>&nbsp;<br>' + pPOLCodeAndName + '</p>';
            ReportHTML += '                     </div></div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="col-xs-6 b-blue">';
            ReportHTML += '                         <p class=""><u>Port of discharge:</u>&nbsp;<br>' + pPODCodeAndName + '</p>';
            ReportHTML += '                     </div>';

            ReportHTML += '                     <div class="col-xs-6 b-blue">';
            ReportHTML += '                         <p class=""><u>Place of delivery:</u>&nbsp;<br>' + (pOperationHeader.DeliveryCityID == 0 ? "" : (pOperationHeader.DeliveryCityCode))/*(pOperationHeader.DeliveryAddress == 0 ? '' : pOperationHeader.DeliveryAddress)*/ + '</p>';
            ReportHTML += '                     </div></div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';



            ReportHTML += '                 </div>';
            ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="">';
            ReportHTML += '                     <div class="row col-xs-12 ">B/L No.' + pHouseNumber + '</div>';
            ReportHTML += '                     <div class="row col-xs-12 ">Reference No.' + pOperationHeader.MasterOperationCode + '</div>';
            ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
            //ReportHTML += '                     <div class="col-xs-12 m-l-lg"><h4>' + pEnCompanyName + '</h4></div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pEnCompanyName + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine1 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine2 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine3 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine4 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n">' + pAddressLine5 + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Phone(s) :</u> ' + pPhones + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Fax :</u> ' + pFaxes + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + pEmail + '</div>';
            ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
            ReportHTML += '                 </div>';
            ReportHTML += '             </div>';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                         <table id="tbl2" class="table table-striped text-sm">';
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Marks & Numbers</th>';
            ReportHTML += '                                     <th>No. of Pkgs</th>';
            ReportHTML += '                                     <th>Cargo Description</th>';
            ReportHTML += '                                     <th>Weight</th>';
            ReportHTML += '                                     <th>Vol.</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            ReportHTML += '                                 <tr class="" style="font-size:100%;">';
            //ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "N/A" : pOperationHeader.MarksAndNumbers) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? (pOperationHeader.ContainerNumber == 0 ? "N/A" : pOperationHeader.ContainerNumber) : pOperationHeader.MarksAndNumbers) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.NumberOfPackages == "0" ? "N/A" : pOperationHeader.NumberOfPackages) + '</td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
            ReportHTML += '                                     <td>' + pGrossWeightSum + ' KGM' + '</td>';
            ReportHTML += '                                     <td>' + pVolumeSum + 'CBM' + '</td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '             </tbody></table></div>';

            ReportHTML += '                   <div class="row col-xs-12">';
            ReportHTML += '                     <div class="col-xs-6 b-blue">';
            var lenCont = pOperationContainerAndPackages_GLS.length;
            //if (lenCont > 0)
            //    ReportHTML += '                         <p class="">LCL/LCL<br>STUFFED IN CONTAINER: ' + pOperationContainerAndPackages_GLS[0].ContainerNumber + ' SEAL NO:' + pOperationContainerAndPackages_GLS[0].CarrierSeal + ' </p>';
            ReportHTML += '                         &emsp;<br>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     <div class="col-xs-6 b-blue">';
            ReportHTML += '                         <p class="">SHIPPED ON BOARD<br>' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ShippedOnBoardDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ShippedOnBoardDate)) : "") + '</p>';

            ReportHTML += '                   </div> </div>';


            ReportHTML += '                   <div class="row col-xs-12" style="text-align:center;">ABOVE PARTICULARS AS DECLARED BY SHIPPER</div>';
            ReportHTML += '                   <hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';

            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="col-xs-5 b-blue">';
            ReportHTML += '                         <p class=""><u>Freight charges</u>&nbsp;<br> Freight ' + (pPOrC == 'P' ? ' Prepaid ' : (pPOrC == 'C' ? ' Collect ' : '')) + '</p>';
            ReportHTML += '                         <p class="">For delivery of the goods apply to</p>';
            ReportHTML += '                         <p class="">Address : ' + (pIsPrintLines ? "<b>Agent</b>" : "") + pAgentName + "" + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1 + ' ') + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2 + ' ') + (pAgentCityName == "" ? "" : ', ' + pAgentCityName + ', ') + pAgentCountryName + '</p>';
            //ReportHTML += '                         <p class="">Name : ' + pAgentContactName + '</p>';
            //ReportHTML += '                         <p class="">Email : ' + pAgentEmail + '</p>';
            //ReportHTML += '                         <p class="">Phone : ' + pAgentPhones + '</p>';
            //var pAgentName = data[65];
            //var pAgentContactName = data[66];
            //var pAgentPhones = data[67];
            //var pAgentFax = data[68];
            //var pAgentEmail = data[69];
            //var pAgentAddressLine1 = data[70];
            //var pAgentAddressLine2 = data[71];
            //var pAgentCityName = data[72];
            //var pAgentCountryName = data[73];
            ReportHTML += '                     </div>';
            var reciever = "by the Carrier the Goods as specified above in apparent good order and condition unless otherwise stated to be transported to such place as agreed, autorised or permitted herein and subject to all the terms and conditions appearing on the front and reverse of this Bill of Lading to which the Merchant agrees by accepting this Bill of Lading, any local privileges and customs notwithstanding. The particulars given above as stated by the shipper and the weight, measure, quantity, condition, contents and value of the Goods are unknown to the Carrier. In WITNESS whereof one (1) original Bill of Lading must be surrendered duly endorsed in exchange for the Goods or delivery order. The contract evidenced by or contained in this Bill of Lading shall be governed by the law of Singapore and any claim or dispute arising hereunder or in connection herewith shall (without prejudice to the Carrier’s right to commence proceedings in any other jurisdiction) be subject to the jurisdiction of the Courts of Singapore"
            ReportHTML += '                     <div class="col-xs-7 b-blue">';
            ReportHTML += '                         <p class="" style="font-size:10px;"><u>RECEIVED</u>&nbsp;<br>' + reciever + '</p>';
            ReportHTML += '                     </div></div><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;">';



            ReportHTML += '                     <div class="row col-xs-12 ">';
            ReportHTML += '                     <div class="col-xs-5">';
            ReportHTML += '                     </div>';

            ReportHTML += '                     <div class="col-xs-7 b-blue">';
            ReportHTML += '                     <div class="col-xs-6">';
            ReportHTML += '                         <p class="">Freight payable at&nbsp;<br>' + (pOperationHeader.FreightPayableAt == 0 ? "" : pOperationHeader.FreightPayableAt) + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     <div class="col-xs-6">';
            ReportHTML += '                         <p class="">Place and date of issue&nbsp;<br>DUBAI</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     <div class="col-xs-12"><hr style="border-top:1px solid #0e0b0b; margin-bottom:0px; margin-top:0px;"> </div>';

            ReportHTML += '                     <div class="col-xs-6">';
            ReportHTML += '                         <p class="">Number of original B/L&nbsp;<br>' + pOperationHeader.NumberOfOriginalBills + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     <div class="col-xs-6">';
            ReportHTML += '                         <p class="">Signature on behalf of &nbsp;<br>By: GLS ' + (pDefaults.UnEditableCompanyName == "GLD" ? "DUBAI" : "EGYPT") + '</p>';
            ReportHTML += '                     </div>';
            ReportHTML += '                     </div></div>';
            ReportHTML += '             <div class="col-xs-12 m-l-md">Excess value declaration refer to clause 6 (4)(B) + (C) on reverse side</div>';
            ReportHTML += '         </body>';

            ReportHTML += '</html>';

            if (pOption == "Print" || pOption == undefined || pOption == null) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
            else if (pOption == "Email") {
                DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
            }
        }

    } //if (pDefaults.UnEditableCompanyName == "GLS" || pDefaults.UnEditableCompanyName == "GLD") {
    else if (pDefaults.UnEditableCompanyName == "KDM") {

        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        //        ReportHTML += '         <div class="break"></div>'; //to start a new page
        ReportHTML += '             <div class="" style="height:100%;"><br><br><br>';
        ReportHTML += '                 <div class="col-xs-12 b-blue" style="height:1cm;">';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="col-xs-6 m-l-md b-blue ' + (pIsPrintLines ? "b-t b-r" : "") + '" style="height:10cm;">';
        ReportHTML += '                     <div class="b-blue row" style="height:2.6cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Shipper</b>" : "<br>") + '</p>' + pShipperName + "<br>" + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName;
        ReportHTML += '                         <p class="">' + pShipperPhones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-blue row" style="height:2.6cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Consignee</b>" : "<br>") + '</p>' + pConsigneeName + "<br>" + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName;
        ReportHTML += '                         <p class="">' + pConsigneePhones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-blue row" style="height:2.9cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Notify Party</b>" : "<br>") + '</p>'
            + (pNotify1Name == ""
                ? ("<br> Same As Consignee")
                : (pConsigneeName + "<br>" + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName)
            );
        ReportHTML += '                         <p class="">' + pNotify1Phones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 <div class="col-xs-12 b-blue" style="height:1.5cm;">';
        ReportHTML += '                 </div>';
        ReportHTML += '                     <div class="b-blue row" style="height:1.9cm; font-size:8px;">';
        ReportHTML += '                             <div class="col-xs-6 m-l-n" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Ocean Vessel / Voy.No</b>' : '<br>') + '<br>';
        ReportHTML += '                                 ' + pVesselName + '&emsp;' + pVoyageOrTruckNumber; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-6 m-l text-right" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place of Receipt</b>' : '<br>') + '<br>';
        ReportHTML += '                                 ' + pPickupAddress; //item.AccountNo.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="col-xs-6 m-l-md b-blue ' + (pIsPrintLines ? "b-t b-r" : "") + '" style="height:6cm;">';
        ReportHTML += '                     <div class="b-blue row" style="height:3.6cm; font-size:8px;">';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        //first complete row
        ReportHTML += '                     <div class="b-blue row" style="height:0.9cm; font-size:8px;">';
        ReportHTML += '                             <div class="col-xs-4" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Port of Discharge</b>' : '<br>') + '<br>';
        ReportHTML += '                                 ' + pPODCodeAndName.split(':')[0].trim(); //item.AccountNo.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-2 m-l-n-lg" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>B/L.No</b>' : '<br>') + '<br>';
        ReportHTML += '                                 ' + pHouseNumber; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-3 m-l-lg" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place of Delivery</b>' : '<br>') + '<br>';
        ReportHTML += '                                 ' + pDeliveryAddress; //item.AccountNo.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-lg"><br>&nbsp;<br>&nbsp;<br>&nbsp;<br></div>';
        var pContainersAndPackagesRowCount = JSON.parse(pContainersAndPackages).length;
        if (pContainersAndPackagesRowCount <= maxContainersWithoutAttachment) {
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-striped text-sm" style="font-size:8px;">';
            ReportHTML += '                             <thead>';
            //ReportHTML += '                                 <tr>';
            //ReportHTML += '                                     <th>Container(s)</th>';
            //ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
            //ReportHTML += '                                     <th>NetWgt(KG)</th>';
            //ReportHTML += '                                     <th>GrossWgt(KG)</th>';
            //ReportHTML += '                                     <th>VGM(KG)</th>';
            //ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';
            //ReportHTML += '                 <div class="col-xs-12 b-blue" style="height:2cm;">';
            //ReportHTML += '                 </div>';
            $.each(JSON.parse(pContainersAndPackages), function (i, item) { //this report is not for air
                if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:22%; border-color:white!Important; text-align:left; vertical-align: top;">' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + (item.CarrierSeal == 0 ? "" : (' - Seal #' + item.CarrierSeal)) + '<br>T.W.' + item.TareWeight + 'KGS' + '<br>' + "1 x " + item.ContainerTypeCode + '</td>';
                    //ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + '</td>';
                    //if (i == 0)
                    //    ReportHTML += '                                     <td style="width:10%; border-color:white!Important; text-align:left; vertical-align: top;" rowspan=' + pContainersAndPackagesRowCount + '>' + (pContainerTypesInMutipleRows == 0 ? "" : pContainerTypesInMutipleRows) + '</td>';
                    //ReportHTML += '                                     <td style="width:10%; border-color:white!Important; text-align:left; vertical-align: top;">' + "1 x " + item.ContainerTypeCode + '</td>';
                    ReportHTML += '                                     <td style="width:48%; border-color:white!Important; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods) + '</td>';
                    ReportHTML += '                                     <td style="width:17%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    //ReportHTML += '                                     <td style="width:10%; border-color:white!Important; text-align:left; vertical-align: top;">' + /*'VGM: ' + item.VGM + ' Kgm' +*/ '</td>'; //Supposed to be measurement
                    ReportHTML += '                                 </tr>';
                }
                else { //final LCL (no final for air)
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:13%; border-color:white!Important; text-align:left; vertical-align: top;">' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                    ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + '</td>';
                    ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td style="width:15%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    ReportHTML += '                                     <td style="width:17%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.Length + 'cm x ' + item.Width + 'cm x ' + item.Height + 'cm' + '</td>';
                    ReportHTML += '                                 </tr>';
                }
            });
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
        } //if (pContainersAndPackagesRowCount <= maxContainersWithoutAttachment)
        else
            ReportHTML += '                     See Attachment';
        ReportHTML += '             </div>'; //<div class="" style="height:100%;">
        /*******************Attachment if needed**********************/
        if (pContainersAndPackagesRowCount > maxContainersWithoutAttachment) {
            ReportHTML += '                     <div class="row break"></div>';
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-bordered table-striped text-sm" style="font-size:8px;">';
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Container(s)</th>';
            ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
            ReportHTML += '                                     <th>NetWgt(KG)</th>';
            ReportHTML += '                                     <th>GrossWgt(KG)</th>';
            if (!(pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL"))
                ReportHTML += '                                     <th>VGM(KG)</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';

            $.each(JSON.parse(pContainersAndPackages), function (i, item) { //this report is not for air
                if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + (item.CarrierSeal == 0 ? "" : (' - Seal #' + item.CarrierSeal)) + '<br>T.W.' + item.TareWeight + 'KGS' + '</td>';
                    //ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + '</td>';
                    //if (i == 0)
                    //    ReportHTML += '                                     <td style="width:10%;  text-align:left; vertical-align: top;" rowspan=' + pContainersAndPackagesRowCount + '>' + (pContainerTypesInMutipleRows == 0 ? "" : pContainerTypesInMutipleRows) + '</td>';
                    ReportHTML += '                                     <td style="width:10%; text-align:left; vertical-align: top;">' + "1 x " + item.ContainerTypeCode + '</td>';
                    ReportHTML += '                                     <td style="width:52%; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td style="width:13%; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    //ReportHTML += '                                     <td style="width:10%; text-align:left; vertical-align: top;">' + /*'VGM: ' + item.VGM + ' Kgm' +*/ '</td>'; //Supposed to be measurement
                    ReportHTML += '                                 </tr>';
                }
                else { //final LCL (no final for air)
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:13%; text-align:left; vertical-align: top;">' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                    ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + '</td>';
                    ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td style="width:15%; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    ReportHTML += '                                     <td style="width:17%; text-align:left; vertical-align: top;">' + item.Length + 'cm x ' + item.Width + 'cm x ' + item.Height + 'cm' + '</td>';
                    ReportHTML += '                                 </tr>';
                }
            });
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
        } //if (pContainersAndPackagesRowCount > maxContainersWithoutAttachment)
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0; font-size:8px;">';
        ReportHTML += '                 <div class="col-xs-6 b-blue" style="height:4cm;">';
        ReportHTML += '                 </div>';
        ReportHTML += '         <div class="col-xs-6 text-left" style="height:4cm;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Prepaid Or Collect</b>' : '<br>') + '<br>';
        ReportHTML += '         ' + (pPOrC == 'P' ? ' Prepaid ' : (pPOrC == 'C' ? ' Collect ' : ''));
        ReportHTML += '         </div>';

        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Total No of Packages</b>' : '<br>') + '<br>';
        //ReportHTML += '             ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Freight payable at</b>' : '<br>') + '<br>';
        //ReportHTML += '             ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-left" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place and date of issue</b>' : '<br>') + '<br>';
        ReportHTML += '             ' + '&emsp;'; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';

        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Title</b>' : '<br>') + '<br>';
        //ReportHTML += '             ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Number of originals</b>' : '<br>') + '<br>';
        ReportHTML += '             &emsp;'; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-left" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place and date of issue</b>' : '<br>') + '<br>';
        ReportHTML += '             ' + pBranchName + '&emsp;' + getTodaysDateInddMMyyyyFormat(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';

        //ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if(pDefaults.UnEditableCompanyName == "KDM") {
    else { //All other Companies

        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        //        ReportHTML += '         <div class="break"></div>'; //to start a new page
        ReportHTML += '             <div class="' + (pDefaults.UnEditableCompanyName == "FFI" ? " m-l-lg m-t-n-md " : "") + '" style="height:100%;"><br><br><br>';
        ReportHTML += '                 <div class="col-xs-6 b-blue ' + (pIsPrintLines ? "b-t b-r" : "") + '" style="height:9cm;">';
        ReportHTML += '                     <div class="b-blue row" style="height:2.6cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Shipper</b>" : "<br>") + '</p>' + pShipperName + "<br>" + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName;
        ReportHTML += '                         <p class="">' + pShipperPhones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-blue row" style="height:2.6cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Consignee</b>" : "<br>") + '</p>' + pConsigneeName + "<br>" + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName;
        ReportHTML += '                         <p class="">' + pConsigneePhones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-blue row" style="height:2.9cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Notify Party</b>" : "<br>") + '</p>'
            + (pNotify1Name == ""
                ? ("<br> Same As Consignee")
                : (pConsigneeName + "<br>" + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName)
            );
        ReportHTML += '                         <p class="">' + pNotify1Phones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-blue row" style="height:0.9cm; font-size:8px;">';
        ReportHTML += '                             <div class="col-xs-6 m-l-n" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Ocean Vessel / Voy.No</b>' : '') + '<br>';
        ReportHTML += '                                 ' + pVesselName + '&emsp;' + (pDefaults.UnEditableCompanyName == "FFI" ? " &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; " : "") + pVoyageOrTruckNumber; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-6 m-l" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place of Receipt</b>' : '<br>') + '<br>';
        ReportHTML += '                                 ' + pPickupAddress; //item.AccountNo.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';

        ReportHTML += '                 <div class="col-xs-6 b-blue ' + (pIsPrintLines ? "b-t b-r" : "") + '" style="height:9cm;">';
        ReportHTML += '                     <div class="b-blue row" style="height:3.6cm; font-size:8px;">';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-blue row m-l-lg" style="height:4.5cm; font-size:8px;">';
        ReportHTML += '                         <p class="text-blue">' + (pIsPrintLines ? "<b>Agent</b>" : "<br>") + '</p>' + pAgentName + "<br>" + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1 + ' ') + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2 + ' ') + (pAgentCityName == "" ? "" : ', ' + pAgentCityName + ', ') + pAgentCountryName;
        ReportHTML += '                         <p class="">' + pAgentPhones + '</p>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        //first complete row
        ReportHTML += '                     <div class="b-blue row" style="height:0.9cm; font-size:8px;">';
        ReportHTML += '                             <div class="col-xs-3" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Port of Loading</b>' : '<br><br>') + '<br>';
        ReportHTML += '                                 ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-4" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Port of Discharge</b>' : '<br><br>') + '<br>';
        ReportHTML += '                                 ' + pPODCodeAndName.split(':')[0].trim(); //item.AccountNo.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-2 m-l-n-lg" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>B/L.No</b>' : '<br><br>') + '<br>';
        ReportHTML += '                                 ' + pHouseNumber; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                             <div class="col-xs-3 m-l-lg" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place of Delivery</b>' : '<br><br>') + '<br>';
        ReportHTML += '                                 ' + pDeliveryAddress; //item.AccountNo.replace(/\n/g, "<br />");
        ReportHTML += '                             </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-lg"><br>&nbsp;<br>&nbsp;<br>&nbsp;<br></div>';
        var pContainersAndPackagesRowCount = JSON.parse(pContainersAndPackages).length;
        if (pContainersAndPackagesRowCount <= maxContainersWithoutAttachment) {
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table m-t table-striped text-sm" style="font-size:8px;">';
            ReportHTML += '                             <thead>';
            //ReportHTML += '                                 <tr>';
            //ReportHTML += '                                     <th>Container(s)</th>';
            //ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
            //ReportHTML += '                                     <th>NetWgt(KG)</th>';
            //ReportHTML += '                                     <th>GrossWgt(KG)</th>';
            //ReportHTML += '                                     <th>VGM(KG)</th>';
            //ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';

            $.each(JSON.parse(pContainersAndPackages), function (i, item) { //this report is not for air
                if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + (item.CarrierSeal == 0 ? "" : (' - Seal #' + item.CarrierSeal)) + '<br>T.W.' + item.TareWeight + 'KGS' + '</td>';
                    //ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + '</td>';
                    //if (i == 0)
                    //    ReportHTML += '                                     <td style="width:10%; border-color:white!Important; text-align:left; vertical-align: top;" rowspan=' + pContainersAndPackagesRowCount + '>' + (pContainerTypesInMutipleRows == 0 ? "" : pContainerTypesInMutipleRows) + '</td>';
                    ReportHTML += '                                     <td style="width:10%; border-color:white!Important; text-align:left; vertical-align: top;">' + "1 x " + item.ContainerTypeCode + '</td>';
                    ReportHTML += '                                     <td style="width:52%; border-color:white!Important; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods) + '</td>';
                    ReportHTML += '                                     <td style="width:13%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    //ReportHTML += '                                     <td style="width:10%; border-color:white!Important; text-align:left; vertical-align: top;">' + /*'VGM: ' + item.VGM + ' Kgm' +*/ '</td>'; //Supposed to be measurement
                    ReportHTML += '                                 </tr>';
                }
                else { //final LCL (no final for air)
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:13%; border-color:white!Important; text-align:left; vertical-align: top;">' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                    ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + '</td>';
                    ReportHTML += '                                     <td style="width:25%; border-color:white!Important; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td style="width:15%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    ReportHTML += '                                     <td style="width:17%; border-color:white!Important; text-align:left; vertical-align: top;">' + item.Length + 'cm x ' + item.Width + 'cm x ' + item.Height + 'cm' + '</td>';
                    ReportHTML += '                                 </tr>';
                }
            });
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
        } //if (pContainersAndPackagesRowCount <= maxContainersWithoutAttachment)
        else
            ReportHTML += '                     See Attachment';
        ReportHTML += '             </div>'; //<div class="" style="height:100%;">
        /*******************Attachment if needed**********************/
        if (pContainersAndPackagesRowCount > maxContainersWithoutAttachment) {
            ReportHTML += '                     <div class="row break"></div>';
            ReportHTML += '                         <table id="tblOperationContainersAndPackages" class="table table-bordered table-striped text-sm" style="font-size:8px;">';
            ReportHTML += '                             <thead>';
            ReportHTML += '                                 <tr>';
            ReportHTML += '                                     <th>Container(s)</th>';
            ReportHTML += '                                     <th>GOODS DESCRIPTION</th>';
            ReportHTML += '                                     <th>NetWgt(KG)</th>';
            ReportHTML += '                                     <th>GrossWgt(KG)</th>';
            if (!(pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL"))
                ReportHTML += '                                     <th>VGM(KG)</th>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                             </thead>';
            ReportHTML += '                             <tbody>';

            $.each(JSON.parse(pContainersAndPackages), function (i, item) { //this report is not for air
                if (pShipmentType == "FCL" || pShipmentType == "FTL" || pShipmentType == "CONSOL") {
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + (item.ContainerNumber == 0 ? "N/A" : item.ContainerNumber) + (item.CarrierSeal == 0 ? "" : (' - Seal #' + item.CarrierSeal)) + '<br>T.W.' + item.TareWeight + 'KGS' + '</td>';
                    //ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + item.NumberOfPackagesOnContainer + 'x' + (item.PackageTypeNameOnContainer == "0" ? "N/A" : item.PackageTypeNameOnContainer) + '</td>';
                    //if (i == 0)
                    //    ReportHTML += '                                     <td style="width:10%;  text-align:left; vertical-align: top;" rowspan=' + pContainersAndPackagesRowCount + '>' + (pContainerTypesInMutipleRows == 0 ? "" : pContainerTypesInMutipleRows) + '</td>';
                    ReportHTML += '                                     <td style="width:10%; text-align:left; vertical-align: top;">' + "1 x " + item.ContainerTypeCode + '</td>';
                    ReportHTML += '                                     <td style="width:52%; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td style="width:13%; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    //ReportHTML += '                                     <td style="width:10%; text-align:left; vertical-align: top;">' + /*'VGM: ' + item.VGM + ' Kgm' +*/ '</td>'; //Supposed to be measurement
                    ReportHTML += '                                 </tr>';
                }
                else { //final LCL (no final for air)
                    ReportHTML += '                                 <tr class="" style="font-size:100%;">';
                    ReportHTML += '                                     <td style="width:13%; text-align:left; vertical-align: top;">' + (pRoadOrContainerNumber == 0 ? "N/A" : pRoadOrContainerNumber) + '</td>';
                    ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + item.Quantity + 'x' + (item.PackageTypeName == "0" ? "N/A" : item.PackageTypeName) + ": " + '</td>';
                    ReportHTML += '                                     <td style="width:25%; text-align:left; vertical-align: top;">' + (item.DescriptionOfGoods.replace(/\n/g, "<br />") == 0 ? "N/A" : item.DescriptionOfGoods.replace(/\n/g, "<br />")) + '</td>';
                    ReportHTML += '                                     <td style="width:15%; text-align:left; vertical-align: top;">' + item.GrossWeight + ' Kgm' + '</td>';
                    ReportHTML += '                                     <td style="width:17%; text-align:left; vertical-align: top;">' + item.Length + 'cm x ' + item.Width + 'cm x ' + item.Height + 'cm' + '</td>';
                    ReportHTML += '                                 </tr>';
                }
            });
            ReportHTML += '                             </tbody>';
            ReportHTML += '                         </table>';
        } //if (pContainersAndPackagesRowCount > maxContainersWithoutAttachment)
        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:absolute; bottom:0; font-size:8px;">';
        ReportHTML += '         <div class="col-xs-12 text-left" style="height:4cm;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Prepaid Or Collect</b>' : '<br>') + '<br>';
        ReportHTML += '         ' + (pPOrC == 'P' ? ' Prepaid ' : (pPOrC == 'C' ? ' Collect ' : ''));
        ReportHTML += '         </div>';

        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Total No of Packages</b>' : '<br>') + '<br>';
        //ReportHTML += '             ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Freight payable at</b>' : '<br>') + '<br>';
        //ReportHTML += '             ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-left ' + (pIsPrintLines ? " m-t-n " : "") + '" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place and date of issue</b>' : '<br>') + '<br>';
        ReportHTML += '             ' + '&emsp;'; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';

        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Title</b>' : '<br>') + '<br>';
        //ReportHTML += '             ' + pPOLCodeAndName.split(':')[0].trim(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-center" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Number of originals</b>' : '<br>') + '<br>';
        ReportHTML += '             &emsp;'; //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';
        ReportHTML += '         <div class="col-xs-4 text-left" style="height:100%;' + (pIsPrintLines ? "border-right:thin;" : "") + ' border-color:blue;">' + (pIsPrintLines ? '<b>Place and date of issue</b>' : '<br>') + '<br>';
        ReportHTML += '             ' + pBranchName + '&emsp;' + getTodaysDateInddMMyyyyFormat(); //item.IATACode.replace(/\n/g, "<br />");
        ReportHTML += '         </div>';

        //ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else All other Companies
}
function DocsOut_Print_HBL(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var RecordsExist = data[0];
    var MissingMandatoryFields = data[1];
    var pOperationCode = data[2];
    var pShipperName = data[3];
    var pShipperContactName = data[4];
    var pShipperPhones = data[5];
    var pShipperFax = data[6];
    var pShipperEmail = data[7];
    var pConsigneeName = data[8];
    var pConsigneeContactName = data[9];
    var pConsigneePhones = data[10];
    var pConsigneeFax = data[11];
    var pConsigneeEmail = data[12];
    var pNotify1Name = data[13];
    var pNotify1ContactName = data[14];
    var pNotify1Phones = data[15];
    var pNotify1Fax = data[16];
    var pNotify1Email = data[17];
    var pLineName = data[18];
    var pVoyageOrTruckNumber = data[19];
    var pVesselName = data[20];
    var pActualDeparture = data[21];
    var pPOLCodeAndName = data[22];
    var pPODCodeAndName = data[23];
    var pEnCompanyName = data[24];
    var pArCompanyName = data[25];
    var pPOrC = data[26];
    var pAddressLine1 = data[27];
    var pAddressLine2 = data[28];
    var pAddressLine3 = data[29];
    var pAddressLine4 = data[30];
    var pAddressLine5 = data[31];
    var pContainersAndPackages = data[32]; //objCvwOperationContainersAndPackages.lstCVarvwOperationContainersAndPackages
    var pPhones = data[33];
    var pFaxes = data[34];
    var pEmail = data[35];
    var pWebsite = data[36];
    var pClientEmail = data[37];
    var pContainerTypes = data[38];
    var pPackageTypes = data[39];
    var pShipmentType = data[40];
    var pGrossWeightSum = data[41];
    var pDescriptionOfGoods = data[42];
    var pRoadOrContainerNumber = data[43];
    var pPackageTypesOnContainersTotals = data[44];

    var pShipperAddressLine1 = data[45];
    var pShipperAddressLine2 = data[46];
    var pShipperCityName = data[47];
    var pShipperCountryName = data[48];

    var pConsigneeAddressLine1 = data[49];
    var pConsigneeAddressLine2 = data[50];
    var pConsigneeCityName = data[51];
    var pConsigneeCountryName = data[52];

    var pNotify1AddressLine1 = data[53];
    var pNotify1AddressLine2 = data[54];
    var pNotify1CityName = data[55];
    var pNotify1CountryName = data[56];

    var pNetWeightSum = data[57];
    var pVGMSum = data[58];

    var pDeliveryCountryName = data[59];
    var pDeliveryCityName = data[60];
    var pBookingNumber = data[61];
    var pExpectedArrival = data[62];
    var pVolumeSum = data[63];
    var pHouseNumber = data[64];

    var pAgentName = data[65];
    var pAgentContactName = data[66];
    var pAgentPhones = data[67];
    var pAgentFax = data[68];
    var pAgentEmail = data[69];
    var pAgentAddressLine1 = data[70];
    var pAgentAddressLine2 = data[71];
    var pAgentCityName = data[72];
    var pAgentCountryName = data[73];
    var pPickupAddress = data[74];
    var pDeliveryAddress = data[75];
    var pETAPOLDate = data[76];
    var pCustomerReference = data[77];
    var pMasterBL = data[78];
    var pRepBLTypeShown = data[79];
    var pBranchName = data[80];
    var pOperationHeader = JSON.parse(data[81]);

    var pPrintedBills = JSON.parse(data[82]);
    var pShipperBankAccount = data[83];
    var pConsigneeBankAccount = data[84];
    var pPayable = JSON.parse(data[85]);

    var pOperationContainerAndPackages_GLS = JSON.parse(data[86]); //kk:by kelany (it seems to be getting cargo on master when printing for house: ask why?)

    var pNotify2Name = data[87];
    var pNotify2ContactName = data[88];
    var pNotify2Phones = data[89];
    var pNotify2Fax = data[90];
    var pNotify2Email = data[91];
    var pNotify2AddressLine1 = data[92];
    var pNotify2AddressLine2 = data[93];
    var pNotify2CityName = data[94];
    var pNotify2CountryName = data[95];

    var pShipper = JSON.parse(data[96]);
    var pConsignee = JSON.parse(data[97]);
    var pAgent = JSON.parse(data[98]);
    var pNotify1 = JSON.parse(data[99]);

    pDescriptionOfGoods = "";
    $.each(JSON.parse(pContainersAndPackages), function (i, item) {
        pDescriptionOfGoods += (item.DescriptionOfGoods == 0 ? "" : (item.DescriptionOfGoods.replace(/\n/g, "<br/>") + " "));
    });
    debugger;
    if (pDefaults.UnEditableCompanyName == "GBL") { //other companies
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';

        //ReportHTML += '             <div class="col-xs-6"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="col-xs-12 text-center">BILL OF LADING FOR COMBINED TRANSPORT SHIPMENT OR PORT TO PORT SHIPMENT</div>';
        ReportHTML += '             <div class="b-dark b-t b-r b-l b-b" style="width:100%;height:12.5cm;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-6" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="m-t-xs"><b>Shipper:</b> ' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        ReportHTML += '                         <div class="" style="clear:both;"><u></u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Tel:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        ReportHTML += '                         <div class="" style="clear:both;"><u></u> ' + pShipperPhones + ' <u></u>, ' + pShipperFax + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="m-t-xs"><b>Consignee  TO ORDER OF:</b> ' + pConsigneeName + '</div>';
        ReportHTML += '                         <div class="" style="clear:both;"><u></u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += '                         <div class="" style="clear:both;"><u></u> ' + pConsigneePhones + ' <u></u>, ' + pConsigneeFax + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="m-t-xs"><b>Notify(NO CLAIM SHALL ATTACH FOR FAILURE TO NOTIFY):</b> ' + (pNotify1Name == 0 ? "Same As Consignee" : pNotify1Name) + '</div>';
        ReportHTML += '                         <div class="" style="clear:both;"><u></u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += '                         <div class="" style="clear:both;"><u></u> ' + pNotify1Phones + ' <u></u>, ' + pNotify1Fax + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:11%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Vessel-VoyNo:</u></b> ' + pVesselName + ' ' + pVoyageOrTruckNumber + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Port of Loading:</u></b> ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Port of Discharge:</u></b> ' + pPODCodeAndName.replace(":", ",") + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Final Destination:</u></b> ' + pPODCodeAndName.replace(":", ",") + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-6 b-b b-dark" style="height:55%;">';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:left;"><h5>' + (pRepBLTypeShown == 'HOUSE' ? 'House ' : '') + 'Bill of Lading</h5></div>';
        ReportHTML += '                     <div class="col-xs-12 m-t-n-sm">';

        ReportHTML += '                         <div class="col-xs-9">';
        ReportHTML += '                             <table class="table table-striped b-light text-sm table-bordered m-l-n">';//style="border:solid #000 !Important;"
        //ReportHTML += '                                 <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        //ReportHTML += '                                     <td style="text-align:center!Important;"><b>Client No : </b>' + pCustomerReference + '</td>';
        //ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important;"><b>B/L No : </b>' + (pHouseNumber == "N/A" ? pMasterBL : pHouseNumber) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </table>';
        ReportHTML += '                         </div>';
        ReportHTML += '                         <div class="col-xs-3">';
        ReportHTML += '                             <b>' + '&emsp;' + '</b>';
        ReportHTML += '                         </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="" style="text-align:center; clear:both;"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        //ReportHTML += '                     <div class="col-xs-12 m-t-n-sm" style="text-align:center;"><h4>' + pEnCompanyName + '</h4></div>';
        //ReportHTML += '                     <div class="col-xs-12 m-t-n-sm" style="text-align:center;">' + pAddressLine1 + '</div>';
        //ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine2 + '</div>';
        //ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine3 + '</div>';
        //ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine4 + '</div>';
        //ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine5 + '</div>';
        //ReportHTML += '                     <div class="col-xs-12" style="text-align:center;"><u>Tel :</u> ' + pPhones + '</div>';
        //ReportHTML += '                     <div class="col-xs-12" style="text-align:center;"><u>Fax :</u> ' + pFaxes + '</div>';

        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + pEmail + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="col-xs-12" style="height:45%;">For Delivery Apply To:</div>';
        ReportHTML += '             </div>';

        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        ////ReportHTML += '                         <table class="table m-t-n-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        //ReportHTML += '                         <table class="m-t-n-xs text-sm col-xs-12" style="height:5.5cm; border:1px solid #000!Important;">';
        //ReportHTML += '                             <thead style="text-align:center; border:1px solid #000!Important;">';
        //ReportHTML += '                                 <tr>';
        ////if ($("#cbIsAir").prop("checked") || $("#cbIsLCL").prop("checked") || $("#cbIsLTL").prop("checked"))
        //if ($("#cbIsAir").prop("checked") || pShipmentType == "LCL" || pShipmentType == "LTL")
        //    ReportHTML += '                                 <th style="text-align:center; width:20%; text-align:left; border:1px solid #000!Important;">Package Type</th>';
        //else
        //    ReportHTML += '                                 <th style="width:20%; text-align:center; border:1px solid #000!Important;">Marks & Numbers</th>';
        //ReportHTML += '                                     <th style="width:10%; text-align:center; border:1px solid #000!Important;">Packages</th>';
        //ReportHTML += '                                     <th style="width:50%; text-align:center; border:1px solid #000!Important;">Description Of Goods</th>';
        //ReportHTML += '                                     <th style="width:10%; text-align:center; border:1px solid #000!Important;">Weight (KG)</th>'; //Gross
        //ReportHTML += '                                     <th style="width:10%; text-align:center; border:1px solid #000!Important;">CBM</th>';
        //ReportHTML += '                                 </tr>';
        //ReportHTML += '                             </thead>';
        //ReportHTML += '                             <tbody>';
        //$.each(JSON.parse(pContainersAndPackages), function (i, item) {
        //    ReportHTML += '                                     <tr class="" style="text-align:left; vertical-align:text-top; font-size:95%;">';
        //    //if ($("#cbIsAir").prop("checked") || $("#cbIsLCL").prop("checked") || $("#cbIsLTL").prop("checked")) {
        //    if ($("#cbIsAir").prop("checked") || pShipmentType == "LCL" || pShipmentType == "LTL") {
        //        ReportHTML += '                                     <td>' + item.PackageTypeName + '</td>';
        //        ReportHTML += '                                     <td>' + item.Quantity + '</td>';
        //    }
        //    else {
        //        ReportHTML += '                                     <td>' + item.MarksAndNumbers + '</td>';
        //        ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + (item.PackageTypeNameOnContainer == 0 ? "" : ( 'x' + item.PackageTypeNameOnContainer)) + '</td>';
        //    }
        //    ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == "0" ? 'N/A' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
        //    ReportHTML += '                                         <td>' + item.GrossWeight.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
        //    ReportHTML += '                                         <td>' + item.Volume.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
        //    ReportHTML += '                                     </tr>';
        //});
        //ReportHTML += '                             </tbody>';
        //ReportHTML += '                         </table>';
        ReportHTML += '                         <table class="m-t-n-xs text-sm col-xs-12" style="height:5.5cm; border:1px solid #000!Important;">';
        ReportHTML += '                             <thead style="text-align:center; border:1px solid #000!Important;">';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;">Marks And Numbers</th>';
        ReportHTML += '                                     <th style=" text-align:center;">No & Kind of Packages</th>';
        ReportHTML += '                                     <th style=" text-align:center;">Goods Desc.</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">G.Weight (KG)</th>'; //Gross
        ReportHTML += '                                     <th style="width:10%; text-align:center;">Measurements</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="text-align:center; vertical-align:text-top; font-size:95%;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>") + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum + ' KGM' + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.VolumeSum + ' CBM' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/BLInnerImage.jpg" alt="logo"/></div>';
        ReportHTML += '                             <table class="table table-striped b-light text-sm table-bordered">';//style="border:solid #000 !Important;"
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                                     <td style="text-align:center!Important; width:50%;"><b>Details of cargo as declared by shipper</b></td>';
        ReportHTML += '                                     <td rowspan=3 colspan=2 style="text-align:left!Important; width:50%;">RECEIVED the goods or the containers, vans, pallets, units or other packages said to contain goods herein mentioned, in apparent good order or condition, except as otherwise indicated, to be transported, delivered or transshipped as provided herein, "Subject to all terms and conditions appearing on this house bill of lading"</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; width:50%;">For particulars of delivery apply with this Bill of Lading to:</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td rowspan=2 colspan=1 style="text-align:left!Important; width:50%;">';
        ReportHTML += '                                         ' + pAgentName;
        ReportHTML += '                                         <br>Email : ' + pAgentEmail;
        ReportHTML += '                                         <br>Phones : ' + pAgentPhones;
        ReportHTML += '                                         <br>Address : ' + (pAgentAddressLine1 == "" ? "" : (pAgentAddressLine1 + ' ' + pAgentAddressLine2)) + ' ' + pAgentCityName + ' ' + pAgentCountryName;
        ReportHTML += '                                         <br>Consol Ref : ' + pMasterBL;
        ReportHTML += '                                     </td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">Freight Payable at:<br>' + pPODCodeAndName + '</td>';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">Place & Date of Issue:<br>' + getTodaysDateInddMMyyyyFormat() + '</td>';
        ReportHTML += '                                 </tr>';
        /*******************Starting new rowspans and colspans**********************/
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; width:50%;">Type of Service : ' + ($("#slMoveTypes option:selected").val() == "" ? "N/A" : $("#slMoveTypes option:selected").text()) + '<br><br><br></td>';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">Number of Original B/Ls:<br><br><br><br> ' + $("#slPrintType").val() + ' </td>';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">For & on behalf of:<br>' + '<br><br><br><br>' + '</td>';
        ReportHTML += '                                 </tr>';

        ReportHTML += '                             </table>';

        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                         </div>';
        //ReportHTML += '                     </div>'; //of table-responsive
        ////ReportHTML += '                 </section>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        ReportHTML += '         <div class="m-r" style="text-align:right;"><b>' + pEnCompanyName + '</b></div>';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "GBL")
    else if (pDefaults.UnEditableCompanyName == "ELI") {

        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body class="text-sm" style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';
        //ReportHTML += '             <div class="col-xs-6 m-t-n"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6 m-t-n"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="m-t-sm b-dark b-t b-r b-l b-b" style="width:100%;height:47%;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-7" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' <u>Fax:</u> ' + (pShipperFax == "" ? "N/A" : pShipperFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        ReportHTML += (pShipperPhones.trim() == "" && pShipperFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pShipperPhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pShipperPhones)) + (pShipperFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pShipperFax)) + '</div>');
        //ReportHTML += (pShipperAddressLine1.trim() == "" && pShipperAddressLine2.trim() == "" && pShipperCityName.trim() == "" && pShipperCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1.trim() == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2.trim() == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName.trim() == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>');
        ReportHTML += '                            <div class="col-xs-12">' + (pOperationHeader.ShipperAddress == 0 ? "" : pOperationHeader.ShipperAddress.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Consignee:</u></b> ' + pConsigneeName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' <u>Fax:</u> ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += (pConsigneePhones.trim() == "" && pConsigneeFax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pConsigneePhones.trim() == "" ? "" : ('<u>Phones:</u> ' + pConsigneePhones)) + (pConsigneeFax.trim() == "" ? "" : (' <u>Fax:</u> ' + pConsigneeFax)) + '</div>');
        //ReportHTML += (pConsigneeAddressLine1.trim() == "" && pConsigneeAddressLine2.trim() == "" && pConsigneeCityName.trim() == "" && pConsigneeCountryName.trim() == "") ? "" : ('<div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1.trim() == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2.trim() == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName.trim() == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>');
        ReportHTML += '                            <div class="col-xs-12">' + (pOperationHeader.ConsigneeAddress == 0 ? "" : pOperationHeader.ConsigneeAddress.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify:</u></b> ' + (pNotify1Name == "" ? "Same As Consignee" : pNotify1Name) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' <u>Fax:</u> ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        if (pNotify1Name != "") {
            ReportHTML += (pNotify1Phones.trim() == "" && pNotify1Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify1Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify1Phones)) + (pNotify1Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify1Fax)) + '</div>');
            ReportHTML += '                            <div class="col-xs-12">' + (pOperationHeader.Notify1Address == 0 ? "" : pOperationHeader.Notify1Address.replace(/\n/g, "<br/>")) + '</div>';
        }
        ReportHTML += '                     </div>';

        ReportHTML += '                     <div class="b-dark b-b row" style="height:11%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;">Ocean Vessel: ' + pVesselName + ' ' + pVoyageOrTruckNumber + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;">Port of Loading: ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;">Port of Discharge: ' + pPODCodeAndName.replace(":", ",") + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;">Place of Delivery: ' + (pOperationHeader.DeliveryCityCode == 0 ? pPODCodeAndName.replace(":", ",") : pOperationHeader.DeliveryCityCode) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        /**************************************2nd half of table*****************************************/
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-5" style="height:100%;">';
        //ReportHTML += '                     <div class="m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     <div class="b-dark row" style="height:13%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t"><b>' + 'B/L No ' + (pOperationHeader.BLType == constHouseBLType ? pOperationHeader.HouseNumber : pOperationHeader.MasterBL) + '</b></div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark row" style="height:33%;">';
        ReportHTML += '                         <div class="text-center m-t-xs"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark row" style="height:54%;">';
        //ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify 2:</u></b> ' + pNotify2Name + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Phones:</u> ' + (pNotify2Phones == "" ? "N/A" : pNotify2Phones) + ' <u>Fax:</u> ' + (pNotify2Fax == "" ? "N/A" : pNotify2Fax) + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify2AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify2AddressLine2 == "" ? "" : pNotify2AddressLine2 + ' ') + (pNotify2CityName == "" ? "" : ', ' + pNotify2CityName + ', ') + pNotify2CountryName + '</div>';
        //ReportHTML += (pNotify2Phones.trim() == "" && pNotify2Fax.trim() == "") ? "" : ('<div class="col-xs-12">' + (pNotify2Phones.trim() == "" ? "" : ('<u>Phones:</u> ' + pNotify2Phones)) + (pNotify2Fax.trim() == "" ? "" : (' <u>Fax:</u> ' + pNotify2Fax)) + '</div>');
        //ReportHTML += '<div class="col-xs-12">' + (pOperationHeader.Notify2Address == 0 ? "" : pOperationHeader.Notify2Address.replace(/\n/g, "<br/>")) + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + 'For delivery of goods, Please apply to:' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b>' + (pOperationHeader.AgentName == 0 ? "" : pOperationHeader.AgentName) + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12"><b>' + pAgentAddressLine1 + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12"><b>' + pAgentAddressLine2 + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12"><b>' + pAgentCityName + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12"><b>' + pAgentCountryName + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12"><b>' + pAgentPhones + '</b></div>';
        if (pAgentEmail != "0" && pAgentEmail != "N/A")
            ReportHTML += '                         <div class="col-xs-12"><b>' + pAgentEmail + '</b></div>';
        ReportHTML += '                     </div>';
        //ReportHTML += '                     <div class="b-dark b-b row" style="height:20%;">';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Line:</u></b> ' + pLineName + '</div>';
        //if ($("#cbIsOcean").prop("checked"))
        //    ReportHTML += '                     <div class="col-xs-6" style="height:50%;"><b><u>Vessel:</u></b> ' + pVesselName + '</div>';
        //else
        //    ReportHTML += '                     <div class="col-xs-6" style="height:50%;">&emsp;</div>';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Departure:</u></b> ' + (pActualDeparture == "01/01/1900" || pActualDeparture == "1/1/1900" ? "N/A" : pActualDeparture) + '</div>';
        //ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>ETA POL:</u></b> ' + (pETAPOLDate == "01/01/1900" || pETAPOLDate == "1/1/1900" ? "N/A" : pETAPOLDate) + '</div>';
        //ReportHTML += '                     </div>';
        //ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        //ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POL:</u></b> ' + pPOLCodeAndName + '</div>';
        //ReportHTML += '                         <div class="m-t-xs col-xs-6" style="height:100%;"><b><u>POD:</u></b> ' + pPODCodeAndName + '</div>';
        //ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '             </div>';

        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        ReportHTML += '<div> &nbsp; </div>'//no final shipping declaration for air

        ReportHTML += '                         <table id="tblOperationContainersAndPackages_Pre" style="height:20%;" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
        ReportHTML += '                             <thead>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th>Marks & Numbers</th>';
        ReportHTML += '                                     <th>Packages</th>';
        ReportHTML += '                                     <th>Goods Desc.</th>';
        ReportHTML += '                                     <th style="width:10%;">GW(KG)</th>';
        ReportHTML += '                                     <th style="width:10%;">Measurement(CBM)</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        if (!$("#cbWithAttachment").prop("checked")) {
            ReportHTML += '                                 <tr class="" style="font-size:95%;">';
            ReportHTML += '                                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + ' </td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.NumberOfPackages + "x" + pOperationHeader.PackageTypeName) + ' </td>';
            ReportHTML += '                                     <td>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + ' </td>';
            ReportHTML += '                                     <td>' + pOperationHeader.GrossWeightSum + ' </td>';
            ReportHTML += '                                     <td>' + pOperationHeader.VolumeSum + ' </td>';
            ReportHTML += '                                 </tr>';
        }
        else {
            ReportHTML += '                                 <tr class="" style="font-size:105%;">';
            ReportHTML += '                                     <td colspan=5>' + 'See Attachment' + ' </td>';
            ReportHTML += '                                 </tr>';
        }
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';

        //ReportHTML += '                         <div> &nbsp; </div>'
        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                         </div>';
        //ReportHTML += '                     </div>'; //of table-responsive
        ////ReportHTML += '                 </section>';
        ////ReportHTML += '             <div class="static-text-primary">asfafs</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</br></br></br></br></br>dada</div>';
        ReportHTML += '             <div class="col-xs-6 m-t text-sm m-l-n" style="font-size:90%;">' + 'Declaration of Interests of the consignor<br>in timely delivery (Clause 6.2.)' + '</div>';
        ReportHTML += '             <div class="col-xs-1 m-t">&emsp;<br>&emsp;</div>';
        ReportHTML += '             <div class="col-xs-5 m-t text-sm m-l" style="font-size:90%;">' + 'Declared value for ad valorem rate according<br>the declaration of the consignor (Clauses 7&8)' + '</div>';

        ReportHTML += '             <div class="col-xs-6 text-sm m-l-n">';
        ReportHTML += '                 <div style="height:40px;border:1px solid #000;"></div>';
        ReportHTML += '             </div>';
        ReportHTML += '             <div class="col-xs-1">&emsp;</div>';
        ReportHTML += '             <div class="col-xs-5 text-sm m-l">';
        ReportHTML += '                 <div style="height:40px;border:1px solid #000;"></div>'
        ReportHTML += '             </div>';

        ReportHTML += '             <div class="col-xs-12 text-sm m-l-n" style="font-size:80%; clear:both;">The goods and instructions are accepted and dealts with subject to the standard conditions printed overleaf</div>';
        ReportHTML += '             <div class="col-xs-12 text-sm m-l-n" style="font-size:80%; clear:both;">Taken in charge in apparent good order and condition, unless otherwise noted herein, at the place of receipt for transport and delivery as mentioned above.</div>';
        ReportHTML += '             <div class="col-xs-12 text-sm m-l-n" style="font-size:80%; clear:both;">One of these Multimodal Transport Bills of Lading must be surrended duly endorsed in exchange for the goods. In Witness whereof the original to be void.</div>';
        {
            ReportHTML += '                 <div class="text-sm" style="height:40px;width:40%;border:1px solid #000; float:left;">Place and date of issue <br>&emsp;' + pOperationHeader.POLCode + ' ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.BLDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.BLDate)) : "") + '</div>';
            ReportHTML += '                 <div class="text-sm" style="height:40px;width:30%;border:1px solid #000; float:left;">Freight Payable at <br>&emsp;' + (pOperationHeader.FreightPayableAt == 0 ? "" : pOperationHeader.FreightPayableAt) + '</div>';
            if (pDefaults.UnEditableCompanyName == "ELI")
                ReportHTML += '                 <div class="text-sm" style="height:40px;width:30%;border:1px solid #000; float:left;">' + (pOperationHeader.IsReceivedFromShipper ? 'Received From Shipper Date <br>&emsp;' : 'Shipped on board date <br>&emsp;') + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ShippedOnBoardDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ShippedOnBoardDate)) : "") + '</div>';
            else
                ReportHTML += '                 <div class="text-sm" style="height:40px;width:30%;border:1px solid #000; float:left;">' + 'Shipped on board date <br>&emsp;' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ShippedOnBoardDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ShippedOnBoardDate)) : "") + '</div>';

            ReportHTML += '                 <div class="text-sm" style="height:40px;width:40%;border:0px solid #000; float:left;"></div>';
            ReportHTML += '                 <div class="text-sm" style="height:40px;width:30%;border:1px solid #000; float:left;">Number of Original BLs:' + '<br>&emsp;' + (pOperationHeader.NumberOfOriginalBills == 0 ? "" : pOperationHeader.NumberOfOriginalBills) + '</div>';
            ReportHTML += '                 <div class="text-sm" style="height:60px;width:30%;border:0px solid #000; float:left;">Stamp and signature' + '<br>Elite Logistics Corporation<br>As Agent Only' + '</div>';
        }
        /******************************Attachment*********************************/
        if ($("#cbWithAttachment").prop("checked")) {
            ReportHTML += '         <div class="break"></div>';
            ReportHTML += '         <table id="tblOperationContainersAndPackages_Pre" class="table table-striped b-light b-a text-sm table-bordered">'; //table-hover
            ReportHTML += '             <thead>';
            ReportHTML += '                 <tr>';
            ReportHTML += '                     <th>Marks & Numbers</th>';
            ReportHTML += '                     <th>Packages</th>';
            ReportHTML += '                     <th>Goods Desc.</th>';
            ReportHTML += '                     <th style="width:10%;">GW(KG)</th>';
            ReportHTML += '                     <th style="width:10%;">Measurement(CBM)</th>';
            ReportHTML += '                 </tr>';
            ReportHTML += '             </thead>';
            ReportHTML += '             <tbody>';
            ReportHTML += '                 <tr class="" style="font-size:95%;">';
            ReportHTML += '                     <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + ' </td>';
            ReportHTML += '                     <td>' + (pOperationHeader.NumberOfPackages + "x" + pOperationHeader.PackageTypeName) + ' </td>';
            ReportHTML += '                     <td>' + (pOperationHeader.DescriptionOfGoods == 0 ? "" : pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>")) + ' </td>';
            ReportHTML += '                     <td>' + pOperationHeader.GrossWeightSum + ' </td>';
            ReportHTML += '                     <td>' + pOperationHeader.VolumetricWeight + ' </td>';
            ReportHTML += '                 </tr>';
            ReportHTML += '             </tbody>';
            ReportHTML += '         </table>';
        }
        /******************************EOF Attachment*********************************/
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        //    ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        //ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "ELI") {
    else if (pDefaults.UnEditableCompanyName == "FIV") { //other companies
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';

        //ReportHTML += '             <div class="col-xs-6"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="b-dark b-t b-r b-l b-b" style="width:100%;height:10cm;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-6" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:34%;">';
        ReportHTML += '                         <div class="col-xs-12 b-dark b-b" style="height:10%;">' + '&nbsp;' + '</div>';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs b-dark b-b"><b>SHIPPER</b>' + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Tel:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        ReportHTML += '                         <div class="col-xs-12">TEL: ' + (pShipperPhones == "" ? "N/A" : pShipperPhones) + ' FAX: ' + (pShipperFax == "" ? "N/A" : pShipperFax) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:33%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs b-dark b-b"><b>CONSIGNEE</b>' + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + pConsigneeName + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += '                         <div class="col-xs-12">TEL: ' + (pConsigneePhones == "" ? "N/A" : pConsigneePhones) + ' FAX: ' + (pConsigneeFax == "" ? "N/A" : pConsigneeFax) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark row" style="height:33%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs b-dark b-b"><b>NOTIFY PARTY,</b> <span class="text-sm">Carrier not responsible for failure to notify</span>' + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + (pNotify1Name == 0 ? "Same As Consignee" : pNotify1Name) + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += '                         <div class="col-xs-12">TEL: ' + (pNotify1Phones == "" ? "N/A" : pNotify1Phones) + ' FAX: ' + (pNotify1Fax == "" ? "N/A" : pNotify1Fax) + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';

        ReportHTML += '                 <div class="m-t-n-xxs col-xs-6 b-dark" style="height:100%;">';
        ReportHTML += '                     <div class="col-xs-1">' + '&nbsp;' + '</div>';
        ReportHTML += '                     <div class="col-xs-5 b-dark b-b b-l b-r" style="text-align:right;">' + '<b>B/L NO.</b>' + '</div>';
        ReportHTML += '                     <div class="col-xs-5 b-dark b-b b-l b-r" style="text-align:left;">' + '<b>' + (pHouseNumber == "N/A" ? pMasterBL : pHouseNumber) + '</b>' + '</div>';
        ReportHTML += '                     <div class="col-xs-1">' + '&nbsp;' + '</div>';

        ReportHTML += '                     <div class="col-xs-12" style="height:15%;">' + '&nbsp;' + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;height:40%;"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     <div class="b-dark row" style="height:35%;">';
        ReportHTML += '                         <div class="col-xs-12 b-dark b-b b-t"><b>DESTINATION AGENT</b>' + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + pAgentName + '</div>';
        ReportHTML += '                         <div class="col-xs-12">' + (pAgentAddressLine1 == "" ? "" : pAgentAddressLine1 + ' ') + (pAgentAddressLine2 == "" ? "" : pAgentAddressLine2 + ' ') + (pAgentCityName == "" ? "" : ', ' + pAgentCityName + ', ') + pAgentCountryName + '</div>';
        ReportHTML += '                         <div class="col-xs-12">TEL: ' + (pAgentPhones == "" ? "N/A" : pAgentPhones) + ' FAX: ' + (pAgentFax == "" ? "N/A" : pAgentFax) + '</div>';
        ReportHTML += '                     </div>';

        ReportHTML += '                 </div>';
        ReportHTML += '             </div>';

        ReportHTML += '                         <table class="m-t-n-xs text-sm col-xs-12 table-bordered" style="height:7cm; border:1px solid #000!Important;">';
        ReportHTML += '                             <thead style="text-align:center; font-size:70%; border:1px solid #000!Important;">';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;" colspan=2>' + 'PRE CARRIAGE BY' + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + 'PLACE OF RECEIPT' + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + 'FREIGHT' + '</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">' + 'B/L STATUS' + '</th>';
        ReportHTML += '                                     <th style="width:10%; text-align:center;" colspan=2>' + 'NUMBER OF B/L' + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;" colspan=2>' + pOperationHeader.LineName + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + pOperationHeader.PODName + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + (pOperationHeader.POrCName == 0 ? "" : pOperationHeader.POrCName) + '</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">' + $("#slPrintType").val() + '</th>';
        ReportHTML += '                                     <th style="width:10%; text-align:center;" colspan=2>' + (pOperationHeader.NumberOfOriginalBills == 0 ? "N/A" : pOperationHeader.NumberOfOriginalBills) + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;" colspan=2>' + 'VESSEL' + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + 'VOYAGE' + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + 'PORT OF LOADING' + '</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">' + 'PORT OF DISCHARGE' + '</th>'; //Gross
        ReportHTML += '                                     <th style="width:10%; text-align:center;" colspan=2>' + ' FINAL PLACE OF DELIVERY' + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;" colspan=2>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + (pOperationHeader.VoyageOrTruckNumber == 0 ? "" : pOperationHeader.VoyageOrTruckNumber) + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + pOperationHeader.POLName + '</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">' + pOperationHeader.PODName + '</th>'; //Gross
        ReportHTML += '                                     <th style="width:10%; text-align:center;" colspan=2>' + (pOperationHeader.DeliveryCityName == 0 ? "" : pOperationHeader.DeliveryCityName) + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;">' + 'MARKS AND NOS' + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;">' + 'NO AND KIND' + '</th>';
        ReportHTML += '                                     <th style=" text-align:center;" colspan=3>' + 'DESCRIPTION OF PACKAGES AND GOODS AS STATED BY SHIPPER' + '</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">' + 'GROSS WEIGHT' + '</th>'; //Gross
        ReportHTML += '                                     <th style="width:10%; text-align:center;">' + 'MEASUREMENT' + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;">CONTAINER AND SEALS</th>';
        ReportHTML += '                                     <th style=" text-align:center;">OF PACKAGES</th>';
        ReportHTML += '                                     <th style=" text-align:center;" colspan=3>SHIPPER LOAD STOW AND COUNT SAID TO CONTAIN</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">' + 'CARGO' + '</th>'; //Gross
        ReportHTML += '                                     <th style="width:10%; text-align:center;">' + '' + '</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="text-align:center; vertical-align:text-top; font-size:95%;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.MarksAndNumbers == 0 ? "" : pOperationHeader.MarksAndNumbers.replace(/\n/g, "<br/>")) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.NumberOfPackages + ' ' + pOperationHeader.PackageTypeName) + '</td>';
        ReportHTML += '                                         <td colspan=3>' + pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>") + "<br/>&nbsp;" + "<br/>&nbsp;" + "<br/>&nbsp;" + "<br/>&nbsp;" + "<br/>&nbsp;" + "<br/>&nbsp;" + '<p style="font-size:75%;">(ABOVE PARTICULARS DECLARED BY SHIPPER.CARRIER NOT RESPONSIBLE.)</p>' + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum + ' KGM' + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.ContainerTypes.replace(/-/g, "<br/>") + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        ReportHTML += '                             <table class="table table-striped b-light text-sm table-bordered">';//style="border:solid #000 !Important;"
        ReportHTML += '                                 <tr style="font-size:95%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                                     <td colspan=2 style="text-align:center!Important;"><b>ADDITIONAL CLAUSES</b></td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:65%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; vertical-align:top; width:45%;">';
        ReportHTML += '                                         Cargo at port is at merchant risk, expenses and responsibility.destination charges';
        ReportHTML += '                                         <br>payable by Merchant as per line/port tariff.Demurrage and detention shall be calculated';
        ReportHTML += '                                         <br>and paid as per general tariff.Mis-declaration of cargo weight endangers crew, port';
        ReportHTML += '                                         <br>workers and vessels safety.Your cargo may be weighed at any place and time of';
        ReportHTML += '                                         <br>carriage and any mis-declaration will expose you to claims for all losses, expenses or';
        ReportHTML += '                                         <br>damages whatsoever resulting thereof and be subject to freight surcharge.The shipper';
        ReportHTML += '                                         <br>acknowledges that the Carrier may carry the goods identified in this bill of lading on the';
        ReportHTML += '                                         <br>deck of any vessel and in taking remittance of this bill of lading the Merchant (including';
        ReportHTML += '                                         <br>the shipper, the consignee and the holder of the bill of lading, as the case may be)';
        ReportHTML += '                                         <br>confirms his express acceptance of all the terms and conditions of this bill of lading and';
        ReportHTML += '                                         <br>expressly confirms his unconditional and irrevocable consent to the possible carriage of';
        ReportHTML += '                                         <br>the goods on the deck of any vessel.';
        ReportHTML += '                                         <br>(OTHER TERMS AND CONDITIONS OF THE CONTRACT ON BACK SIDE)';
        ReportHTML += '                                     </td>';
        ReportHTML += '                                     <td style="text-align:left!Important; vertical-align:top; width:65%;">';
        ReportHTML += '                                         RECEIVED by the Carrier from the Shipper in apparent good order and condition (unless otherwise noted herein)';
        ReportHTML += '                                         <br>the total number or quantity of containers or other packages or units indicated above by Merchant for carriage,';
        ReportHTML += '                                         <br>subject to all the terms hereof (including the terms on page one) and tariff for the relevant trade, from the place of';
        ReportHTML += '                                         <br>receipt or the port of loading, whichever applicable,to the port of discharge or place of delivery, whichever';
        ReportHTML += '                                         <br>applicable.This BL is deemed to be a contract of carriage as defined in Article I(b) of Hague Rules and Hague';
        ReportHTML += '                                         <br>Visby Rules although this is not a document of title to the Goods. DELIVERY will only be made on Payment of all';
        ReportHTML += '                                         <br>Freight and Charges and to the named Consignee or any third party nominated by the Consignee by written';
        ReportHTML += '                                         <br>instruction to the Carrier or his Agent, unless the Shipper instructs otherwise prior to delivery. The rights and';
        ReportHTML += '                                         <br>liabilities arising according to the terms hereof shall (without prejudice to any rule of common law and status)';
        ReportHTML += '                                         <br>become binding between the Carrier and Consignee as if this agreement has been made between them and the';
        ReportHTML += '                                         <br>Shipper guarantees on reception of this B/L that he has accepted it on his own behalf,on behalf of the Consignee';
        ReportHTML += '                                         <br>and the Owner of the Goods,and warrants that he has authority to do so.All claims and actions arising between';
        ReportHTML += '                                         <br>Carrier and the Merchant in relation with the contract of Carriage evidenced by this B/L shall exclusively be';
        ReportHTML += '                                         <br>brought before the concerned Tribunal.';
        ReportHTML += '                                     </td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr style="font-size:95%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                                     <td colspan=2 style="text-align:center!Important;">' + '&nbsp;' + '</td>';
        ReportHTML += '                                 </tr>';

        ReportHTML += '                                 <tr class="" style="font-size:100%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; vertical-align:top; width:45%;">';
        ReportHTML += '                                         &nbsp;';
        ReportHTML += '                                     </td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:100%;">';
        ReportHTML += '                                     <th style="text-align:left!Important; vertical-align:top; width:45%;">';
        ReportHTML += '                                         PLACE AND DATE OF ISSUE';
        ReportHTML += '                                     </th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </table>';

        ReportHTML += '                             <div class="m-t-n col-xs-12 b-dark">';
        ReportHTML += '                                 <div class="col-xs-7 m-l-n">' + pOperationHeader.POLName + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.BLDate)) > 0 ? ("/" + ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.BLDate))) : "") + '</div>';
        ReportHTML += '                                 <div class="col-xs-5 m-l b-dark b-b b-l b-r b-t" style="text-align:right;">' + '<b>' + pDefaults.CompanyName + '</b>' + '</div>';

        ReportHTML += '                                 <div class="col-xs-12 text-right">' + 'Signed on behalf of the carrier' + '</div>';
        ReportHTML += '                             </div>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        //ReportHTML += '         <div class="m-r" style="text-align:right;"><b>' + pEnCompanyName + '</b></div>';
        ////ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        //    ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        //if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        //    ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //else if (pDefaults.UnEditableCompanyName == "FIV") {
    else { //other companies
        //var ReportHTML = '';
        if (IsLastPage == undefined || IsFirstPage == true) {
            ReportHTML = '';
        } else {
            ReportHTML += '         <div class="break"></div>';
        }
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        //ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</h3></div> </br>';

        //ReportHTML += '             <div class="col-xs-6"><b>Date:</b> ' + ConvertDateFormat(FormattedTodaysDate) + '</div><div class="col-xs-6"><b>Operation No. :</b> ' + pOperationCode + '</div>';
        ReportHTML += '             <div class="col-xs-12 m-l-n">SHIPPED by or RECEIVED for shipment in apparent good order and condition, except as noted in the particulars</div>';
        ReportHTML += '             <div class="b-dark b-t b-r b-l b-b" style="width:100%;height:12.5cm;">';
        ReportHTML += '                 <div class="m-t-n-xxs b-dark b-r col-xs-6" style="height:100%;">';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Shipper:</u></b> ' + pShipperName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Contact Person:</u> ' + pShipperContactName + '</div>';
        ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pShipperAddressLine1 == "" ? "" : pShipperAddressLine1 + ' ') + (pShipperAddressLine2 == "" ? "" : pShipperAddressLine2 + ' ') + (pShipperCityName == "" ? "" : ', ' + pShipperCityName + ', ') + pShipperCountryName + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Tel:</u> ' + pShipperPhones + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Fax:</u> ' + pShipperFax + '</div>';
        //ReportHTML += '                         <div class="col-xs-12"><u>Email:</u> ' + pShipperEmail + '</div>';
        ReportHTML += '                         <div class="col-xs-12"><u>Tel:</u> ' + pShipperPhones + ' <u>Fax:</u> ' + pShipperFax + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Consignee:</u></b> ' + pConsigneeName + '</div>';
        ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pConsigneeAddressLine1 == "" ? "" : pConsigneeAddressLine1 + ' ') + (pConsigneeAddressLine2 == "" ? "" : pConsigneeAddressLine2 + ' ') + (pConsigneeCityName == "" ? "" : ', ' + pConsigneeCityName + ', ') + pConsigneeCountryName + '</div>';
        ReportHTML += '                         <div class="col-xs-12"><u>Tel:</u> ' + pConsigneePhones + ' <u>Fax:</u> ' + pConsigneeFax + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:26%;">';
        ReportHTML += '                         <div class="col-xs-12 m-t-xs"><b><u>Notify:</u></b> ' + (pNotify1Name == 0 ? "Same As Consignee" : pNotify1Name) + '</div>';
        ReportHTML += '                         <div class="col-xs-12"><u>Address:</u> ' + (pNotify1AddressLine1 == "" ? "" : pNotify1AddressLine1 + ' ') + (pNotify1AddressLine2 == "" ? "" : pNotify1AddressLine2 + ' ') + (pNotify1CityName == "" ? "" : ', ' + pNotify1CityName + ', ') + pNotify1CountryName + '</div>';
        ReportHTML += '                         <div class="col-xs-12"><u>Tel:</u> ' + pNotify1Phones + ' <u>Fax:</u> ' + pNotify1Fax + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="b-dark b-b row" style="height:11%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Vessel:</u></b> ' + pVesselName + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Port of Loading:</u></b> ' + pPOLCodeAndName + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="m-t-n-xxs row" style="height:11%;">';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Port of Discharge:</u></b> ' + pPODCodeAndName.replace(":", ",") + '</div>';
        ReportHTML += '                         <div class="col-xs-6" style="height:50%;"><b><u>Final Destination:</u></b> ' + pPODCodeAndName.replace(":", ",") + '</div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                 <div class="m-t-n-xxs col-xs-6 b-b b-dark" style="height:75%;">';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:right;"><h5>' + (pRepBLTypeShown == 'HOUSE' ? 'House ' : '') + 'Bill of Lading</h5></div>';
        ReportHTML += '                     <div class="col-xs-12 m-t-n-sm">';
        ReportHTML += '                         <div class="col-xs-3">';
        ReportHTML += '                             <b>' + $("#slPrintType").val() + '</b>';
        ReportHTML += '                         </div>';
        ReportHTML += '                         <div class="col-xs-9">';
        ReportHTML += '                             <table class="table table-striped b-light text-sm table-bordered m-l">';//style="border:solid #000 !Important;"
        //ReportHTML += '                                 <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        //ReportHTML += '                                     <td style="text-align:center!Important;"><b>Client No : </b>' + pCustomerReference + '</td>';
        //ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:center!Important;"><b>B/L No : </b>' + (pHouseNumber == "N/A" ? pMasterBL : pHouseNumber) + '</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </table>';
        ReportHTML += '                         </div>';
        ReportHTML += '                     </div>';
        ReportHTML += '                     <div class="" style="text-align:center;"><img src="/Content/Images/CompanyLogo.jpg" alt="logo"/></div>';
        ReportHTML += '                     <div class="col-xs-12 m-t-n-sm" style="text-align:center;"><h4>' + pEnCompanyName + '</h4></div>';
        ReportHTML += '                     <div class="col-xs-12 m-t-n-sm" style="text-align:center;">' + pAddressLine1 + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine2 + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine3 + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine4 + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;">' + pAddressLine5 + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;"><u>Tel :</u> ' + pPhones + '</div>';
        ReportHTML += '                     <div class="col-xs-12" style="text-align:center;"><u>Fax :</u> ' + pFaxes + '</div>';

        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Email :</u> ' + pEmail + '</div>';
        //ReportHTML += '                     <div class="col-xs-12 m-l-n"><u>Website :</u> ' + pWebsite + '</div>';
        ReportHTML += '                 </div>';
        ReportHTML += '                     <div class="col-xs-12" style="height:25%;">Notify Also:</div>';
        ReportHTML += '             </div>';

        ////ReportHTML += '                 <section class="panel panel-default">';
        //ReportHTML += '                     <div class="table-responsive">';
        ////ReportHTML += '                         <table class="table m-t-n-xs table-striped b-t b-light text-sm table-bordered">'; //table-hover
        //ReportHTML += '                         <table class="m-t-n-xs text-sm col-xs-12" style="height:5.5cm; border:1px solid #000!Important;">';
        //ReportHTML += '                             <thead style="text-align:center; border:1px solid #000!Important;">';
        //ReportHTML += '                                 <tr>';
        ////if ($("#cbIsAir").prop("checked") || $("#cbIsLCL").prop("checked") || $("#cbIsLTL").prop("checked"))
        //if ($("#cbIsAir").prop("checked") || pShipmentType == "LCL" || pShipmentType == "LTL")
        //    ReportHTML += '                                 <th style="text-align:center; width:20%; text-align:left; border:1px solid #000!Important;">Package Type</th>';
        //else
        //    ReportHTML += '                                 <th style="width:20%; text-align:center; border:1px solid #000!Important;">Marks & Numbers</th>';
        //ReportHTML += '                                     <th style="width:10%; text-align:center; border:1px solid #000!Important;">Packages</th>';
        //ReportHTML += '                                     <th style="width:50%; text-align:center; border:1px solid #000!Important;">Description Of Goods</th>';
        //ReportHTML += '                                     <th style="width:10%; text-align:center; border:1px solid #000!Important;">Weight (KG)</th>'; //Gross
        //ReportHTML += '                                     <th style="width:10%; text-align:center; border:1px solid #000!Important;">CBM</th>';
        //ReportHTML += '                                 </tr>';
        //ReportHTML += '                             </thead>';
        //ReportHTML += '                             <tbody>';
        //$.each(JSON.parse(pContainersAndPackages), function (i, item) {
        //    ReportHTML += '                                     <tr class="" style="text-align:left; vertical-align:text-top; font-size:95%;">';
        //    //if ($("#cbIsAir").prop("checked") || $("#cbIsLCL").prop("checked") || $("#cbIsLTL").prop("checked")) {
        //    if ($("#cbIsAir").prop("checked") || pShipmentType == "LCL" || pShipmentType == "LTL") {
        //        ReportHTML += '                                     <td>' + item.PackageTypeName + '</td>';
        //        ReportHTML += '                                     <td>' + item.Quantity + '</td>';
        //    }
        //    else {
        //        ReportHTML += '                                     <td>' + item.MarksAndNumbers + '</td>';
        //        ReportHTML += '                                     <td>' + item.NumberOfPackagesOnContainer + (item.PackageTypeNameOnContainer == 0 ? "" : ( 'x' + item.PackageTypeNameOnContainer)) + '</td>';
        //    }
        //    ReportHTML += '                                         <td>' + (item.DescriptionOfGoods == "0" ? 'N/A' : item.DescriptionOfGoods.replace(/\n/g, "<br/>")) + '</td>';
        //    ReportHTML += '                                         <td>' + item.GrossWeight.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
        //    ReportHTML += '                                         <td>' + item.Volume.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
        //    ReportHTML += '                                     </tr>';
        //});
        //ReportHTML += '                             </tbody>';
        //ReportHTML += '                         </table>';
        ReportHTML += '                         <table class="m-t-n-xs text-sm col-xs-12" style="height:5.5cm; border:1px solid #000!Important;">';
        ReportHTML += '                             <thead style="text-align:center; border:1px solid #000!Important;">';
        ReportHTML += '                                 <tr>';
        ReportHTML += '                                     <th style=" text-align:center;">Marks And Numbers</th>';
        ReportHTML += '                                     <th style=" text-align:center;">No & Kind of Packages</th>';
        ReportHTML += '                                     <th style=" text-align:center;">Goods Desc.</th>';
        ReportHTML += '                                     <th style="width:15%; text-align:center;">G.Weight (KG)</th>'; //Gross
        ReportHTML += '                                     <th style="width:10%; text-align:center;">Measurements</th>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                             </thead>';
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="text-align:center; vertical-align:text-top; font-size:95%;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.PackageTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? "" : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.PackageTypes) + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.DescriptionOfGoods.replace(/\n/g, "<br/>") + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum + ' KGM' + '</td>';
        ReportHTML += '                                         <td>' + pOperationHeader.VolumeSum + ' CBM' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table>';
        ReportHTML += '                             <table class="table table-striped b-light text-sm table-bordered">';//style="border:solid #000 !Important;"
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';//style="border:solid #000 !Important;"
        ReportHTML += '                                     <td style="text-align:center!Important; width:50%;"><b>Details of cargo as declared by shipper</b></td>';
        ReportHTML += '                                     <td rowspan=3 colspan=2 style="text-align:left!Important; width:50%;">RECEIVED the goods or the containers, vans, pallets, units or other packages said to contain goods herein mentioned, in apparent good order or condition, except as otherwise indicated, to be transported, delivered or transshipped as provided herein, "Subject to all terms and conditions appearing on this house bill of lading"</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; width:50%;">For particulars of delivery apply with this Bill of Lading to:</td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td rowspan=2 colspan=1 style="text-align:left!Important; width:50%;">';
        ReportHTML += '                                         ' + pAgentName;
        ReportHTML += '                                         <br>Email : ' + pAgentEmail;
        ReportHTML += '                                         <br>Phones : ' + pAgentPhones;
        ReportHTML += '                                         <br>Address : ' + (pAgentAddressLine1 == "" ? "" : (pAgentAddressLine1 + ' ' + pAgentAddressLine2)) + ' ' + pAgentCityName + ' ' + pAgentCountryName;
        ReportHTML += '                                         <br>Consol Ref : ' + pMasterBL;
        ReportHTML += '                                     </td>';
        ReportHTML += '                                 </tr>';
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">Freight Payable at:<br>' + pPODCodeAndName + '</td>';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">Place & Date of Issue:<br>' + getTodaysDateInddMMyyyyFormat() + '</td>';
        ReportHTML += '                                 </tr>';
        /*******************Starting new rowspans and colspans**********************/
        ReportHTML += '                                 <tr class="" style="font-size:95%;">';
        ReportHTML += '                                     <td style="text-align:left!Important; width:50%;">Type of Service : ' + ($("#slMoveTypes option:selected").val() == "" ? "N/A" : $("#slMoveTypes option:selected").text()) + '<br><br><br></td>';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">Number of Original B/Ls:<br><br><br><br> 3/3 </td>';
        ReportHTML += '                                     <td style="text-align:left!Important; width:25%;">For & on behalf of:<br>' + '<br><br><br><br>' + '</td>';
        ReportHTML += '                                 </tr>';

        ReportHTML += '                             </table>';

        //ReportHTML += '                         <div class="form-group float-right m-r-lg strong">';
        //ReportHTML += '                             <b>Total: ' + $("#tblInvoices #" + pID + " td.InvoiceAmount").text() + ' ' + $("#tblInvoices #" + pID + " td.InvoiceCurrency").text() + '</b>';
        //ReportHTML += '                         </div>';
        //ReportHTML += '                     </div>'; //of table-responsive
        ////ReportHTML += '                 </section>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        ReportHTML += '         <div class="m-r" style="text-align:right;"><b>' + pEnCompanyName + '</b></div>';
        //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF other companies
}
function DocsOut_Print_MEDCover(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    var pMainRoute = JSON.parse(data[2]);
    var pMainRouteMaster = data[3] == null ? 0 : JSON.parse(data[3]);
    var pSupplierName = data[4];

    // HS Code   >> Old >> pOperationHeader.BusinessUnit
    // new >> 3 Commodity Codes
    pOperationHeader.BusinessUnit = pOperationHeader.CommodityCode + " - " + pOperationHeader.CommodityCode2 + " - " + pOperationHeader.CommodityCode3;

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';
    if (1 == 1) {
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '             <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' REF IMP ' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' REF IMP ' + '</b></h3></div>';

        ReportHTML += '             <div class="col-xs-4"><h5><b><u>' + 'Weight: ' + '</u>' + pOperationHeader.GrossWeightSum + ' KGM' + '</b></h5></div>';
        ReportHTML += '             <div class="col-xs-8"><h5><b><u>' + 'Containers: ' + '</u>' + pOperationHeader.ContainerTypes + '</b></h5></div>';
        ReportHTML += '             <div class="col-xs-12"><h5><b><u>' + 'Consignee: ' + '</u>' + pOperationHeader.ConsigneeName + '</b></h5></div>';
        ReportHTML += '             <div class="col-xs-4"><h5><b><u>' + 'ACID Number: ' + '</u>' + pOperationHeader.ACIDNumber + '</b></h5></div><hr style="border-top: 1px solid;">';
        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <u>COMMERCIAL INVOICE</u>';
            ReportHTML += '                                             <br>Supplier: ' + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>No: ';//+ (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Date: ';// + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Amount: ';// + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Incoterm: ' + (pOperationHeader.IncotermName == 0 ? "" : pOperationHeader.IncotermName);
            ReportHTML += '                                             <br>N.W.: ' + (pOperationHeader.NetWeightSum) + ' KG' + '&emsp;&emsp;&emsp; G.W.: ' + (pOperationHeader.GrossWeightSum) + ' KG';
            ReportHTML += '                                             <br>Commodity: ' + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName);
            ReportHTML += '                                             <br>HS Code: ' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit);
            ReportHTML += '                                             <br>ACID Number: ';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <u>PACKING LIST</u>';
            ReportHTML += '                                             <br><br>N.W.: ' + (pOperationHeader.NetWeightSum) + ' KG';
            ReportHTML += '                                             <br>G.W.: ' + (pOperationHeader.GrossWeightSum) + ' KG';
            ReportHTML += '                                             <br>No of Packages: ' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages);
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:100%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <div class="col-xs-12 m-l-n"><u>BILL OD LADING</u></div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">POL: ' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">POD: ' + (pOperationHeader.PODName == 0 ? "" : pOperationHeader.PODName) + '</div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">Cargo: ' + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName) + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">HS Code: ' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit) + '</div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">N.W.: ' + (pOperationHeader.NetWeightSum) + ' KG' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">G.W.: ' + (pOperationHeader.GrossWeightSum) + ' KG' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">Shipping Line: ' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">Departure: ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualDeparture)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualDeparture)) : "") + '</div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">ACID Number: </div>';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <u>MOVEMENT CERTIFICATE/EUR</u>';
            ReportHTML += '                                             <br>Invoice No: ';
            ReportHTML += '                                             <br>Date of Issue: ';// + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Description: ';// + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Weight: ' + (pOperationHeader.GrossWeightSum) + ' KG';
            ReportHTML += '                                             <br>HS Code: ' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit);
            ReportHTML += '                                             <br>Declaration: ';// + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName);
            ReportHTML += '                                             <br>ACID Number: ';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <u>CERTIFICATE OF ORIGIN/IMPORT DECLERATION</u>';
            ReportHTML += '                                             <br>Invoice No: ';
            ReportHTML += '                                             <br>Date of Issue: ';// + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Description: ';// + (pSupplierName == 0 ? "" : pSupplierName);
            ReportHTML += '                                             <br>Weight: ' + (pOperationHeader.GrossWeightSum) + ' KG';
            ReportHTML += '                                             <br>HS Code: ' + (pOperationHeader.BusinessUnit == 0 ? "" : pOperationHeader.BusinessUnit);
            ReportHTML += '                                             <br>Other: ';// + (pOperationHeader.CommodityName == 0 ? "" : pOperationHeader.CommodityName);
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:100%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <div class="col-xs-12 m-l-n"><u>SHIPPING PART</u></div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">ETA: ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ExpectedArrival)) : "") + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">Free Days: ' + (pMainRouteMaster == 0 ? pMainRoute.FreeTime : pMainRouteMaster.FreeTime) + '</div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">ATA: ' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ActualArrival)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival)) : "") + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">Storage At: ' + (pMainRouteMaster == 0 ? pMainRoute.WareHouseLocation : pMainRouteMaster.WareHouseLocation) + '</div>';

            ReportHTML += '                                             <div class="col-xs-6 m-l-n">ACID Number: </div>';

            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <u>OPERATION NOTES & ANY REQUIRES</u>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:left;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <u>IMPORT MANAGER & CEO IMPORTANT NOTES</u>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                             <br>';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }
        ReportHTML += '                 <div class="m-t" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
        ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + 'Prepared By' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + 'Manager' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-4 m-t text-center"><b>' + 'CEO' + '</b></div>';
        ReportHTML += '                 </div>'
        ReportHTML += '                 <div class="m-t" style="clear:both;">'; //this is supposed to  be in the footer but i added it here to test not put on text
        ReportHTML += '                     <div class="col-xs-4 text-center"><b>' + pLoggedUser.Name + '</b></div>';
        ReportHTML += '                     <div class="col-xs-4 text-center"><b>' + '&emsp;' + '</b></div>';
        ReportHTML += '                     <div class="col-xs-4 text-center"><b>' + '&emsp;' + '</b></div>';
        ReportHTML += '                 </div>'

        ReportHTML += '         <div class="break"></div>';

        ReportHTML += '             <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' REF IMP ' + '</b></h3></div>';

        ReportHTML += '             <div class="col-xs-4"><h5><b><u>' + 'Weight: ' + '</u>' + pOperationHeader.GrossWeightSum + ' KGM' + '</b></h5></div>';
        ReportHTML += '             <div class="col-xs-8"><h5><b><u>' + 'Containers: ' + '</u>' + pOperationHeader.ContainerTypes + '</b></h5></div>';
        ReportHTML += '             <div class="col-xs-12"><h5><b><u>' + 'Consignee: ' + '</u>' + pOperationHeader.ConsigneeName + '</b></h5></div><hr style="border-top: 1px solid;">';
        {
            ReportHTML += '                     <div class="col-xs-12 m-t text-right"><b>' + ' ................................................... / ................................................... / ...................................................' + ' : البند الجمركى ' + '</b></div>';

            ReportHTML += '                     <div class="col-xs-4 m-t-sm text-right"><b>' + ' ................................' + '   نوع التعاقد   ' + '</b></div>';
            ReportHTML += '                     <div class="col-xs-4 m-t-sm text-right"><b>' + ' ................................' + '   العملة   ' + '</b></div>';
            ReportHTML += '                     <div class="col-xs-4 m-t-sm text-right"><b>' + ' .......................' + '  قيمة الفاتورة بدون خصم ' + '</b></div>';

            ReportHTML += '                     <div class="col-xs-12 m-t-sm text-right"><b>' + ' ................................................... / ................................................... / ...................................................' + ' : البند الجمركى ' + '</b></div>';
            ReportHTML += '                     <div class="col-xs-12 m-t-sm text-right"><b>' + ' ...................................................' + ' :  التفريغ ' + '</b></div>';
            ReportHTML += '                     <div class="col-xs-12 m-t-sm text-right"><b>' + ' ...................................................' + ' :  الشحن ' + '</b></div>';
            ReportHTML += '                     <div class="col-xs-12 m-t-sm text-right"><b>' + ' ...................................................' + ' :  التأمين ' + '</b></div>';
            ReportHTML += '                     <div class="col-xs-12 m-t-sm text-right"><b>' + ' ..........................................' + ' :  معامل التحويل ' + '</b></div>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:right;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <div class="col-xs-6">' + '....................  السعر المقبول' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6"> في حالة تحسين السعر ان وجد  * ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + ' القيمة المقر عنها ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '  ضريبة الوارد ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '  ضريبة القيمة المضافة  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '  أ . ت . ص ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '   (&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;)  اخرى  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '   (&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;)  اخرى  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '   الاجمــــالي ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  الاعتمـــــاد  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '&emsp;' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '&emsp;' + '</div>';

            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                     <td style="width:50%;vertical-align:top;text-align:right;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <div class="col-xs-12">' + '<u>الرسوم الجمركية</u>  في حالة قبول السعر *  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + ' القيمة المقر عنها ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '  ضريبة الوارد ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '  ضريبة القيمة المضافة  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '  أ . ت . ص ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '   (&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;)  اخرى  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '   (&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;)  اخرى  ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '   الاجمــــالي ' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  الاعتمـــــاد  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '&emsp;' + '</div>';

            ReportHTML += '                                             <div class="col-xs-6">' + '  ....................................  ' + '</div>';
            ReportHTML += '                                             <div class="col-xs-6">' + '&emsp;' + '</div>';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:100%;vertical-align:top;text-align:right;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <div class="col-xs-2">' + ' صحة صناعى  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  صرف تحت تحفظ  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  كيمياء  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '   زراعة مشمول  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '   زراعة   ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2"><u>' + '    العروض على الشحنة    ' + '</u></div>';

            ReportHTML += '                                             <div class="col-xs-2" style="clear:both;">' + '  مطافي  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  أمن عام  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  مفرقعات  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  دمغة وموازين  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '   طاقة ذرية  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  صحة غذائي  ' + '<input type="checkbox" >' + '</div>';

            ReportHTML += '                                             <div class="col-xs-2">' + '  اتصالات  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  مصنفات  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '   إفراج وطني  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  بيطري  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  أمن وطني  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  تزيف وتزوير  ' + '<input type="checkbox" >' + '</div>';

            ReportHTML += '                                             <div class="col-xs-8">' + '  .........................................................  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '  ملاحظات اخرى  ' + '<input type="checkbox" >' + '</div>';
            ReportHTML += '                                             <div class="col-xs-2">' + '   شؤون بيئية  ' + '</div>';
            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        {
            ReportHTML += '                         <table class="table table-striped text-sm  table-bordered" style="border:solid #000 !Important;">';  //table-hover
            ReportHTML += '                                 <tr class="" style="">';
            ReportHTML += '                                     <td style="width:100%;vertical-align:top;text-align:right;">';
            ReportHTML += '                                         <b>';
            ReportHTML += '                                             <div class="col-xs-12"><u>' + '   مستندات مطلوبة لم يتم مراجعتها والملاحظات إن وجدت    ' + '</u></div>';
            ReportHTML += '                                             <div class="col-xs-12">' + '<br>&emsp;<br>&emsp;<br>&emsp;<br>&emsp;<br>&emsp;' + '</div>';

            ReportHTML += '                                             <div class="col-xs-12"><u>' + '   مدة التخليص الجمركي المتوقعة     ' + '</u></div>';
            ReportHTML += '                                             <div class="col-xs-12">' + '<br>&emsp;' + '</div>';

            ReportHTML += '                                         </b>';
            ReportHTML += '                                     </td>';
            ReportHTML += '                                 </tr>';
            ReportHTML += '                         </table>';
        }

        ReportHTML += '                             <div class="col-xs-12"><h3><b>' + '  الاعتمـــــاد  ' + '</b></h3></div>';

    }

    ReportHTML += '         </body>';
    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
    //ReportHTML += '         <div class="row text-right m-r">الشركه خاضعه لنظام الدفعات المقدمه تطبيقا لأحكام الماده 62 من القانون رقم 91 لسنة 2005 و لا يجوز الخصم عليها</div>';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
//kk------------------------------------------------function DocsOut_Print_Route(data, pDocumentTypeID, pOption)-------------------------------------------------
function DocsOut_Print_Route(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;

    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    var POLName = pOperationHeader.POLName
    var PODName = pOperationHeader.PODName
    var GrossWeightSum = pOperationHeader.GrossWeightSum
    var VesselName = pOperationHeader.VesselName
    var MasterBL = pOperationHeader.MasterBL
    var POLName = pOperationHeader.POLName

    if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + 'Route' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + 'Route' + '</b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-lg">' + '<b style="font-size:16px;">Printed on :' + ConvertDateFormat(FormattedTodaysDate) + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + 'Dear Messers / Customs Authority' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm">' + '<b style="font-size:15px;">' + 'Good Day,' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + 'The cargo transferred From ' + (POLName == "0" ? "" : POLName) + ' To ' + (PODName == "0" ? "" : PODName) + ' has not been changed throughout the way.' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-md">' + '<b style="font-size:16px;">' + 'Client :' + (pOperationHeader.ClientName == "0" ? "" : pOperationHeader.ClientName) + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-md">' + '<b style="font-size:16px;">' + 'Gross Weight ' + (GrossWeightSum == "0" ? "" : ("كجم " + GrossWeightSum)) + '</b></div>';
        //POLName  PODName   GrossWeightSum  VesselName   MasterBL
        // (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs)
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-md">' + '<b style="font-size:16px;">' + 'BL No. : ' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-md">' + '<b style="font-size:16px;">' + 'Packages :  ' + (pOperationHeader.NumberOfPackages == 0 ? pOperationHeader.PackageTypes : pOperationHeader.NumberOfPackages) + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-md">' + '<b style="font-size:16px;">' + 'Vessel : ' + (pOperationHeader.VesselName == "0" ? "" : pOperationHeader.VesselName) + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 m-b-sm m-t-md">' + '<b style="font-size:16px;">' + 'Line : ' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 m-t-lg">' + '<b style="font-size:15px;">' + 'Thanks and best regards ...........  ' + '</b></div>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //if (pDefaults.UnEditableCompanyName == "SET")
    else {//other companies
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b>' + ' خط سير ' + '</b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b>' + ' خط سير ' + '</b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ConvertDateFormat(FormattedTodaysDate) + ' الاسكندرية فى  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' الساده / جمارك اسكندرية ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm">' + '<b style="font-size:15px;">' + ' تحيه طيبه وبعد  ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ': دون العبث بها ' + (PODName == "0" ? "" : PODName) + ' الى ميناء ' + (POLName == "0" ? "" : POLName) + '  نحيط سيادتكم علما بأن الشحنة الاتي بياناتها تم شحنها من     ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + (pOperationHeader.ClientName == "0" ? "" : pOperationHeader.ClientName) + '<b style="font-size:16px;">' + ' اسم العميل ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + (GrossWeightSum == "0" ? "" : ("كجم " + GrossWeightSum)) + '<b style="font-size:16px;">' + ' اجمالى الوزن ' + '</b></div>';
        //POLName  PODName   GrossWeightSum  VesselName   MasterBL
        // (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs)
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + (pOperationHeader.HouseBLs == 0 ? (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) : pOperationHeader.HouseBLs) + '<b style="font-size:16px;">' + ' بوليصة رقم ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + (pOperationHeader.NumberOfPackages == 0 ? pOperationHeader.PackageTypes : pOperationHeader.NumberOfPackages) + '<b style="font-size:16px;">' + ' عدد الطرود ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + (pOperationHeader.VesselName == "0" ? "" : pOperationHeader.VesselName) + ' اسم الباخرة ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + ' الخط الملاحي ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm">' + '<b style="font-size:15px;">' + ' وتفضلوا بقبول فائق الاحترام  ' + '</b></div>';

        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
//kk-----------------------------------------------------------------function DocsOut_Print_DismissalPermission(data, pDocumentTypeID, pOption) ---------------------
function DocsOut_Print_DismissalPermission(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    var pMainRoute = JSON.parse(data[2]);
    var pMainRouteMaster = data[3] == null ? 0 : JSON.parse(data[3]);
    var pWarehouseLocation = pMainRoute.WareHouseLocation == 0 ? (pMainRouteMaster.WareHouseLocation == 0 || pMainRouteMaster.WareHouseLocation == undefined ? "" : pMainRouteMaster.WareHouseLocation) : pMainRoute.WareHouseLocation
    var pOpenDate = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.OpenDate));

    var POLName = pOperationHeader.POLName
    var PODName = pOperationHeader.PODName
    var GrossWeightSum = pOperationHeader.GrossWeightSum
    var VesselName = pOperationHeader.VesselName
    var MasterBL = pOperationHeader.MasterBL
    var POLName = pOperationHeader.POLName
    var BLDate = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.BLDate));
    var ActualArrival = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival));

    if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        //ReportHTML += "<style> body { background-image: url('/Content/Images/DangerShippingDecBackground.jpg');background-repeat: no-repeat;}</style>";
        //ReportHTML += '         <body style="background-color:white; background-image: url(/Content/Images/DangerShippingDecBackground.jpg);background-repeat: no-repeat;">';

        //ReportHTML += '             <div style="position:absolute;left:0px;top:0px;">';
        //ReportHTML += '             <img src="/Content/Images/DangerShippingDecBackground.jpg" alt="logo" width=612px; height=792px;></div>';

        ReportHTML += '         <body style="background-color:white;>';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';

        ReportHTML += '                     <div class="col-xs-12 text-center text-ul"><h2><b>' + ' Dismissal Permission ' + '</b></h2></div>';
        ReportHTML += '                         <div class="row col-xs-12 container">';
        ReportHTML += '                         <div class="col-xs-9">';
        ReportHTML += '                         <table id="tblDISMISSALPERMISSION" class="table table-striped b-t b-light text-sm  table-bordered" style="margin-left:100px;">';  //table-hover
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Date ' + '</th>';
        ReportHTML += '                                         <td>' + getTodaysDateInddMMyyyyFormat() + '</td>';
        ReportHTML += '                                     </tr>';
        if (pDefaults.UnEditableCompanyName == "TEU") {
            ReportHTML += '                                     <tr class="" style="font-size:14px;">';
            ReportHTML += '                                         <th>' + ' Permission No. ' + '</th>';
            ReportHTML += '                                         <td>' + pOperationHeader.DismissalPermissionSerial + '</td>';
            ReportHTML += '                                     </tr>';
        }
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        //ReportHTML += '                                         <td>' + (pOperationHeader.ClientName == 0 ? '' : pOperationHeader.ClientName) + '</td>';
        ReportHTML += '                                         <th>' + ' Client ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Bill No  ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Vessel ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.VesselName == 0 ? '' : pOperationHeader.VesselName) + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Arrival Date ' + '</th>';
        ReportHTML += '                                         <td>' + (ActualArrival == "01/01/1900" || ActualArrival == "1/1/1900" ? "" : ActualArrival) + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        //(pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.ContainerTypes)
        ReportHTML += '                                         <th>' + ' Quantity ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + ' x ' + (pOperationHeader.PackageTypeName == 0 ? "" : pOperationHeader.PackageTypeName) + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Weight ' + '</th>';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' KGS' + '</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <th>' + ' Volume ' + '</th>';
        ReportHTML += '                                         <td>' + (pOperationHeader.VolumeSum == 0 ? "" : pOperationHeader.VolumeSum) + ' CBM</td>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table></div>';
        ReportHTML += '                         <div class="col-xs-3"><label hidden></label></div></div>';
        //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-left"  style="margin-left:100px;"><b style="margin-right:30px;"> ' + pWarehouseLocation + ' <span class="float-right m-r-lg"> : Sir </span></b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-left"  style="margin-left:100px;"><b style="margin-right:30px;">We would like to inform you that the storage services are paid by the client</b></div>';
        //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-center"  style="margin-left:100px;"><b style="margin-right:30px;">ويأذن له بالصرف حتي تاريخ</b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-center"  style="margin-left:100px;"><b style="margin-right:30px;">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ReleaseDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ReleaseDate)) : "") + '</b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-left"  style="margin-left:100px;"><b style="margin-right:30px;">Signature </b></div>';
        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF if (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA") {
    else { //other companies
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        //ReportHTML += "<style> body { background-image: url('/Content/Images/DangerShippingDecBackground.jpg');background-repeat: no-repeat;}</style>";
        //ReportHTML += '         <body style="background-color:white; background-image: url(/Content/Images/DangerShippingDecBackground.jpg);background-repeat: no-repeat;">';

        //ReportHTML += '             <div style="position:absolute;left:0px;top:0px;">';
        //ReportHTML += '             <img src="/Content/Images/DangerShippingDecBackground.jpg" alt="logo" width=612px; height=792px;></div>';

        ReportHTML += '         <body style="background-color:white;>';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked"))
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';

        ReportHTML += '                     <div class="col-xs-12 text-center text-ul"><h2><b>' + ' اذن صرف ' + '</b></h2></div>';
        ReportHTML += '                         <div class="row col-xs-12 container">';
        ReportHTML += '                         <div class="col-xs-9">';
        ReportHTML += '                         <table id="tblDISMISSALPERMISSION" class="table table-striped b-t b-light text-sm  table-bordered" style="margin-left:100px;">';  //table-hover
        ReportHTML += '                             <tbody>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + getTodaysDateInddMMyyyyFormat() + '</td>';
        ReportHTML += '                                         <th>' + ' التاريخ ' + '</th>';
        ReportHTML += '                                     </tr>';
        if (pDefaults.UnEditableCompanyName != "TEU") {
            ReportHTML += '                                     <tr class="" style="font-size:14px;">';
            ReportHTML += '                                         <td>' + pOperationHeader.DismissalPermissionSerial + '</td>';
            ReportHTML += '                                         <th>' + ' اذن صرف رقم ' + '</th>';
            ReportHTML += '                                     </tr>';
        }
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        //ReportHTML += '                                         <td>' + (pOperationHeader.ClientName == 0 ? '' : pOperationHeader.ClientName) + '</td>';
        ReportHTML += '                                         <td>' + (pOperationHeader.ConsigneeName == 0 ? "" : pOperationHeader.ConsigneeName) + '</td>';
        ReportHTML += '                                         <th>' + ' اسم صاحب الشأن ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) + '</td>';
        ReportHTML += '                                         <th>' + ' رقم البوليصة  ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.VesselName == 0 ? '' : pOperationHeader.VesselName) + '</td>';
        ReportHTML += '                                         <th>' + ' اسم الباخرة ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + (ActualArrival == "01/01/1900" || ActualArrival == "1/1/1900" ? "" : ActualArrival) + '</td>';
        ReportHTML += '                                         <th>' + ' تاريخ الرحلة ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        //(pOperationHeader.ContainerTypes == 0 ? (pOperationHeader.PackageTypesOnContainersTotals == 0 ? (pOperationHeader.PackageTypes == 0 ? "" : pOperationHeader.PackageTypes) : pOperationHeader.PackageTypesOnContainersTotals) : pOperationHeader.ContainerTypes)
        ReportHTML += '                                         <td>' + (pOperationHeader.NumberOfPackages == 0 ? "" : pOperationHeader.NumberOfPackages) + ' x ' + (pOperationHeader.PackageTypeName == 0 ? "" : pOperationHeader.PackageTypeName) + '</td>';
        ReportHTML += '                                         <th>' + ' العدد ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + pOperationHeader.GrossWeightSum.toString() + ' KGS' + '</td>';
        ReportHTML += '                                         <th>' + ' الوزن ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                                     <tr class="" style="font-size:14px;">';
        ReportHTML += '                                         <td>' + (pOperationHeader.VolumeSum == 0 ? "" : pOperationHeader.VolumeSum) + ' CBM</td>';
        ReportHTML += '                                         <th>' + ' الحجم ' + '</th>';
        ReportHTML += '                                     </tr>';
        ReportHTML += '                             </tbody>';
        ReportHTML += '                         </table></div>';
        ReportHTML += '                         <div class="col-xs-3"><label hidden></label></div></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-right"  style="margin-left:100px;"><b style="margin-right:30px;"> ' + pWarehouseLocation + ' <span class="float-right m-r-lg"> : السادة </span></b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-right"  style="margin-left:100px;"><b style="margin-right:30px;">نحيط على سيادتكم بانه تم تسديدىالخدمات التخزينية من قبل العميل</b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-center"  style="margin-left:100px;"><b style="margin-right:30px;">ويأذن له بالصرف حتي تاريخ</b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-center"  style="margin-left:100px;"><b style="margin-right:30px;">' + (Date.prototype.compareDates("01/01/1900", GetDateWithFormatMDY(pOperationHeader.ReleaseDate)) > 0 ? ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ReleaseDate)) : "") + '</b></div>';
        ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-right"  style="margin-left:100px;"><b style="margin-right:30px;">التوقيع </b></div>';
        ReportHTML += '         </body>';
        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';
        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //EOF else { //other companies
}
//kk-----------------------------------------------------------------function DocsOut_Print_ConsolidationLetter(data, pDocumentTypeID, pOption)------------------------------
function DocsOut_Print_ConsolidationLetter(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    var POLName = pOperationHeader.POLName
    var PODName = pOperationHeader.PODName
    var GrossWeightSum = pOperationHeader.GrossWeightSum
    var VesselName = pOperationHeader.VesselName
    var MasterBL = pOperationHeader.MasterBL
    var POLName = pOperationHeader.POLName
    var BLDate = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.BLDate));
    var ActualArrival = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival));

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
        ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h2><b>' + ' Consolidation Letter ' + '</b></h2></div>';
    }
    else //header not printed so leave place for header on the original company paper
        ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h2><b>' + ' Consolidation Letter ' + '</b></h2></div>';

    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-md"><b>Alexandria in: ' + getTodaysDateInddMMyyyyFormat() + ' </b></div>';

    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-md"><b>Messer /  ' + (pOperationHeader.LineName == 0 ? "" : pOperationHeader.LineName) + ' </b></div></br>';

    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-md m-r-md" style="font-size:18px;">Regarding B/L no.  ' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '';

    ReportHTML += '   ,Container no. ' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + ' ,POL:' + (POLName == 0 ? "" : POLName) + ' ,VSL:' + (VesselName == 0 ? "" : VesselName) + ' ,please treat Container as consilidated Cargo to be received at LCL Yard. ';
    ReportHTML += '   </div> ';

    ReportHTML += '             <div class="row col-xs-12 m-t-md m-r-md text-right"><b style="margin-right:30px; font-size:18px;">Thanks and best Regards </b></div>';

    ReportHTML += '         </body>';

    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }
}
//kk------------------------------------------function DocsOut_Print_ShippingOrder(data, pDocumentTypeID, pOption) {----------------------------------------------
function DocsOut_Print_ShippingOrder(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    var POLName = pOperationHeader.POLName
    var PODName = pOperationHeader.PODName
    var GrossWeightSum = pOperationHeader.GrossWeightSum
    var VesselName = pOperationHeader.VesselName
    var MasterBL = pOperationHeader.MasterBL
    var POLName = pOperationHeader.POLName
    var BLDate = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.BLDate));
    var ActualArrival = ConvertDateFormat(GetDateWithFormatMDY(pOperationHeader.ActualArrival));

    /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
    //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
    ReportHTML += '<html>';
    ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
    ReportHTML += '         <body style="background-color:white;">';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
        ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
        ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h2><b>' + 'Shipping Order ' + '</b></h2></div>';
    }
    else //header not printed so leave place for header on the original company paper
        ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h2><b>' + ' Shipping Order ' + '</b></h2></div>';

    ReportHTML += '                         <div class="row col-xs-12">';
    ReportHTML += '                         <div class="col-xs-9">';
    ReportHTML += '                         <table id="tblShippingOrder" class="table table-striped b-t b-light text-sm  table-bordered" style="margin-left:100px;">';  //table-hover

    ReportHTML += '                             <tbody>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <th>' + ' Booking Number: ' + '</th>';
    ReportHTML += '                                         <td>' + (pOperationHeader.HouseNumber == 0 ? "" : pOperationHeader.HouseNumber) + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <th>' + 'Receive on board: ' + '</th>';
    ReportHTML += '                                         <td>' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <th>' + ' Shipper: ' + '</th>';
    ReportHTML += '                                         <td>' + (pOperationHeader.ShipperName == 0 ? '' : pOperationHeader.ShipperName) + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <th>' + ' POL:  ' + '</th>';
    ReportHTML += '                                         <td>' + (pOperationHeader.POLName == 0 ? "" : pOperationHeader.POLName) + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <th>' + ' POD: ' + '</th>';
    ReportHTML += '                                         <td>' + (pOperationHeader.PODName == 0 ? '' : pOperationHeader.PODName) + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <th>' + ' Final Destination: ' + '</th>';
    ReportHTML += '                                         <td>' + (pOperationHeader.DeliveryAddress == 0 ? "" : pOperationHeader.DeliveryAddress) /*$("#txtDeliveryAddress").val().trim().toUpperCase()*/ + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table></div>';
    ReportHTML += '                         <div class="col-xs-3"><label hidden></label></div></div>';


    ReportHTML += '                         <div class="row col-xs-12">';
    ReportHTML += '                         <div class="col-xs-9">';
    ReportHTML += '                         <table id="tblShippingOrderMarks" class="table table-striped b-t b-light text-sm  table-bordered" style="margin-left:100px;">';  //table-hover

    ReportHTML += '                             <thead>';
    ReportHTML += '                                         <th>' + ' Marks & Numbers ' + '</th>';
    ReportHTML += '                                         <th>' + ' Description of Goods ' + '</th>';
    ReportHTML += '                                         <th>' + ' Gross & Net weight ' + '</th>';
    ReportHTML += '                             </thead>';
    var Gross_Net_Weight = 'TOTAL G.W: ' + (pOperationHeader.GrossWeightSum + ' KGM') + '</br> TOTAL N.W: ' + pOperationHeader.NetWeightSum + ' KGM' + ' </br>';
    ReportHTML += '                             <tbody>';
    ReportHTML += '                                     <tr class="" style="font-size:14px;">';
    ReportHTML += '                                         <td>' + (pOperationHeader.MarksAndNumbers == "0" ? "" : pOperationHeader.MarksAndNumbers) + '</td>';
    ReportHTML += '                                         <td>' + (pOperationHeader.DescriptionOfGoods == "0" ? "" : pOperationHeader.DescriptionOfGoods) + '</td>';
    ReportHTML += '                                         <td>' + Gross_Net_Weight + '</td>';
    ReportHTML += '                                     </tr>';
    ReportHTML += '                             </tbody>';
    ReportHTML += '                         </table></div>';
    ReportHTML += '                         <div class="col-xs-3"><label hidden></label></div></div>';

    ReportHTML += '       <div class="row col-xs-12 m-t-md m-l-lg">';

    ReportHTML += '             <div class="row ' + (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA" ? 'col-xs-12' : 'col-xs-6') + ' m-t-md m-l-n">';
    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-n">Subject to all clauses & Conditions of Bill of Lading. </div>';
    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-n">N.B- The receipt must not be delivered unless the goods are actually on board and number of packages are written in letters. </div>';
    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-n">Important Note: Shippers of the herein mentioned goods are warned that any remarks concerning appearing on the mat’s receipt the conditions of the cargo will invariably be reproduced on the respective BL. </div>';
    ReportHTML += '             </div>';

    ReportHTML += '             <div class="row col-xs-6 m-t-md m-l-n ' + (pDefaults.UnEditableCompanyName == "SET" || pDefaults.UnEditableCompanyName == "PLA" ? 'hide' : '') + ' ">';
    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-n text-right">خاضع لجميع شروط بوليصة الشحن.  </div>';
    ReportHTML += '             <div class="row col-xs-12 m-t-md m-l-n text-right">  ملحوظة: لا يجب تسليم الايصال الا اذا كانت البضائع فعلا علي الباخرة وعدد الطرود بالحروف </div>';
    ReportHTML += '             </br><div class="row col-xs-12 m-t-md m-l-n text-right">ملحوظه هامة: نخطر شاحني البضائع المبينة في اذن الشحن هذا بان ايه </div>';
    ReportHTML += '             <div class="row col-xs-12 m-l-n text-right">  ملاحظة واردة في ايصال كبير ضباط الباخرة عن حالة الشحنة تدرج فى  </div>';
    ReportHTML += '             <div class="row col-xs-12 m-l-n text-right">بوليصة الشحن الخاصة بها بدون تغيير ولا يقبل ضمان عوضا عنها  </div>';

    ReportHTML += '             </div>';
    ReportHTML += '      </div>';

    ReportHTML += '             <div class="row col-xs-12 m-l-n text-right" style="font-size:23px;"><u>(برجاء الاتصال بالمندوب قبل دخول الشحنة ب 24 ساعة ( حتى الساعة 2 مساءا</u></div>';
    if (pDefaults.UnEditableCompanyName == "PLA") {
        ReportHTML += '             <div class="row col-xs-12 m-l-n text-right" style="font-size:23px;"><u>استاذ احمد لطفي    01221216088</u></div>';
    }
    //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-right"  style="margin-left:100px;"><b style="margin-right:30px;">السادة  شركة المستودعات المصرية العامة </b></div>';

    //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-right"  style="margin-left:100px;"><b style="margin-right:30px;">نحيط على سيادتكم بانه تم تسديد بالخدمات التخزينية من قبل العميل</b></div>';

    //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-center"  style="margin-left:100px;"><b style="margin-right:30px;">ويأذن له بالصرف حتي تاريخ</b></div>';

    //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-center"  style="margin-left:100px;"><b style="margin-right:30px;">' + getTodaysDateInddMMyyyyFormat() + '</b></div>';

    //ReportHTML += '             <div class="row col-xs-9 m-t-md m-l-n text-right"  style="margin-left:100px;"><b style="margin-right:30px;">التوقيع </b></div>';

    //getTodaysDateInddMMyyyyFormat()

    ReportHTML += '         </body>';

    ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
        ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
    if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
        ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
    ReportHTML += '     </footer>';

    ReportHTML += '</html>';
    if (pOption == "Print" || pOption == undefined || pOption == null) {
        if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
            var mywindow = window.open('', '_blank');
            mywindow.document.write(ReportHTML);
            mywindow.document.close();
        }
    }
    else if (pOption == "Email") {
        DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
    }

}
/*******************************Endorsements**************************************/
function DocsOut_Print_HBLEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    if (1 == 1) { //other companies
        debugger;
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + pDefaults.CompanyLocalName + '<span style="float:right;">' + ' : نقر نحن شركة    ' + '</span>' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' بأن البوالص الفرعيه المقدمة علي ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '  : بوليصة رقم     ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '  :  الباخرة       ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' والمعتمدة بخاتم توكيلنا ( وكيل الشحن ) هي نسخ أصلية للبوالص الفرعية وعلي مسؤليتنا ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   ,,, وهذا إقرار منا بذلك  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-left m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' المدير المسؤول' + '</b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_Print_ManifestEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    if (1 == 1) { //other companies
        debugger;
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<h4><b>' + getTodaysDateInddMMyyyyFormat() + ' : الاسكندرية في ' + '</b></h4></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '  : بوليصة رقم     ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '  :  الباخرة       ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' السادة المنافستو المركزي ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '   ,,, تحية طيبة وبعد  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '   يرجي التكرم بالموافقة علي تجزئة البوليصه عاليه الي اصحاب الشأن المستفيدين الوارد اسمائهم في المنافستو التفصيلي المرفق و ذلك حسب منشور الاجرءات الخاص بنا  ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;"><u>' + '   مرفقات  ' + '</u></b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm">' + '<b style="font-size:16px;">' + '   منافستو تفصيلي معتمد ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm">' + '<b style="font-size:16px;">' + '   بوليصة كلية و بوليصة فرعية ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   ,,, ولكم وافر الاحترام  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-left m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' مقدمه  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-left m-b-sm m-t-md">' + '<b style="font-size:16px;">' + pDefaults.CompanyLocalName + '</b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_Print_StoreEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    if (1 == 1) { //other companies
        debugger;
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<h4><b>' + getTodaysDateInddMMyyyyFormat() + ' : الاسكندرية في ' + '</b></h4></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' السادة المنافستو المركزي ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '   ,,, تحية طيبة وبعد  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '  برجاء التكرم بالموافقة علي نقل مشمول البوليصة رقم     ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.ContainerNumbers == 0 ? "" : pOperationHeader.ContainerNumbers) + '    حاوية رقم       ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '  من الاسكندرية الي الايداع   ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   ,,,  وتفضلوا بقبول فائق الاحترام والتقدير   ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-left m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' مقدمه إلي سيادتكم   ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-left m-b-sm m-t-md">' + '<b style="font-size:16px;">' + pDefaults.CompanyLocalName + '</b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_Print_WarehouseEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    if (1 == 1) { //other companies
        debugger;
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<h4><b>' + getTodaysDateInddMMyyyyFormat() + ' : الاسكندرية في ' + '</b></h4></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.MasterBL == 0 ? "" : pOperationHeader.MasterBL) + '  : بوليصة رقم     ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '  :  الباخرة       ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pDefaults.CompanyLocalName == 0 ? "" : pDefaults.CompanyLocalName) + '<span style="float:right;">' + '  :  باسم          ' + '</span>' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' السادة شركة المستودعات المصرية ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '   ,,, تحية طيبة وبعد  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.ContainerTypes == 0 ? "" : pOperationHeader.ContainerTypes) + '    يرجي التكرم بتحصيل مصاريف تفريغ عدد   ' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '   &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;      الي مخزن ' + '<span style="float:right;">' + ' &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; وذلك من ساحة ' + '</span>' + '</b></div>';

        ReportHTML += '                         <div class="col-xs-12 text-center m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   ,,, ولكم التحية   ' + '</b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_Print_ExplosivesEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    if (1 == 1) { //other companies
        debugger;
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + pDefaults.CompanyLocalName + '<span style="float:right;">' + ' : نقر نحن شركة    ' + '</span>' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + ' : بأن البضائع الواردة بنا لا تحتوي علي اي من  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '  ( مفرقعات – بارود – اسلحة – ذخيرة – مواد خطرة )  ' + '</b></div><br><br>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' وأننا سوف نقوم بإخطار فوج تشهيلات البحر الأبيض المتوسط فى حال وجود أي من الأشياء المذكورة أعلاه وذلك حفاظا علي الأمن العام  ' + '</b></div><br><br>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   ,,, وهذا إقرار منا بذلك  ' + '</b></div><br><br>';

        ReportHTML += '                         <div class="col-xs-4 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   مقدمه  ' + '</b></div>'
        ReportHTML += '                         <div class="col-xs-4 text-right m-b-sm" style="clear:both;">' + '<b style="font-size:16px;">' + (pDefaults.CompanyLocalName == 0 ? "" : pDefaults.CompanyLocalName) + '</b></div>'
        ReportHTML += '                         <div class="col-xs-4 text-right m-b-sm" style="clear:both;">' + '<b style="font-size:16px;">' + '   الاسم  ' + '</b></div>'
        ReportHTML += '                         <div class="col-xs-4 text-right m-b-sm" style="clear:both;">' + '<b style="font-size:16px;">' + '   التوقيع  ' + '</b></div>'
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_Print_NetworkEndorsement(data, pDocumentTypeID, pOption, IsLastPage, IsFirstPage) {
    debugger;
    var pOperationContainersAndPackages = JSON.parse(data[0]);
    var pOperationHeader = JSON.parse(data[1]);
    if (1 == 1) { //other companies
        debugger;
        /*var ReportHTML = '';*/ReportHTML = ((IsLastPage == undefined || IsFirstPage == true) ? ('') : (ReportHTML + ('<div class="break"></div>')));
        //<div style="width:500px;height:100px;border:1px solid #000;">This is a rectangle!</div>
        ReportHTML += '<html>';
        ReportHTML += '     <head><title>' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text() + '</title><link rel="stylesheet" href="/Content/CSS/app.v2.css" type="text/css" /></head>';
        ReportHTML += '         <body style="background-color:white;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowHeader input[type=checkbox]").prop("checked")) {
            ReportHTML += '             <div class="col-xs-12 text-center"><img src="/Content/Images/CompanyHeader.jpg" alt="logo"/></div> </br>';
            ReportHTML += '          </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul m-t-n-lg"><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';
        }
        else //header not printed so leave place for header on the original company paper
            ReportHTML += '           </br> </br> </br> </br>   <div class="col-xs-12 text-center text-ul"></br></br><h3><b><u>' + ' إقرار ' + '</u></b></h3></div>';

        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + pDefaults.CompanyLocalName + '<span style="float:right;">' + ' / نقر نحن توكيل    ' + '</span>' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + '   بأن البيانات الخاصة بالبوالص المقدمة ضمن قائمة الشحن الورقية والتى تخص  ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-lg">' + '<b style="font-size:16px;">' + (pOperationHeader.VesselName == 0 ? "" : pOperationHeader.VesselName) + '  :  الباخرة       ' + '</b></div>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' والمقدمة منا مطابقة لما هو مدرج بالشبكة الالكترونية الخاصة بالجمارك وفى حالة وجود اى اختلاف فى البيانات المدرجة عن النسخة الورقية نتحمل المسئولية كاملة دون ادنى مسئولية على الجمارك ' + '</b></div><br>';
        ReportHTML += '                         <div class="col-xs-12 text-right m-b-sm m-t-md">' + '<b style="font-size:16px;">' + '   ,,, وهذا إقرار منا بذلك  ' + '</b></div><br>';

        ReportHTML += '                         <div class="col-xs-12 text-left m-b-sm m-t-md">' + '<b style="font-size:16px;">' + ' المدير المسؤول' + '</b></div>';
        ReportHTML += '         </body>';

        ReportHTML += '     <footer class="footer col-xs-12" style="width:100%; position:fixed; bottom:0;">';

        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.IsPrintISOCode input[type=checkbox]").prop("checked"))
            ReportHTML += '     <div class="row m-l">' + $("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ISOCode").text() + '</div>';
        if ($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.ShowFooter input[type=checkbox]").prop("checked"))
            ReportHTML += '         <div class="row text-center"><img src="/Content/Images/CompanyFooter.jpg" alt="footer"/></div>';
        ReportHTML += '     </footer>';

        ReportHTML += '</html>';
        if (pOption == "Print" || pOption == undefined || pOption == null) {
            if (((IsLastPage != undefined) && IsLastPage) || (IsLastPage == undefined)) {
                var mywindow = window.open('', '_blank');
                mywindow.document.write(ReportHTML);
                mywindow.document.close();
            }
        }
        else if (pOption == "Email") {
            DocsOut_SendEmail($("#tblDocsOut tr[id=" + pDocumentTypeID + "] td.TableOrViewName").text(), ReportHTML);
        }
    } //other companies
}
function DocsOut_PaymentRequests_CalculateSubtotals(pPayablesSubTotals) {
    debugger;
    var htmlLblPayablesSubTotals = "";
    for (var i = 0; i < pPayablesSubTotals.length; i++)
        htmlLblPayablesSubTotals += pPayablesSubTotals[i].CostAmountSubTotal.toFixed(2) + " " + pPayablesSubTotals[i].CurrencyCode + ",";
    htmlLblPayablesSubTotals = "<u>Currencies Totals:</u><br/>" + htmlLblPayablesSubTotals.slice(0, -1);
    return htmlLblPayablesSubTotals;
}
function DocsOut_SendEmail(pReportTitle, pReportHTML) {
    debugger;
    var pEmail_To = $("#slSelectListGeneral option:selected").attr("ClientEmailNotContact") == "" || $("#slSelectListGeneral option:selected").attr("ClientEmailNotContact") == "0"
        ? $("#slSelectListGeneral option:selected").attr("Email")
        : $("#slSelectListGeneral option:selected").attr("ClientEmailNotContact");
    if (pEmail_To == "" || pEmail_To == "0") {
        swal("Sorry", "Please, check the receiver email.");
        FadePageCover(false);
    }
    else
        //SendPDFEmail_General(pEmail_Subject, pEmail_To, pReportHTML, pReportTitle, null);
        SendPDFEmail_General("Operation " + $("#hOperationCode").val(), pEmail_To, pReportHTML, pReportTitle, null);

    //window.onbeforeunload = null;
    //var strEmail = $("#slDocsOutOperations option:selected").attr("ClientEmail");
    //var strSubject = $("#tblDocsOut tr[id=" + pID + "] td.TableOrViewName").text();
    //window.location = 'mailto:' + strEmail + '?subject=' + strSubject + '&body=' + strSubject;// + ReportHTML;
    //var afterFourSeconds = function () {
    //    window.onbeforeunload = confirmExit;
    //}
    //window.setTimeout(afterFourSeconds, 4000);
    ////if (callback != null && callback != undefined)
    ////    callback();
    //////URL 
    ////url = new File("test.html").toURI().toURL();
    //////WebClient 
    ////webClient = new WebClient(); 
    //////HtmlPage 
    ////page = webClient.getPage(url);
    //////OutputStream 
    //////os = null;
    ////try {
    ////    debugger;
    ////    os = new FileOutputStream("test.pdf");
    ////    //ITextRenderer 
    ////    renderer = new ITextRenderer();
    ////    renderer.setDocument(page,url.toString());
    ////    renderer.layout();
    ////    renderer.createPDF(os);
    ////} finally {
    ////    debugger;
    ////    if(os != null) os.close();
    ////}
}

function eFBL_Generate() {
    debugger;
    if (1 == 2)
        swal("Sorry", "Please, check.");
    else {
        swal({
            title: "Are you sure?",
            text: "The eFBL will be sent to the FIATA.",
            type: "",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "Yes, Apply",
            closeOnConfirm: false
        },
            //callback function in case of confirm delete
            function () {
                FadePageCover(true);
                var pParametersWithValues = {
                    pID_eFBL: $("#hOperationID").val()
                };
                CallGETFunctionWithParameters("/api/eFBL/eFBL_Generate", pParametersWithValues
                    //CallGETFunctionWithParameters("/api/Defaults/eFBL_Generate", pParametersWithValues
                    , function (pData) {
                        debugger;
                        let _ReturnedMessage = pData[0];
                        let pdfInBytes = pData[1];
                        let pFileName = pData[2];

                        if (_ReturnedMessage == "") {
                            //let arr = base64ToArrayBuffer(pdfInBytes);
                            //saveByteArray(pFileName, arr);
                            swal("Success", "Saved, successfully");
                            pOperationHeader_Global.eFBLID = pFileName;
                            $("#tblDocsOut tbody tr[ID=2] td.TableOrViewName").text("eFBL-" + pFileName.split(".")[0]);
                            $("#a2").attr("onclick", "OpenUploadedFile_Global(" + `"/api` + String.raw`\\eFBL\\` + pOperationHeader_Global.ID + String.raw`\\` + pFileName.split(".")[0] + `.pdf"` + ");");
                            $("#a2_SendeFBLEmail").attr("onclick", "eFBL_SendMail(" + pOperationHeader_Global.ID + `,"` + pOperationHeader_Global.eFBLID + `"` + ");");
                            $(".classEnableForeFBL").removeClass("disabled");
                        }
                        else
                            swal("Sorry", _ReturnedMessage);
                        FadePageCover(false);
                    }
                    , null);
            }); //ConfirmationMessage
    }
}
function eFBL_SendMail(peFBLID, pFileName) {
    debugger;
    swal({
        title: "Are you sure?",
        text: "eFBL will be sent to client.",
        type: "",
        showCancelButton: true,
        confirmButtonColor: "#DD6B55",
        confirmButtonText: "Yes, Apply",
        closeOnConfirm: false
    },
        function () {
            if (pOperationHeader_Global.ClientEmail == "" || pOperationHeader_Global.ClientEmail == "0")
                swal("Sorry", "Please, add client email");
            else if (pFileName == "0.pdf")
                swal("Sorry", "Please, check eFBL is genereted.");
            else {
                FadePageCover(true)
                var pParametersWithValues = {
                    pFileName: pFileName
                    , pMapPath: "eFBL\\" + peFBLID
                    , pEmail_Subject: "eFBL-" + pFileName
                    , pEmail_To: pOperationHeader_Global.ClientEmail
                    , pEmail_Body: "Electronic B/L"
                };
                CallPOSTFunctionWithParameters("/api/Defaults/SendEmailWithAttachment", pParametersWithValues
                    , function (pData) {
                        let pReturnedMessage = pData[0];
                        if (pReturnedMessage == "")
                            swal("Success", "Sent successfully");
                        else
                            swal("Sorry", pReturnedMessage);
                        FadePageCover(false);
                    }
                    , null);
            }
        });
}

function confirmExit() {
    return "";
}


