using System;
using System.Text;
using System.Data;
using System.Collections;
using System.Configuration;
using System.Data.SqlClient;
using System.Collections.Generic;

/*This class is autogenerated by Khedrawy Code gen v.3.1*/
namespace Forwarding.MvcApp.Models.MasterData.Locations.Generated
{
    [Serializable]
    public class CPKLM_Domestic_AWB
    {
        #region "variables"
        private Int32 mID;
        #endregion

        #region "Methods"
        public Int32 ID
        {
            get { return mID; }
            set { mID = value; }
        }
        #endregion
    }
    [Serializable]
    public partial class CVarLM_Domestic_AWB : CPKLM_Domestic_AWB
    {
        #region "variables"
        internal Boolean mIsChanges = false;
        internal String mAWBNumber;
        internal Int32 mShipperID;
        internal Int32 mConsigneeID;
        internal Decimal mActWgt;
        internal Decimal mDimWgt;
        internal Decimal mChgWgt;
        internal Decimal mPcs;
        internal Decimal mCODAmount;
        internal String mDescription;
        internal String mRemarks;
        internal DateTime mcreationDate;
        internal Int32 mCreatorUserID;
        internal String mConsigneeName;
        internal Int32 mConsigneeCityID;
        internal Int32 mConsigneeRegionID;
        internal String mConsigneePhone1;
        internal String mConsigneePhone2;
        internal String mConsigneeCompanyName;
        internal String mConsigneeSenderName;
        internal String mConsigneeAccountNo;
        internal String mConsigneeCity;
        internal String mConsigneeAddress;
        internal String mShipperName;
        internal Int32 mShipperCityID;
        internal Int32 mShipperRegionID;
        internal String mShipperPhone1;
        internal String mShipperPhone2;
        internal String mShipperCompanyName;
        internal String mShipperSenderName;
        internal String mShipperAccountNo;
        internal String mShipperCity;
        internal String mShipperAddress;
        internal Int32 mPaymentTypeID;
        internal Int32 mStoreID;
        internal String mPickupAddress;
        internal DateTime mEstimatedReceivedDate_Custody;
        internal DateTime mActualReceivedDate_Custody;
        internal DateTime mEstimatedArrivalDateToStore;
        internal DateTime mActualArrivalDateToStore;
        internal DateTime mEstimatedDeliveryDateFrom;
        internal DateTime mEstimatedDeliveryDateTo;
        internal DateTime mActualDeliveryDate;
        internal Int32 mTrackingStageID;
        internal Int32 mRunnerFromShipperID;
        internal Int32 mRunnerToConsigneeID;
        internal Boolean mIsClosed;
        internal Int32 mRateID;
        internal Int32 mPackageTypeID;
        internal Decimal mQuantity;
        internal Decimal mSellingAmount;
        internal String mRateDetails;
        internal Decimal mCommodityFees;
        #endregion

        #region "Methods"
        public String AWBNumber
        {
            get { return mAWBNumber; }
            set { mIsChanges = true; mAWBNumber = value; }
        }
        public Int32 ShipperID
        {
            get { return mShipperID; }
            set { mIsChanges = true; mShipperID = value; }
        }
        public Int32 ConsigneeID
        {
            get { return mConsigneeID; }
            set { mIsChanges = true; mConsigneeID = value; }
        }
        public Decimal ActWgt
        {
            get { return mActWgt; }
            set { mIsChanges = true; mActWgt = value; }
        }
        public Decimal DimWgt
        {
            get { return mDimWgt; }
            set { mIsChanges = true; mDimWgt = value; }
        }
        public Decimal ChgWgt
        {
            get { return mChgWgt; }
            set { mIsChanges = true; mChgWgt = value; }
        }
        public Decimal Pcs
        {
            get { return mPcs; }
            set { mIsChanges = true; mPcs = value; }
        }
        public Decimal CODAmount
        {
            get { return mCODAmount; }
            set { mIsChanges = true; mCODAmount = value; }
        }
        public String Description
        {
            get { return mDescription; }
            set { mIsChanges = true; mDescription = value; }
        }
        public String Remarks
        {
            get { return mRemarks; }
            set { mIsChanges = true; mRemarks = value; }
        }
        public DateTime creationDate
        {
            get { return mcreationDate; }
            set { mIsChanges = true; mcreationDate = value; }
        }
        public Int32 CreatorUserID
        {
            get { return mCreatorUserID; }
            set { mIsChanges = true; mCreatorUserID = value; }
        }
        public String ConsigneeName
        {
            get { return mConsigneeName; }
            set { mIsChanges = true; mConsigneeName = value; }
        }
        public Int32 ConsigneeCityID
        {
            get { return mConsigneeCityID; }
            set { mIsChanges = true; mConsigneeCityID = value; }
        }
        public Int32 ConsigneeRegionID
        {
            get { return mConsigneeRegionID; }
            set { mIsChanges = true; mConsigneeRegionID = value; }
        }
        public String ConsigneePhone1
        {
            get { return mConsigneePhone1; }
            set { mIsChanges = true; mConsigneePhone1 = value; }
        }
        public String ConsigneePhone2
        {
            get { return mConsigneePhone2; }
            set { mIsChanges = true; mConsigneePhone2 = value; }
        }
        public String ConsigneeCompanyName
        {
            get { return mConsigneeCompanyName; }
            set { mIsChanges = true; mConsigneeCompanyName = value; }
        }
        public String ConsigneeSenderName
        {
            get { return mConsigneeSenderName; }
            set { mIsChanges = true; mConsigneeSenderName = value; }
        }
        public String ConsigneeAccountNo
        {
            get { return mConsigneeAccountNo; }
            set { mIsChanges = true; mConsigneeAccountNo = value; }
        }
        public String ConsigneeCity
        {
            get { return mConsigneeCity; }
            set { mIsChanges = true; mConsigneeCity = value; }
        }
        public String ConsigneeAddress
        {
            get { return mConsigneeAddress; }
            set { mIsChanges = true; mConsigneeAddress = value; }
        }
        public String ShipperName
        {
            get { return mShipperName; }
            set { mIsChanges = true; mShipperName = value; }
        }
        public Int32 ShipperCityID
        {
            get { return mShipperCityID; }
            set { mIsChanges = true; mShipperCityID = value; }
        }
        public Int32 ShipperRegionID
        {
            get { return mShipperRegionID; }
            set { mIsChanges = true; mShipperRegionID = value; }
        }
        public String ShipperPhone1
        {
            get { return mShipperPhone1; }
            set { mIsChanges = true; mShipperPhone1 = value; }
        }
        public String ShipperPhone2
        {
            get { return mShipperPhone2; }
            set { mIsChanges = true; mShipperPhone2 = value; }
        }
        public String ShipperCompanyName
        {
            get { return mShipperCompanyName; }
            set { mIsChanges = true; mShipperCompanyName = value; }
        }
        public String ShipperSenderName
        {
            get { return mShipperSenderName; }
            set { mIsChanges = true; mShipperSenderName = value; }
        }
        public String ShipperAccountNo
        {
            get { return mShipperAccountNo; }
            set { mIsChanges = true; mShipperAccountNo = value; }
        }
        public String ShipperCity
        {
            get { return mShipperCity; }
            set { mIsChanges = true; mShipperCity = value; }
        }
        public String ShipperAddress
        {
            get { return mShipperAddress; }
            set { mIsChanges = true; mShipperAddress = value; }
        }
        public Int32 PaymentTypeID
        {
            get { return mPaymentTypeID; }
            set { mIsChanges = true; mPaymentTypeID = value; }
        }
        public Int32 StoreID
        {
            get { return mStoreID; }
            set { mIsChanges = true; mStoreID = value; }
        }
        public String PickupAddress
        {
            get { return mPickupAddress; }
            set { mIsChanges = true; mPickupAddress = value; }
        }
        public DateTime EstimatedReceivedDate_Custody
        {
            get { return mEstimatedReceivedDate_Custody; }
            set { mIsChanges = true; mEstimatedReceivedDate_Custody = value; }
        }
        public DateTime ActualReceivedDate_Custody
        {
            get { return mActualReceivedDate_Custody; }
            set { mIsChanges = true; mActualReceivedDate_Custody = value; }
        }
        public DateTime EstimatedArrivalDateToStore
        {
            get { return mEstimatedArrivalDateToStore; }
            set { mIsChanges = true; mEstimatedArrivalDateToStore = value; }
        }
        public DateTime ActualArrivalDateToStore
        {
            get { return mActualArrivalDateToStore; }
            set { mIsChanges = true; mActualArrivalDateToStore = value; }
        }
        public DateTime EstimatedDeliveryDateFrom
        {
            get { return mEstimatedDeliveryDateFrom; }
            set { mIsChanges = true; mEstimatedDeliveryDateFrom = value; }
        }
        public DateTime EstimatedDeliveryDateTo
        {
            get { return mEstimatedDeliveryDateTo; }
            set { mIsChanges = true; mEstimatedDeliveryDateTo = value; }
        }
        public DateTime ActualDeliveryDate
        {
            get { return mActualDeliveryDate; }
            set { mIsChanges = true; mActualDeliveryDate = value; }
        }
        public Int32 TrackingStageID
        {
            get { return mTrackingStageID; }
            set { mIsChanges = true; mTrackingStageID = value; }
        }
        public Int32 RunnerFromShipperID
        {
            get { return mRunnerFromShipperID; }
            set { mIsChanges = true; mRunnerFromShipperID = value; }
        }
        public Int32 RunnerToConsigneeID
        {
            get { return mRunnerToConsigneeID; }
            set { mIsChanges = true; mRunnerToConsigneeID = value; }
        }
        public Boolean IsClosed
        {
            get { return mIsClosed; }
            set { mIsChanges = true; mIsClosed = value; }
        }
        public Int32 RateID
        {
            get { return mRateID; }
            set { mIsChanges = true; mRateID = value; }
        }
        public Int32 PackageTypeID
        {
            get { return mPackageTypeID; }
            set { mIsChanges = true; mPackageTypeID = value; }
        }
        public Decimal Quantity
        {
            get { return mQuantity; }
            set { mIsChanges = true; mQuantity = value; }
        }
        public Decimal SellingAmount
        {
            get { return mSellingAmount; }
            set { mIsChanges = true; mSellingAmount = value; }
        }
        public String RateDetails
        {
            get { return mRateDetails; }
            set { mIsChanges = true; mRateDetails = value; }
        }
        public Decimal CommodityFees
        {
            get { return mCommodityFees; }
            set { mIsChanges = true; mCommodityFees = value; }
        }
        #endregion

        #region Functions
        public Boolean GetIsChange()
        {
            return mIsChanges;
        }
        public void SetIsChange(Boolean IsChange)
        {
            mIsChanges = IsChange;
        }
        #endregion
    }

    public partial class CLM_Domestic_AWB
    {
        #region "variables"
        /*If "App.Config" isnot exist add it to your Application
		Add this code after <Configuration> tag
		-------------------------------------------------------
		<appsettings>
		<add key="ConnectionString" value="............"/>
		</appsettings>
		-------------------------------------------------------
		where ".........." is connection string to database server*/
        private SqlTransaction tr;
        public List<CVarLM_Domestic_AWB> lstCVarLM_Domestic_AWB = new List<CVarLM_Domestic_AWB>();
        public List<CPKLM_Domestic_AWB> lstDeletedCPKLM_Domestic_AWB = new List<CPKLM_Domestic_AWB>();
        #endregion

        #region "Select Methods"
        public Exception GetList(string WhereClause)
        {
            return DataFill(WhereClause, true);
        }
        public Exception GetListPaging(Int32 PageSize, Int32 PageNumber, string WhereClause, string OrderBy, out Int32 TotalRecords)
        {
            return DataFill(PageSize, PageNumber, WhereClause, OrderBy, out TotalRecords);
        }
        public Exception GetItem(Int32 ID)
        {
            return DataFill(Convert.ToString(ID), false);
        }
        private Exception DataFill(string Param, Boolean IsList)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarLM_Domestic_AWB.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;
                if (IsList == true)
                {
                    Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.VarChar));
                    Com.CommandText = "[dbo].GetListLM_Domestic_AWB";
                    Com.Parameters[0].Value = Param;
                }
                else
                {
                    Com.CommandText = "[dbo].GetItemLM_Domestic_AWB";
                    Com.Parameters.Add(new SqlParameter("@ID", SqlDbType.Int));
                    Com.Parameters[0].Value = Convert.ToInt32(Param);
                }
                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarLM_Domestic_AWB ObjCVarLM_Domestic_AWB = new CVarLM_Domestic_AWB();
                        ObjCVarLM_Domestic_AWB.ID = Convert.ToInt32(dr["ID"].ToString());
                        ObjCVarLM_Domestic_AWB.mAWBNumber = Convert.ToString(dr["AWBNumber"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperID = Convert.ToInt32(dr["ShipperID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeID = Convert.ToInt32(dr["ConsigneeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mActWgt = Convert.ToDecimal(dr["ActWgt"].ToString());
                        ObjCVarLM_Domestic_AWB.mDimWgt = Convert.ToDecimal(dr["DimWgt"].ToString());
                        ObjCVarLM_Domestic_AWB.mChgWgt = Convert.ToDecimal(dr["ChgWgt"].ToString());
                        ObjCVarLM_Domestic_AWB.mPcs = Convert.ToDecimal(dr["Pcs"].ToString());
                        ObjCVarLM_Domestic_AWB.mCODAmount = Convert.ToDecimal(dr["CODAmount"].ToString());
                        ObjCVarLM_Domestic_AWB.mDescription = Convert.ToString(dr["Description"].ToString());
                        ObjCVarLM_Domestic_AWB.mRemarks = Convert.ToString(dr["Remarks"].ToString());
                        ObjCVarLM_Domestic_AWB.mcreationDate = Convert.ToDateTime(dr["creationDate"].ToString());
                        ObjCVarLM_Domestic_AWB.mCreatorUserID = Convert.ToInt32(dr["CreatorUserID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeName = Convert.ToString(dr["ConsigneeName"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeCityID = Convert.ToInt32(dr["ConsigneeCityID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeRegionID = Convert.ToInt32(dr["ConsigneeRegionID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneePhone1 = Convert.ToString(dr["ConsigneePhone1"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneePhone2 = Convert.ToString(dr["ConsigneePhone2"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeCompanyName = Convert.ToString(dr["ConsigneeCompanyName"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeSenderName = Convert.ToString(dr["ConsigneeSenderName"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeAccountNo = Convert.ToString(dr["ConsigneeAccountNo"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeCity = Convert.ToString(dr["ConsigneeCity"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeAddress = Convert.ToString(dr["ConsigneeAddress"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperName = Convert.ToString(dr["ShipperName"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperCityID = Convert.ToInt32(dr["ShipperCityID"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperRegionID = Convert.ToInt32(dr["ShipperRegionID"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperPhone1 = Convert.ToString(dr["ShipperPhone1"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperPhone2 = Convert.ToString(dr["ShipperPhone2"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperCompanyName = Convert.ToString(dr["ShipperCompanyName"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperSenderName = Convert.ToString(dr["ShipperSenderName"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperAccountNo = Convert.ToString(dr["ShipperAccountNo"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperCity = Convert.ToString(dr["ShipperCity"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperAddress = Convert.ToString(dr["ShipperAddress"].ToString());
                        ObjCVarLM_Domestic_AWB.mPaymentTypeID = Convert.ToInt32(dr["PaymentTypeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mStoreID = Convert.ToInt32(dr["StoreID"].ToString());
                        ObjCVarLM_Domestic_AWB.mPickupAddress = Convert.ToString(dr["PickupAddress"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedReceivedDate_Custody = Convert.ToDateTime(dr["EstimatedReceivedDate_Custody"].ToString());
                        ObjCVarLM_Domestic_AWB.mActualReceivedDate_Custody = Convert.ToDateTime(dr["ActualReceivedDate_Custody"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedArrivalDateToStore = Convert.ToDateTime(dr["EstimatedArrivalDateToStore"].ToString());
                        ObjCVarLM_Domestic_AWB.mActualArrivalDateToStore = Convert.ToDateTime(dr["ActualArrivalDateToStore"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedDeliveryDateFrom = Convert.ToDateTime(dr["EstimatedDeliveryDateFrom"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedDeliveryDateTo = Convert.ToDateTime(dr["EstimatedDeliveryDateTo"].ToString());
                        ObjCVarLM_Domestic_AWB.mActualDeliveryDate = Convert.ToDateTime(dr["ActualDeliveryDate"].ToString());
                        ObjCVarLM_Domestic_AWB.mTrackingStageID = Convert.ToInt32(dr["TrackingStageID"].ToString());
                        ObjCVarLM_Domestic_AWB.mRunnerFromShipperID = Convert.ToInt32(dr["RunnerFromShipperID"].ToString());
                        ObjCVarLM_Domestic_AWB.mRunnerToConsigneeID = Convert.ToInt32(dr["RunnerToConsigneeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mIsClosed = Convert.ToBoolean(dr["IsClosed"].ToString());
                        ObjCVarLM_Domestic_AWB.mRateID = Convert.ToInt32(dr["RateID"].ToString());
                        ObjCVarLM_Domestic_AWB.mPackageTypeID = Convert.ToInt32(dr["PackageTypeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mQuantity = Convert.ToDecimal(dr["Quantity"].ToString());
                        ObjCVarLM_Domestic_AWB.mSellingAmount = Convert.ToDecimal(dr["SellingAmount"].ToString());
                        ObjCVarLM_Domestic_AWB.mRateDetails = Convert.ToString(dr["RateDetails"].ToString());
                        ObjCVarLM_Domestic_AWB.mCommodityFees = Convert.ToDecimal(dr["CommodityFees"].ToString());
                        lstCVarLM_Domestic_AWB.Add(ObjCVarLM_Domestic_AWB);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }

        private Exception DataFill(Int32 PageSize, Int32 PageNumber, string WhereClause, string OrderBy, out Int32 TotRecs)
        {
            Exception Exp = null;
            TotRecs = 0;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarLM_Domestic_AWB.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;
                Com.Parameters.Add(new SqlParameter("@PageSize", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@PageNumber", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@OrderBy", SqlDbType.VarChar));
                Com.CommandText = "[dbo].GetListPagingLM_Domestic_AWB";
                Com.Parameters[0].Value = PageSize;
                Com.Parameters[1].Value = PageNumber;
                Com.Parameters[2].Value = WhereClause;
                Com.Parameters[3].Value = OrderBy;
                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarLM_Domestic_AWB ObjCVarLM_Domestic_AWB = new CVarLM_Domestic_AWB();
                        ObjCVarLM_Domestic_AWB.ID = Convert.ToInt32(dr["ID"].ToString());
                        ObjCVarLM_Domestic_AWB.mAWBNumber = Convert.ToString(dr["AWBNumber"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperID = Convert.ToInt32(dr["ShipperID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeID = Convert.ToInt32(dr["ConsigneeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mActWgt = Convert.ToDecimal(dr["ActWgt"].ToString());
                        ObjCVarLM_Domestic_AWB.mDimWgt = Convert.ToDecimal(dr["DimWgt"].ToString());
                        ObjCVarLM_Domestic_AWB.mChgWgt = Convert.ToDecimal(dr["ChgWgt"].ToString());
                        ObjCVarLM_Domestic_AWB.mPcs = Convert.ToDecimal(dr["Pcs"].ToString());
                        ObjCVarLM_Domestic_AWB.mCODAmount = Convert.ToDecimal(dr["CODAmount"].ToString());
                        ObjCVarLM_Domestic_AWB.mDescription = Convert.ToString(dr["Description"].ToString());
                        ObjCVarLM_Domestic_AWB.mRemarks = Convert.ToString(dr["Remarks"].ToString());
                        ObjCVarLM_Domestic_AWB.mcreationDate = Convert.ToDateTime(dr["creationDate"].ToString());
                        ObjCVarLM_Domestic_AWB.mCreatorUserID = Convert.ToInt32(dr["CreatorUserID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeName = Convert.ToString(dr["ConsigneeName"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeCityID = Convert.ToInt32(dr["ConsigneeCityID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeRegionID = Convert.ToInt32(dr["ConsigneeRegionID"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneePhone1 = Convert.ToString(dr["ConsigneePhone1"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneePhone2 = Convert.ToString(dr["ConsigneePhone2"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeCompanyName = Convert.ToString(dr["ConsigneeCompanyName"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeSenderName = Convert.ToString(dr["ConsigneeSenderName"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeAccountNo = Convert.ToString(dr["ConsigneeAccountNo"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeCity = Convert.ToString(dr["ConsigneeCity"].ToString());
                        ObjCVarLM_Domestic_AWB.mConsigneeAddress = Convert.ToString(dr["ConsigneeAddress"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperName = Convert.ToString(dr["ShipperName"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperCityID = Convert.ToInt32(dr["ShipperCityID"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperRegionID = Convert.ToInt32(dr["ShipperRegionID"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperPhone1 = Convert.ToString(dr["ShipperPhone1"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperPhone2 = Convert.ToString(dr["ShipperPhone2"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperCompanyName = Convert.ToString(dr["ShipperCompanyName"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperSenderName = Convert.ToString(dr["ShipperSenderName"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperAccountNo = Convert.ToString(dr["ShipperAccountNo"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperCity = Convert.ToString(dr["ShipperCity"].ToString());
                        ObjCVarLM_Domestic_AWB.mShipperAddress = Convert.ToString(dr["ShipperAddress"].ToString());
                        ObjCVarLM_Domestic_AWB.mPaymentTypeID = Convert.ToInt32(dr["PaymentTypeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mStoreID = Convert.ToInt32(dr["StoreID"].ToString());
                        ObjCVarLM_Domestic_AWB.mPickupAddress = Convert.ToString(dr["PickupAddress"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedReceivedDate_Custody = Convert.ToDateTime(dr["EstimatedReceivedDate_Custody"].ToString());
                        ObjCVarLM_Domestic_AWB.mActualReceivedDate_Custody = Convert.ToDateTime(dr["ActualReceivedDate_Custody"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedArrivalDateToStore = Convert.ToDateTime(dr["EstimatedArrivalDateToStore"].ToString());
                        ObjCVarLM_Domestic_AWB.mActualArrivalDateToStore = Convert.ToDateTime(dr["ActualArrivalDateToStore"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedDeliveryDateFrom = Convert.ToDateTime(dr["EstimatedDeliveryDateFrom"].ToString());
                        ObjCVarLM_Domestic_AWB.mEstimatedDeliveryDateTo = Convert.ToDateTime(dr["EstimatedDeliveryDateTo"].ToString());
                        ObjCVarLM_Domestic_AWB.mActualDeliveryDate = Convert.ToDateTime(dr["ActualDeliveryDate"].ToString());
                        ObjCVarLM_Domestic_AWB.mTrackingStageID = Convert.ToInt32(dr["TrackingStageID"].ToString());
                        ObjCVarLM_Domestic_AWB.mRunnerFromShipperID = Convert.ToInt32(dr["RunnerFromShipperID"].ToString());
                        ObjCVarLM_Domestic_AWB.mRunnerToConsigneeID = Convert.ToInt32(dr["RunnerToConsigneeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mIsClosed = Convert.ToBoolean(dr["IsClosed"].ToString());
                        ObjCVarLM_Domestic_AWB.mRateID = Convert.ToInt32(dr["RateID"].ToString());
                        ObjCVarLM_Domestic_AWB.mPackageTypeID = Convert.ToInt32(dr["PackageTypeID"].ToString());
                        ObjCVarLM_Domestic_AWB.mQuantity = Convert.ToDecimal(dr["Quantity"].ToString());
                        ObjCVarLM_Domestic_AWB.mSellingAmount = Convert.ToDecimal(dr["SellingAmount"].ToString());
                        ObjCVarLM_Domestic_AWB.mRateDetails = Convert.ToString(dr["RateDetails"].ToString());
                        ObjCVarLM_Domestic_AWB.mCommodityFees = Convert.ToDecimal(dr["CommodityFees"].ToString());
                        TotRecs = Convert.ToInt32(dr["TotalRecords"].ToString());
                        lstCVarLM_Domestic_AWB.Add(ObjCVarLM_Domestic_AWB);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }

        #endregion
        #region "Common Methods"
        private void BeginTrans(SqlCommand Com, SqlConnection Con)
        {

            tr = Con.BeginTransaction(IsolationLevel.Serializable);
            Com.CommandType = CommandType.StoredProcedure;
        }

        private void EndTrans(SqlCommand Com, SqlConnection Con)
        {

            Com.Transaction = tr;
            Com.Connection = Con;
            Com.ExecuteNonQuery();
            tr.Commit();
        }

        #endregion
        #region "Set List Method"
        private Exception SetList(string WhereClause, Boolean IsDelete)
        {

            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
            SqlCommand Com;
            try
            {
                Con.Open();
                Com = new SqlCommand();
                if (IsDelete == true)
                    Com.CommandText = "[dbo].DeleteListLM_Domestic_AWB";
                else
                    Com.CommandText = "[dbo].UpdateListLM_Domestic_AWB";
                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.VarChar));
                BeginTrans(Com, Con);
                Com.Parameters[0].Value = WhereClause;
                EndTrans(Com, Con);
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }

        #endregion
        #region "Delete Methods"
        public Exception DeleteItem(List<CPKLM_Domestic_AWB> DeleteList)
        {

            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
            SqlCommand Com;
            try
            {
                Con.Open();
                Com = new SqlCommand();
                Com.CommandText = "[dbo].DeleteItemLM_Domestic_AWB";
                Com.Parameters.Add(new SqlParameter("@ID", SqlDbType.Int));
                foreach (CPKLM_Domestic_AWB ObjCPKLM_Domestic_AWB in DeleteList)
                {
                    BeginTrans(Com, Con);
                    Com.Parameters[0].Value = Convert.ToInt32(ObjCPKLM_Domestic_AWB.ID);
                    EndTrans(Com, Con);
                }
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
                DeleteList.Clear();
            }
            return Exp;
        }

        public Exception DeleteList(string WhereClause)
        {

            return SetList(WhereClause, true);
        }

        #endregion
        #region "Save Methods"
        public Exception SaveMethod(List<CVarLM_Domestic_AWB> SaveList)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
            SqlCommand Com;
            try
            {
                Con.Open();
                Com = new SqlCommand();
                Com.Parameters.Add(new SqlParameter("@AWBNumber", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ConsigneeID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ActWgt", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@DimWgt", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@ChgWgt", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Pcs", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@CODAmount", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Description", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@Remarks", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@creationDate", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@CreatorUserID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ConsigneeName", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneeCityID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ConsigneeRegionID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ConsigneePhone1", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneePhone2", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneeCompanyName", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneeSenderName", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneeAccountNo", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneeCity", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ConsigneeAddress", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperName", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperCityID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ShipperRegionID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@ShipperPhone1", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperPhone2", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperCompanyName", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperSenderName", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperAccountNo", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperCity", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@ShipperAddress", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@PaymentTypeID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@StoreID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@PickupAddress", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@EstimatedReceivedDate_Custody", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@ActualReceivedDate_Custody", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@EstimatedArrivalDateToStore", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@ActualArrivalDateToStore", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@EstimatedDeliveryDateFrom", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@EstimatedDeliveryDateTo", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@ActualDeliveryDate", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@TrackingStageID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@RunnerFromShipperID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@RunnerToConsigneeID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@IsClosed", SqlDbType.Bit));
                Com.Parameters.Add(new SqlParameter("@RateID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@PackageTypeID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@Quantity", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@SellingAmount", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@RateDetails", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@CommodityFees", SqlDbType.Decimal));
                SqlParameter paraID = Com.Parameters.Add(new SqlParameter("@ID", SqlDbType.Int, 0, ParameterDirection.Input, false, 0, 0, "ID", DataRowVersion.Default, null));
                foreach (CVarLM_Domestic_AWB ObjCVarLM_Domestic_AWB in SaveList)
                {
                    if (ObjCVarLM_Domestic_AWB.mIsChanges == true)
                    {
                        if (ObjCVarLM_Domestic_AWB.ID == 0)
                        {
                            Com.CommandText = "[dbo].InsertItemLM_Domestic_AWB";
                            paraID.Direction = ParameterDirection.Output;
                        }
                        else if (ObjCVarLM_Domestic_AWB.ID != 0)
                        {
                            Com.CommandText = "[dbo].UpdateItemLM_Domestic_AWB";
                            paraID.Direction = ParameterDirection.Input;
                        }
                        BeginTrans(Com, Con);
                        if (ObjCVarLM_Domestic_AWB.ID != 0)
                        {
                            Com.Parameters["@ID"].Value = ObjCVarLM_Domestic_AWB.ID;
                        }
                        Com.Parameters["@AWBNumber"].Value = ObjCVarLM_Domestic_AWB.AWBNumber;
                        Com.Parameters["@ShipperID"].Value = ObjCVarLM_Domestic_AWB.ShipperID;
                        Com.Parameters["@ConsigneeID"].Value = ObjCVarLM_Domestic_AWB.ConsigneeID;
                        Com.Parameters["@ActWgt"].Value = ObjCVarLM_Domestic_AWB.ActWgt;
                        Com.Parameters["@DimWgt"].Value = ObjCVarLM_Domestic_AWB.DimWgt;
                        Com.Parameters["@ChgWgt"].Value = ObjCVarLM_Domestic_AWB.ChgWgt;
                        Com.Parameters["@Pcs"].Value = ObjCVarLM_Domestic_AWB.Pcs;
                        Com.Parameters["@CODAmount"].Value = ObjCVarLM_Domestic_AWB.CODAmount;
                        Com.Parameters["@Description"].Value = ObjCVarLM_Domestic_AWB.Description;
                        Com.Parameters["@Remarks"].Value = ObjCVarLM_Domestic_AWB.Remarks;
                        Com.Parameters["@creationDate"].Value = ObjCVarLM_Domestic_AWB.creationDate;
                        Com.Parameters["@CreatorUserID"].Value = ObjCVarLM_Domestic_AWB.CreatorUserID;
                        Com.Parameters["@ConsigneeName"].Value = ObjCVarLM_Domestic_AWB.ConsigneeName;
                        Com.Parameters["@ConsigneeCityID"].Value = ObjCVarLM_Domestic_AWB.ConsigneeCityID;
                        Com.Parameters["@ConsigneeRegionID"].Value = ObjCVarLM_Domestic_AWB.ConsigneeRegionID;
                        Com.Parameters["@ConsigneePhone1"].Value = ObjCVarLM_Domestic_AWB.ConsigneePhone1;
                        Com.Parameters["@ConsigneePhone2"].Value = ObjCVarLM_Domestic_AWB.ConsigneePhone2;
                        Com.Parameters["@ConsigneeCompanyName"].Value = ObjCVarLM_Domestic_AWB.ConsigneeCompanyName;
                        Com.Parameters["@ConsigneeSenderName"].Value = ObjCVarLM_Domestic_AWB.ConsigneeSenderName;
                        Com.Parameters["@ConsigneeAccountNo"].Value = ObjCVarLM_Domestic_AWB.ConsigneeAccountNo;
                        Com.Parameters["@ConsigneeCity"].Value = ObjCVarLM_Domestic_AWB.ConsigneeCity;
                        Com.Parameters["@ConsigneeAddress"].Value = ObjCVarLM_Domestic_AWB.ConsigneeAddress;
                        Com.Parameters["@ShipperName"].Value = ObjCVarLM_Domestic_AWB.ShipperName;
                        Com.Parameters["@ShipperCityID"].Value = ObjCVarLM_Domestic_AWB.ShipperCityID;
                        Com.Parameters["@ShipperRegionID"].Value = ObjCVarLM_Domestic_AWB.ShipperRegionID;
                        Com.Parameters["@ShipperPhone1"].Value = ObjCVarLM_Domestic_AWB.ShipperPhone1;
                        Com.Parameters["@ShipperPhone2"].Value = ObjCVarLM_Domestic_AWB.ShipperPhone2;
                        Com.Parameters["@ShipperCompanyName"].Value = ObjCVarLM_Domestic_AWB.ShipperCompanyName;
                        Com.Parameters["@ShipperSenderName"].Value = ObjCVarLM_Domestic_AWB.ShipperSenderName;
                        Com.Parameters["@ShipperAccountNo"].Value = ObjCVarLM_Domestic_AWB.ShipperAccountNo;
                        Com.Parameters["@ShipperCity"].Value = ObjCVarLM_Domestic_AWB.ShipperCity;
                        Com.Parameters["@ShipperAddress"].Value = ObjCVarLM_Domestic_AWB.ShipperAddress;
                        Com.Parameters["@PaymentTypeID"].Value = ObjCVarLM_Domestic_AWB.PaymentTypeID;
                        Com.Parameters["@StoreID"].Value = ObjCVarLM_Domestic_AWB.StoreID;
                        Com.Parameters["@PickupAddress"].Value = ObjCVarLM_Domestic_AWB.PickupAddress;
                        Com.Parameters["@EstimatedReceivedDate_Custody"].Value = ObjCVarLM_Domestic_AWB.EstimatedReceivedDate_Custody;
                        Com.Parameters["@ActualReceivedDate_Custody"].Value = ObjCVarLM_Domestic_AWB.ActualReceivedDate_Custody;
                        Com.Parameters["@EstimatedArrivalDateToStore"].Value = ObjCVarLM_Domestic_AWB.EstimatedArrivalDateToStore;
                        Com.Parameters["@ActualArrivalDateToStore"].Value = ObjCVarLM_Domestic_AWB.ActualArrivalDateToStore;
                        Com.Parameters["@EstimatedDeliveryDateFrom"].Value = ObjCVarLM_Domestic_AWB.EstimatedDeliveryDateFrom;
                        Com.Parameters["@EstimatedDeliveryDateTo"].Value = ObjCVarLM_Domestic_AWB.EstimatedDeliveryDateTo;
                        Com.Parameters["@ActualDeliveryDate"].Value = ObjCVarLM_Domestic_AWB.ActualDeliveryDate;
                        Com.Parameters["@TrackingStageID"].Value = ObjCVarLM_Domestic_AWB.TrackingStageID;
                        Com.Parameters["@RunnerFromShipperID"].Value = ObjCVarLM_Domestic_AWB.RunnerFromShipperID;
                        Com.Parameters["@RunnerToConsigneeID"].Value = ObjCVarLM_Domestic_AWB.RunnerToConsigneeID;
                        Com.Parameters["@IsClosed"].Value = ObjCVarLM_Domestic_AWB.IsClosed;
                        Com.Parameters["@RateID"].Value = ObjCVarLM_Domestic_AWB.RateID;
                        Com.Parameters["@PackageTypeID"].Value = ObjCVarLM_Domestic_AWB.PackageTypeID;
                        Com.Parameters["@Quantity"].Value = ObjCVarLM_Domestic_AWB.Quantity;
                        Com.Parameters["@SellingAmount"].Value = ObjCVarLM_Domestic_AWB.SellingAmount;
                        Com.Parameters["@RateDetails"].Value = ObjCVarLM_Domestic_AWB.RateDetails;
                        Com.Parameters["@CommodityFees"].Value = ObjCVarLM_Domestic_AWB.CommodityFees;
                        EndTrans(Com, Con);
                        if (ObjCVarLM_Domestic_AWB.ID == 0)
                        {
                            ObjCVarLM_Domestic_AWB.ID = Convert.ToInt32(Com.Parameters["@ID"].Value);
                        }
                        ObjCVarLM_Domestic_AWB.mIsChanges = false;
                    }
                }
            }
            catch (Exception ex)
            {
                Exp = ex;
                if (tr != null)
                    tr.Rollback();
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        #endregion
        #region "Update Methods"
        public Exception UpdateList(string UpdateClause)
        {

            return SetList(UpdateClause, false);
        }

        #endregion
    }
}
