using System;
using System.Collections;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using System.Text;
/*This class is autogenerated by Khedrawy Code gen v.3.1*/
namespace Forwarding.MvcApp.Models.Administration.DisbursementLink.Generated
{
    [Serializable]
    public class CPKDAS_Vessels
    {
        #region "variables"
        private Int32 mVessel_ID;
        #endregion

        #region "Methods"
        public Int32 Vessel_ID
        {
            get { return mVessel_ID; }
            set { mVessel_ID = value; }
        }
        #endregion
    }
    [Serializable]
    public partial class CVarDAS_Vessels : CPKDAS_Vessels
    {
        #region "variables"
        internal Boolean mIsChanges = false;
        internal String mVessel_Code;
        internal String mSC_Serial;
        internal String mVessel_Name;
        internal String mCallSign;
        internal Int32 mCountryID;
        internal Decimal mGrossWeightTons;
        internal Decimal mNetWeightTons;
        internal Decimal mSCGRT_Tons;
        internal Decimal mSCNRT_Tons;
        internal Decimal mDraft;
        internal Decimal mBeam;
        internal Decimal mClient_ID;
        internal Int32 mVesselType_ID;
        internal Decimal mLOA;
        internal Int32 mYearOfBuild;
        internal String mIMO_No;
        internal Decimal mDeadWeight;
        internal Decimal mDraft_Aft;
        internal Decimal mMax_Tropical_Draft;
        internal DateTime mLastTransitDate;
        internal String mVessel_XName;
        internal String mRemarks;
        internal String mVesselEmail;
        internal String mVesselPhone;
        internal String mVesselFax;
        internal String mVesselTelx;
        internal Int32 mAddedBy;
        internal DateTime mAddedAt;
        internal Int32 mUpdatedBy;
        internal DateTime mUpdatedAt;
        internal String mClientName;
        #endregion

        #region "Methods"
        public String Vessel_Code
        {
            get { return mVessel_Code; }
            set { mIsChanges = true; mVessel_Code = value; }
        }
        public String SC_Serial
        {
            get { return mSC_Serial; }
            set { mIsChanges = true; mSC_Serial = value; }
        }
        public String Vessel_Name
        {
            get { return mVessel_Name; }
            set { mIsChanges = true; mVessel_Name = value; }
        }
        public String CallSign
        {
            get { return mCallSign; }
            set { mIsChanges = true; mCallSign = value; }
        }
        public Int32 CountryID
        {
            get { return mCountryID; }
            set { mIsChanges = true; mCountryID = value; }
        }
        public Decimal GrossWeightTons
        {
            get { return mGrossWeightTons; }
            set { mIsChanges = true; mGrossWeightTons = value; }
        }
        public Decimal NetWeightTons
        {
            get { return mNetWeightTons; }
            set { mIsChanges = true; mNetWeightTons = value; }
        }
        public Decimal SCGRT_Tons
        {
            get { return mSCGRT_Tons; }
            set { mIsChanges = true; mSCGRT_Tons = value; }
        }
        public Decimal SCNRT_Tons
        {
            get { return mSCNRT_Tons; }
            set { mIsChanges = true; mSCNRT_Tons = value; }
        }
        public Decimal Draft
        {
            get { return mDraft; }
            set { mIsChanges = true; mDraft = value; }
        }
        public Decimal Beam
        {
            get { return mBeam; }
            set { mIsChanges = true; mBeam = value; }
        }
        public Decimal Client_ID
        {
            get { return mClient_ID; }
            set { mIsChanges = true; mClient_ID = value; }
        }
        public Int32 VesselType_ID
        {
            get { return mVesselType_ID; }
            set { mIsChanges = true; mVesselType_ID = value; }
        }
        public Decimal LOA
        {
            get { return mLOA; }
            set { mIsChanges = true; mLOA = value; }
        }
        public Int32 YearOfBuild
        {
            get { return mYearOfBuild; }
            set { mIsChanges = true; mYearOfBuild = value; }
        }
        public String IMO_No
        {
            get { return mIMO_No; }
            set { mIsChanges = true; mIMO_No = value; }
        }
        public Decimal DeadWeight
        {
            get { return mDeadWeight; }
            set { mIsChanges = true; mDeadWeight = value; }
        }
        public Decimal Draft_Aft
        {
            get { return mDraft_Aft; }
            set { mIsChanges = true; mDraft_Aft = value; }
        }
        public Decimal Max_Tropical_Draft
        {
            get { return mMax_Tropical_Draft; }
            set { mIsChanges = true; mMax_Tropical_Draft = value; }
        }
        public DateTime LastTransitDate
        {
            get { return mLastTransitDate; }
            set { mIsChanges = true; mLastTransitDate = value; }
        }
        public String Vessel_XName
        {
            get { return mVessel_XName; }
            set { mIsChanges = true; mVessel_XName = value; }
        }
        public String Remarks
        {
            get { return mRemarks; }
            set { mIsChanges = true; mRemarks = value; }
        }
        public String VesselEmail
        {
            get { return mVesselEmail; }
            set { mIsChanges = true; mVesselEmail = value; }
        }
        public String VesselPhone
        {
            get { return mVesselPhone; }
            set { mIsChanges = true; mVesselPhone = value; }
        }
        public String VesselFax
        {
            get { return mVesselFax; }
            set { mIsChanges = true; mVesselFax = value; }
        }
        public String VesselTelx
        {
            get { return mVesselTelx; }
            set { mIsChanges = true; mVesselTelx = value; }
        }
        public Int32 AddedBy
        {
            get { return mAddedBy; }
            set { mIsChanges = true; mAddedBy = value; }
        }
        public DateTime AddedAt
        {
            get { return mAddedAt; }
            set { mIsChanges = true; mAddedAt = value; }
        }
        public Int32 UpdatedBy
        {
            get { return mUpdatedBy; }
            set { mIsChanges = true; mUpdatedBy = value; }
        }
        public DateTime UpdatedAt
        {
            get { return mUpdatedAt; }
            set { mIsChanges = true; mUpdatedAt = value; }
        }
        public String ClientName
        {
            get { return mClientName; }
            set { mClientName = value; }
        }
        #endregion

        #region Functions
        public Boolean GetIsChange()
        {
            return mIsChanges;
        }
        public void SetIsChange(Boolean IsChange)
        {
            mIsChanges = IsChange;
        }
        #endregion
    }

    public partial class CDAS_Vessels
    {
        #region "variables"
        /*If "App.Config" isnot exist add it to your Application
		Add this code after <Configuration> tag
		-------------------------------------------------------
		<appsettings>
		<add key="DisbursementConnectionString" value="............"/>
		</appsettings>
		-------------------------------------------------------
		where ".........." is connection string to database server*/
        private SqlTransaction tr;
        public List<CVarDAS_Vessels> lstCVarDAS_Vessels = new List<CVarDAS_Vessels>();
        public List<CPKDAS_Vessels> lstDeletedCPKDAS_Vessels = new List<CPKDAS_Vessels>();
        #endregion

        #region "Select Methods"
        public Exception GetList(string WhereClause)
        {
            return DataFill(WhereClause, true);
        }
        public Exception GetListPaging(Int32 PageSize, Int32 PageNumber, string WhereClause, string OrderBy, out Int32 TotalRecords)
        {
            return DataFill(PageSize, PageNumber, WhereClause, OrderBy, out TotalRecords);
        }
        public Exception GetListPagingCbo(Int32 PageSize, Int32 PageNumber, string WhereClause, string OrderBy)
        {
            return DataFillCbo(PageSize, PageNumber, WhereClause, OrderBy);
        }
        public Exception GetItem(Int32 Vessel_ID)
        {
            return DataFill(Convert.ToString(Vessel_ID), false);
        }
        private Exception DataFill(string Param, Boolean IsList)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;
                if (IsList == true)
                {
                    Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                    Com.CommandText = "[dbo].GetListDAS_Vessels";
                    Com.Parameters[0].Value = Param;
                }
                else
                {
                    Com.CommandText = "[dbo].GetItemDAS_Vessels";
                    Com.Parameters.Add(new SqlParameter("@Vessel_ID", SqlDbType.Int));
                    Com.Parameters[0].Value = Convert.ToInt32(Param);
                }
                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels ObjCVarDAS_Vessels = new CVarDAS_Vessels();
                        ObjCVarDAS_Vessels.Vessel_ID = Convert.ToInt32(dr["Vessel_ID"].ToString());
                        ObjCVarDAS_Vessels.mVessel_Code = Convert.ToString(dr["Vessel_Code"].ToString());
                        ObjCVarDAS_Vessels.mSC_Serial = Convert.ToString(dr["SC_Serial"].ToString());
                        ObjCVarDAS_Vessels.mVessel_Name = Convert.ToString(dr["Vessel_Name"].ToString());
                        ObjCVarDAS_Vessels.mCallSign = Convert.ToString(dr["CallSign"].ToString());
                        ObjCVarDAS_Vessels.mCountryID = Convert.ToInt32(dr["CountryID"].ToString());
                        ObjCVarDAS_Vessels.mGrossWeightTons = Convert.ToDecimal(dr["GrossWeightTons"].ToString());
                        ObjCVarDAS_Vessels.mNetWeightTons = Convert.ToDecimal(dr["NetWeightTons"].ToString());
                        ObjCVarDAS_Vessels.mSCGRT_Tons = Convert.ToDecimal(dr["SCGRT_Tons"].ToString());
                        ObjCVarDAS_Vessels.mSCNRT_Tons = Convert.ToDecimal(dr["SCNRT_Tons"].ToString());
                        ObjCVarDAS_Vessels.mDraft = Convert.ToDecimal(dr["Draft"].ToString());
                        ObjCVarDAS_Vessels.mBeam = Convert.ToDecimal(dr["Beam"].ToString());
                        ObjCVarDAS_Vessels.mClient_ID = Convert.ToInt64(dr["Client_ID"].ToString());
                        ObjCVarDAS_Vessels.mVesselType_ID = Convert.ToInt32(dr["VesselType_ID"].ToString());
                        ObjCVarDAS_Vessels.mLOA = Convert.ToDecimal(dr["LOA"].ToString());
                        ObjCVarDAS_Vessels.mYearOfBuild = Convert.ToInt32(dr["YearOfBuild"].ToString());
                        ObjCVarDAS_Vessels.mIMO_No = Convert.ToString(dr["IMO_No"].ToString());
                        ObjCVarDAS_Vessels.mDeadWeight = Convert.ToDecimal(dr["DeadWeight"].ToString());
                        ObjCVarDAS_Vessels.mDraft_Aft = Convert.ToDecimal(dr["Draft_Aft"].ToString());
                        ObjCVarDAS_Vessels.mMax_Tropical_Draft = Convert.ToDecimal(dr["Max_Tropical_Draft"].ToString());
                        ObjCVarDAS_Vessels.mLastTransitDate = Convert.ToDateTime(dr["LastTransitDate"].ToString());
                        ObjCVarDAS_Vessels.mVessel_XName = Convert.ToString(dr["Vessel_XName"].ToString());
                        ObjCVarDAS_Vessels.mRemarks = Convert.ToString(dr["Remarks"].ToString());
                        ObjCVarDAS_Vessels.mVesselEmail = Convert.ToString(dr["VesselEmail"].ToString());
                        ObjCVarDAS_Vessels.mVesselPhone = Convert.ToString(dr["VesselPhone"].ToString());
                        ObjCVarDAS_Vessels.mVesselFax = Convert.ToString(dr["VesselFax"].ToString());
                        ObjCVarDAS_Vessels.mVesselTelx = Convert.ToString(dr["VesselTelx"].ToString());
                        ObjCVarDAS_Vessels.mAddedBy = Convert.ToInt32(dr["AddedBy"].ToString());
                        ObjCVarDAS_Vessels.mAddedAt = Convert.ToDateTime(dr["AddedAt"].ToString());
                        ObjCVarDAS_Vessels.mUpdatedBy = Convert.ToInt32(dr["UpdatedBy"].ToString());
                        ObjCVarDAS_Vessels.mUpdatedAt = Convert.ToDateTime(dr["UpdatedAt"].ToString());
                        lstCVarDAS_Vessels.Add(ObjCVarDAS_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }

        private Exception DataFill(Int32 PageSize, Int32 PageNumber, string WhereClause, string OrderBy, out Int32 TotRecs)
        {
            Exception Exp = null;
            TotRecs = 0;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;
                Com.Parameters.Add(new SqlParameter("@PageSize", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@PageNumber", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                Com.Parameters.Add(new SqlParameter("@OrderBy", SqlDbType.VarChar));
                Com.CommandText = "[dbo].GetListPagingDAS_Vessels";
                Com.Parameters[0].Value = PageSize;
                Com.Parameters[1].Value = PageNumber;
                Com.Parameters[2].Value = WhereClause;
                Com.Parameters[3].Value = OrderBy;
                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels ObjCVarDAS_Vessels = new CVarDAS_Vessels();
                        ObjCVarDAS_Vessels.Vessel_ID = Convert.ToInt32(dr["Vessel_ID"].ToString());
                        ObjCVarDAS_Vessels.mVessel_Code = Convert.ToString(dr["Vessel_Code"].ToString());
                        ObjCVarDAS_Vessels.mSC_Serial = Convert.ToString(dr["SC_Serial"].ToString());
                        ObjCVarDAS_Vessels.mVessel_Name = Convert.ToString(dr["Vessel_Name"].ToString());
                        ObjCVarDAS_Vessels.mCallSign = Convert.ToString(dr["CallSign"].ToString());
                        ObjCVarDAS_Vessels.mCountryID = Convert.ToInt32(dr["CountryID"].ToString());
                        ObjCVarDAS_Vessels.mGrossWeightTons = Convert.ToDecimal(dr["GrossWeightTons"].ToString());
                        ObjCVarDAS_Vessels.mNetWeightTons = Convert.ToDecimal(dr["NetWeightTons"].ToString());
                        ObjCVarDAS_Vessels.mSCGRT_Tons = Convert.ToDecimal(dr["SCGRT_Tons"].ToString());
                        ObjCVarDAS_Vessels.mSCNRT_Tons = Convert.ToDecimal(dr["SCNRT_Tons"].ToString());
                        ObjCVarDAS_Vessels.mDraft = Convert.ToDecimal(dr["Draft"].ToString());
                        ObjCVarDAS_Vessels.mBeam = Convert.ToDecimal(dr["Beam"].ToString());
                        ObjCVarDAS_Vessels.mClient_ID = Convert.ToInt64(dr["Client_ID"].ToString());
                        ObjCVarDAS_Vessels.mVesselType_ID = Convert.ToInt32(dr["VesselType_ID"].ToString());
                        ObjCVarDAS_Vessels.mLOA = Convert.ToDecimal(dr["LOA"].ToString());
                        ObjCVarDAS_Vessels.mYearOfBuild = Convert.ToInt32(dr["YearOfBuild"].ToString());
                        ObjCVarDAS_Vessels.mIMO_No = Convert.ToString(dr["IMO_No"].ToString());
                        ObjCVarDAS_Vessels.mDeadWeight = Convert.ToDecimal(dr["DeadWeight"].ToString());
                        ObjCVarDAS_Vessels.mDraft_Aft = Convert.ToDecimal(dr["Draft_Aft"].ToString());
                        ObjCVarDAS_Vessels.mMax_Tropical_Draft = Convert.ToDecimal(dr["Max_Tropical_Draft"].ToString());
                        ObjCVarDAS_Vessels.mLastTransitDate = Convert.ToDateTime(dr["LastTransitDate"].ToString());
                        ObjCVarDAS_Vessels.mVessel_XName = Convert.ToString(dr["Vessel_XName"].ToString());
                        ObjCVarDAS_Vessels.mRemarks = Convert.ToString(dr["Remarks"].ToString());
                        ObjCVarDAS_Vessels.mVesselEmail = Convert.ToString(dr["VesselEmail"].ToString());
                        ObjCVarDAS_Vessels.mVesselPhone = Convert.ToString(dr["VesselPhone"].ToString());
                        ObjCVarDAS_Vessels.mVesselFax = Convert.ToString(dr["VesselFax"].ToString());
                        ObjCVarDAS_Vessels.mVesselTelx = Convert.ToString(dr["VesselTelx"].ToString());
                        ObjCVarDAS_Vessels.mAddedBy = Convert.ToInt32(dr["AddedBy"].ToString());
                        ObjCVarDAS_Vessels.mAddedAt = Convert.ToDateTime(dr["AddedAt"].ToString());
                        ObjCVarDAS_Vessels.mUpdatedBy = Convert.ToInt32(dr["UpdatedBy"].ToString());
                        ObjCVarDAS_Vessels.mUpdatedAt = Convert.ToDateTime(dr["UpdatedAt"].ToString());
                        TotRecs = Convert.ToInt32(dr["TotalRecords"].ToString());
                        lstCVarDAS_Vessels.Add(ObjCVarDAS_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        private Exception DataFillCbo(Int32 PageSize, Int32 PageNumber, string WhereClause, string OrderBy)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;
                Com.Parameters.Add(new SqlParameter("@PageSize", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@PageNumber", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@OrderBy", SqlDbType.VarChar));
                Com.CommandText = "[dbo].DAS_GetListPaging_VesselsCbo";
                Com.Parameters[0].Value = PageSize;
                Com.Parameters[1].Value = PageNumber;
                Com.Parameters[2].Value = WhereClause;
                Com.Parameters[3].Value = OrderBy;
                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels ObjCVarDAS_Vessels = new CVarDAS_Vessels();
                        ObjCVarDAS_Vessels.Vessel_ID = Convert.ToInt32(dr["Vessel_ID"].ToString());
                        ObjCVarDAS_Vessels.mVessel_Name = Convert.ToString(dr["Vessel_Name"].ToString());
                        lstCVarDAS_Vessels.Add(ObjCVarDAS_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }

        public Exception GetListForJobSearch(string Param)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;

                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                Com.CommandText = "[dbo].DAS_Vessels_GetListForJobSearch";
                Com.Parameters[0].Value = Param;


                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels Obj_CVar_Vessels = new CVarDAS_Vessels();
                        Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
                        Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
                        ///////////////COMMENTED 12-11-2019 ///////////////////////
                        //////////////Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
                        //////////////Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
                        //////////////Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
                        //////////////Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
                        //////////////Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
                        //////////////Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
                        //////////////Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
                        //////////////Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
                        //////////////Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
                        //////////////Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
                        //////////////Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
                        //////////////Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
                        //////////////Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
                        //////////////Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
                        //////////////Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
                        //////////////Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
                        //////////////Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
                        //////////////Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
                        //////////////Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
                        //////////////if (dr[21] != DBNull.Value)
                        //////////////{
                        //////////////    Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
                        //////////////}
                        //////////////Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
                        //////////////Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
                        //////////////Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
                        //////////////Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());

                        lstCVarDAS_Vessels.Add(Obj_CVar_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        //public List<CVar_Vessels> GetListForJobSearch(string Param)
        //{
        //    SqlDataReader dr = null;
        //    SqlParameter[] Param_Arr;
        //    lst_CVar_Vessels.Clear();

        //    try
        //    {
        //        Param_Arr = new SqlParameter[1];
        //        Param_Arr[0] = new SqlParameter("@WhereClause", SqlDbType.VarChar, 500);
        //        Param_Arr[0].Value = Param;
        //        dr = Globals.objDataAccess.QueryString("DAS_Vessels_GetListForJobSearch", Param_Arr);

        //        while (dr.Read())
        //        {
        //            /*Start DataReader*/
        //            CVar_Vessels Obj_CVar_Vessels = new CVar_Vessels();
        //            Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
        //            Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
        //            Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
        //            Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
        //            Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
        //            Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
        //            Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
        //            Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
        //            Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
        //            Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
        //            Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
        //            Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
        //            Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
        //            Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
        //            Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
        //            Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
        //            Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
        //            Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
        //            Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
        //            Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
        //            Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
        //            if (dr[21] != DBNull.Value)
        //            {
        //                Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
        //            }
        //            Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
        //            Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
        //            Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
        //            Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());

        //            lst_CVar_Vessels.Add(Obj_CVar_Vessels);
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        throw new Exception(ex.Message);
        //    }
        //    finally
        //    {
        //        if (dr != null)
        //        {
        //            dr.Close();
        //            dr.Dispose();
        //        }
        //    }
        //    return _lst_CVar_Vessels;
        //}

        public Exception GetListForDebitSearch(string Param)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;

                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                Com.CommandText = "[dbo].DAS_Vessels_GetListForDebitSearch";
                Com.Parameters[0].Value = Param;


                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels Obj_CVar_Vessels = new CVarDAS_Vessels();
                        Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
                        Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
                        ///////////////COMMENTED 12-11-2019 ///////////////////////
                        //////////////Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
                        //////////////Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
                        //////////////Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
                        //////////////Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
                        //////////////Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
                        //////////////Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
                        //////////////Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
                        //////////////Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
                        //////////////Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
                        //////////////Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
                        //////////////Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
                        //////////////Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
                        //////////////Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
                        //////////////Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
                        //////////////Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
                        //////////////Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
                        //////////////Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
                        //////////////Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
                        //////////////Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
                        //////////////if (dr[21] != DBNull.Value)
                        //////////////{
                        //////////////    Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
                        //////////////}
                        //////////////Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
                        //////////////Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
                        //////////////Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
                        //////////////Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());
                        lstCVarDAS_Vessels.Add(Obj_CVar_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        //public List<CVar_Vessels> GetListForDebitSearch(string Param)
        //{
        //    SqlDataReader dr = null;
        //    SqlParameter[] Param_Arr;
        //    lst_CVar_Vessels.Clear();

        //    try
        //    {
        //        Param_Arr = new SqlParameter[1];
        //        Param_Arr[0] = new SqlParameter("@WhereClause", SqlDbType.VarChar, 500);
        //        Param_Arr[0].Value = Param;
        //        dr = Globals.objDataAccess.QueryString("DAS_Vessels_GetListForDebitSearch", Param_Arr);

        //        while (dr.Read())
        //        {
        //            /*Start DataReader*/
        //            CVar_Vessels Obj_CVar_Vessels = new CVar_Vessels();
        //            Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
        //            Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
        //            Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
        //            Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
        //            Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
        //            Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
        //            Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
        //            Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
        //            Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
        //            Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
        //            Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
        //            Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
        //            Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
        //            Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
        //            Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
        //            Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
        //            Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
        //            Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
        //            Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
        //            Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
        //            Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
        //            if (dr[21] != DBNull.Value)
        //            {
        //                Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
        //            }
        //            Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
        //            Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
        //            Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
        //            Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());

        //            lst_CVar_Vessels.Add(Obj_CVar_Vessels);
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        throw new Exception(ex.Message);
        //    }
        //    finally
        //    {
        //        if (dr != null)
        //        {
        //            dr.Close();
        //            dr.Dispose();
        //        }
        //    }
        //    return _lst_CVar_Vessels;
        //}

        public Exception GetListForInquiryStatus(string Param)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;

                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                Com.CommandText = "[dbo].DAS_Vessels_GetListForInquiryStatus";
                Com.Parameters[0].Value = Param;


                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels Obj_CVar_Vessels = new CVarDAS_Vessels();
                        Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
                        Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());

                        ///////////////COMMENTED 12-11-2019 ///////////////////////
                        //////////////Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
                        //////////////Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
                        //////////////Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
                        //////////////Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
                        //////////////Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
                        //////////////Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
                        //////////////Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
                        //////////////Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
                        //////////////Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
                        //////////////Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
                        //////////////Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
                        //////////////Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
                        //////////////Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
                        //////////////Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
                        //////////////Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
                        //////////////Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
                        //////////////Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
                        //////////////Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
                        //////////////Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
                        //////////////if (dr[21] != DBNull.Value)
                        //////////////{
                        //////////////    Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
                        //////////////}
                        //////////////Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
                        //////////////Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
                        //////////////Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
                        //////////////Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());
                        lstCVarDAS_Vessels.Add(Obj_CVar_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        //public List<CVar_Vessels> GetListForInquiryStatus(string Param)
        //{
        //    SqlDataReader dr = null;
        //    SqlParameter[] Param_Arr;
        //    lst_CVar_Vessels.Clear();

        //    try
        //    {
        //        Param_Arr = new SqlParameter[1];
        //        Param_Arr[0] = new SqlParameter("@WhereClause", SqlDbType.VarChar, 500);
        //        Param_Arr[0].Value = Param;
        //        dr = Globals.objDataAccess.QueryString("DAS_Vessels_GetListForInquiryStatus", Param_Arr);

        //        while (dr.Read())
        //        {
        //            /*Start DataReader*/
        //            CVar_Vessels Obj_CVar_Vessels = new CVar_Vessels();
        //            Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
        //            Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
        //            Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
        //            Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
        //            Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
        //            Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
        //            Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
        //            Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
        //            Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
        //            Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
        //            Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
        //            Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
        //            Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
        //            Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
        //            Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
        //            Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
        //            Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
        //            Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
        //            Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
        //            Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
        //            Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
        //            if (dr[21] != DBNull.Value)
        //            {
        //                Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
        //            }
        //            Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
        //            Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
        //            Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
        //            Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());

        //            lst_CVar_Vessels.Add(Obj_CVar_Vessels);
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        throw new Exception(ex.Message);
        //    }
        //    finally
        //    {
        //        if (dr != null)
        //        {
        //            dr.Close();
        //            dr.Dispose();
        //        }
        //    }
        //    return _lst_CVar_Vessels;
        //}

        public Exception GetListForInvoiceSearch(string Param)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;

                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                Com.CommandText = "[dbo].DAS_Vessels_GetListForInvoiceSearch";
                Com.Parameters[0].Value = Param;


                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels Obj_CVar_Vessels = new CVarDAS_Vessels();
                        Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
                        Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());

                        ///////////////COMMENTED 12-11-2019 ///////////////////////
                        //////////////Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
                        //////////////Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
                        //////////////Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
                        //////////////Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
                        //////////////Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
                        //////////////Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
                        //////////////Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
                        //////////////Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
                        //////////////Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
                        //////////////Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
                        //////////////Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
                        //////////////Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
                        //////////////Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
                        //////////////Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
                        //////////////Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
                        //////////////Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
                        //////////////Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
                        //////////////Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
                        //////////////Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
                        //////////////if (dr[21] != DBNull.Value)
                        //////////////{
                        //////////////    Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
                        //////////////}
                        //////////////Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
                        //////////////Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
                        //////////////Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
                        //////////////Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());
                        lstCVarDAS_Vessels.Add(Obj_CVar_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        //public List<CVar_Vessels> GetListForInvoiceSearch(string Param)
        //{
        //    SqlDataReader dr = null;
        //    SqlParameter[] Param_Arr;
        //    lst_CVar_Vessels.Clear();

        //    try
        //    {
        //        Param_Arr = new SqlParameter[1];
        //        Param_Arr[0] = new SqlParameter("@WhereClause", SqlDbType.VarChar, 500);
        //        Param_Arr[0].Value = Param;
        //        dr = Globals.objDataAccess.QueryString("DAS_Vessels_GetListForInvoiceSearch", Param_Arr);

        //        while (dr.Read())
        //        {
        //            /*Start DataReader*/
        //            CVar_Vessels Obj_CVar_Vessels = new CVar_Vessels();
        //            Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
        //            Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
        //            Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
        //            Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
        //            Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
        //            Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
        //            Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
        //            Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
        //            Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
        //            Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
        //            Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
        //            Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
        //            Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
        //            Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
        //            Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
        //            Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
        //            Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
        //            Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
        //            Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
        //            Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
        //            Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
        //            if (dr[21] != DBNull.Value)
        //            {
        //                Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
        //            }
        //            Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
        //            Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
        //            Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
        //            Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());

        //            lst_CVar_Vessels.Add(Obj_CVar_Vessels);
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        throw new Exception(ex.Message);
        //    }
        //    finally
        //    {
        //        if (dr != null)
        //        {
        //            dr.Close();
        //            dr.Dispose();
        //        }
        //    }
        //    return _lst_CVar_Vessels;
        //}


        public Exception GetListForFDASearch(string Param)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            SqlDataReader dr;
            lstCVarDAS_Vessels.Clear();

            try
            {
                Con.Open();
                tr = Con.BeginTransaction(IsolationLevel.ReadCommitted);
                Com = new SqlCommand();
                Com.CommandType = CommandType.StoredProcedure;

                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                Com.CommandText = "[dbo].DAS_Vessels_GetListForFDASearch";
                Com.Parameters[0].Value = Param;


                Com.Transaction = tr;
                Com.Connection = Con;
                dr = Com.ExecuteReader();
                try
                {
                    while (dr.Read())
                    {
                        /*Start DataReader*/
                        CVarDAS_Vessels Obj_CVar_Vessels = new CVarDAS_Vessels();
                        Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
                        Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());


                        ///////////////COMMENTED 12-11-2019 ///////////////////////
                        //////////////Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
                        //////////////Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
                        //////////////Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
                        //////////////Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
                        //////////////Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
                        //////////////Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
                        //////////////Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
                        //////////////Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
                        //////////////Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
                        //////////////Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
                        //////////////Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
                        //////////////Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
                        //////////////Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
                        //////////////Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
                        //////////////Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
                        //////////////Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
                        //////////////Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
                        //////////////Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
                        //////////////Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
                        //////////////if (dr[21] != DBNull.Value)
                        //////////////{
                        //////////////    Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
                        //////////////}
                        //////////////Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
                        //////////////Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
                        //////////////Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
                        //////////////Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());
                        lstCVarDAS_Vessels.Add(Obj_CVar_Vessels);
                    }
                }
                catch (Exception ex)
                {
                    Exp = ex;
                }
                finally
                {
                    if (dr != null)
                    {
                        dr.Close();
                        dr.Dispose();
                    }
                }
                tr.Commit();
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        //public List<CVar_Vessels> GetListForFDASearch(string Param)
        //{
        //    SqlDataReader dr = null;
        //    SqlParameter[] Param_Arr;
        //    lst_CVar_Vessels.Clear();

        //    try
        //    {
        //        Param_Arr = new SqlParameter[1];
        //        Param_Arr[0] = new SqlParameter("@WhereClause", SqlDbType.VarChar, 500);
        //        Param_Arr[0].Value = Param;
        //        dr = Globals.objDataAccess.QueryString("DAS_Vessels_GetListForFDASearch", Param_Arr);

        //        while (dr.Read())
        //        {
        //            /*Start DataReader*/
        //            CVar_Vessels Obj_CVar_Vessels = new CVar_Vessels();
        //            Obj_CVar_Vessels.Vessel_ID = Convert.ToInt32(dr[0].ToString());
        //            Obj_CVar_Vessels.Vessel_Code = Convert.ToString(dr[1].ToString());
        //            Obj_CVar_Vessels.SC_Serial = Convert.ToString(dr[2].ToString());
        //            Obj_CVar_Vessels.Vessel_Name = Convert.ToString(dr[3].ToString());
        //            Obj_CVar_Vessels.CallSign = Convert.ToString(dr[4].ToString());
        //            Obj_CVar_Vessels.CountryID = Convert.ToInt32(dr[5].ToString());
        //            Obj_CVar_Vessels.GrossWeightTons = Convert.ToDecimal(dr[6].ToString());
        //            Obj_CVar_Vessels.NetWeightTons = Convert.ToDecimal(dr[7].ToString());
        //            Obj_CVar_Vessels.SCGRT_Tons = Convert.ToDecimal(dr[8].ToString());
        //            Obj_CVar_Vessels.SCNRT_Tons = Convert.ToDecimal(dr[9].ToString());
        //            Obj_CVar_Vessels.Draft = Convert.ToDecimal(dr[10].ToString());
        //            Obj_CVar_Vessels.Beam = Convert.ToDecimal(dr[11].ToString());
        //            Obj_CVar_Vessels.Client_ID = Convert.ToDecimal(dr[12].ToString());
        //            Obj_CVar_Vessels.VesselType_ID = Convert.ToInt32(dr[13].ToString());
        //            Obj_CVar_Vessels.LOA = Convert.ToDecimal(dr[14].ToString());
        //            Obj_CVar_Vessels.YearOfBuild = Convert.ToInt32(dr[15].ToString());
        //            Obj_CVar_Vessels.IMO_No = dr[16].ToString().Trim();
        //            Obj_CVar_Vessels.DeadWeight = Convert.ToDecimal(dr[17].ToString());
        //            Obj_CVar_Vessels.Draft_Aft = Convert.ToDecimal(dr[18].ToString());
        //            Obj_CVar_Vessels.Max_Tropical_Draft = Convert.ToDecimal(dr[19].ToString());
        //            Obj_CVar_Vessels.ClientName = Convert.ToString(dr[20].ToString());
        //            if (dr[21] != DBNull.Value)
        //            {
        //                Obj_CVar_Vessels.LastTransitDate = Convert.ToDateTime(dr[21].ToString());
        //            }
        //            Obj_CVar_Vessels.Vessel_XName = Convert.ToString(dr[22].ToString());
        //            Obj_CVar_Vessels.Remarks = Convert.ToString(dr[23].ToString());
        //            Obj_CVar_Vessels.VesselEmail = Convert.ToString(dr[24].ToString());
        //            Obj_CVar_Vessels.VesselPhone = Convert.ToString(dr[25].ToString());

        //            lst_CVar_Vessels.Add(Obj_CVar_Vessels);
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        throw new Exception(ex.Message);
        //    }
        //    finally
        //    {
        //        if (dr != null)
        //        {
        //            dr.Close();
        //            dr.Dispose();
        //        }
        //    }
        //    return _lst_CVar_Vessels;
        //}
        #endregion
        #region "Common Methods"
        private void BeginTrans(SqlCommand Com, SqlConnection Con)
        {

            tr = Con.BeginTransaction(IsolationLevel.Serializable);
            Com.CommandType = CommandType.StoredProcedure;
        }

        private void EndTrans(SqlCommand Com, SqlConnection Con)
        {

            Com.Transaction = tr;
            Com.Connection = Con;
            Com.ExecuteNonQuery();
            tr.Commit();
        }

        #endregion
        #region "Set List Method"
        private Exception SetList(string WhereClause, Boolean IsDelete)
        {

            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            try
            {
                Con.Open();
                Com = new SqlCommand();
                if (IsDelete == true)
                    Com.CommandText = "[dbo].DAS_Vessels_DeleteList";
                else
                    Com.CommandText = "[dbo].DAS_Vessels_UpdateList";
                Com.Parameters.Add(new SqlParameter("@WhereClause", SqlDbType.NVarChar));
                BeginTrans(Com, Con);
                Com.Parameters[0].Value = WhereClause;
                EndTrans(Com, Con);
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }

        #endregion
        #region "Delete Methods"
        public Exception DeleteItem(List<CPKDAS_Vessels> DeleteList)
        {

            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            try
            {
                Con.Open();
                Com = new SqlCommand();
                Com.CommandText = "[dbo].DAS_Vessels_DeleteItem";
                Com.Parameters.Add(new SqlParameter("@Vessel_ID", SqlDbType.Int));
                foreach (CPKDAS_Vessels ObjCPKDAS_Vessels in DeleteList)
                {
                    BeginTrans(Com, Con);
                    Com.Parameters[0].Value = Convert.ToInt32(ObjCPKDAS_Vessels.Vessel_ID);
                    EndTrans(Com, Con);
                }
            }
            catch (Exception ex)
            {
                Exp = ex;
            }
            finally
            {
                Con.Close();
                Con.Dispose();
                DeleteList.Clear();
            }
            return Exp;
        }

        public Exception DeleteList(string WhereClause)
        {

            return SetList(WhereClause, true);
        }

        #endregion
        #region "Save Methods"
        public Exception SaveMethod(List<CVarDAS_Vessels> SaveList)
        {
            Exception Exp = null;
            SqlConnection Con = new SqlConnection(ConfigurationManager.ConnectionStrings["DisbursementConnectionString"].ToString());
            SqlCommand Com;
            try
            {
                Con.Open();
                Com = new SqlCommand();
                Com.Parameters.Add(new SqlParameter("@Vessel_Code", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@SC_Serial", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@Vessel_Name", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@CallSign", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@CountryID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@GrossWeightTons", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@NetWeightTons", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@SCGRT_Tons", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@SCNRT_Tons", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Draft", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Beam", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Client_ID", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@VesselType_ID", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@LOA", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@YearOfBuild", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@IMO_No", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@DeadWeight", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Draft_Aft", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@Max_Tropical_Draft", SqlDbType.Decimal));
                Com.Parameters.Add(new SqlParameter("@LastTransitDate", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@Vessel_XName", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@Remarks", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@VesselEmail", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@VesselPhone", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@VesselFax", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@VesselTelx", SqlDbType.VarChar));
                Com.Parameters.Add(new SqlParameter("@AddedBy", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@AddedAt", SqlDbType.DateTime));
                Com.Parameters.Add(new SqlParameter("@UpdatedBy", SqlDbType.Int));
                Com.Parameters.Add(new SqlParameter("@UpdatedAt", SqlDbType.DateTime));
                SqlParameter paraVessel_ID = Com.Parameters.Add(new SqlParameter("@Vessel_ID", SqlDbType.Int, 0, ParameterDirection.Input, false, 0, 0, "Vessel_ID", DataRowVersion.Default, null));
                foreach (CVarDAS_Vessels ObjCVarDAS_Vessels in SaveList)
                {
                    if (ObjCVarDAS_Vessels.mIsChanges == true)
                    {
                        if (ObjCVarDAS_Vessels.Vessel_ID == 0)
                        {
                            Com.CommandText = "[dbo].DAS_Vessels_InsertItem";
                            paraVessel_ID.Direction = ParameterDirection.Output;
                        }
                        else if (ObjCVarDAS_Vessels.Vessel_ID != 0)
                        {
                            Com.CommandText = "[dbo].DAS_Vessels_UpdateItem";
                            paraVessel_ID.Direction = ParameterDirection.Input;
                        }
                        BeginTrans(Com, Con);
                        if (ObjCVarDAS_Vessels.Vessel_ID != 0)
                        {
                            Com.Parameters["@Vessel_ID"].Value = ObjCVarDAS_Vessels.Vessel_ID;
                        }
                        Com.Parameters["@Vessel_Code"].Value = ObjCVarDAS_Vessels.Vessel_Code;
                        Com.Parameters["@SC_Serial"].Value = ObjCVarDAS_Vessels.SC_Serial;
                        Com.Parameters["@Vessel_Name"].Value = ObjCVarDAS_Vessels.Vessel_Name;
                        Com.Parameters["@CallSign"].Value = ObjCVarDAS_Vessels.CallSign;
                        Com.Parameters["@CountryID"].Value = ObjCVarDAS_Vessels.CountryID;
                        Com.Parameters["@GrossWeightTons"].Value = ObjCVarDAS_Vessels.GrossWeightTons;
                        Com.Parameters["@NetWeightTons"].Value = ObjCVarDAS_Vessels.NetWeightTons;
                        Com.Parameters["@SCGRT_Tons"].Value = ObjCVarDAS_Vessels.SCGRT_Tons;
                        Com.Parameters["@SCNRT_Tons"].Value = ObjCVarDAS_Vessels.SCNRT_Tons;
                        Com.Parameters["@Draft"].Value = ObjCVarDAS_Vessels.Draft;
                        Com.Parameters["@Beam"].Value = ObjCVarDAS_Vessels.Beam;
                        Com.Parameters["@Client_ID"].Value = ObjCVarDAS_Vessels.Client_ID;
                        Com.Parameters["@VesselType_ID"].Value = ObjCVarDAS_Vessels.VesselType_ID;
                        Com.Parameters["@LOA"].Value = ObjCVarDAS_Vessels.LOA;
                        Com.Parameters["@YearOfBuild"].Value = ObjCVarDAS_Vessels.YearOfBuild;
                        Com.Parameters["@IMO_No"].Value = ObjCVarDAS_Vessels.IMO_No;
                        Com.Parameters["@DeadWeight"].Value = ObjCVarDAS_Vessels.DeadWeight;
                        Com.Parameters["@Draft_Aft"].Value = ObjCVarDAS_Vessels.Draft_Aft;
                        Com.Parameters["@Max_Tropical_Draft"].Value = ObjCVarDAS_Vessels.Max_Tropical_Draft;
                        //Com.Parameters["@LastTransitDate"].Value = ObjCVarDAS_Vessels.LastTransitDate;
                        if (ObjCVarDAS_Vessels.LastTransitDate.Year > 2000)
                        {
                            Com.Parameters["@LastTransitDate"].Value = ObjCVarDAS_Vessels.LastTransitDate;
                        }
                        else
                        {
                            Com.Parameters["@LastTransitDate"].Value = DBNull.Value;
                        }
                        Com.Parameters["@Vessel_XName"].Value = ObjCVarDAS_Vessels.Vessel_XName;
                        Com.Parameters["@Remarks"].Value = ObjCVarDAS_Vessels.Remarks;
                        Com.Parameters["@VesselEmail"].Value = ObjCVarDAS_Vessels.VesselEmail;
                        Com.Parameters["@VesselPhone"].Value = ObjCVarDAS_Vessels.VesselPhone;
                        Com.Parameters["@VesselFax"].Value = ObjCVarDAS_Vessels.VesselFax;
                        Com.Parameters["@VesselTelx"].Value = ObjCVarDAS_Vessels.VesselTelx;
                        Com.Parameters["@AddedBy"].Value = ObjCVarDAS_Vessels.AddedBy;
                        Com.Parameters["@AddedAt"].Value = ObjCVarDAS_Vessels.AddedAt;
                        Com.Parameters["@UpdatedBy"].Value = ObjCVarDAS_Vessels.UpdatedBy;
                        Com.Parameters["@UpdatedAt"].Value = ObjCVarDAS_Vessels.UpdatedAt;
                        EndTrans(Com, Con);
                        if (ObjCVarDAS_Vessels.Vessel_ID == 0)
                        {
                            ObjCVarDAS_Vessels.Vessel_ID = Convert.ToInt32(Com.Parameters["@Vessel_ID"].Value);
                        }
                        ObjCVarDAS_Vessels.mIsChanges = false;
                    }
                }
            }
            catch (Exception ex)
            {
                Exp = ex;
                if (tr != null)
                    tr.Rollback();
            }
            finally
            {
                Con.Close();
                Con.Dispose();
            }
            return Exp;
        }
        #endregion
        #region "Update Methods"
        public Exception UpdateList(string UpdateClause)
        {

            return SetList(UpdateClause, false);
        }

        #endregion
    }
}
